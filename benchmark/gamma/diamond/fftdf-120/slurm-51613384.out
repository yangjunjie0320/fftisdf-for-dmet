SLURMD_NODENAME = hpc-19-37
Start time = Wed Jul  9 01:18:14 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 4
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 32768
TMPDIR = /resnick/scratch/yangjunjie//diamond-fftdf-120/51613384/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-fftdf-120/51613384/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/gamma/diamond/fftdf-120/main.py with:
name: diamond
basis: cc-pvdz
density_fitting_method: fftdf-120
is_unrestricted: False
init_guess_method: minao
xc: None
df_to_read: None
kmesh: 1-1-1


Poscar path: /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/data/vasp/diamond.vasp
Loading basis for C from /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/code/../../data/basis/cc-pvdz.dat
Using FFTDF, method = fftdf-120
ke_cutoff = 120.0, mesh = [25 25 25]
Big error detected in the electron number of initial guess density matrix (Ne/cell = 7.74684)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.20087
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.59971
pop of  0 C 2py           0.59971
pop of  0 C 2pz           0.59971
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.20087
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.59971
pop of  1 C 2py           0.59971
pop of  1 C 2pz           0.59971
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000

WARN: ke_cutoff/mesh (120 / [25 25 25]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.37 Eh.
Recommended ke_cutoff/mesh are 646.329 / [57 57 57].



******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-fftdf-120/51613384/tmpukwe5wg9
max_memory 32768 MB (current use 121 MB)


******** PBC SCF flags ********
N kpts = 1
kpts = [[0. 0. 0.]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.6789035833440397
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -2.71561433338
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x7ffad72ed7b0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.77 sec, wall time      0.50 sec
E1 = 4.745319209223985  E_coul = -2.0192959013233747
init E= -10.0363810944187
    CPU time for initialize scf      2.29 sec, wall time      0.64 sec
HOMO = 0.687724151787  LUMO = 0.945382186135
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.05234802  0.68772415  0.68772415  0.68772415] [0.94538219 0.94538219 0.94538219 1.07477836 1.86272968 1.86272968
 2.02496835 2.13890592 2.13890592 2.13890592 2.75894639 2.75894639
 2.75894639 3.58446648 3.58446649 3.58446649 3.72651101 3.72651101
 4.78325779 4.78325779 4.78325779 5.21863431]
    CPU time for vj and vk      0.96 sec, wall time      0.24 sec
E1 = 4.754085094339883  E_coul = -2.1808191354568423
cycle= 1 E= -10.1891384434363  delta_E= -0.153  |g|= 0.343  |ddm|=  8.7
    CPU time for cycle= 1      1.00 sec, wall time      0.25 sec
HOMO = 0.270929736693  LUMO = 1.09704859084
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.62753121  0.27092974  0.27092974  0.27092974] [1.09704859 1.09704859 1.09704859 1.40471616 1.85951344 1.85951344
 2.06174877 2.1435733  2.1435733  2.1435733  2.73960039 2.73960039
 2.73960039 3.57018401 3.57018401 3.57018401 3.71837566 3.71837566
 4.77672373 4.77672373 4.77672373 5.2175602 ]
    CPU time for vj and vk      1.02 sec, wall time      0.25 sec
E1 = 4.787562321523944  E_coul = -2.2408701704581064
cycle= 2 E= -10.2157122512535  delta_E= -0.0266  |g|= 0.0745  |ddm|=  1.3
    CPU time for cycle= 2      1.07 sec, wall time      0.27 sec
HOMO = 0.259433896153  LUMO = 1.09123378072
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63490186  0.2594339   0.2594339   0.2594339 ] [1.09123378 1.09123378 1.09123378 1.39771312 1.85564458 1.85564458
 2.06547558 2.13992492 2.13992492 2.13992492 2.72772124 2.72772124
 2.72772124 3.56683344 3.56683344 3.56683344 3.71211978 3.71211978
 4.77073442 4.77073442 4.77073442 5.21128305]
    CPU time for vj and vk      1.00 sec, wall time      0.25 sec
E1 = 4.79904118851436  E_coul = -2.2536266012231594
cycle= 3 E= -10.2169898150281  delta_E= -0.00128  |g|= 0.00247  |ddm|= 0.689
    CPU time for cycle= 3      1.05 sec, wall time      0.27 sec
HOMO = 0.260037850159  LUMO = 1.09171978975
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63386061  0.26003785  0.26003785  0.26003785] [1.09171979 1.09171979 1.09171979 1.39841332 1.85586265 1.85586265
 2.06461316 2.14007186 2.14007186 2.14007186 2.72822213 2.72822213
 2.72822213 3.56692341 3.56692341 3.56692341 3.71250465 3.71250465
 4.77105513 4.77105513 4.77105513 5.21157786]
    CPU time for vj and vk      0.99 sec, wall time      0.25 sec
E1 = 4.798716285636154  E_coul = -2.2533028737153122
cycle= 4 E= -10.2169909903985  delta_E= -1.18e-06  |g|= 0.000189  |ddm|= 0.0487
    CPU time for cycle= 4      1.04 sec, wall time      0.26 sec
HOMO = 0.259998824083  LUMO = 1.09170860349
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63402166  0.25999882  0.25999882  0.25999882] [1.0917086  1.0917086  1.0917086  1.39839644 1.85585389 1.85585389
 2.06475007 2.14007264 2.14007264 2.14007264 2.72819955 2.72819955
 2.72819955 3.56692962 3.56692962 3.56692962 3.71250365 3.71250365
 4.77105256 4.77105256 4.77105256 5.21154437]
    CPU time for vj and vk      0.99 sec, wall time      0.25 sec
E1 = 4.798778534061105  E_coul = -2.2533651348784516
cycle= 5 E= -10.2169910031367  delta_E= -1.27e-08  |g|= 1.39e-05  |ddm|= 0.00407
    CPU time for cycle= 5      1.04 sec, wall time      0.26 sec
HOMO = 0.260001482621  LUMO = 1.09170828492
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63398032  0.26000148  0.26000148  0.26000148] [1.09170828 1.09170828 1.09170829 1.39839422 1.8558541  1.8558541
 2.06470987 2.14006984 2.14006984 2.14006984 2.72819672 2.72819672
 2.72819672 3.56692602 3.56692602 3.56692602 3.71250077 3.71250077
 4.7710496  4.7710496  4.7710496  5.21154305]
    CPU time for vj and vk      0.99 sec, wall time      0.25 sec
E1 = 4.798773525609076  E_coul = -2.253360126472665
Extra cycle  E= -10.2169910031829  delta_E= -4.62e-11  |g|= 1.85e-06  |ddm|= 0.000317
    CPU time for scf_cycle      8.54 sec, wall time      2.23 sec
    CPU time for SCF      9.23 sec, wall time      2.44 sec
converged SCF energy = -10.2169910031829
End time = Wed Jul  9 01:18:27 PM PDT 2025
