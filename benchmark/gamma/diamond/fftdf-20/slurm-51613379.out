SLURMD_NODENAME = hpc-54-15
Start time = Wed Jul  9 01:18:14 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 4
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 32768
TMPDIR = /resnick/scratch/yangjunjie//diamond-fftdf-20/51613379/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-fftdf-20/51613379/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/gamma/diamond/fftdf-20/main.py with:
name: diamond
basis: cc-pvdz
density_fitting_method: fftdf-20
is_unrestricted: False
init_guess_method: minao
xc: None
df_to_read: None
kmesh: 1-1-1


Poscar path: /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/data/vasp/diamond.vasp
Loading basis for C from /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/code/../../data/basis/cc-pvdz.dat
Using FFTDF, method = fftdf-20
ke_cutoff = 20.0, mesh = [11 11 11]
Big error detected in the electron number of initial guess density matrix (Ne/cell = 7.74684)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.20087
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.59971
pop of  0 C 2py           0.59971
pop of  0 C 2pz           0.59971
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.20087
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.59971
pop of  1 C 2py           0.59971
pop of  1 C 2pz           0.59971
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000

WARN: ke_cutoff/mesh (20 / [11 11 11]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 47 Eh.
Recommended ke_cutoff/mesh are 646.329 / [57 57 57].



******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-fftdf-20/51613379/tmp9yijmxht
max_memory 32768 MB (current use 121 MB)


******** PBC SCF flags ********
N kpts = 1
kpts = [[0. 0. 0.]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.6789035833440397
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -2.71561433338
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x7efe21ffd7b0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      0.33 sec, wall time      0.08 sec
E1 = 4.739154048877476  E_coul = -2.0190235367208085
init E= -10.0422738901626
    CPU time for initialize scf      0.55 sec, wall time      0.14 sec
HOMO = 0.689395157826  LUMO = 0.943555237638
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.05230507  0.68577134  0.68939516  0.68939516] [0.94355524 0.94676655 0.94676655 1.07496004 1.86271859 1.86271859
 2.006999   2.13592128 2.142653   2.142653   2.75357934 2.76820835
 2.76820835 3.58478879 3.58726808 3.58726808 3.72653286 3.72653286
 4.78275085 4.78306408 4.78306408 5.14626178]
    CPU time for vj and vk      0.17 sec, wall time      0.04 sec
E1 = 4.758158650991143  E_coul = -2.1814456963289865
cycle= 1 E= -10.1856914476571  delta_E= -0.143  |g|= 0.343  |ddm|= 8.88
    CPU time for cycle= 1      0.21 sec, wall time      0.06 sec
HOMO = 0.272534624338  LUMO = 1.09502470474
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.62737077  0.26883454  0.27253462  0.27253462] [1.0950247  1.09822541 1.09822541 1.40484409 1.85947205 1.85947205
 2.04341027 2.1404194  2.1474927  2.1474927  2.73372394 2.74873856
 2.74873856 3.57052634 3.57281614 3.57281614 3.71833568 3.71833568
 4.77615285 4.77642531 4.77642531 5.14410333]
    CPU time for vj and vk      0.17 sec, wall time      0.04 sec
E1 = 4.791968043637233  E_coul = -2.241947074431741
cycle= 2 E= -10.2123834331138  delta_E= -0.0267  |g|= 0.0768  |ddm|= 1.32
    CPU time for cycle= 2      0.22 sec, wall time      0.06 sec
HOMO = 0.261142468393  LUMO = 1.0892943291
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63459061  0.2573919   0.26114247  0.26114247] [1.08929433 1.09259424 1.09259424 1.39807546 1.85567309 1.85567309
 2.0471175  2.13672503 2.14377256 2.14377256 2.72215245 2.73710779
 2.73710779 3.56729263 3.56956999 3.56956999 3.71217    3.71217
 4.77022645 4.77050166 4.77050166 5.13763863]
    CPU time for vj and vk      0.17 sec, wall time      0.04 sec
E1 = 4.80312348961717  E_coul = -2.254414664649675
cycle= 3 E= -10.2136955773518  delta_E= -0.00131  |g|= 0.0127  |ddm|= 0.708
    CPU time for cycle= 3      0.22 sec, wall time      0.06 sec
HOMO = 0.261372731842  LUMO = 1.0894971872
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63406688  0.25761755  0.26137273  0.26137273] [1.08949719 1.09279606 1.09279606 1.39835714 1.85574482 1.85574482
 2.04659488 2.13680862 2.14385765 2.14385765 2.72221656 2.73717439
 2.7371744  3.56727033 3.56954587 3.56954587 3.71230906 3.71230906
 4.770335   4.77060907 4.77060907 5.13779339]
    CPU time for vj and vk      0.17 sec, wall time      0.04 sec
E1 = 4.803224108073838  E_coul = -2.2545499805761344
cycle= 4 E= -10.2137302748216  delta_E= -3.47e-05  |g|= 0.00203  |ddm|= 0.0597
    CPU time for cycle= 4      0.22 sec, wall time      0.06 sec
HOMO = 0.261577318601  LUMO = 1.08966933582
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63376382  0.25781938  0.26157732  0.26157732] [1.08966934 1.09296644 1.09296644 1.39861061 1.85582187 1.85582187
 2.04635215 2.13685922 2.14390872 2.14390872 2.72239916 2.73736019
 2.73736019 3.56731104 3.56958583 3.56958583 3.71244982 3.71244982
 4.77045227 4.77072541 4.77072541 5.13788253]
    CPU time for vj and vk      0.17 sec, wall time      0.04 sec
E1 = 4.8031178148898315  E_coul = -2.2544446166663903
cycle= 5 E= -10.2137312040959  delta_E= -9.29e-07  |g|= 0.000519  |ddm|= 0.0211
    CPU time for cycle= 5      0.22 sec, wall time      0.06 sec
HOMO = 0.261560160353  LUMO = 1.08966277025
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63380811  0.25780204  0.26156016  0.26156016] [1.08966277 1.09296018 1.09296018 1.39860134 1.85581771 1.85581771
 2.04638857 2.136856   2.14390575 2.14390575 2.72238828 2.73734948
 2.73734948 3.56731201 3.5695866  3.5695866  3.7124459  3.7124459
 4.77044806 4.77072105 4.77072105 5.13786635]
    CPU time for vj and vk      0.17 sec, wall time      0.04 sec
E1 = 4.803138560822922  E_coul = -2.254465459955064
Extra cycle  E= -10.2137313014514  delta_E= -9.74e-08  |g|= 0.000188  |ddm|= 0.00556
    CPU time for scf_cycle      1.86 sec, wall time      0.49 sec
    CPU time for SCF      2.54 sec, wall time      0.77 sec
converged SCF energy = -10.2137313014514
End time = Wed Jul  9 01:18:21 PM PDT 2025
