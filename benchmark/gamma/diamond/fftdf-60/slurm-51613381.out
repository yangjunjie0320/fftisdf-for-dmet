SLURMD_NODENAME = hpc-19-22
Start time = Wed Jul  9 01:18:14 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 4
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 32768
TMPDIR = /resnick/scratch/yangjunjie//diamond-fftdf-60/51613381/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-fftdf-60/51613381/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/gamma/diamond/fftdf-60/main.py with:
name: diamond
basis: cc-pvdz
density_fitting_method: fftdf-60
is_unrestricted: False
init_guess_method: minao
xc: None
df_to_read: None
kmesh: 1-1-1


Poscar path: /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/data/vasp/diamond.vasp
Loading basis for C from /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/code/../../data/basis/cc-pvdz.dat
Using FFTDF, method = fftdf-60
ke_cutoff = 60.0, mesh = [19 19 19]
Big error detected in the electron number of initial guess density matrix (Ne/cell = 7.74684)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.20087
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.59971
pop of  0 C 2py           0.59971
pop of  0 C 2pz           0.59971
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.20087
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.59971
pop of  1 C 2py           0.59971
pop of  1 C 2pz           0.59971
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000

WARN: ke_cutoff/mesh (60 / [19 19 19]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 8.2 Eh.
Recommended ke_cutoff/mesh are 646.329 / [57 57 57].



******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-fftdf-60/51613381/tmpo20t80jh
max_memory 32768 MB (current use 121 MB)


******** PBC SCF flags ********
N kpts = 1
kpts = [[0. 0. 0.]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.6789035833440397
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -2.71561433338
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x7f046e5f17b0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      0.85 sec, wall time      0.21 sec
E1 = 4.745312753082906  E_coul = -2.0192956884030075
init E= -10.0363873376394
    CPU time for initialize scf      1.18 sec, wall time      0.30 sec
HOMO = 0.687724130541  LUMO = 0.945381936262
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.05234828  0.68772388  0.68772413  0.68772413] [0.94538194 0.94538217 0.94538217 1.07477769 1.86272967 1.86272967
 2.02496238 2.13890522 2.13890588 2.13890588 2.75894494 2.75894629
 2.75894629 3.58446616 3.58446646 3.58446646 3.72651101 3.72651101
 4.78325772 4.78325781 4.78325781 5.21861174]
    CPU time for vj and vk      0.46 sec, wall time      0.11 sec
E1 = 4.754083322415301  E_coul = -2.1808184505608343
cycle= 1 E= -10.1891395304648  delta_E= -0.153  |g|= 0.343  |ddm|=  8.7
    CPU time for cycle= 1      0.50 sec, wall time      0.13 sec
HOMO = 0.270929807974  LUMO = 1.09704833318
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.62753126  0.27092947  0.27092981  0.27092981] [1.09704833 1.09704863 1.09704863 1.40471574 1.85951347 1.85951347
 2.06174262 2.14357238 2.14357326 2.14357326 2.73959859 2.73960036
 2.73960036 3.57018365 3.57018401 3.57018401 3.71837572 3.71837572
 4.77672367 4.77672378 4.77672378 5.21753741]
    CPU time for vj and vk      0.45 sec, wall time      0.11 sec
E1 = 4.787560571962493  E_coul = -2.2408694535127083
cycle= 2 E= -10.2157132838695  delta_E= -0.0266  |g|= 0.0745  |ddm|=  1.3
    CPU time for cycle= 2      0.50 sec, wall time      0.13 sec
HOMO = 0.259433972868  LUMO = 1.09123350934
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63490192  0.25943362  0.25943397  0.25943397] [1.09123351 1.09123382 1.09123382 1.3977127  1.85564462 1.85564462
 2.06546944 2.13992399 2.13992488 2.13992489 2.72771942 2.72772121
 2.72772121 3.56683308 3.56683345 3.56683345 3.71211984 3.71211984
 4.77073436 4.77073447 4.77073447 5.21126023]
    CPU time for vj and vk      0.45 sec, wall time      0.11 sec
E1 = 4.799039466454624  E_coul = -2.2536259132968333
cycle= 3 E= -10.2169908491615  delta_E= -0.00128  |g|= 0.00247  |ddm|= 0.689
    CPU time for cycle= 3      0.50 sec, wall time      0.13 sec
HOMO = 0.260037927928  LUMO = 1.09171951785
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63386066  0.26003758  0.26003793  0.26003793] [1.09171952 1.09171983 1.09171983 1.3984129  1.85586268 1.85586268
 2.06460702 2.14007093 2.14007183 2.14007183 2.72822031 2.7282221
 2.72822211 3.56692305 3.56692341 3.56692341 3.71250471 3.71250471
 4.77105507 4.77105518 4.77105518 5.21155505]
    CPU time for vj and vk      0.45 sec, wall time      0.11 sec
E1 = 4.798714559577571  E_coul = -2.253302181767168
cycle= 4 E= -10.2169920245089  delta_E= -1.18e-06  |g|= 0.000189  |ddm|= 0.0487
    CPU time for cycle= 4      0.53 sec, wall time      0.14 sec
HOMO = 0.259998902533  LUMO = 1.09170833176
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63402172  0.25999855  0.2599989   0.2599989 ] [1.09170833 1.09170864 1.09170864 1.39839601 1.85585393 1.85585393
 2.06474392 2.14007172 2.14007261 2.14007261 2.72819773 2.72819952
 2.72819952 3.56692927 3.56692963 3.56692963 3.71250371 3.71250371
 4.7710525  4.77105261 4.77105261 5.21152155]
    CPU time for vj and vk      0.46 sec, wall time      0.11 sec
E1 = 4.798776807181147  E_coul = -2.2533644421085035
cycle= 5 E= -10.2169920372467  delta_E= -1.27e-08  |g|= 1.39e-05  |ddm|= 0.00407
    CPU time for cycle= 5      0.51 sec, wall time      0.13 sec
HOMO = 0.260001561083  LUMO = 1.09170801317
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.63398037  0.26000121  0.26000156  0.26000156] [1.09170801 1.09170833 1.09170833 1.3983938  1.85585414 1.85585414
 2.06470373 2.14006891 2.14006981 2.14006981 2.7281949  2.72819669
 2.72819669 3.56692567 3.56692603 3.56692603 3.71250083 3.71250083
 4.77104954 4.77104965 4.77104965 5.21152024]
    CPU time for vj and vk      0.45 sec, wall time      0.11 sec
E1 = 4.798771798702631  E_coul = -2.253359433676228
Extra cycle  E= -10.2169920372929  delta_E= -4.62e-11  |g|= 1.85e-06  |ddm|= 0.000317
    CPU time for scf_cycle      4.22 sec, wall time      1.08 sec
    CPU time for SCF      4.73 sec, wall time      1.23 sec
converged SCF energy = -10.2169920372929
End time = Wed Jul  9 01:18:20 PM PDT 2025
