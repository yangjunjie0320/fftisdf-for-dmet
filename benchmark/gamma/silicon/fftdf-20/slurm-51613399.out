SLURMD_NODENAME = hpc-80-15
Start time = Wed Jul  9 01:18:15 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 4
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 32768
TMPDIR = /resnick/scratch/yangjunjie//silicon-fftdf-20/51613399/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//silicon-fftdf-20/51613399/
WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.

WARNING!
  Very diffused basis functions are found in the basis set. They may lead to severe
  linear dependence and numerical instability.  You can set  cell.exp_to_discard=0.1
  to remove the diffused Gaussians whose exponents are less than 0.1.


Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/gamma/silicon/fftdf-20/main.py with:
name: silicon
basis: cc-pvdz
density_fitting_method: fftdf-20
is_unrestricted: False
init_guess_method: minao
xc: None
df_to_read: None
kmesh: 1-1-1


Poscar path: /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/data/vasp/silicon.vasp
Loading basis for Si from /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/code/../../data/basis/cc-pvdz.dat
Using FFTDF, method = fftdf-20
ke_cutoff = 20.0, mesh = [17 17 17]
Big error detected in the electron number of initial guess density matrix (Ne/cell = 7.78646)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 Si 3s           2.41114
pop of  0 Si 4s           0.00000
pop of  0 Si 3px          0.52962
pop of  0 Si 3py          0.52962
pop of  0 Si 3pz          0.52962
pop of  0 Si 4px          0.00000
pop of  0 Si 4py          0.00000
pop of  0 Si 4pz          0.00000
pop of  0 Si 3dxy         0.00000
pop of  0 Si 3dyz         0.00000
pop of  0 Si 3dz^2        0.00000
pop of  0 Si 3dxz         0.00000
pop of  0 Si 3dx2-y2      0.00000
pop of  1 Si 3s           2.41114
pop of  1 Si 4s           0.00000
pop of  1 Si 3px          0.52962
pop of  1 Si 3py          0.52962
pop of  1 Si 3pz          0.52962
pop of  1 Si 4px          0.00000
pop of  1 Si 4py          0.00000
pop of  1 Si 4pz          0.00000
pop of  1 Si 3dxy         0.00000
pop of  1 Si 3dyz         0.00000
pop of  1 Si 3dz^2        0.00000
pop of  1 Si 3dxz         0.00000
pop of  1 Si 3dx2-y2      0.00000
 ** Mulliken atomic charges  **
charge of    0Si =     -0.00000
charge of    1Si =      0.00000

WARN: ke_cutoff/mesh (20 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.73 Eh.
Recommended ke_cutoff/mesh are 141.067 / [41 41 41].



******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/silicon-fftdf-20/51613399/tmp8yqd9u73
max_memory 32768 MB (current use 123 MB)


******** PBC SCF flags ********
N kpts = 1
kpts = [[0. 0. 0.]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.44365061214096385
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.77460244856
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x7f0a53aed7b0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      0.82 sec, wall time      0.21 sec
E1 = 2.2476284104683373  E_coul = -2.083714437818522
init E= -8.17607518691573
    CPU time for initialize scf      1.17 sec, wall time      0.30 sec
HOMO = 0.33007756148  LUMO = 0.41818244192
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.86045161  0.33007743  0.33007743  0.33007756] [0.41818244 0.46746608 0.46746608 0.46746618 0.79065492 0.79065492
 0.892295   0.92628935 0.92628952 0.92628952 1.4360255  1.4360258
 1.4360258  1.48459904 1.48459904 1.48459905 1.52159697 1.52159697
 1.91044932 1.91044963 1.91044963 2.17965146]
    CPU time for vj and vk      0.50 sec, wall time      0.13 sec
E1 = 2.808481056963183  E_coul = -1.6292744909064603
cycle= 1 E= -7.16078259350882  delta_E= 1.02  |g|= 0.137  |ddm|= 5.41
    CPU time for cycle= 1      0.55 sec, wall time      0.14 sec
HOMO = 0.0647801237832  LUMO = 0.575787978427
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.42365164  0.06478     0.06478     0.06478012] [0.57578798 0.57578798 0.57578807 0.62224572 0.80264115 0.80264115
 0.89081893 0.93727505 0.93727524 0.93727524 1.43684038 1.43684065
 1.43684065 1.49753155 1.49753156 1.49753156 1.53371422 1.53371422
 1.91623295 1.91623325 1.91623325 2.17102267]
    CPU time for vj and vk      0.48 sec, wall time      0.12 sec
E1 = 2.8164043189880865  E_coul = -1.649074018374512
cycle= 2 E= -7.17265885895197  delta_E= -0.0119  |g|= 0.0521  |ddm|= 1.15
    CPU time for cycle= 2      0.54 sec, wall time      0.14 sec
HOMO = 0.0589849846831  LUMO = 0.57600001612
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.42631722  0.05898487  0.05898487  0.05898498] [0.57600002 0.57600002 0.57600011 0.62121018 0.80007816 0.80007816
 0.89189993 0.93851623 0.93851641 0.93851641 1.43588317 1.43588345
 1.43588345 1.4940433  1.4940433  1.4940433  1.53139168 1.53139168
 1.9137724  1.9137727  1.9137727  2.16702042]
    CPU time for vj and vk      0.49 sec, wall time      0.12 sec
E1 = 2.8269303736882114  E_coul = -1.6617618825532763
cycle= 3 E= -7.17482066843061  delta_E= -0.00216  |g|= 0.00444  |ddm|= 1.19
    CPU time for cycle= 3      0.56 sec, wall time      0.14 sec
HOMO = 0.0594777247466  LUMO = 0.575970490668
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.42629232  0.05947761  0.05947761  0.05947772] [0.57597049 0.57597049 0.57597058 0.62084014 0.79989995 0.79989995
 0.89189962 0.93808892 0.9380891  0.9380891  1.43559364 1.43559392
 1.43559392 1.49380699 1.493807   1.493807   1.53118566 1.53118566
 1.91357048 1.91357079 1.91357079 2.16681334]
    CPU time for vj and vk      0.51 sec, wall time      0.13 sec
E1 = 2.827600473325371  E_coul = -1.6624476891574642
cycle= 4 E= -7.17483637539764  delta_E= -1.57e-05  |g|= 0.000129  |ddm|= 0.275
    CPU time for cycle= 4      0.60 sec, wall time      0.15 sec
HOMO = 0.0592577081663  LUMO = 0.575993203601
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.42637396  0.05925759  0.05925759  0.05925771] [0.5759932  0.5759932  0.5759933  0.62089311 0.79990022 0.79990022
 0.89194008 0.93824606 0.93824624 0.93824624 1.43567765 1.43567793
 1.43567793 1.49382953 1.49382954 1.49382954 1.53121289 1.53121289
 1.91359536 1.91359567 1.91359567 2.16680424]
    CPU time for vj and vk      0.48 sec, wall time      0.12 sec
E1 = 2.8276485584847255  E_coul = -1.6624957890990915
cycle= 5 E= -7.17483639017991  delta_E= -1.48e-08  |g|= 2.17e-05  |ddm|= 0.00814
    CPU time for cycle= 5      0.56 sec, wall time      0.15 sec
HOMO = 0.0592371743719  LUMO = 0.575993381854
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.42638281  0.05923706  0.05923706  0.05923717] [0.57599338 0.57599338 0.57599348 0.62089356 0.79989808 0.79989808
 0.89194492 0.93825914 0.93825932 0.93825932 1.43568338 1.43568366
 1.43568366 1.49382872 1.49382872 1.49382872 1.53121197 1.53121197
 1.91359543 1.91359574 1.91359574 2.16680262]
    CPU time for vj and vk      0.48 sec, wall time      0.12 sec
E1 = 2.8276562610302  E_coul = -1.6625034919421078
Extra cycle  E= -7.17483639047745  delta_E= -2.98e-10  |g|= 6.23e-06  |ddm|= 0.00122
    CPU time for scf_cycle      4.50 sec, wall time      1.15 sec
    CPU time for SCF      5.16 sec, wall time      1.36 sec
converged SCF energy = -7.17483639047745
End time = Wed Jul  9 01:18:26 PM PDT 2025
