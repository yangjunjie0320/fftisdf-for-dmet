SLURMD_NODENAME = hpc-22-07
Start time = Wed Jul  9 02:03:34 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 4
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 32768
TMPDIR = /resnick/scratch/yangjunjie//co2-fftisdf-140-30/51615175/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//co2-fftisdf-140-30/51615175/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/gamma/co2/fftisdf-140-30/main.py with:
name: co2
basis: cc-pvdz
density_fitting_method: fftisdf-140-30
is_unrestricted: False
init_guess_method: minao
xc: None
df_to_read: None
kmesh: 1-1-1


Poscar path: /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/data/vasp/co2.vasp
Loading basis for C from /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/code/../../data/basis/cc-pvdz.dat
Loading basis for O from /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/code/../../data/basis/cc-pvdz.dat
Using FFTISDF, method = fftisdf-140-30
ke_cutoff = 140.0, mesh = [59 59 59]
Using ke_cutoff = 140.0, cisdf = 30.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            1.93240
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.74077
pop of  0 C 2py           0.74077
pop of  0 C 2pz           0.74077
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            1.93240
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.74077
pop of  1 C 2py           0.74077
pop of  1 C 2pz           0.74077
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
pop of  2 C 2s            1.93240
pop of  2 C 3s            0.00000
pop of  2 C 2px           0.74077
pop of  2 C 2py           0.74077
pop of  2 C 2pz           0.74077
pop of  2 C 3px           0.00000
pop of  2 C 3py           0.00000
pop of  2 C 3pz           0.00000
pop of  2 C 3dxy          0.00000
pop of  2 C 3dyz          0.00000
pop of  2 C 3dz^2         0.00000
pop of  2 C 3dxz          0.00000
pop of  2 C 3dx2-y2       0.00000
pop of  3 C 2s            1.93240
pop of  3 C 3s            0.00000
pop of  3 C 2px           0.74077
pop of  3 C 2py           0.74077
pop of  3 C 2pz           0.74077
pop of  3 C 3px           0.00000
pop of  3 C 3py           0.00000
pop of  3 C 3pz           0.00000
pop of  3 C 3dxy          0.00000
pop of  3 C 3dyz          0.00000
pop of  3 C 3dz^2         0.00000
pop of  3 C 3dxz          0.00000
pop of  3 C 3dx2-y2       0.00000
pop of  4 O 2s            1.92764
pop of  4 O 3s            0.00000
pop of  4 O 2px           1.33143
pop of  4 O 2py           1.33143
pop of  4 O 2pz           1.33143
pop of  4 O 3px           0.00000
pop of  4 O 3py           0.00000
pop of  4 O 3pz           0.00000
pop of  4 O 3dxy          0.00000
pop of  4 O 3dyz          0.00000
pop of  4 O 3dz^2         0.00000
pop of  4 O 3dxz          0.00000
pop of  4 O 3dx2-y2       0.00000
pop of  5 O 2s            1.92764
pop of  5 O 3s            0.00000
pop of  5 O 2px           1.33143
pop of  5 O 2py           1.33143
pop of  5 O 2pz           1.33143
pop of  5 O 3px           0.00000
pop of  5 O 3py           0.00000
pop of  5 O 3pz           0.00000
pop of  5 O 3dxy          0.00000
pop of  5 O 3dyz          0.00000
pop of  5 O 3dz^2         0.00000
pop of  5 O 3dxz          0.00000
pop of  5 O 3dx2-y2       0.00000
pop of  6 O 2s            1.92764
pop of  6 O 3s            0.00000
pop of  6 O 2px           1.33143
pop of  6 O 2py           1.33143
pop of  6 O 2pz           1.33143
pop of  6 O 3px           0.00000
pop of  6 O 3py           0.00000
pop of  6 O 3pz           0.00000
pop of  6 O 3dxy          0.00000
pop of  6 O 3dyz          0.00000
pop of  6 O 3dz^2         0.00000
pop of  6 O 3dxz          0.00000
pop of  6 O 3dx2-y2       0.00000
pop of  7 O 2s            1.92764
pop of  7 O 3s            0.00000
pop of  7 O 2px           1.33143
pop of  7 O 2py           1.33143
pop of  7 O 2pz           1.33143
pop of  7 O 3px           0.00000
pop of  7 O 3py           0.00000
pop of  7 O 3pz           0.00000
pop of  7 O 3dxy          0.00000
pop of  7 O 3dyz          0.00000
pop of  7 O 3dz^2         0.00000
pop of  7 O 3dxz          0.00000
pop of  7 O 3dx2-y2       0.00000
pop of  8 O 2s            1.92764
pop of  8 O 3s            0.00000
pop of  8 O 2px           1.33143
pop of  8 O 2py           1.33143
pop of  8 O 2pz           1.33143
pop of  8 O 3px           0.00000
pop of  8 O 3py           0.00000
pop of  8 O 3pz           0.00000
pop of  8 O 3dxy          0.00000
pop of  8 O 3dyz          0.00000
pop of  8 O 3dz^2         0.00000
pop of  8 O 3dxz          0.00000
pop of  8 O 3dx2-y2       0.00000
pop of  9 O 2s            1.92764
pop of  9 O 3s            0.00000
pop of  9 O 2px           1.33143
pop of  9 O 2py           1.33143
pop of  9 O 2pz           1.33143
pop of  9 O 3px           0.00000
pop of  9 O 3py           0.00000
pop of  9 O 3pz           0.00000
pop of  9 O 3dxy          0.00000
pop of  9 O 3dyz          0.00000
pop of  9 O 3dz^2         0.00000
pop of  9 O 3dxz          0.00000
pop of  9 O 3dx2-y2       0.00000
pop of  10 O 2s           1.92764
pop of  10 O 3s           0.00000
pop of  10 O 2px          1.33143
pop of  10 O 2py          1.33143
pop of  10 O 2pz          1.33143
pop of  10 O 3px          0.00000
pop of  10 O 3py          0.00000
pop of  10 O 3pz          0.00000
pop of  10 O 3dxy         0.00000
pop of  10 O 3dyz         0.00000
pop of  10 O 3dz^2        0.00000
pop of  10 O 3dxz         0.00000
pop of  10 O 3dx2-y2      0.00000
pop of  11 O 2s           1.92764
pop of  11 O 3s           0.00000
pop of  11 O 2px          1.33143
pop of  11 O 2py          1.33143
pop of  11 O 2pz          1.33143
pop of  11 O 3px          0.00000
pop of  11 O 3py          0.00000
pop of  11 O 3pz          0.00000
pop of  11 O 3dxy         0.00000
pop of  11 O 3dyz         0.00000
pop of  11 O 3dz^2        0.00000
pop of  11 O 3dxz         0.00000
pop of  11 O 3dx2-y2      0.00000
 ** Mulliken atomic charges  **
charge of    0C =     -0.15471
charge of    1C =     -0.15471
charge of    2C =     -0.15471
charge of    3C =     -0.15471
charge of    4O =      0.07808
charge of    5O =      0.07808
charge of    6O =      0.07808
charge of    7O =      0.07808
charge of    8O =      0.07808
charge of    9O =      0.07808
charge of   10O =      0.07808
charge of   11O =      0.07808
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (140 / [59 59 59]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 3.6 Eh.
Recommended ke_cutoff/mesh are 1047.9 / [157 157 157].

Select interpolating points with local Cholesky decomposition:
CHOLESKY_MAX_SIZE = 20000, BLKSIZE = 56
ngrid = 205379, blksize = 18704
ngrid // blksize = 10, ngrid % blksize = 18339
Cholesky decomposition for grids [      0,   18704], rank = 2535
Cholesky decomposition for grids [  18704,   37408], rank = 2483
Cholesky decomposition for grids [  37408,   56112], rank = 2475
Cholesky decomposition for grids [  56112,   74816], rank = 2503
Cholesky decomposition for grids [  74816,   93520], rank = 2459
Cholesky decomposition for grids [  93520,  112224], rank = 2507
Cholesky decomposition for grids [ 112224,  130928], rank = 2557
Cholesky decomposition for grids [ 130928,  149632], rank = 2511
Cholesky decomposition for grids [ 149632,  168336], rank = 2447
Cholesky decomposition for grids [ 168336,  187040], rank = 2500
Cholesky decomposition for grids [ 187040,  205379], rank = 2436
Parent grid size = 205379, Cholesky rank = 8514
nao = 156, nip = 4680, cisdf =  30.00
Largest Cholesky weight:   1.20e+00
Smallest remaining weight: 6.98e-06
Largest discarded weight:  6.98e-06
Total remaining weight:    2.79e+02
Total discarded weight:    5.17e-03
    CPU time for selecting interpolating points    808.27 sec, wall time    708.37 sec


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [59 59 59] (205379 PWs)
lstsq tol = 1e-08
kmesh = [1 1 1]
nip = 4680
nao = 156
cisdf =  30.00
isdf_to_save = /resnick/scratch/yangjunjie//co2-fftisdf-140-30/51615175/isdf.h5

Out-core version is used for eta_kpt.
shape = (4680, 205379)
disk space required: 1.54e+01 GB
blksize = 18704, ngrid = 205379
approximate memory needed for each block:   1.40e+00 GB
approximate memory needed for each k-point: 1.54e+01 GB
max_memory: 3.26e+01 GB

Computing eta_kpt
    CPU time for eta_kpt[      0:  18704]      7.04 sec, wall time      2.93 sec
    CPU time for eta_kpt[  18704:  37408]      7.90 sec, wall time      3.91 sec
    CPU time for eta_kpt[  37408:  56112]     14.19 sec, wall time     10.69 sec
    CPU time for eta_kpt[  56112:  74816]     21.94 sec, wall time     13.76 sec
    CPU time for eta_kpt[  74816:  93520]     10.44 sec, wall time      6.56 sec
    CPU time for eta_kpt[  93520: 112224]     13.91 sec, wall time     10.24 sec
    CPU time for eta_kpt[ 112224: 130928]     36.56 sec, wall time     21.68 sec
    CPU time for eta_kpt[ 130928: 149632]     36.60 sec, wall time     20.47 sec
    CPU time for eta_kpt[ 149632: 168336]     25.09 sec, wall time     16.11 sec
    CPU time for eta_kpt[ 168336: 187040]      7.32 sec, wall time      4.18 sec
    CPU time for eta_kpt[ 187040: 205379]      6.91 sec, wall time      3.07 sec
    CPU time for building eta_kpt    193.13 sec, wall time    114.96 sec

Computing coul_kpt
/var/spool/slurmd/job51615175/slurm_script: line 42: 3099400 Killed                  python main.py --basis=cc-pvdz --density-fitting-method=fftisdf-140-30 --name=co2 --init-guess-method=minao
End time = Wed Jul  9 02:18:21 PM PDT 2025
slurmstepd: error: Detected 1 oom_kill event in StepId=51615175.batch. Some of the step tasks have been OOM Killed.
