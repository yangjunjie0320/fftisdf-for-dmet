SLURMD_NODENAME = hpc-35-06
Start time = Tue Jun  3 04:50:03 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-20/49984427/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-20/49984427/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/200/20/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-200-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-20
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2325, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 35937, selected grid size = 520
truncated values = 6.99e+01, estimated error = 3.28e-01
Number of interpolating points is 520.
    CPU time for building inpv_kpt     87.88 sec, wall time     79.94 sec

Out-core version is used for eta_kpt.
disk space required: 1.20e+00 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   1.20e+00 GB
memory needed for each k-point: 2.99e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     20.99 sec, wall time      1.88 sec
    CPU time for building eta_kpt     25.41 sec, wall time      2.02 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      8.89 sec, wall time      1.49 sec
    CPU time for coul_kpt[ 2 / 4]      3.70 sec, wall time      1.49 sec
    CPU time for coul_kpt[ 3 / 4]      3.68 sec, wall time      1.47 sec
    CPU time for coul_kpt[ 4 / 4]      3.68 sec, wall time      1.49 sec
    CPU time for building coul_kpt     20.63 sec, wall time      5.97 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-20/49984427/g93issnp


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-20/49984427/tmp8en3wcc5
max_memory 327680 MB (current use 390 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fcb4f392770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      7.06 sec, wall time      0.22 sec
E1 = (3.604511953301932+1.3160798458434153e-17j)  E_coul = (-4.238148576976158+2.231354428144771e-17j)
init E= -13.4207657692985
    CPU time for initialize scf     14.31 sec, wall time      0.46 sec
HOMO = 0.64214939509  LUMO = 0.776528955215
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422285  0.60527275  0.6092321   0.6421494 ] [0.85981276 0.88582556 0.91020208 1.12520017 1.79100292 1.80523368
 1.86205716 2.0834199  2.0874815  2.09925429 2.64579564 2.64767011
 2.64895139 3.55319445 3.55392133 3.55479501 3.65950959 3.66029056
 4.21011611 4.73495953 4.73541609 4.7359718 ]
   1 (-0.000 -0.000  0.500)   [-0.78015077 -0.50848217  0.46133139  0.50285039] [0.94785816 1.02143245 1.04032734 1.35354539 1.62942595 1.75601638
 1.81457138 1.82408328 2.11260053 2.11925184 2.95658413 3.06754751
 3.06862521 3.10243483 3.10320679 3.30379638 3.64927496 3.65340647
 3.76725067 3.76775938 5.13917992 9.64995961]
   2 ( 0.000  0.500 -0.000)   [-0.78014983 -0.50848286  0.46133266  0.50285093] [0.94785665 1.0214318  1.04032624 1.35354779 1.62942599 1.75601398
 1.81457147 1.82408367 2.11260123 2.11925489 2.95658628 3.0675474
 3.06863289 3.10243346 3.10321001 3.30379668 3.6492712  3.65340616
 3.76724779 3.76775239 5.13918147 9.64995945]
   3 ( 0.000  0.500  0.500)   [-0.41689086 -0.40450169  0.22475807  0.31063679] [0.77652896 0.84136639 1.40153331 1.40349299 1.67780216 1.68165995
 2.07043047 2.07586472 2.31225682 2.3146518  2.79346819 2.80080059
 2.87065992 2.87949509 2.95490062 2.95599702 3.67413177 3.67560437
 5.0476408  5.04822777 6.80908775 6.81454551]
    CPU time for vj and vk      7.13 sec, wall time      0.23 sec
E1 = (4.198028333791004+1.2574518159004201e-17j)  E_coul = (-2.2326127097480035+1.130751101503527e-17j)
cycle= 1 E= -10.8217135215812  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      7.63 sec, wall time      0.24 sec
HOMO = 0.352244677642  LUMO = 0.898272752002
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169413  0.3015621   0.34067913  0.35224468] [0.97853074 0.99133862 1.01471838 1.33231604 1.80554144 1.80601975
 1.88405066 2.11998906 2.12202265 2.12539465 2.70806698 2.71166871
 2.71193694 3.56353216 3.56539929 3.56997998 3.6975911  3.70486648
 4.22159052 4.77133423 4.77264654 4.77475487]
   1 (-0.000 -0.000  0.500)   [-0.39621709 -0.25657527  0.18712802  0.22273248] [1.09293315 1.10500426 1.15031104 1.39709589 1.68430031 1.81150426
 1.8470906  1.85166116 2.11920334 2.12573464 3.00549434 3.12357753
 3.12502638 3.13811501 3.14100284 3.32109553 3.66803532 3.66810697
 3.79986191 3.80638255 5.18613747 9.83349486]
   2 ( 0.000  0.500 -0.000)   [-0.39621729 -0.25657614  0.18712731  0.22273413] [1.09293043 1.10500473 1.15030903 1.39710217 1.68429903 1.81149752
 1.84709641 1.85165526 2.11920321 2.12573939 3.00549804 3.123577
 3.12502916 3.13811639 3.14100923 3.32109581 3.66804372 3.66810161
 3.7998564  3.80637037 5.18614046 9.83350091]
   3 ( 0.000  0.500  0.500)   [-0.25545655 -0.25122865  0.039564    0.07509067] [0.89827275 0.95899802 1.50273304 1.50995098 1.74944552 1.76464295
 2.07048709 2.07210284 2.32316331 2.33068144 2.84347753 2.85143022
 2.8850848  2.88514504 2.9837536  2.98719111 3.73224061 3.73350127
 5.07645022 5.07992446 6.89788271 6.8989939 ]
    CPU time for vj and vk      7.15 sec, wall time      0.23 sec
E1 = (4.194216532186809+1.5219541137258936e-17j)  E_coul = (-2.241273081829808+1.189663383252951e-17j)
cycle= 2 E= -10.8341856952672  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      7.80 sec, wall time      0.25 sec
HOMO = 0.34610309437  LUMO = 0.903475356684
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976095  0.30008532  0.33519637  0.34610309] [0.98176969 0.99581821 1.017114   1.33874435 1.80541258 1.80618297
 1.88486065 2.12065219 2.12313233 2.12643012 2.70744726 2.7103034
 2.7109571  3.56370324 3.56580823 3.56959714 3.69892348 3.70581979
 4.21947506 4.77237428 4.77325588 4.77525678]
   1 (-0.000 -0.000  0.500)   [-0.39588073 -0.25760831  0.18697362  0.21794638] [1.09766555 1.10849965 1.1515249  1.39893836 1.68507992 1.81195827
 1.84609442 1.8517961  2.11922417 2.12552355 3.00621382 3.12425882
 3.1252424  3.13885757 3.1412603  3.32162759 3.6676969  3.66834251
 3.80026254 3.80639134 5.18501974 9.82836197]
   2 ( 0.000  0.500 -0.000)   [-0.39588125 -0.25760934  0.18697296  0.21794826] [1.09766317 1.10850004 1.15152292 1.39894404 1.68507862 1.8119518
 1.84610009 1.85179006 2.11922395 2.12552786 3.00621713 3.12425834
 3.12524517 3.13885906 3.14126648 3.32162775 3.6676894  3.66835357
 3.80025655 3.80638036 5.18502304 9.82836831]
   3 ( 0.000  0.500  0.500)   [-0.25627649 -0.25205056  0.04011887  0.07062982] [0.90347536 0.95976471 1.50637324 1.51278063 1.75053851 1.76461101
 2.07003077 2.07148171 2.32338736 2.33115163 2.84349617 2.85177543
 2.88518476 2.88527012 2.98354973 2.9872399  3.73376356 3.73460063
 5.07653393 5.07919089 6.89473162 6.89640896]
    CPU time for vj and vk      7.13 sec, wall time      0.23 sec
E1 = (4.1934512630428555+1.5507261516850726e-17j)  E_coul = (-2.2411017373608466+1.2068746149065736e-17j)
cycle= 3 E= -10.8347796199422  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      7.76 sec, wall time      0.25 sec
HOMO = 0.346444575126  LUMO = 0.90377959647
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6692608   0.3004592   0.33535051  0.34644458] [0.98225071 0.99639752 1.01756046 1.33931799 1.80561577 1.8063601
 1.88472928 2.12080128 2.12322768 2.12657941 2.70783782 2.71065144
 2.71139353 3.5638079  3.56594972 3.56963321 3.69923819 3.70609108
 4.21952853 4.77265046 4.77350268 4.77549003]
   1 (-0.000 -0.000  0.500)   [-0.39527696 -0.25726759  0.18743763  0.21819264] [1.09808074 1.10896109 1.15171614 1.39901035 1.68522023 1.81233122
 1.84631103 1.8520322  2.11943151 2.12559855 3.00655848 3.1244984
 3.12539062 3.1393632  3.14171845 3.32174363 3.66778203 3.66848141
 3.80049004 3.80659862 5.18533335 9.82960988]
   2 ( 0.000  0.500 -0.000)   [-0.39527747 -0.25726862  0.18743699  0.21819453] [1.09807831 1.10896148 1.15171416 1.39901606 1.68521892 1.81232478
 1.84631671 1.85202614 2.11943131 2.12560287 3.0065618  3.1244979
 3.12539338 3.13936467 3.14172463 3.3217438  3.66777456 3.66849254
 3.80048408 3.80658765 5.18533662 9.82961624]
   3 ( 0.000  0.500  0.500)   [-0.25578328 -0.25164171  0.04053922  0.0709042 ] [0.9037796  0.95975866 1.50715042 1.51355916 1.75082523 1.76488214
 2.07011579 2.07149234 2.32349624 2.33138644 2.84384184 2.85206644
 2.88519618 2.88541502 2.98374959 2.9874657  3.73407565 3.73506137
 5.07677704 5.07937324 6.89525405 6.89710185]
    CPU time for vj and vk      7.20 sec, wall time      0.23 sec
E1 = (4.193480366799437+1.546653403362693e-17j)  E_coul = (-2.2411335271148913+1.2078093217707206e-17j)
cycle= 4 E= -10.8347823059397  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      7.87 sec, wall time      0.25 sec
HOMO = 0.3464006328  LUMO = 0.903766395997
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931395  0.30040185  0.33527424  0.34640063] [0.98222697 0.99636389 1.01752455 1.3392628  1.8056035  1.80633719
 1.88474297 2.12079155 2.12320642 2.12656657 2.70778172 2.71059341
 2.7113463  3.5637958  3.56593886 3.5696151  3.69920907 3.70606093
 4.21951173 4.77262603 4.77347394 4.77546081]
   1 (-0.000 -0.000  0.500)   [-0.39529793 -0.2573363   0.187389    0.2181273 ] [1.09803873 1.1089321  1.15169196 1.39901579 1.68519108 1.812291
 1.84626745 1.8519952  2.11942436 2.12557401 3.00652688 3.12448647
 3.12537333 3.13931146 3.14166352 3.32173581 3.66776269 3.66847225
 3.80045726 3.80656552 5.18529505 9.82943466]
   2 ( 0.000  0.500 -0.000)   [-0.39529845 -0.25733733  0.18738836  0.21812919] [1.09803631 1.10893248 1.15168997 1.3990215  1.68518977 1.81228457
 1.84627313 1.85198915 2.11942416 2.12557832 3.0065302  3.12448597
 3.12537609 3.13931293 3.14166969 3.32173597 3.66775523 3.66848337
 3.80045129 3.80655455 5.18529832 9.82944102]
   3 ( 0.000  0.500  0.500)   [-0.25584157 -0.25169774  0.04048763  0.07086667] [0.9037664  0.95975018 1.50709887 1.51352707 1.75075836 1.76482119
 2.07009984 2.07148045 2.32347324 2.33136342 2.84380092 2.85202252
 2.88518686 2.88541165 2.9837179  2.98744681 3.73403353 3.73502365
 5.0767537  5.07934438 6.89516197 6.8970247 ]
    CPU time for vj and vk      7.63 sec, wall time      0.24 sec
E1 = (4.193501855085173+1.5461830414406198e-17j)  E_coul = (-2.2411550615351667+1.2078496933868466e-17j)
cycle= 5 E= -10.8347823520742  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00954
    CPU time for cycle= 5      8.26 sec, wall time      0.26 sec
HOMO = 0.346407619761  LUMO = 0.903767554094
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931118  0.30040277  0.33527476  0.34640762] [0.9822284  0.99636541 1.01752532 1.33926446 1.80560416 1.8063379
 1.88474193 2.12079121 2.12320573 2.12656729 2.70778291 2.71059495
 2.71134958 3.56379632 3.5659395  3.56961503 3.69920988 3.70606164
 4.21951275 4.77262693 4.77347461 4.77546152]
   1 (-0.000 -0.000  0.500)   [-0.39529262 -0.25733349  0.18739006  0.21812829] [1.09803952 1.10893356 1.1516914  1.39901498 1.68519225 1.81229325
 1.84626813 1.85199647 2.11942719 2.12557431 3.00652903 3.12448749
 3.1253735  3.13931302 3.14166462 3.32173577 3.66776258 3.66847324
 3.80045729 3.80656597 5.18529686 9.82944244]
   2 ( 0.000  0.500 -0.000)   [-0.39529313 -0.25733452  0.18738942  0.21813018] [1.0980371  1.10893394 1.15168941 1.39902069 1.68519093 1.81228681
 1.84627381 1.85199042 2.11942699 2.12557862 3.00653236 3.12448699
 3.12537625 3.13931449 3.1416708  3.32173593 3.66775512 3.66848436
 3.80045133 3.806555   5.18530013 9.8294488 ]
   3 ( 0.000  0.500  0.500)   [-0.25583799 -0.2516966   0.04048905  0.07087086] [0.90376755 0.95974975 1.50710046 1.51353177 1.75075872 1.7648201
 2.07010075 2.07148069 2.32347291 2.33136491 2.84380222 2.85202324
 2.88518592 2.88541302 2.98371848 2.98744839 3.73403326 3.73502604
 5.07675497 5.07934541 6.89516434 6.89702997]
    CPU time for vj and vk      7.22 sec, wall time      0.23 sec
E1 = (4.193502430633312+1.546194391818992e-17j)  E_coul = (-2.2411556379622537+1.2078459967513237e-17j)
Extra cycle  E= -10.8347823529532  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     61.45 sec, wall time      1.96 sec
    CPU time for SCF     63.71 sec, wall time      2.04 sec
converged SCF energy = -10.8347823529532
**** SCF Summaries ****
Total Energy =                         -10.834782352953182
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193502430633312
Two-electron Energy =                   -2.241155637962254
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.43 sec, wall time      0.05 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 431 MB)
    CPU time for KMP2      4.30 sec, wall time      0.13 sec
E(KMP2) = -11.0642771116824  E_corr = -0.22949475872921
E(SCS-KMP2) = -11.0587864592795  E_corr = -0.224004106326321
E_corr(same-spin) = -0.0592956970946897
E_corr(oppo-spin) = -0.17019906163452
End time = Tue Jun  3 04:51:35 PM PDT 2025
