SLURMD_NODENAME = hpc-53-05
Start time = Tue Jun  3 10:58:47 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-30/49986255/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-30/49986255/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/200/30/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-200-30
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-30
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 30.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 30.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2325, c0 =  30.00, nao = 26, nip = 780
Parent grid size = 35937, selected grid size = 780
truncated values = 7.01e+01, estimated error = 5.27e-02
Number of interpolating points is 780.
    CPU time for building inpv_kpt     85.03 sec, wall time     76.85 sec

Out-core version is used for eta_kpt.
disk space required: 1.79e+00 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   1.79e+00 GB
memory needed for each k-point: 4.48e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     23.36 sec, wall time      2.66 sec
    CPU time for building eta_kpt     27.71 sec, wall time      2.80 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     11.07 sec, wall time      2.91 sec
    CPU time for coul_kpt[ 2 / 4]      5.58 sec, wall time      2.90 sec
    CPU time for coul_kpt[ 3 / 4]      5.60 sec, wall time      2.89 sec
    CPU time for coul_kpt[ 4 / 4]      5.64 sec, wall time      2.96 sec
    CPU time for building coul_kpt     29.13 sec, wall time     11.71 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-30/49986255/zjm5rj0s


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-30/49986255/tmphgha5tro
max_memory 327680 MB (current use 408 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fa6ca352770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      8.45 sec, wall time      0.27 sec
E1 = (3.6045119533019316-2.722923818986536e-18j)  E_coul = (-4.238151427198949+3.102717999139514e-17j)
init E= -13.4207686195213
    CPU time for initialize scf     15.41 sec, wall time      0.49 sec
HOMO = 0.642148617199  LUMO = 0.776527958071
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422408  0.60527272  0.60923107  0.64214862] [0.85981248 0.88582627 0.91020205 1.12520312 1.7910034  1.80523335
 1.86205241 2.08341774 2.08748604 2.09924995 2.64579665 2.64766403
 2.6489525  3.5531974  3.55392463 3.55480225 3.65950813 3.66029215
 4.2101212  4.73494809 4.73541843 4.73595952]
   1 (-0.000 -0.000  0.500)   [-0.78015265 -0.50848297  0.46133111  0.50284987] [0.94785947 1.02143216 1.04032678 1.35354545 1.62942679 1.7560139
 1.81456935 1.82408297 2.11260147 2.11925381 2.95658595 3.0675515
 3.06862797 3.10243228 3.10320865 3.30379469 3.64927171 3.65340664
 3.76724629 3.76776064 5.13917425 9.64996383]
   2 ( 0.000  0.500 -0.000)   [-0.78015263 -0.50848299  0.46133114  0.50284988] [0.94785962 1.02143225 1.0403268  1.35354522 1.62942672 1.75601316
 1.81456934 1.82408261 2.11260173 2.11925382 2.95658594 3.06754998
 3.06862934 3.10243211 3.10320816 3.30379498 3.64927323 3.65340455
 3.76724411 3.76776237 5.13917595 9.64996192]
   3 ( 0.000  0.500  0.500)   [-0.41689396 -0.40450191  0.22475874  0.31063579] [0.77652796 0.84136831 1.40153404 1.40349577 1.67780162 1.6816616
 2.07043205 2.07586532 2.31225621 2.31465188 2.79346775 2.80080015
 2.8706581  2.87949516 2.95490339 2.95599489 3.67413145 3.67560553
 5.04761719 5.04821728 6.80908734 6.81454518]
    CPU time for vj and vk      8.30 sec, wall time      0.26 sec
E1 = (4.1980215442901825+1.154654726034219e-19j)  E_coul = (-2.2326090894217585+1.7724432595535168e-17j)
cycle= 1 E= -10.8217166907558  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      8.78 sec, wall time      0.28 sec
HOMO = 0.352246283624  LUMO = 0.89827114271
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169533  0.30156442  0.34067972  0.35224628] [0.97853057 0.99133826 1.0147195  1.33231911 1.80554182 1.80602107
 1.88404518 2.11998703 2.1220306  2.12540044 2.70808264 2.71166984
 2.71194167 3.56353432 3.56540958 3.56998233 3.69759014 3.70486821
 4.22159953 4.7713072  4.77263867 4.77472904]
   1 (-0.000 -0.000  0.500)   [-0.39621894 -0.25657632  0.18712858  0.22273359] [1.09293268 1.10500527 1.15031177 1.39709859 1.6843008  1.81150144
 1.84709064 1.8516602  2.11920463 2.12573904 3.00549424 3.12357454
 3.12502747 3.13812346 3.14101211 3.32109393 3.66804065 3.66809776
 3.79986093 3.80639234 5.18613521 9.83351657]
   2 ( 0.000  0.500 -0.000)   [-0.39621887 -0.25657633  0.18712852  0.22273359] [1.09293265 1.10500563 1.15031191 1.39709831 1.68430088 1.81150154
 1.84709151 1.851659   2.11920479 2.12573913 3.0054943  3.12357402
 3.12502628 3.13812185 3.14101252 3.32109451 3.66804069 3.66809899
 3.79985979 3.80639301 5.18613491 9.83350992]
   3 ( 0.000  0.500  0.500)   [-0.25545714 -0.25123118  0.03956556  0.0750913 ] [0.89827114 0.95900128 1.50274214 1.50995533 1.74944607 1.76464538
 2.07049152 2.07210857 2.32316369 2.33068231 2.84347556 2.8514327
 2.88507985 2.88514414 2.9837534  2.9871965  3.7322418  3.7335015
 5.07642018 5.07995079 6.89788055 6.89899801]
    CPU time for vj and vk      8.36 sec, wall time      0.26 sec
E1 = (4.194212621908283+5.427647475944292e-18j)  E_coul = (-2.241272834547146+1.8141371690146964e-17j)
cycle= 2 E= -10.8341893582631  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      8.98 sec, wall time      0.28 sec
HOMO = 0.346103879839  LUMO = 0.903473673931
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976243  0.30008736  0.33519625  0.34610388] [0.98176878 0.99581753 1.0171148  1.33874642 1.80541291 1.80618377
 1.88485567 2.12064984 2.12313965 2.1264356  2.70746146 2.71030296
 2.7109609  3.56370498 3.56581845 3.56959802 3.69892217 3.7058209
 4.21948382 4.7723458  4.7732478  4.77522963]
   1 (-0.000 -0.000  0.500)   [-0.39588291 -0.25760998  0.18697367  0.21794684] [1.09766472 1.10850027 1.15152526 1.39894041 1.6850795  1.81195464
 1.84609397 1.85179469 2.11922532 2.1255273  3.00621318 3.12425566
 3.12524275 3.13886472 3.14126846 3.32162575 3.66768847 3.66834707
 3.80026072 3.8064006  5.1850174  9.8283811 ]
   2 ( 0.000  0.500 -0.000)   [-0.39588284 -0.25761     0.18697358  0.21794685] [1.09766468 1.10850061 1.15152539 1.39894013 1.68507956 1.81195471
 1.84609472 1.85179355 2.11922549 2.12552737 3.00621319 3.124255
 3.12524187 3.13886341 3.14126889 3.32162657 3.66768951 3.66834736
 3.80025972 3.80640128 5.18501719 9.82837523]
   3 ( 0.000  0.500  0.500)   [-0.25627762 -0.25205356  0.04011992  0.07062979] [0.90347367 0.95976806 1.5063815  1.51278402 1.75053798 1.76461233
 2.07003502 2.07148698 2.32338724 2.33115211 2.84349364 2.85177695
 2.88517996 2.88526912 2.98354894 2.98724511 3.73376407 3.73460025
 5.0765005  5.07922011 6.89472917 6.89641184]
    CPU time for vj and vk      8.37 sec, wall time      0.26 sec
E1 = (4.193447596921476+6.0915061993294094e-18j)  E_coul = (-2.2411017514345337+1.8271420995324086e-17j)
cycle= 3 E= -10.8347833001373  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      8.97 sec, wall time      0.28 sec
HOMO = 0.346445398768  LUMO = 0.903778004905
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6692622   0.30046132  0.33535041  0.3464454 ] [0.98224986 0.99639691 1.01756133 1.33932019 1.80561609 1.80636092
 1.88472432 2.12079895 2.12323508 2.1265849  2.7078521  2.71065111
 2.71139745 3.56380968 3.56595994 3.56963416 3.69923693 3.70609225
 4.21953735 4.77262191 4.77349469 4.77546305]
   1 (-0.000 -0.000  0.500)   [-0.39527906 -0.25726922  0.18743779  0.21819313] [1.09807997 1.10896177 1.15171654 1.39901244 1.6852199  1.81232771
 1.8463106  1.85203081 2.11943272 2.12560235 3.00655789 3.12449527
 3.12539099 3.13937048 3.14172669 3.32174182 3.66777365 3.66848605
 3.80048832 3.80660796 5.18533104 9.82962926]
   2 ( 0.000  0.500 -0.000)   [-0.39527899 -0.25726924  0.1874377   0.21819314] [1.09807994 1.10896211 1.15171667 1.39901216 1.68521996 1.81232779
 1.84631136 1.85202967 2.11943289 2.12560243 3.00655791 3.1244946
 3.1253901  3.13936916 3.14172713 3.32174263 3.66777466 3.66848636
 3.80048732 3.80660866 5.18533083 9.82962339]
   3 ( 0.000  0.500  0.500)   [-0.25578435 -0.25164466  0.04054033  0.07090418] [0.903778   0.95976206 1.50715883 1.51356271 1.75082483 1.76488359
 2.07012006 2.07149764 2.32349617 2.33138696 2.84383937 2.85206799
 2.88519125 2.88541414 2.98374888 2.98747096 3.73407624 3.73506109
 5.07674355 5.07940279 6.89525173 6.89710487]
    CPU time for vj and vk      8.31 sec, wall time      0.26 sec
E1 = (4.193476720306925+6.060430615248162e-18j)  E_coul = (-2.2411335615006727+1.828203164382053e-17j)
cycle= 4 E= -10.834785986818  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      8.89 sec, wall time      0.28 sec
HOMO = 0.34640145634  LUMO = 0.90376479962
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931535  0.30040396  0.33527413  0.34640146] [0.98222612 0.99636327 1.01752541 1.33926499 1.80560382 1.80633802
 1.88473802 2.12078922 2.12321381 2.12657205 2.70779598 2.71059307
 2.71135021 3.56379757 3.56594907 3.56961605 3.69920781 3.70606209
 4.21952054 4.77259748 4.77346593 4.77543384]
   1 (-0.000 -0.000  0.500)   [-0.39530003 -0.25733794  0.18738915  0.21812778] [1.09803797 1.10893277 1.15169236 1.39901789 1.68519074 1.81228749
 1.84626702 1.85199381 2.11942557 2.1255778  3.00652629 3.12448334
 3.1253737  3.13931872 3.14167174 3.321734   3.66775431 3.66847688
 3.80045553 3.80657484 5.18529273 9.82945401]
   2 ( 0.000  0.500 -0.000)   [-0.39529996 -0.25733796  0.18738907  0.21812779] [1.09803794 1.10893311 1.15169248 1.3990176  1.6851908  1.81228757
 1.84626777 1.85199267 2.11942574 2.12557788 3.00652631 3.12448266
 3.12537281 3.13931741 3.14167218 3.32173481 3.66775532 3.6684772
 3.80045453 3.80657554 5.18529252 9.82944815]
   3 ( 0.000  0.500  0.500)   [-0.25584264 -0.25170069  0.04048874  0.07086665] [0.9037648  0.95975358 1.50710726 1.51353062 1.75075796 1.76482263
 2.07010411 2.07148574 2.32347316 2.33136394 2.84379843 2.85202406
 2.88518193 2.88541075 2.98371718 2.98745206 3.73403411 3.73502337
 5.0767202  5.07937395 6.89515965 6.8970277 ]
    CPU time for vj and vk      8.41 sec, wall time      0.27 sec
E1 = (4.1934982202023345+6.0585105941556235e-18j)  E_coul = (-2.241155107548484+1.8283396863002738e-17j)
cycle= 5 E= -10.8347860329704  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      9.01 sec, wall time      0.28 sec
HOMO = 0.346408445175  LUMO = 0.903765957308
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931258  0.30040488  0.33527465  0.34640845] [0.98222755 0.99636479 1.01752618 1.33926666 1.80560447 1.80633873
 1.88473697 2.12078887 2.12321312 2.12657278 2.70779717 2.71059461
 2.71135349 3.5637981  3.56594971 3.56961598 3.69920862 3.7060628
 4.21952157 4.77259837 4.7734666  4.77543456]
   1 (-0.000 -0.000  0.500)   [-0.39529472 -0.25733513  0.18739021  0.21812877] [1.09803876 1.10893423 1.1516918  1.39901708 1.68519191 1.81228974
 1.8462677  1.85199508 2.1194284  2.1255781  3.00652845 3.12448436
 3.12537386 3.13932029 3.14167284 3.32173395 3.6677542  3.66847787
 3.80045556 3.80657529 5.18529454 9.82946179]
   2 ( 0.000  0.500 -0.000)   [-0.39529465 -0.25733515  0.18739013  0.21812878] [1.09803873 1.10893457 1.15169192 1.39901679 1.68519197 1.81228981
 1.84626845 1.85199394 2.11942857 2.12557817 3.00652847 3.12448369
 3.12537297 3.13931897 3.14167328 3.32173477 3.66775521 3.66847819
 3.80045456 3.80657599 5.18529433 9.82945593]
   3 ( 0.000  0.500  0.500)   [-0.25583907 -0.25169956  0.04049015  0.07087084] [0.90376596 0.95975315 1.50710885 1.51353532 1.75075831 1.76482153
 2.07010502 2.07148598 2.32347283 2.33136542 2.84379974 2.85202477
 2.88518099 2.88541213 2.98371776 2.98745364 3.73403384 3.73502576
 5.07672147 5.07937498 6.89516202 6.89703297]
    CPU time for vj and vk      8.33 sec, wall time      0.26 sec
E1 = (4.193498796645298+6.059770113792605e-18j)  E_coul = (-2.2411556848706398+1.82834816488948e-17j)
Extra cycle  E= -10.8347860338496  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     68.92 sec, wall time      2.18 sec
    CPU time for SCF     71.15 sec, wall time      2.26 sec
converged SCF energy = -10.8347860338496
**** SCF Summaries ****
Total Energy =                         -10.834786033849582
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193498796645298
Two-electron Energy =                   -2.241155684870640
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      2.50 sec, wall time      0.08 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 448 MB)
    CPU time for KMP2      4.25 sec, wall time      0.13 sec
E(KMP2) = -11.0642803911461  E_corr = -0.229494357296539
E(SCS-KMP2) = -11.0587898908453  E_corr = -0.224003856995694
E_corr(same-spin) = -0.0592954289540231
E_corr(oppo-spin) = -0.170198928342516
End time = Tue Jun  3 11:00:22 PM PDT 2025
