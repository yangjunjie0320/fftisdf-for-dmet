SLURMD_NODENAME = hpc-35-03
Start time = Tue Jun  3 10:58:08 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-5/49986250/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-5/49986250/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/200/5/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-200-5
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-5
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 5.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 5.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2325, c0 =   5.00, nao = 26, nip = 130
Parent grid size = 35937, selected grid size = 130
truncated values = 5.81e+01, estimated error = 1.21e+01
Number of interpolating points is 130.
    CPU time for building inpv_kpt     84.10 sec, wall time     76.01 sec

Out-core version is used for eta_kpt.
disk space required: 2.99e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   2.99e-01 GB
memory needed for each k-point: 7.47e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     11.80 sec, wall time      0.48 sec
    CPU time for building eta_kpt     16.17 sec, wall time      0.61 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      6.13 sec, wall time      0.29 sec
    CPU time for coul_kpt[ 2 / 4]      0.86 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 3 / 4]      0.88 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 4 / 4]      0.89 sec, wall time      0.24 sec
    CPU time for building coul_kpt      8.82 sec, wall time      0.99 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-5/49986250/ndnpa735


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-200-5/49986250/tmpdrcuy91y
max_memory 327680 MB (current use 372 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f3ecd56e770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      6.14 sec, wall time      0.20 sec
E1 = (3.604511953301932+1.0891695275945486e-17j)  E_coul = (-4.225431219165855-1.5414740142299616e-16j)
init E= -13.4080484114882
    CPU time for initialize scf     15.71 sec, wall time      0.51 sec
HOMO = 0.643553067121  LUMO = 0.779131767359
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97028636  0.60605594  0.60818632  0.64355307] [0.86085104 0.8843323  0.90950304 1.13771577 1.78979662 1.80419857
 1.87458398 2.08306343 2.08364437 2.0962117  2.64393357 2.64821478
 2.65438112 3.54538524 3.55158014 3.55293613 3.65729782 3.65813153
 4.21178473 4.7296165  4.73165168 4.73382776]
   1 (-0.000 -0.000  0.500)   [-0.77435575 -0.50557469  0.46079752  0.50396024] [0.95308934 1.02123012 1.03931759 1.35729684 1.63221183 1.7651861
 1.81582191 1.82341429 2.11340864 2.11704609 2.95691459 3.06456688
 3.06679857 3.09997052 3.10245967 3.30666028 3.64684031 3.65056662
 3.7615802  3.76508602 5.13907902 9.60810646]
   2 ( 0.000  0.500 -0.000)   [-0.77291278 -0.50799537  0.46069117  0.50349575] [0.95622577 1.02116165 1.03907661 1.35646588 1.6333435  1.76098978
 1.81584348 1.82345987 2.11244847 2.11748784 2.95774313 3.06553814
 3.06698682 3.10094944 3.10325757 3.30357364 3.64479002 3.65006395
 3.7613579  3.76366853 5.14048123 9.60733867]
   3 ( 0.000  0.500  0.500)   [-0.41214476 -0.39938293  0.22507095  0.31030047] [0.77913177 0.84647532 1.40328791 1.40428029 1.67839196 1.690224
 2.06858219 2.07546862 2.30986272 2.31437512 2.79396709 2.79930253
 2.86832816 2.87926052 2.95052573 2.95562119 3.67119013 3.67680364
 5.04050308 5.04939246 6.79282095 6.81027856]
    CPU time for vj and vk      6.18 sec, wall time      0.20 sec
E1 = (4.201232764042194+7.741022131595182e-18j)  E_coul = (-2.2342713368162372-1.6809960589301957e-16j)
cycle= 1 E= -10.8201677183983  delta_E= 2.59  |g|= 0.465  |ddm|= 64.4
    CPU time for cycle= 1      6.68 sec, wall time      0.21 sec
HOMO = 0.351951761163  LUMO = 0.900040458673
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66753743  0.29912482  0.33665294  0.35195176] [0.97778973 0.9853245  1.0114145  1.34120444 1.80369106 1.80514835
 1.89802779 2.11615534 2.11851455 2.12193404 2.69998098 2.70822405
 2.71199693 3.55872224 3.55917185 3.56434348 3.69504293 3.70156836
 4.22388101 4.76583462 4.76670366 4.76958716]
   1 (-0.000 -0.000  0.500)   [-0.39178529 -0.25603958  0.18521535  0.22048877] [1.09423022 1.09961859 1.15148163 1.39919472 1.68328899 1.8139983
 1.84366306 1.84677446 2.11894701 2.12260566 3.00504354 3.11892583
 3.12166583 3.1355291  3.13702596 3.32223947 3.66223942 3.66303524
 3.793618   3.79936925 5.18889757 9.79238663]
   2 ( 0.000  0.500 -0.000)   [-0.3899487  -0.25768978  0.18453784  0.21973987] [1.0955456  1.09859021 1.15092004 1.39935458 1.68531108 1.81194587
 1.84261063 1.84812122 2.11705375 2.12334129 3.00624099 3.12081161
 3.12199573 3.13569137 3.1375806  3.32019764 3.6586773  3.66283482
 3.79440566 3.79769341 5.18695802 9.78180776]
   3 ( 0.000  0.500  0.500)   [-0.25350184 -0.24864658  0.03655166  0.07474306] [0.90004046 0.96117078 1.49681096 1.51001399 1.74845454 1.76383482
 2.06669922 2.07038963 2.32098289 2.32894293 2.84182346 2.84881673
 2.88106497 2.88157573 2.97491819 2.98410219 3.73016125 3.73158723
 5.06962957 5.07488699 6.88060371 6.89446922]
    CPU time for vj and vk      6.19 sec, wall time      0.20 sec
E1 = (4.1976447643371175+1.1502301898345897e-17j)  E_coul = (-2.2436476686029523-1.7186647612591274e-16j)
cycle= 2 E= -10.8331320498901  delta_E= -0.013  |g|= 0.092  |ddm|= 51.5
    CPU time for cycle= 2      6.79 sec, wall time      0.22 sec
HOMO = 0.345715118896  LUMO = 0.905252371604
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66541121  0.29755982  0.33067898  0.34571512] [0.98094538 0.98988729 1.01398009 1.34742289 1.8036339  1.8051357
 1.89904923 2.11671618 2.11971807 2.12284116 2.69944983 2.70684357
 2.71033665 3.55890436 3.55954062 3.5642433  3.69626417 3.70251141
 4.22220694 4.76648569 4.7679024  4.77041079]
   1 (-0.000 -0.000  0.500)   [-0.3913912  -0.25721915  0.18497544  0.2153872 ] [1.09898007 1.10312169 1.15276414 1.4007641  1.68392325 1.8142991
 1.84238139 1.84676335 2.11886929 2.12255921 3.0058758  3.11931659
 3.12202305 3.13617709 3.13727369 3.32257355 3.66210387 3.66327506
 3.79386365 3.79935004 5.18834675 9.78792319]
   2 ( 0.000  0.500 -0.000)   [-0.38940205 -0.25898949  0.1843124   0.21453595] [1.1001102  1.10238043 1.15209032 1.40097458 1.68601006 1.8121064
 1.84120888 1.84802283 2.11699631 2.12313992 3.00708988 3.12117066
 3.12246093 3.13629659 3.13795036 3.32064848 3.65867226 3.66297835
 3.79463979 3.79795508 5.1863091  9.77821378]
   3 ( 0.000  0.500  0.500)   [-0.25407537 -0.24967026  0.03695136  0.07011261] [0.90525237 0.96197131 1.50054717 1.51262767 1.74934947 1.76367383
 2.06618637 2.06979901 2.32121279 2.32931503 2.84179136 2.84906818
 2.88089855 2.88154468 2.97490948 2.98386335 3.7315727  3.73297636
 5.0690867  5.07462082 6.87858286 6.89213185]
    CPU time for vj and vk      6.14 sec, wall time      0.19 sec
E1 = (4.197080684820384+1.209859898232356e-17j)  E_coul = (-2.243707811057611-1.7304225901570868e-16j)
cycle= 3 E= -10.8337562718615  delta_E= -0.000624  |g|= 0.0063  |ddm|= 4.75
    CPU time for cycle= 3      6.78 sec, wall time      0.22 sec
HOMO = 0.346005153454  LUMO = 0.905569211589
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66492779  0.29793015  0.33073982  0.34600515] [0.98145461 0.99051037 1.01439809 1.34806423 1.80380461 1.80530709
 1.89891214 2.11687613 2.11980085 2.12298851 2.69981843 2.70722003
 2.71062028 3.55899828 3.5596408  3.56428504 3.69657853 3.70278275
 4.22218961 4.76673949 4.7682018  4.77068177]
   1 (-0.000 -0.000  0.500)   [-0.39077564 -0.25691673  0.18543645  0.2155624 ] [1.09946142 1.10363041 1.15296475 1.40082695 1.68405126 1.81461518
 1.84254545 1.84700061 2.11905857 2.12259837 3.00621034 3.11946763
 3.12223722 3.13666876 3.13773494 3.32267879 3.66219674 3.66341179
 3.79406947 3.79955098 5.18863163 9.78902904]
   2 ( 0.000  0.500 -0.000)   [-0.38879546 -0.25867331  0.18478186  0.21468922] [1.10058781 1.10285231 1.15229365 1.40103937 1.68615066 1.81244777
 1.84135824 1.84824616 2.11719949 2.12318826 3.00745089 3.12132405
 3.12267287 3.13677206 3.13842176 3.32076193 3.65877457 3.66308248
 3.79483694 3.79813872 5.18661015 9.77926733]
   3 ( 0.000  0.500  0.500)   [-0.25362636 -0.24926051  0.0373753   0.07032783] [0.90556921 0.9619848  1.50137671 1.51342907 1.74959785 1.76389312
 2.06623749 2.0698151  2.32133578 2.3295261  2.84212648 2.84934961
 2.88097805 2.88159243 2.97507898 2.98407146 3.73198346 3.73335834
 5.06929589 5.07483763 6.87919664 6.89258674]
    CPU time for vj and vk      6.18 sec, wall time      0.20 sec
E1 = (4.197167810930949+1.2106832293767252e-17j)  E_coul = (-2.243798782438949-1.7315750604788513e-16j)
cycle= 4 E= -10.8337601171322  delta_E= -3.85e-06  |g|= 0.000971  |ddm|= 0.269
    CPU time for cycle= 4      6.77 sec, wall time      0.21 sec
HOMO = 0.345972179949  LUMO = 0.905554694082
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66497616  0.29787295  0.33065525  0.34597218] [0.98143135 0.9904794  1.01435801 1.34801352 1.80378838 1.80528697
 1.89892189 2.11686532 2.11977315 2.12297282 2.69976332 2.70717224
 2.71056129 3.55898695 3.5596322  3.56426791 3.69654998 3.70275296
 4.22217721 4.7667122  4.76817898 4.77065604]
   1 (-0.000 -0.000  0.500)   [-0.39078728 -0.25698705  0.18538952  0.21549272] [1.09942306 1.10360213 1.15293774 1.40082954 1.68401932 1.81457759
 1.84249711 1.84696344 2.11905405 2.12257241 3.00617926 3.11945174
 3.12222471 3.13661656 3.13768007 3.32266972 3.66217938 3.66340318
 3.79403935 3.79951925 5.18859417 9.78886578]
   2 ( 0.000  0.500 -0.000)   [-0.38880699 -0.25874313  0.18473445  0.21462168] [1.10055268 1.10282067 1.1522674  1.40104163 1.68611804 1.81241058
 1.84130766 1.84820618 2.11719407 2.12316156 3.00742081 3.1213099
 3.1226602  3.13672408 3.13836345 3.32075328 3.65875901 3.66307228
 3.79480412 3.79810831 5.18657283 9.77910998]
   3 ( 0.000  0.500  0.500)   [-0.25368099 -0.24931938  0.037323    0.0702941 ] [0.90555469 0.96198033 1.50133057 1.51340545 1.74952534 1.76382312
 2.06622383 2.06980115 2.32130303 2.32951291 2.84208203 2.849304
 2.88095043 2.88161074 2.9750506  2.98405347 3.73192382 3.73333912
 5.06927022 5.07481474 6.87910262 6.89252066]
    CPU time for vj and vk      6.16 sec, wall time      0.19 sec
E1 = (4.1971992557244056+1.2115298688179272e-17j)  E_coul = (-2.2438303805391113-1.7316111171158178e-16j)
cycle= 5 E= -10.8337602704389  delta_E= -1.53e-07  |g|= 0.000336  |ddm|= 0.0264
    CPU time for cycle= 5      6.76 sec, wall time      0.21 sec
HOMO = 0.345979229321  LUMO = 0.905554585824
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66497447  0.29787291  0.33065302  0.34597923] [0.9814324  0.99047923 1.01435661 1.34801472 1.80378809 1.80528659
 1.89892188 2.11686458 2.11977107 2.12297268 2.69976284 2.70717353
 2.71056104 3.55898674 3.55963243 3.56426734 3.69654989 3.70275261
 4.22217887 4.76671211 4.76817979 4.77065643]
   1 (-0.000 -0.000  0.500)   [-0.39078204 -0.25698615  0.18538949  0.21549176] [1.09942284 1.1036019  1.15293666 1.40082861 1.68401981 1.81457874
 1.84249632 1.84696399 2.11905617 2.12257172 3.0061803  3.11945159
 3.12222396 3.13661545 3.13768027 3.32266938 3.66217859 3.66340498
 3.79403856 3.79951827 5.18859574 9.788869  ]
   2 ( 0.000  0.500 -0.000)   [-0.3888017  -0.25874254  0.18473442  0.2146209 ] [1.10055278 1.10282031 1.15226664 1.40104088 1.6861187  1.812412
 1.84130592 1.84820673 2.11719608 2.12316079 3.00742168 3.12130873
 3.12266058 3.13672206 3.13836524 3.32075314 3.65875927 3.66307317
 3.79480335 3.79810676 5.18657417 9.77911466]
   3 ( 0.000  0.500  0.500)   [-0.25368048 -0.24931847  0.03732306  0.07029799] [0.90555459 0.9619805  1.50133006 1.51340999 1.74952235 1.76382104
 2.06622423 2.06980104 2.3213061  2.32950908 2.84208236 2.84930347
 2.88095954 2.88160245 2.97504966 2.98405415 3.73193081 3.73333186
 5.06927067 5.07481576 6.87911666 6.8925114 ]
    CPU time for vj and vk      6.25 sec, wall time      0.20 sec
E1 = (4.197202042826217+1.2117459942451317e-17j)  E_coul = (-2.243833190600137-1.73170636493174e-16j)
Extra cycle  E= -10.8337602933982  delta_E= -2.3e-08  |g|= 0.000196  |ddm|= 0.00905
    CPU time for scf_cycle     56.32 sec, wall time      1.80 sec
    CPU time for SCF     59.03 sec, wall time      1.89 sec
converged SCF energy = -10.8337602933982
**** SCF Summaries ****
Total Energy =                         -10.833760293398161
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.197202042826217
Two-electron Energy =                   -2.243833190600137
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.88928
pop of  0 C 3s            0.00342
pop of  0 C 2px           1.05627
pop of  0 C 2py           1.01405
pop of  0 C 2pz           1.01527
pop of  0 C 3px           0.00301
pop of  0 C 3py           0.00213
pop of  0 C 3pz           0.00221
pop of  0 C 3dxy          0.00642
pop of  0 C 3dyz          0.00561
pop of  0 C 3dz^2         0.00009
pop of  0 C 3dxz          0.00635
pop of  0 C 3dx2-y2       0.00017
pop of  1 C 2s            0.89107
pop of  1 C 3s            0.00314
pop of  1 C 2px           1.05925
pop of  1 C 2py           1.00812
pop of  1 C 2pz           1.00790
pop of  1 C 3px           0.00289
pop of  1 C 3py           0.00226
pop of  1 C 3pz           0.00218
pop of  1 C 3dxy          0.00661
pop of  1 C 3dyz          0.00561
pop of  1 C 3dz^2         0.00012
pop of  1 C 3dxz          0.00642
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00428
charge of    1C =      0.00428
    CPU time for vj and vk      0.40 sec, wall time      0.01 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 451 MB)
    CPU time for KMP2      1.43 sec, wall time      0.04 sec
E(KMP2) = -11.0718666931458  E_corr = -0.238106399747596
E(SCS-KMP2) = -11.0652331801316  E_corr = -0.231472886733489
E_corr(same-spin) = -0.0626016841887996
E_corr(oppo-spin) = -0.175504715558797
End time = Tue Jun  3 10:59:29 PM PDT 2025
