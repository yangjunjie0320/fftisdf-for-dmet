SLURMD_NODENAME = hpc-34-35
Start time = Tue Jun  3 04:48:37 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-20/49984415/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-20/49984415/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/100/20/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-100-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-20
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2235, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 12167, selected grid size = 520
truncated values = 6.84e+01, estimated error = 2.98e-01
Number of interpolating points is 520.
    CPU time for building inpv_kpt     15.92 sec, wall time      9.01 sec

Out-core version is used for eta_kpt.
disk space required: 4.05e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   4.05e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     13.00 sec, wall time      0.62 sec
    CPU time for building eta_kpt     14.69 sec, wall time      0.67 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     11.31 sec, wall time      0.64 sec
    CPU time for coul_kpt[ 2 / 4]      9.69 sec, wall time      0.65 sec
    CPU time for coul_kpt[ 3 / 4]      9.67 sec, wall time      0.65 sec
    CPU time for coul_kpt[ 4 / 4]      9.71 sec, wall time      0.64 sec
    CPU time for building coul_kpt     40.92 sec, wall time      2.60 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-20/49984415/y9jyhpx3


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-20/49984415/tmpmvdsr1b1
max_memory 327680 MB (current use 396 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f014d3da770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.16 sec, wall time      0.10 sec
E1 = (3.6045119526610727-9.076412729954548e-18j)  E_coul = (-4.2381497703636635+3.190068620564423e-17j)
init E= -13.4207669633268
    CPU time for initialize scf      6.24 sec, wall time      0.20 sec
HOMO = 0.642146554224  LUMO = 0.776528112156
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422329  0.60527194  0.60923087  0.64214655] [0.85981293 0.88582616 0.9102037  1.12520332 1.79100423 1.80523357
 1.86205442 2.08341906 2.08748901 2.09925325 2.64579705 2.64766349
 2.64895007 3.553191   3.55392078 3.55480255 3.65950691 3.66029295
 4.21011404 4.73494683 4.73543022 4.73597348]
   1 (-0.000 -0.000  0.500)   [-0.78015154 -0.5084825   0.46133072  0.50284963] [0.94785986 1.02143207 1.04032649 1.35354117 1.62942735 1.7560157
 1.81456893 1.82408047 2.11260189 2.11925053 2.95658912 3.06755567
 3.06863216 3.10243466 3.10320931 3.30379156 3.64927865 3.65341279
 3.76724776 3.76776385 5.13917248 9.64996251]
   2 ( 0.000  0.500 -0.000)   [-0.78015074 -0.508483    0.46133119  0.50284951] [0.9478593  1.02143251 1.04032773 1.3535441  1.62942577 1.75601427
 1.8145688  1.82408024 2.11260084 2.1192508  2.95658613 3.06755317
 3.0686334  3.10243197 3.10320853 3.3037952  3.64928013 3.6534095
 3.76724479 3.76775488 5.13917084 9.64996051]
   3 ( 0.000  0.500  0.500)   [-0.41689228 -0.40450287  0.22475992  0.31063613] [0.77652811 0.84136893 1.40153207 1.40349525 1.6778002  1.68166089
 2.07043344 2.07585877 2.31225577 2.31465143 2.79346487 2.8008039
 2.87066017 2.87949611 2.95490739 2.95599439 3.67413113 3.67560399
 5.04761005 5.0482406  6.80908189 6.81454297]
    CPU time for vj and vk      3.30 sec, wall time      0.11 sec
E1 = (4.1980178389081955+3.1735716922724587e-18j)  E_coul = (-2.2326075023775833+1.9607946596704774e-17j)
cycle= 1 E= -10.8217188090936  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      3.79 sec, wall time      0.12 sec
HOMO = 0.352244542938  LUMO = 0.898271133923
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169389  0.30155994  0.34067953  0.35224454] [0.97853179 0.99134168 1.01472033 1.33231782 1.80554252 1.80602218
 1.88404623 2.11998894 2.1220358  2.1254037  2.70807104 2.71166922
 2.71194401 3.56351999 3.56540464 3.56995385 3.69758976 3.70487004
 4.22159762 4.77130824 4.77265991 4.77474322]
   1 (-0.000 -0.000  0.500)   [-0.39621693 -0.25657474  0.18712789  0.2227324 ] [1.0929321  1.10500459 1.15031271 1.39709042 1.68430203 1.81150785
 1.84709382 1.85165889 2.1192048  2.12573227 3.00550102 3.12358076
 3.1250302  3.13812965 3.14101977 3.32108692 3.66804529 3.66810646
 3.79986209 3.80639033 5.18613121 9.83351192]
   2 ( 0.000  0.500 -0.000)   [-0.39621715 -0.25657629  0.18712891  0.22273334] [1.09293382 1.10500901 1.15031105 1.39709803 1.68430164 1.81150112
 1.84708988 1.85165288 2.11920164 2.12572911 3.00549571 3.12357484
 3.12502156 3.13812353 3.14102422 3.32109125 3.66805254 3.66811438
 3.79985645 3.80637292 5.18613405 9.83350953]
   3 ( 0.000  0.500  0.500)   [-0.25545755 -0.2512309   0.03956678  0.07509195] [0.89827113 0.95900274 1.5027419  1.50995308 1.74944226 1.76464582
 2.07049278 2.07209346 2.32316365 2.33068306 2.84347286 2.85144301
 2.88508125 2.88514406 2.98375171 2.98720082 3.73224226 3.73350341
 5.076406   5.07994971 6.89787852 6.89900001]
    CPU time for vj and vk      3.64 sec, wall time      0.12 sec
E1 = (4.194202248663065+3.905032789079859e-18j)  E_coul = (-2.241263808719123+1.9825987840539914e-17j)
cycle= 2 E= -10.8341907056803  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      4.28 sec, wall time      0.14 sec
HOMO = 0.346103279665  LUMO = 0.903473565615
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976     0.30008443  0.33519754  0.34610328] [0.98177122 0.99582191 1.01711636 1.33874701 1.80541402 1.80618585
 1.88485658 2.12065262 2.12314528 2.12643954 2.70745194 2.7103035
 2.71096464 3.56369242 3.56581422 3.56957043 3.69892251 3.70582349
 4.21948278 4.77234659 4.7732692  4.77524483]
   1 (-0.000 -0.000  0.500)   [-0.39587963 -0.25760781  0.18697425  0.21794662] [1.09766509 1.1085005  1.15152738 1.39893276 1.68508161 1.81196234
 1.84609727 1.85179515 2.1192256  2.12552082 3.00622073 3.1242622
 3.12524621 3.13887261 3.14127783 3.32161897 3.66769679 3.66835191
 3.80026296 3.80639998 5.1850142  9.82838181]
   2 ( 0.000  0.500 -0.000)   [-0.39588006 -0.25760936  0.18697569  0.21794763] [1.09766675 1.10850477 1.15152565 1.39893997 1.68508175 1.81195574
 1.84609351 1.85178885 2.11922257 2.1255179  3.00621548 3.12425646
 3.12523806 3.1388673  3.14128248 3.32162343 3.66770319 3.66836024
 3.80025747 3.80638245 5.18501781 9.82837945]
   3 ( 0.000  0.500  0.500)   [-0.25627718 -0.25205228  0.04012246  0.07063162] [0.90347357 0.95977026 1.5063832  1.5127838  1.75053589 1.76461436
 2.07003663 2.07147272 2.32338833 2.33115324 2.84349221 2.8517884
 2.8851811  2.88526915 2.98354808 2.98725009 3.7337655  3.73460315
 5.07649236 5.07921278 6.89472969 6.89641585]
    CPU time for vj and vk      3.67 sec, wall time      0.12 sec
E1 = (4.193437729033687+3.785816606926203e-18j)  E_coul = (-2.241093224831325+1.988095789511091e-17j)
cycle= 3 E= -10.8347846414219  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      4.29 sec, wall time      0.14 sec
HOMO = 0.346444624172  LUMO = 0.903777739294
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926003  0.30045802  0.33535135  0.34644462] [0.98225199 0.99640093 1.0175626  1.33932028 1.80561707 1.80636283
 1.88472526 2.12080159 2.12324056 2.12658872 2.70784223 2.71065128
 2.71140082 3.56379711 3.5659556  3.56960637 3.69923704 3.70609458
 4.21953623 4.7726225  4.77351583 4.77547795]
   1 (-0.000 -0.000  0.500)   [-0.39527604 -0.25726724  0.18743803  0.21819265] [1.09808004 1.10896171 1.15171842 1.39900472 1.68522173 1.81233509
 1.8463137  1.85203099 2.11943291 2.12559575 3.00656514 3.12450166
 3.12539433 3.13937795 3.14173567 3.32173491 3.66778186 3.66849071
 3.80049036 3.80660709 5.18532755 9.82962877]
   2 ( 0.000  0.500 -0.000)   [-0.39527647 -0.25726877  0.1874395   0.21819365] [1.09808169 1.10896597 1.15171666 1.39901195 1.68522184 1.81232853
 1.84630992 1.85202469 2.11942988 2.12559284 3.00655989 3.12449591
 3.12538613 3.13937262 3.1417403  3.32173938 3.66778825 3.66849912
 3.80048487 3.80658957 5.18533116 9.82962642]
   3 ( 0.000  0.500  0.500)   [-0.2557841  -0.25164368  0.04054258  0.07090585] [0.90377774 0.95976418 1.50715995 1.51356205 1.75082229 1.76488517
 2.07012159 2.07148331 2.32349702 2.33138798 2.84383761 2.85207912
 2.88519232 2.88541408 2.98374781 2.98747577 3.73407732 3.73506367
 5.07673498 5.07939479 6.89525166 6.89710834]
    CPU time for vj and vk      3.63 sec, wall time      0.12 sec
E1 = (4.19346690173004+3.7186851990645425e-18j)  E_coul = (-2.241125083741938+1.9885590693977918e-17j)
cycle= 4 E= -10.8347873276361  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0986
    CPU time for cycle= 4      4.24 sec, wall time      0.14 sec
HOMO = 0.346400684745  LUMO = 0.903764531314
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931319  0.30040068  0.33527507  0.34640068] [0.98222825 0.99636729 1.01752668 1.3392651  1.8056048  1.80633992
 1.88473897 2.12079187 2.1232193  2.12657588 2.70778613 2.71059326
 2.71135359 3.56378502 3.56594473 3.56958828 3.69920792 3.70606443
 4.21951943 4.77259807 4.77348708 4.77544874]
   1 (-0.000 -0.000  0.500)   [-0.39529702 -0.25733597  0.1873894   0.2181273 ] [1.09803804 1.10893272 1.15169425 1.39901017 1.68519259 1.81229487
 1.84627012 1.851994   2.11942576 2.12557121 3.00653354 3.12448972
 3.12537704 3.13932621 3.14168074 3.3217271  3.66776252 3.66848155
 3.80045758 3.80657399 5.18528925 9.82945356]
   2 ( 0.000  0.500 -0.000)   [-0.39529745 -0.25733749  0.18739088  0.2181283 ] [1.09803969 1.10893697 1.15169248 1.3990174  1.6851927  1.81228832
 1.84626635 1.85198771 2.11942273 2.1255683  3.00652829 3.12448397
 3.12536885 3.13932088 3.14168537 3.32173156 3.66776891 3.66848995
 3.80045209 3.80655648 5.18529286 9.82945121]
   3 ( 0.000  0.500  0.500)   [-0.25584241 -0.25169973  0.040491    0.07086832] [0.90376453 0.95975572 1.5071084  1.51352996 1.75075543 1.76482423
 2.07010565 2.07147144 2.32347402 2.33136495 2.84379669 2.85203519
 2.88518301 2.88541069 2.98371611 2.98745688 3.73403519 3.73502595
 5.07671165 5.07936592 6.89515961 6.89703118]
    CPU time for vj and vk      3.62 sec, wall time      0.12 sec
E1 = (4.193488401395227+3.711813877468172e-18j)  E_coul = (-2.2411466295454483+1.9886431101710386e-17j)
cycle= 5 E= -10.8347873737745  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00952
    CPU time for cycle= 5      4.25 sec, wall time      0.14 sec
HOMO = 0.346407676707  LUMO = 0.903765689572
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931041  0.3004016   0.33527559  0.34640768] [0.98222968 0.99636881 1.01752745 1.33926676 1.80560546 1.80634063
 1.88473792 2.12079152 2.12321861 2.1265766  2.70778732 2.71059479
 2.71135686 3.56378554 3.56594537 3.56958821 3.69920873 3.70606513
 4.21952046 4.77259897 4.77348775 4.77544946]
   1 (-0.000 -0.000  0.500)   [-0.3952917  -0.25733316  0.18739046  0.21812829] [1.09803883 1.10893418 1.15169369 1.39900936 1.68519376 1.81229712
 1.8462708  1.85199527 2.11942859 2.12557151 3.0065357  3.12449074
 3.12537721 3.13932777 3.14168184 3.32172706 3.66776241 3.66848254
 3.80045761 3.80657444 5.18529106 9.82946134]
   2 ( 0.000  0.500 -0.000)   [-0.39529213 -0.25733468  0.18739194  0.21812929] [1.09804049 1.10893843 1.15169192 1.39901659 1.68519387 1.81229057
 1.84626702 1.85198898 2.11942556 2.1255686  3.00653045 3.12448499
 3.12536901 3.13932244 3.14168647 3.32173152 3.6677688  3.66849094
 3.80045212 3.80655693 5.18529467 9.82945899]
   3 ( 0.000  0.500  0.500)   [-0.25583883 -0.25169859  0.04049241  0.07087252] [0.90376569 0.95975529 1.50710999 1.51353467 1.75075578 1.76482313
 2.07010656 2.07147168 2.32347369 2.33136644 2.84379799 2.8520359
 2.88518207 2.88541207 2.9837167  2.98745846 3.73403492 3.73502835
 5.07671292 5.07936695 6.89516198 6.89703645]
    CPU time for vj and vk      3.61 sec, wall time      0.12 sec
E1 = (4.193488977702945+3.711438316102987e-18j)  E_coul = (-2.2411472067325975+1.9886555446024167e-17j)
Extra cycle  E= -10.8347873746539  delta_E= -8.79e-10  |g|= 2.68e-05  |ddm|= 0.00139
    CPU time for scf_cycle     31.24 sec, wall time      1.00 sec
    CPU time for SCF     33.22 sec, wall time      1.07 sec
converged SCF energy = -10.8347873746539
**** SCF Summaries ****
Total Energy =                         -10.834787374653892
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193488977702945
Two-electron Energy =                   -2.241147206732597
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89509
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.45 sec, wall time      0.05 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 425 MB)
    CPU time for KMP2      4.56 sec, wall time      0.14 sec
E(KMP2) = -11.0642849504419  E_corr = -0.22949757578802
E(SCS-KMP2) = -11.0587940527911  E_corr = -0.224006678137162
E_corr(same-spin) = -0.0592966301636106
E_corr(oppo-spin) = -0.17020094562441
End time = Tue Jun  3 04:48:52 PM PDT 2025
