SLURMD_NODENAME = hpc-35-02
Start time = Tue Jun  3 04:48:40 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-25/49984416/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-25/49984416/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/100/25/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-100-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-25
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 25.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2235, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 12167, selected grid size = 650
truncated values = 6.86e+01, estimated error = 1.11e-01
Number of interpolating points is 650.
    CPU time for building inpv_kpt     15.88 sec, wall time      8.88 sec

Out-core version is used for eta_kpt.
disk space required: 5.06e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   5.06e-01 GB
memory needed for each k-point: 1.27e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     14.87 sec, wall time      0.76 sec
    CPU time for building eta_kpt     16.64 sec, wall time      0.81 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     12.71 sec, wall time      1.00 sec
    CPU time for coul_kpt[ 2 / 4]     10.91 sec, wall time      1.00 sec
    CPU time for coul_kpt[ 3 / 4]     10.89 sec, wall time      1.00 sec
    CPU time for coul_kpt[ 4 / 4]     11.07 sec, wall time      1.01 sec
    CPU time for building coul_kpt     46.46 sec, wall time      4.04 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-25/49984416/v5765ta4


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-100-25/49984416/tmpcuc2ando
max_memory 327680 MB (current use 461 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f42e50ca770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.65 sec, wall time      0.12 sec
E1 = (3.6045119526610736+1.815282545990902e-18j)  E_coul = (-4.238151274443127+3.8568346022753344e-17j)
init E= -13.4207684674063
    CPU time for initialize scf      6.48 sec, wall time      0.21 sec
HOMO = 0.642148669133  LUMO = 0.776528017634
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422405  0.60527265  0.60923123  0.64214867] [0.85981234 0.88582613 0.91020216 1.12520268 1.79100345 1.80523337
 1.86205237 2.08341881 2.08748561 2.09925082 2.64579723 2.64766393
 2.64895291 3.55319568 3.55391983 3.55480191 3.65950812 3.6602922
 4.21012223 4.73494641 4.73542145 4.73596215]
   1 (-0.000 -0.000  0.500)   [-0.78015231 -0.50848284  0.46133112  0.50284967] [0.9478595  1.02143189 1.04032691 1.35354504 1.62942689 1.75601273
 1.81456864 1.82408313 2.1126015  2.11925371 2.95658492 3.06755098
 3.06862838 3.10243264 3.10320881 3.30379439 3.64927377 3.65340399
 3.76724456 3.76776288 5.13917626 9.64996618]
   2 ( 0.000  0.500 -0.000)   [-0.78015251 -0.50848303  0.4613312   0.50284995] [0.94785915 1.0214318  1.04032679 1.35354567 1.62942695 1.75601355
 1.81456884 1.82408276 2.11260129 2.11925359 2.95658592 3.06755129
 3.06862859 3.1024338  3.10320884 3.30379471 3.64927244 3.65340748
 3.76724519 3.76776136 5.1391758  9.64996175]
   3 ( 0.000  0.500  0.500)   [-0.41689369 -0.40450209  0.22475868  0.31063572] [0.77652802 0.84136782 1.40153371 1.4034958  1.67780138 1.68166155
 2.0704325  2.07586461 2.31225619 2.31465184 2.79346736 2.80080001
 2.87065866 2.87949534 2.95490353 2.95599666 3.67413174 3.67560441
 5.0476194  5.04821605 6.8090867  6.81454637]
    CPU time for vj and vk      3.74 sec, wall time      0.12 sec
E1 = (4.19802146235328-1.298541982088546e-17j)  E_coul = (-2.2326088251619765+2.7929518435219877e-17j)
cycle= 1 E= -10.8217165084329  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      4.20 sec, wall time      0.13 sec
HOMO = 0.352246279081  LUMO = 0.89827114984
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169529  0.3015644   0.34068004  0.35224628] [0.97853037 0.99133832 1.0147194  1.33231902 1.80554189 1.80602121
 1.88404505 2.11998724 2.12202994 2.12540014 2.70808405 2.71167085
 2.71194219 3.56352314 3.56540623 3.56997201 3.69758999 3.70486837
 4.22160105 4.77130803 4.77263921 4.7747273 ]
   1 (-0.000 -0.000  0.500)   [-0.39621851 -0.25657611  0.18712808  0.22273358] [1.09293295 1.10500595 1.15031123 1.39709758 1.68430091 1.81150043
 1.84708985 1.85166045 2.11920457 2.12573825 3.00549365 3.12357701
 3.12502869 3.13812191 3.14101026 3.321094   3.6680354  3.66810069
 3.79985573 3.80639287 5.1861356  9.83351597]
   2 ( 0.000  0.500 -0.000)   [-0.39621875 -0.25657641  0.18712866  0.22273397] [1.09293273 1.10500514 1.15031105 1.39709853 1.68430114 1.81150073
 1.8470911  1.85166009 2.11920405 2.12573861 3.00549459 3.12357658
 3.12502868 3.13812226 3.14101281 3.32109408 3.66804336 3.66809584
 3.79985829 3.8063905  5.18613254 9.83351659]
   3 ( 0.000  0.500  0.500)   [-0.25545721 -0.25123069  0.03956548  0.07509114] [0.89827115 0.95900085 1.50274244 1.50995553 1.74944571 1.76464558
 2.07049156 2.07210726 2.32316372 2.33068225 2.84347475 2.85143276
 2.8850802  2.88514431 2.98375792 2.98719627 3.73224128 3.73350094
 5.07640131 5.07993548 6.89788059 6.89900171]
    CPU time for vj and vk      3.76 sec, wall time      0.12 sec
E1 = (4.194211545923538-1.106139829135841e-17j)  E_coul = (-2.241271392536109+2.875310916808953e-17j)
cycle= 2 E= -10.8341889922368  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      4.30 sec, wall time      0.14 sec
HOMO = 0.346104109306  LUMO = 0.903473732777
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976228  0.30008754  0.33519688  0.34610411] [0.98176873 0.99581776 1.01711473 1.33874656 1.80541303 1.806184
 1.88485547 2.12065024 2.12313922 2.12643557 2.70746323 2.71030405
 2.71096182 3.56369444 3.5658156  3.56958811 3.69892208 3.70582123
 4.21948517 4.77234699 4.77324768 4.77523015]
   1 (-0.000 -0.000  0.500)   [-0.39588234 -0.25760964  0.18697335  0.21794702] [1.09766508 1.10850101 1.15152483 1.39893939 1.68507979 1.81195395
 1.84609309 1.85179519 2.11922531 2.12552657 3.0062127  3.12425823
 3.12524406 3.13886369 3.14126688 3.32162587 3.66769152 3.66834187
 3.80025606 3.80640129 5.18501804 9.82838131]
   2 ( 0.000  0.500 -0.000)   [-0.39588256 -0.25760999  0.1869739   0.21794748] [1.09766488 1.10850031 1.15152463 1.39894048 1.68508003 1.81195404
 1.84609448 1.85179475 2.11922479 2.12552685 3.00621367 3.12425776
 3.12524415 3.1388642  3.14126959 3.32162608 3.6676866  3.66834982
 3.8002585  3.80639897 5.18501519 9.82838158]
   3 ( 0.000  0.500  0.500)   [-0.25627756 -0.25205287  0.04012008  0.07062978] [0.90347373 0.95976764 1.50638196 1.51278451 1.75053792 1.76461276
 2.07003504 2.07148584 2.32338739 2.3311521  2.84349303 2.85177735
 2.88518042 2.88526922 2.98355342 2.98724506 3.73376377 3.73459989
 5.0764838  5.07919564 6.89472939 6.89641538]
    CPU time for vj and vk      3.73 sec, wall time      0.12 sec
E1 = (4.193446580833348-1.0581749829852906e-17j)  E_coul = (-2.2411003647056953+2.897103609671029e-17j)
cycle= 3 E= -10.8347829294966  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      4.28 sec, wall time      0.14 sec
HOMO = 0.346445588593  LUMO = 0.903778034686
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926209  0.30046145  0.335351    0.34644559] [0.98224977 0.99639709 1.01756122 1.33932025 1.80561619 1.80636114
 1.88472413 2.12079932 2.12323462 2.12658484 2.70785382 2.71065215
 2.71139832 3.56379911 3.56595706 3.56962418 3.69923681 3.70609255
 4.21953868 4.77262307 4.77349451 4.77546337]
   1 (-0.000 -0.000  0.500)   [-0.39527852 -0.25726892  0.18743742  0.21819327] [1.0980803  1.10896247 1.15171607 1.3990114  1.68522015 1.81232699
 1.84630968 1.85203126 2.11943268 2.1256016  3.00655736 3.12449782
 3.12539227 3.13936936 3.14172505 3.32174193 3.66777668 3.66848081
 3.80048362 3.80660861 5.18533164 9.82962933]
   2 ( 0.000  0.500 -0.000)   [-0.39527875 -0.25726927  0.18743798  0.21819373] [1.09808008 1.10896176 1.15171587 1.39901251 1.68522038 1.81232707
 1.8463111  1.85203083 2.11943218 2.12560189 3.00655835 3.12449736
 3.12539238 3.13936989 3.14172776 3.32174213 3.66777176 3.66848877
 3.80048606 3.80660631 5.18532876 9.82962956]
   3 ( 0.000  0.500  0.500)   [-0.25578432 -0.251644    0.04054045  0.07090415] [0.90377803 0.95976162 1.50715921 1.51356312 1.7508247  1.76488396
 2.07012007 2.07149648 2.32349628 2.33138692 2.84383871 2.85206833
 2.88519169 2.88541423 2.98375331 2.98747087 3.73407588 3.73506068
 5.07672673 5.07937763 6.89525187 6.89710836]
    CPU time for vj and vk      3.76 sec, wall time      0.12 sec
E1 = (4.193475710694244-1.051929548194683e-17j)  E_coul = (-2.241132181145158+2.898409945606461e-17j)
cycle= 4 E= -10.8347856160752  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      4.33 sec, wall time      0.14 sec
HOMO = 0.346401645392  LUMO = 0.903764829585
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931524  0.30040409  0.33527472  0.34640165] [0.98222602 0.99636346 1.0175253  1.33926506 1.80560393 1.80633823
 1.88473783 2.12078959 2.12321335 2.12657199 2.70779769 2.71059411
 2.71135108 3.56378701 3.5659462  3.56960607 3.69920769 3.70606239
 4.21952187 4.77259864 4.77346576 4.77543417]
   1 (-0.000 -0.000  0.500)   [-0.39529949 -0.25733764  0.18738879  0.21812793] [1.09803829 1.10893347 1.15169188 1.39901684 1.68519099 1.81228677
 1.8462661  1.85199426 2.11942553 2.12557705 3.00652576 3.12448588
 3.12537498 3.13931761 3.1416701  3.3217341  3.66775734 3.66847165
 3.80045083 3.8065755  5.18529333 9.82945409]
   2 ( 0.000  0.500 -0.000)   [-0.39529972 -0.25733799  0.18738934  0.21812838] [1.09803808 1.10893277 1.15169169 1.39901796 1.68519123 1.81228685
 1.84626752 1.85199383 2.11942503 2.12557734 3.00652674 3.12448542
 3.12537508 3.13931814 3.14167282 3.32173431 3.66775242 3.6684796
 3.80045327 3.8065732  5.18529046 9.82945431]
   3 ( 0.000  0.500  0.500)   [-0.25584262 -0.25170004  0.04048887  0.07086662] [0.90376483 0.95975314 1.50710764 1.51353103 1.75075783 1.764823
 2.07010412 2.07148458 2.32347328 2.3313639  2.84379778 2.8520244
 2.88518238 2.88541085 2.98372161 2.98745198 3.73403375 3.73502295
 5.07670338 5.07934876 6.8951598  6.89703119]
    CPU time for vj and vk      3.74 sec, wall time      0.12 sec
E1 = (4.193497210101521-1.051363367856291e-17j)  E_coul = (-2.2411537267015538+2.898540742420954e-17j)
cycle= 5 E= -10.8347856622243  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      4.33 sec, wall time      0.14 sec
HOMO = 0.346408634284  LUMO = 0.903765987402
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931247  0.30040501  0.33527524  0.34640863] [0.98222745 0.99636497 1.01752608 1.33926672 1.80560458 1.80633894
 1.88473679 2.12078925 2.12321266 2.12657272 2.70779888 2.71059564
 2.71135435 3.56378753 3.56594684 3.569606   3.6992085  3.70606309
 4.2195229  4.77259954 4.77346643 4.77543488]
   1 (-0.000 -0.000  0.500)   [-0.39529417 -0.25733483  0.18738985  0.21812891] [1.09803908 1.10893493 1.15169132 1.39901603 1.68519216 1.81228902
 1.84626678 1.85199553 2.11942836 2.12557735 3.00652792 3.1244869
 3.12537514 3.13931917 3.1416712  3.32173406 3.66775723 3.66847264
 3.80045087 3.80657594 5.18529514 9.82946186]
   2 ( 0.000  0.500 -0.000)   [-0.39529441 -0.25733518  0.1873904   0.21812937] [1.09803887 1.10893423 1.15169113 1.39901715 1.6851924  1.81228909
 1.84626819 1.8519951  2.11942786 2.12557764 3.0065289  3.12448645
 3.12537524 3.1393197  3.14167392 3.32173427 3.66775231 3.66848059
 3.80045331 3.80657365 5.18529227 9.82946209]
   3 ( 0.000  0.500  0.500)   [-0.25583904 -0.25169891  0.04049028  0.07087081] [0.90376599 0.95975271 1.50710923 1.51353573 1.75075818 1.76482191
 2.07010503 2.07148483 2.32347295 2.33136539 2.84379908 2.85202511
 2.88518143 2.88541222 2.98372219 2.98745356 3.73403348 3.73502535
 5.07670465 5.07934978 6.89516216 6.89703646]
    CPU time for vj and vk      3.74 sec, wall time      0.12 sec
E1 = (4.193497786429276-1.0515080437451889e-17j)  E_coul = (-2.24115430390847+2.898551829388765e-17j)
Extra cycle  E= -10.8347856631034  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     32.18 sec, wall time      1.03 sec
    CPU time for SCF     34.16 sec, wall time      1.10 sec
converged SCF energy = -10.8347856631034
**** SCF Summaries ****
Total Energy =                         -10.834785663103434
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193497786429276
Two-electron Energy =                   -2.241154303908470
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.69 sec, wall time      0.06 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 457 MB)
    CPU time for KMP2      4.38 sec, wall time      0.14 sec
E(KMP2) = -11.0642807131534  E_corr = -0.229495050049952
E(SCS-KMP2) = -11.0587901595004  E_corr = -0.224004496397006
E_corr(same-spin) = -0.0592956503803115
E_corr(oppo-spin) = -0.170199399669641
End time = Tue Jun  3 04:48:56 PM PDT 2025
