SLURMD_NODENAME = hpc-54-38
Start time = Tue Jun  3 10:57:40 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-5/49986232/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-5/49986232/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/50/5/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-5
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-5
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 5.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 5.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =   5.00, nao = 26, nip = 130
Parent grid size = 4913, selected grid size = 130
truncated values = 5.64e+01, estimated error = 1.08e+01
Number of interpolating points is 130.
    CPU time for building inpv_kpt      8.25 sec, wall time      1.68 sec

Out-core version is used for eta_kpt.
disk space required: 4.09e-02 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   4.09e-02 GB
memory needed for each k-point: 1.02e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      2.21 sec, wall time      0.08 sec
    CPU time for building eta_kpt      3.15 sec, wall time      0.11 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      1.07 sec, wall time      0.03 sec
    CPU time for coul_kpt[ 2 / 4]      0.91 sec, wall time      0.03 sec
    CPU time for coul_kpt[ 3 / 4]      0.89 sec, wall time      0.03 sec
    CPU time for coul_kpt[ 4 / 4]      0.86 sec, wall time      0.03 sec
    CPU time for building coul_kpt      3.81 sec, wall time      0.12 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-5/49986232/e7okwxcw


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-5/49986232/tmp_p0ckfhf
max_memory 327680 MB (current use 402 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fd90e656770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.09 sec, wall time      0.04 sec
E1 = (3.6045120653301033-1.3614619035760704e-18j)  E_coul = (-4.224997169766885-2.914746511722469e-17j)
init E= -13.407614250061
    CPU time for initialize scf      2.71 sec, wall time      0.09 sec
HOMO = 0.64202060905  LUMO = 0.777664191948
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.96966819  0.60584029  0.60986836  0.64202061] [0.86084824 0.88603304 0.90819922 1.13342261 1.78964248 1.80380917
 1.86914644 2.08605085 2.08858927 2.09957452 2.6446442  2.64675397
 2.64936815 3.54753114 3.55517749 3.5556214  3.65557664 3.65805668
 4.21088343 4.73214991 4.73377327 4.73580975]
   1 (-0.000 -0.000  0.500)   [-0.77386748 -0.50628707  0.46240856  0.50215574] [0.9529278  1.02461568 1.03911316 1.35634021 1.63186023 1.75989487
 1.81954717 1.82248142 2.1120671  2.11800761 2.95798319 3.06478452
 3.06644183 3.09985159 3.10271404 3.30576893 3.64937161 3.65236506
 3.76289302 3.76486328 5.13895316 9.61544035]
   2 ( 0.000  0.500 -0.000)   [-0.77263021 -0.5070759   0.46132155  0.5023817 ] [0.95361221 1.02279274 1.0387203  1.35756462 1.63101609 1.7611121
 1.81615248 1.82256871 2.1128679  2.11775571 2.95753032 3.0665976
 3.06726599 3.10062391 3.10250208 3.30330893 3.64766097 3.65325629
 3.76294413 3.76481332 5.14269859 9.61586147]
   3 ( 0.000  0.500  0.500)   [-0.41127711 -0.3995125   0.22593333  0.30991347] [0.77766419 0.84886744 1.4024444  1.40333994 1.67780008 1.68634005
 2.07261523 2.0760853  2.31002084 2.3139572  2.79578391 2.79959138
 2.86862827 2.87891971 2.9520639  2.95368155 3.67453442 3.67634755
 5.04339197 5.04902056 6.79732066 6.80208373]
    CPU time for vj and vk      1.16 sec, wall time      0.04 sec
E1 = (4.19864552994928-9.198138454729335e-19j)  E_coul = (-2.2305907181793994-3.2595280703008225e-17j)
cycle= 1 E= -10.8190743338544  delta_E= 2.59  |g|= 0.463  |ddm|= 65.3
    CPU time for cycle= 1      1.57 sec, wall time      0.05 sec
HOMO = 0.352230805387  LUMO = 0.899515714907
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66707318  0.29923855  0.33853374  0.35223081] [0.9786063  0.98717084 1.01400896 1.33796802 1.80343643 1.80435367
 1.89298065 2.12025885 2.12041626 2.12479726 2.70008719 2.70852221
 2.71024113 3.56034589 3.56386465 3.5647432  3.69392005 3.7026342
 4.22258296 4.76959224 4.76993745 4.77122207]
   1 (-0.000 -0.000  0.500)   [-0.39136423 -0.25594469  0.18409988  0.22264304] [1.09491039 1.10228742 1.15283986 1.39817388 1.68278357 1.81197718
 1.84729091 1.8487276  2.1173548  2.12379856 3.0062874  3.11805142
 3.12348817 3.13577857 3.13822019 3.32139628 3.6635929  3.66549999
 3.79474598 3.80175324 5.18698432 9.80379156]
   2 ( 0.000  0.500 -0.000)   [-0.3897645  -0.25605437  0.18477557  0.2207757 ] [1.09465649 1.09964531 1.15223316 1.3990403  1.6836023  1.81244691
 1.84500155 1.84840908 2.11801238 2.12407577 3.00469495 3.12071419
 3.12239173 3.13764455 3.13885877 3.31882744 3.66204019 3.66681465
 3.79487967 3.80261936 5.18929889 9.804958  ]
   3 ( 0.000  0.500  0.500)   [-0.25338483 -0.24677679  0.03607884  0.07536145] [0.89951571 0.96297469 1.49953294 1.5096241  1.74626934 1.76311201
 2.06942044 2.07184176 2.32076354 2.33009349 2.84395922 2.84954565
 2.8784567  2.88259711 2.97656098 2.98532433 3.73203309 3.73362639
 5.06960519 5.07798666 6.88344916 6.896381  ]
    CPU time for vj and vk      1.15 sec, wall time      0.04 sec
E1 = (4.19542730252455+4.192949573709858e-19j)  E_coul = (-2.2403434879407063-3.242349340859067e-17j)
cycle= 2 E= -10.8320453310404  delta_E= -0.013  |g|= 0.092  |ddm|= 30.2
    CPU time for cycle= 2      1.66 sec, wall time      0.05 sec
HOMO = 0.345933988165  LUMO = 0.904774340276
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66499051  0.29765628  0.33231523  0.34593399] [0.98166563 0.99156523 1.01626088 1.3444059  1.80332791 1.80430616
 1.89428326 2.12110436 2.1213701  2.12566619 2.69941012 2.7068219
 2.70893718 3.56049021 3.56401623 3.56446354 3.69513467 3.70346303
 4.22057852 4.77042458 4.77048242 4.77209929]
   1 (-0.000 -0.000  0.500)   [-0.39090368 -0.2571211   0.18387015  0.21731917] [1.09949825 1.10568436 1.15398933 1.39986602 1.68332991 1.81217621
 1.8470624  1.84770848 2.11726235 2.12352079 3.00699088 3.11886723
 3.12386037 3.13601684 3.13825994 3.32184055 3.66380452 3.66540103
 3.795056   3.80151682 5.18601044 9.79859229]
   2 ( 0.000  0.500 -0.000)   [-0.38918498 -0.25736019  0.18454759  0.21543174] [1.09937997 1.10290926 1.15340492 1.40070128 1.68423669 1.81279189
 1.84391183 1.84794726 2.11789401 2.12371554 3.00529157 3.12138143
 3.12261537 3.13809602 3.13888233 3.31939631 3.66189475 3.66669679
 3.79522919 3.80250827 5.18840031 9.80013467]
   3 ( 0.000  0.500  0.500)   [-0.25436463 -0.24754932  0.03638752  0.07066121] [0.90477434 0.96381572 1.50310816 1.51201369 1.74716252 1.76266898
 2.06885455 2.07122603 2.32112089 2.33009571 2.84390203 2.84954731
 2.87885088 2.8820851  2.97627538 2.98519812 3.73328617 3.73479917
 5.06949793 5.0775301  6.87899899 6.89581793]
    CPU time for vj and vk      1.17 sec, wall time      0.04 sec
E1 = (4.19477268114002+2.0997462861775762e-19j)  E_coul = (-2.240310896036292-3.2361348673338054e-17j)
cycle= 3 E= -10.8326673605205  delta_E= -0.000622  |g|= 0.00693  |ddm|=    3
    CPU time for cycle= 3      1.68 sec, wall time      0.06 sec
HOMO = 0.346230883202  LUMO = 0.905088628003
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66449552  0.29804393  0.3323921   0.34623088] [0.98215843 0.99217813 1.01669554 1.34505514 1.80351559 1.80447762
 1.89412056 2.12124771 2.12143232 2.12580736 2.69980974 2.70713886
 2.70932221 3.56057196 3.56406875 3.56455595 3.69545508 3.70373959
 4.22057468 4.77069788 4.77073465 4.77236401]
   1 (-0.000 -0.000  0.500)   [-0.39028731 -0.25680007  0.18434622  0.2175044 ] [1.09994889 1.10616901 1.15418053 1.39991663 1.68346226 1.81253072
 1.84728597 1.84787952 2.11745238 2.12358585 3.00734934 3.11899547
 3.12398554 3.13660181 3.13878213 3.32194051 3.66389552 3.66551453
 3.79528598 3.80172607 5.18631763 9.79975562]
   2 ( 0.000  0.500 -0.000)   [-0.38858329 -0.25704667  0.18502949  0.21562171] [1.09982807 1.10338894 1.15360569 1.40074356 1.68436972 1.81313295
 1.84411075 1.84815025 2.11809467 2.12377554 3.00565387 3.12156242
 3.1227411  3.1386563  3.13939299 3.3194955  3.66199721 3.66679653
 3.79545037 3.80271556 5.18867802 9.80130107]
   3 ( 0.000  0.500  0.500)   [-0.25383878 -0.24719211  0.03681585  0.07089821] [0.90508863 0.96380885 1.50393628 1.51281304 1.74728062 1.76304362
 2.06891135 2.07124095 2.32108816 2.33047647 2.84423588 2.84984907
 2.87870981 2.88235548 2.97646426 2.98542527 3.73374915 3.7351305
 5.06974875 5.07770874 6.88067322 6.89526518]
    CPU time for vj and vk      1.15 sec, wall time      0.04 sec
E1 = (4.194832682336047+1.8683006337973562e-19j)  E_coul = (-2.2403750274512055-3.234834433428356e-17j)
cycle= 4 E= -10.8326714907394  delta_E= -4.13e-06  |g|= 0.002  |ddm|= 0.127
    CPU time for cycle= 4      1.66 sec, wall time      0.05 sec
HOMO = 0.346223738436  LUMO = 0.905092931909
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66450577  0.29802317  0.33234057  0.34622374] [0.9821649  0.99218163 1.01668471 1.34504971 1.80351009 1.80446835
 1.89413083 2.12124186 2.12141592 2.12580345 2.69978693 2.70710741
 2.70930409 3.56056248 3.56405992 3.56455182 3.695446   3.70373036
 4.22057421 4.77069355 4.77073075 4.77235873]
   1 (-0.000 -0.000  0.500)   [-0.39026621 -0.25683027  0.18433534  0.21746855] [1.09993963 1.10617068 1.15417008 1.3999213  1.68344927 1.81251556
 1.84726759 1.84785608 2.11745558 2.1235693  3.00734303 3.1190404
 3.12399447 3.13653917 3.1387486  3.32194284 3.66389517 3.66551258
 3.79526663 3.80170561 5.18631153 9.79969187]
   2 ( 0.000  0.500 -0.000)   [-0.38856218 -0.25707764  0.18501911  0.21558666] [1.09982041 1.10338812 1.15359682 1.40074725 1.68435425 1.81312018
 1.84408825 1.84813073 2.11809839 2.12375811 3.00564538 3.12158553
 3.12274723 3.13861176 3.13936013 3.31950253 3.66199161 3.66679853
 3.79543383 3.80269871 5.18867027 9.80124036]
   3 ( 0.000  0.500  0.500)   [-0.25388401 -0.24718008  0.03679889  0.0708886 ] [0.90509293 0.96380437 1.50394313 1.51283031 1.7472938  1.76294807
 2.06890421 2.07123278 2.32113347 2.33040849 2.84422251 2.84983065
 2.87876933 2.8822908  2.97645023 2.98542016 3.7337573  3.73510316
 5.06974174 5.07770371 6.88022807 6.8956634 ]
    CPU time for vj and vk      1.17 sec, wall time      0.04 sec
E1 = (4.194858223980049+1.8435880960094517e-19j)  E_coul = (-2.2404008994839346-3.235846298914768e-17j)
cycle= 5 E= -10.8326718211281  delta_E= -3.3e-07  |g|= 0.000589  |ddm|= 0.0581
    CPU time for cycle= 5      1.67 sec, wall time      0.06 sec
HOMO = 0.346215842308  LUMO = 0.905086787777
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66452194  0.29800355  0.33231455  0.34621584] [0.98215431 0.99216816 1.01666917 1.34503228 1.80350398 1.80446122
 1.89413378 2.12123668 2.12140646 2.12579823 2.6997677  2.70708927
 2.70928825 3.56055868 3.56405523 3.56454752 3.6954358  3.70371974
 4.22057044 4.77068315 4.77072064 4.77234872]
   1 (-0.000 -0.000  0.500)   [-0.39027119 -0.2568516   0.18431764  0.21744665] [1.09992473 1.10615907 1.15415997 1.39992062 1.68343988 1.81250314
 1.84725447 1.84784098 2.11745417 2.12356149 3.0073318  3.11902973
 3.12398691 3.13652558 3.13873093 3.32193791 3.66388943 3.66550849
 3.79525671 3.80169523 5.18629842 9.79963823]
   2 ( 0.000  0.500 -0.000)   [-0.38856696 -0.25709912  0.18500136  0.21556567] [1.09980549 1.10337643 1.1535872  1.40074697 1.6843435  1.81310782
 1.84407337 1.84811707 2.11809655 2.1237498  3.00563462 3.12157813
 3.12273944 3.13859612 3.13934269 3.31949775 3.66198507 3.66679438
 3.79542342 3.80268798 5.18865815 9.80118848]
   3 ( 0.000  0.500  0.500)   [-0.25390006 -0.24720149  0.03678051  0.07087934] [0.90508679 0.96380273 1.50392354 1.5128191  1.74726196 1.76293274
 2.06889956 2.07123011 2.32111619 2.33040896 2.84420578 2.84981556
 2.87875637 2.88229929 2.97644031 2.98541377 3.73374359 3.73508762
 5.06973268 5.07769586 6.88025881 6.89557967]
    CPU time for vj and vk      1.15 sec, wall time      0.04 sec
E1 = (4.194867198980047+1.8510347894739603e-19j)  E_coul = (-2.240409943890993-3.235835049258437e-17j)
Extra cycle  E= -10.8326718905352  delta_E= -6.94e-08  |g|= 0.000345  |ddm|= 0.0162
    CPU time for scf_cycle     12.59 sec, wall time      0.42 sec
    CPU time for SCF     14.63 sec, wall time      0.49 sec
converged SCF energy = -10.8326718905352
**** SCF Summaries ****
Total Energy =                         -10.832671890535186
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.194867198980047
Two-electron Energy =                   -2.240409943890993
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.88900
pop of  0 C 3s            0.00325
pop of  0 C 2px           1.05705
pop of  0 C 2py           1.01162
pop of  0 C 2pz           1.01313
pop of  0 C 3px           0.00294
pop of  0 C 3py           0.00219
pop of  0 C 3pz           0.00219
pop of  0 C 3dxy          0.00626
pop of  0 C 3dyz          0.00552
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00641
pop of  0 C 3dx2-y2       0.00016
pop of  1 C 2s            0.89400
pop of  1 C 3s            0.00320
pop of  1 C 2px           1.05443
pop of  1 C 2py           1.01161
pop of  1 C 2pz           1.01113
pop of  1 C 3px           0.00287
pop of  1 C 3py           0.00212
pop of  1 C 3pz           0.00213
pop of  1 C 3dxy          0.00646
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00642
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00019
charge of    1C =     -0.00019
    CPU time for vj and vk      0.36 sec, wall time      0.01 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 451 MB)
    CPU time for KMP2      1.25 sec, wall time      0.04 sec
E(KMP2) = -11.0686777524113  E_corr = -0.236005861876147
E(SCS-KMP2) = -11.0622431624818  E_corr = -0.229571271946638
E_corr(same-spin) = -0.0618874180439291
E_corr(oppo-spin) = -0.174118443832218
End time = Tue Jun  3 10:57:44 PM PDT 2025
