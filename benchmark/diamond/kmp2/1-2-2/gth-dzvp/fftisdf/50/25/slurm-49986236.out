SLURMD_NODENAME = hpc-35-03
Start time = Tue Jun  3 10:57:44 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-25/49986236/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-25/49986236/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/50/25/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-25
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 25.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 4913, selected grid size = 650
truncated values = 6.72e+01, estimated error = 9.44e-02
Number of interpolating points is 650.
    CPU time for building inpv_kpt      8.23 sec, wall time      1.66 sec

Out-core version is used for eta_kpt.
disk space required: 2.04e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   2.04e-01 GB
memory needed for each k-point: 5.11e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      9.73 sec, wall time      0.33 sec
    CPU time for building eta_kpt     10.66 sec, wall time      0.36 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      9.03 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 2 / 4]      8.23 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 3 / 4]      8.27 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 4 / 4]      8.25 sec, wall time      0.63 sec
    CPU time for building coul_kpt     34.61 sec, wall time      2.55 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-25/49986236/nwlcpic9


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-25/49986236/tmphloe0kdb
max_memory 327680 MB (current use 388 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f562c3b6770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.67 sec, wall time      0.09 sec
E1 = (3.604512065330103+1.0437874635218045e-17j)  E_coul = (-4.238150976531659+2.5322980748726147e-17j)
init E= -13.4207680568258
    CPU time for initialize scf      4.46 sec, wall time      0.15 sec
HOMO = 0.642142403341  LUMO = 0.776528523491
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422286  0.60527262  0.60922826  0.6421424 ] [0.85981203 0.88582313 0.910196   1.12520813 1.79100344 1.80523338
 1.86207082 2.08341783 2.08748074 2.0992384  2.64579542 2.64765102
 2.64892776 3.55319037 3.5539208  3.55480518 3.65950781 3.6602922
 4.21017845 4.73495228 4.73542081 4.73596261]
   1 (-0.000 -0.000  0.500)   [-0.78015069 -0.50848224  0.46132961  0.50284462] [0.94786263 1.02143011 1.04032072 1.35354407 1.62942502 1.75601253
 1.81456543 1.82407339 2.11260118 2.11925336 2.95658511 3.06754217
 3.06860425 3.10243002 3.10320102 3.30379732 3.64927367 3.65340399
 3.76724287 3.76774965 5.13924673 9.6501195 ]
   2 ( 0.000  0.500 -0.000)   [-0.78015067 -0.50848258  0.46132942  0.50284457] [0.94786164 1.02143014 1.04032069 1.35354341 1.62942478 1.75601333
 1.81456577 1.82407338 2.11260137 2.11925286 2.95658624 3.06754198
 3.0686045  3.10243117 3.10320097 3.30379692 3.64927358 3.65340435
 3.76724012 3.76775108 5.13924809 9.65011779]
   3 ( 0.000  0.500  0.500)   [-0.41689271 -0.40449995  0.22475862  0.31063167] [0.77652852 0.84136908 1.40153319 1.40348218 1.67779426 1.68165488
 2.07043195 2.07585836 2.3122562  2.31465187 2.79346691 2.80078481
 2.8706577  2.87949517 2.95490288 2.95598318 3.67413334 3.6756086
 5.04763009 5.04820165 6.80918747 6.8146455 ]
    CPU time for vj and vk      2.66 sec, wall time      0.09 sec
E1 = (4.198007090666742-8.28731225942274e-18j)  E_coul = (-2.232603425879561+1.4064227748906623e-17j)
cycle= 1 E= -10.8217254808371  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      3.12 sec, wall time      0.10 sec
HOMO = 0.352247290819  LUMO = 0.898272263351
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169319  0.30155892  0.34067792  0.35224729] [0.97853083 0.99133345 1.01471717 1.3323244  1.80554189 1.80602157
 1.88406378 2.11998741 2.12202608 2.12538956 2.70805491 2.71165675
 2.71194141 3.56353072 3.56541333 3.56997458 3.69759013 3.70486864
 4.22165674 4.77131537 4.77264566 4.7747315 ]
   1 (-0.000 -0.000  0.500)   [-0.39621605 -0.2565753   0.18712398  0.22273283] [1.09293511 1.10500101 1.15031166 1.3970979  1.68430048 1.81150106
 1.84708743 1.85165046 2.11920449 2.12573884 3.00549467 3.12357318
 3.12501994 3.13811501 3.1409903  3.3210966  3.66803598 3.66810385
 3.79985827 3.80638164 5.18621059 9.83367594]
   2 ( 0.000  0.500 -0.000)   [-0.39621618 -0.25657543  0.18712393  0.22273286] [1.09293454 1.10500056 1.15031174 1.39709605 1.68429969 1.81150264
 1.847087   1.85165051 2.11920444 2.12573831 3.00549558 3.12357516
 3.12502006 3.13811459 3.14098994 3.32109676 3.66803914 3.66810153
 3.79985688 3.80638359 5.18621132 9.83367624]
   3 ( 0.000  0.500  0.500)   [-0.255455   -0.2512295   0.03956202  0.07509185] [0.89827226 0.95900246 1.50272935 1.50995556 1.74943976 1.7646395
 2.07049185 2.07210189 2.32316405 2.33068261 2.84347586 2.85141845
 2.8850795  2.88514417 2.98374216 2.98719615 3.73224445 3.73350598
 5.07643799 5.07990523 6.8979853  6.89910168]
    CPU time for vj and vk      2.68 sec, wall time      0.09 sec
E1 = (4.194199460444145-6.2684000660318914e-18j)  E_coul = (-2.241268593921364+1.4444245085022165e-17j)
cycle= 2 E= -10.8341982791015  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      3.23 sec, wall time      0.10 sec
HOMO = 0.346104628141  LUMO = 0.903474744671
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976033  0.30008158  0.3351941   0.34610463] [0.9817688  0.99581249 1.01711212 1.33875164 1.80541282 1.80618415
 1.88487439 2.12065022 2.12313496 2.12642444 2.70743352 2.71028955
 2.71096026 3.5637016  3.56582243 3.56959032 3.6989218  3.70582112
 4.21954075 4.77235303 4.77325514 4.77523364]
   1 (-0.000 -0.000  0.500)   [-0.39588006 -0.25760916  0.18696876  0.21794573] [1.097667   1.10849585 1.15152506 1.39893969 1.68507894 1.81195396
 1.84609032 1.85178467 2.11922506 2.12552699 3.00621363 3.12425423
 3.12523523 3.13885607 3.14124609 3.32162834 3.66769419 3.66834282
 3.80025781 3.80638954 5.18509277 9.82853905]
   2 ( 0.000  0.500 -0.000)   [-0.39588018 -0.25760938  0.18696871  0.21794578] [1.09766656 1.10849545 1.15152504 1.39893779 1.68507812 1.81195546
 1.84608993 1.85178469 2.11922498 2.12552635 3.00621427 3.12425608
 3.12523532 3.13885582 3.14124579 3.3216285  3.66769159 3.66834537
 3.80025667 3.80639148 5.18509344 9.82853944]
   3 ( 0.000  0.500  0.500)   [-0.25627566 -0.25205201  0.04011621  0.0706301 ] [0.90347474 0.95976919 1.50636832 1.51278393 1.75053132 1.76460598
 2.07003512 2.07148026 2.32338751 2.33115226 2.84349373 2.85176238
 2.88517965 2.88526894 2.98353742 2.98724453 3.73376651 3.73460436
 5.07651712 5.0791766  6.8948337  6.89651401]
    CPU time for vj and vk      2.71 sec, wall time      0.09 sec
E1 = (4.1934344988118895-5.834467785830262e-18j)  E_coul = (-2.2410975782131506+1.455329645400279e-17j)
cycle= 3 E= -10.8347922250255  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      3.24 sec, wall time      0.10 sec
HOMO = 0.346446191648  LUMO = 0.903779088997
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926008  0.30045558  0.33534828  0.34644619] [0.98224993 0.99639191 1.01755868 1.33932548 1.80561601 1.80636133
 1.88474304 2.12079935 2.1232304  2.12657376 2.70782419 2.71063773
 2.71139687 3.56380633 3.56596397 3.56962645 3.6992366  3.70609249
 4.21959427 4.77262923 4.77350196 4.7754669 ]
   1 (-0.000 -0.000  0.500)   [-0.39527616 -0.2572684   0.18743292  0.21819205] [1.09808231 1.1089574  1.15171636 1.39901173 1.68521938 1.81232707
 1.84630699 1.85202081 2.11943246 2.12560204 3.00655837 3.12449388
 3.12538349 3.13936186 3.14170437 3.32174443 3.6677794  3.66848184
 3.80048545 3.80659694 5.18540646 9.82978741]
   2 ( 0.000  0.500 -0.000)   [-0.39527629 -0.2572686   0.18743288  0.21819208] [1.09808185 1.10895699 1.15171635 1.39900984 1.68521855 1.81232859
 1.8463066  1.85202083 2.11943241 2.12560142 3.00655902 3.12449571
 3.12538357 3.13936161 3.14170407 3.32174458 3.66777676 3.66848434
 3.8004843  3.80659886 5.18540714 9.82978777]
   3 ( 0.000  0.500  0.500)   [-0.25578236 -0.25164309  0.04053666  0.07090452] [0.90377909 0.95976319 1.50714571 1.51356268 1.75081821 1.76487728
 2.07012018 2.07149091 2.32349645 2.33138712 2.84383951 2.85205346
 2.88519095 2.88541397 2.98373736 2.98747041 3.73407871 3.73506524
 5.07676032 5.07935868 6.89535629 6.89720716]
    CPU time for vj and vk      2.67 sec, wall time      0.09 sec
E1 = (4.193463628701781-5.77316020905634e-18j)  E_coul = (-2.2411293949396+1.455925357612985e-17j)
cycle= 4 E= -10.8347949118621  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0986
    CPU time for cycle= 4      3.21 sec, wall time      0.10 sec
HOMO = 0.346402249583  LUMO = 0.903765881114
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931323  0.30039822  0.33527199  0.34640225] [0.98222618 0.99635828 1.01752275 1.33927028 1.80560375 1.80633841
 1.88475674 2.12078961 2.12320912 2.12656091 2.70776807 2.71057969
 2.71134963 3.56379423 3.56595311 3.56960833 3.69920748 3.70606233
 4.21957746 4.77260479 4.77347321 4.77543769]
   1 (-0.000 -0.000  0.500)   [-0.39529713 -0.25733712  0.18738428  0.2181267 ] [1.0980403  1.1089284  1.15169217 1.39901717 1.68519022 1.81228685
 1.8462634  1.85198381 2.11942531 2.12557749 3.00652676 3.12448194
 3.1253662  3.1393101  3.14164942 3.3217366  3.66776005 3.66847268
 3.80045265 3.80656382 5.18536815 9.82961215]
   2 ( 0.000  0.500 -0.000)   [-0.39529725 -0.25733732  0.18738424  0.21812673] [1.09803985 1.10892799 1.15169215 1.39901528 1.68518939 1.81228836
 1.84626301 1.85198383 2.11942525 2.12557687 3.00652742 3.12448377
 3.12536627 3.13930985 3.14164912 3.32173676 3.66775742 3.66847517
 3.80045151 3.80656574 5.18536882 9.8296125 ]
   3 ( 0.000  0.500  0.500)   [-0.25584066 -0.25169912  0.04048506  0.07086699] [0.90376588 0.95975471 1.50709415 1.51353059 1.75075132 1.76481631
 2.07010423 2.07147901 2.32347344 2.3313641  2.84379856 2.85200952
 2.88518163 2.88541059 2.98370566 2.98745151 3.73403658 3.73502751
 5.07673696 5.07932985 6.89526425 6.89712993]
    CPU time for vj and vk      2.65 sec, wall time      0.09 sec
E1 = (4.193485132670673-5.766702048122621e-18j)  E_coul = (-2.2411509450674685+1.455638749870493e-17j)
cycle= 5 E= -10.834794958021  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      3.20 sec, wall time      0.10 sec
HOMO = 0.346409238646  LUMO = 0.90376703834
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931045  0.30039914  0.33527251  0.34640924] [0.98222761 0.9963598  1.01752353 1.33927195 1.8056044  1.80633912
 1.8847557  2.12078927 2.12320844 2.12656164 2.70776926 2.71058122
 2.7113529  3.56379476 3.56595375 3.56960826 3.69920829 3.70606303
 4.21957849 4.77260569 4.77347388 4.7754384 ]
   1 (-0.000 -0.000  0.500)   [-0.39529181 -0.25733432  0.18738534  0.21812769] [1.09804109 1.10892986 1.15169162 1.39901636 1.68519139 1.8122891
 1.84626408 1.85198508 2.11942814 2.12557779 3.00652892 3.12448296
 3.12536636 3.13931166 3.14165052 3.32173656 3.66775995 3.66847367
 3.80045269 3.80656427 5.18536996 9.82961992]
   2 ( 0.000  0.500 -0.000)   [-0.39529194 -0.25733451  0.1873853   0.21812772] [1.09804064 1.10892945 1.1516916  1.39901447 1.68519056 1.81229061
 1.84626368 1.8519851  2.11942808 2.12557717 3.00652957 3.12448479
 3.12536643 3.13931141 3.14165022 3.32173672 3.66775731 3.66847616
 3.80045155 3.80656619 5.18537063 9.82962028]
   3 ( 0.000  0.500  0.500)   [-0.25583708 -0.25169799  0.04048648  0.07087118] [0.90376704 0.95975428 1.50709573 1.51353529 1.75075167 1.76481522
 2.07010514 2.07147925 2.32347311 2.33136558 2.84379987 2.85201023
 2.88518069 2.88541197 2.98370624 2.98745309 3.7340363  3.73502991
 5.07673823 5.07933087 6.8952666  6.89713523]
    CPU time for vj and vk      2.70 sec, wall time      0.09 sec
E1 = (4.193485709723804-5.768756661366626e-18j)  E_coul = (-2.2411515230002004+1.4557409118460222e-17j)
Extra cycle  E= -10.8347949589006  delta_E= -8.8e-10  |g|= 2.68e-05  |ddm|= 0.00139
    CPU time for scf_cycle     23.64 sec, wall time      0.76 sec
    CPU time for SCF     25.66 sec, wall time      0.83 sec
converged SCF energy = -10.8347949589006
**** SCF Summaries ****
Total Energy =                         -10.834794958900636
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193485709723804
Two-electron Energy =                   -2.241151523000200
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89509
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01164
pop of  0 C 2pz           1.01164
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89509
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      1.78 sec, wall time      0.06 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 434 MB)
    CPU time for KMP2      3.59 sec, wall time      0.11 sec
E(KMP2) = -11.0642891969138  E_corr = -0.229494238013182
E(SCS-KMP2) = -11.0587987476404  E_corr = -0.224003788739764
E_corr(same-spin) = -0.059295342549293
E_corr(oppo-spin) = -0.170198895463889
End time = Tue Jun  3 10:57:50 PM PDT 2025
