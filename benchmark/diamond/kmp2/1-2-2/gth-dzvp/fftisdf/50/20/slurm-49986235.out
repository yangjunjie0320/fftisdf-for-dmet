SLURMD_NODENAME = hpc-35-24
Start time = Tue Jun  3 10:57:44 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-20/49986235/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-20/49986235/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/50/20/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-20
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 4913, selected grid size = 520
truncated values = 6.70e+01, estimated error = 2.55e-01
Number of interpolating points is 520.
    CPU time for building inpv_kpt      8.23 sec, wall time      1.67 sec

Out-core version is used for eta_kpt.
disk space required: 1.64e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   1.64e-01 GB
memory needed for each k-point: 4.09e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      8.31 sec, wall time      0.27 sec
    CPU time for building eta_kpt      9.31 sec, wall time      0.30 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      8.30 sec, wall time      0.40 sec
    CPU time for coul_kpt[ 2 / 4]      7.70 sec, wall time      0.41 sec
    CPU time for coul_kpt[ 3 / 4]      7.38 sec, wall time      0.41 sec
    CPU time for coul_kpt[ 4 / 4]      7.57 sec, wall time      0.41 sec
    CPU time for building coul_kpt     31.49 sec, wall time      1.64 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-20/49986235/rnfzsf0m


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-20/49986235/tmp_8xc5ap2
max_memory 327680 MB (current use 388 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f2fc8562770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.24 sec, wall time      0.07 sec
E1 = (3.604512065330103-9.07641265813619e-19j)  E_coul = (-4.238151011121367+1.9232673624333305e-17j)
init E= -13.4207680914155
    CPU time for initialize scf      3.92 sec, wall time      0.13 sec
HOMO = 0.642143158909  LUMO = 0.776528117201
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422293  0.60527286  0.60922785  0.64214316] [0.85981066 0.88582314 0.91019589 1.12520974 1.79100379 1.80523394
 1.86206619 2.08341525 2.08747733 2.09923782 2.6457973  2.6476538
 2.6489277  3.55319525 3.5539229  3.55480225 3.65950769 3.66029092
 4.21018445 4.73496042 4.73541712 4.73597937]
   1 (-0.000 -0.000  0.500)   [-0.78015191 -0.50848133  0.46133103  0.50284396] [0.94786414 1.02142875 1.04031997 1.35354185 1.62942477 1.75601449
 1.81456842 1.82407623 2.11260228 2.11925443 2.95658488 3.06753699
 3.06860715 3.10243189 3.1032016  3.30379545 3.64927168 3.65340065
 3.7672422  3.76774894 5.13924477 9.65011431]
   2 ( 0.000  0.500 -0.000)   [-0.78015057 -0.50848188  0.46132835  0.50284457] [0.94785852 1.0214308  1.04032075 1.3535391  1.62942519 1.75600945
 1.81456834 1.82407401 2.11260105 2.11925226 2.95658399 3.06753779
 3.06860499 3.10242978 3.10319705 3.30379722 3.64927515 3.65340948
 3.76724671 3.76774598 5.13925212 9.65011408]
   3 ( 0.000  0.500  0.500)   [-0.41689289 -0.40449948  0.22475811  0.31063122] [0.77652812 0.84136817 1.4015331  1.4034815  1.67779311 1.6816548
 2.07043173 2.07585766 2.31225564 2.3146515  2.7934671  2.80078427
 2.87065549 2.87949436 2.95490554 2.95598468 3.67413175 3.67560928
 5.04762324 5.04820407 6.80918891 6.81464654]
    CPU time for vj and vk      2.18 sec, wall time      0.07 sec
E1 = (4.198007980749825-9.780155897525612e-18j)  E_coul = (-2.232605194375004+7.262476472761887e-18j)
cycle= 1 E= -10.8217263592494  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      2.66 sec, wall time      0.09 sec
HOMO = 0.352247252339  LUMO = 0.89827292547
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169325  0.3015596   0.34067629  0.35224725] [0.97852822 0.99133348 1.01471711 1.33232611 1.80554246 1.80602205
 1.88406024 2.11998264 2.12202443 2.12538917 2.70806154 2.71166364
 2.71194022 3.56352653 3.56541146 3.56997699 3.69759091 3.70486765
 4.2216656  4.7713419  4.77263022 4.77474951]
   1 (-0.000 -0.000  0.500)   [-0.39621729 -0.25657461  0.18712288  0.22273311] [1.09293768 1.10500157 1.15030814 1.39709752 1.68430011 1.81150216
 1.84709769 1.85165367 2.11920475 2.12573911 3.00549661 3.12357436
 3.12502143 3.13810741 3.1409943  3.32109254 3.66802742 3.66810259
 3.79985719 3.80637919 5.18620326 9.8336683 ]
   2 ( 0.000  0.500 -0.000)   [-0.39621641 -0.25657475  0.1871243   0.22273111] [1.09293356 1.104997   1.15031138 1.39708858 1.6843015  1.81150439
 1.84709572 1.85165669 2.11920509 2.12573665 3.0054958  3.12356907
 3.12502292 3.13811044 3.14099457 3.32109659 3.66803427 3.66810127
 3.7998567  3.80637811 5.18621724 9.83366863]
   3 ( 0.000  0.500  0.500)   [-0.25545375 -0.25123116  0.03955993  0.07509225] [0.89827293 0.95899888 1.50272706 1.50995568 1.74943917 1.76464079
 2.07049039 2.07210221 2.32316297 2.33068218 2.84347855 2.85141917
 2.88507985 2.88514043 2.98374511 2.98720225 3.73224408 3.73350897
 5.0764241  5.07991292 6.89798284 6.89910508]
    CPU time for vj and vk      2.13 sec, wall time      0.07 sec
E1 = (4.194199457157467-7.565813883366015e-18j)  E_coul = (-2.241269618407202+7.125737551143586e-18j)
cycle= 2 E= -10.834199306874  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      2.70 sec, wall time      0.09 sec
HOMO = 0.346104802603  LUMO = 0.903475743304
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976019  0.30008249  0.33519249  0.3461048 ] [0.98176647 0.99581283 1.01711224 1.33875414 1.80541368 1.80618461
 1.88487099 2.12064565 2.12313408 2.12642417 2.70743995 2.71029647
 2.71095934 3.56369787 3.56582012 3.56959236 3.69892288 3.7058205
 4.21954974 4.77237912 4.77323985 4.77525012]
   1 (-0.000 -0.000  0.500)   [-0.39588125 -0.25760839  0.18696779  0.21794613] [1.09766984 1.10849654 1.15152175 1.39893936 1.68507876 1.8119553
 1.84610095 1.85178777 2.11922536 2.12552709 3.00621524 3.1242553
 3.1252367  3.13884897 3.14124989 3.32162432 3.66769212 3.66833628
 3.80025727 3.8063872  5.18508521 9.82853255]
   2 ( 0.000  0.500 -0.000)   [-0.39588031 -0.2576085   0.18696918  0.21794372] [1.09766623 1.10849214 1.15152505 1.3989304  1.68508002 1.81195743
 1.84609836 1.85179062 2.11922557 2.12552487 3.00621477 3.12424994
 3.12523812 3.13885209 3.1412501  3.32162836 3.66769054 3.66834268
 3.80025654 3.80638614 5.18509929 9.82853267]
   3 ( 0.000  0.500  0.500)   [-0.25627432 -0.25205367  0.04011414  0.07063063] [0.90347574 0.95976599 1.50636651 1.51278437 1.7505305  1.76460746
 2.07003376 2.07148071 2.32338652 2.331152   2.8434969  2.85176277
 2.88517976 2.88526528 2.98354043 2.98725081 3.73376628 3.73460797
 5.07650401 5.07917789 6.89483125 6.89651839]
    CPU time for vj and vk      2.19 sec, wall time      0.07 sec
E1 = (4.19343499076847-7.149744103203373e-18j)  E_coul = (-2.241099122270986+7.086819181536757e-18j)
cycle= 3 E= -10.8347932771268  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      2.79 sec, wall time      0.09 sec
HOMO = 0.346446334529  LUMO = 0.903779988554
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66925999  0.30045638  0.33534653  0.34644633] [0.9822475  0.99639214 1.01755868 1.33932783 1.8056168  1.80636175
 1.88473966 2.1207947  2.12322945 2.12657343 2.70783051 2.71064461
 2.71139588 3.56380259 3.56596162 3.56962847 3.69923759 3.70609179
 4.21960326 4.77265528 4.77348663 4.77548335]
   1 (-0.000 -0.000  0.500)   [-0.39527742 -0.25726766  0.18743187  0.21819235] [1.09808503 1.10895797 1.15171296 1.39901141 1.68521914 1.81232838
 1.84631758 1.85202385 2.11943276 2.12560212 3.00655992 3.12449491
 3.12538491 3.13935459 3.14170807 3.32174034 3.6677772  3.66847522
 3.80048484 3.80659452 5.18539876 9.82978054]
   2 ( 0.000  0.500 -0.000)   [-0.39527648 -0.25726781  0.18743324  0.21818997] [1.09808146 1.1089536  1.15171627 1.39900243 1.68522042 1.81233048
 1.84631497 1.85202668 2.11943294 2.12559987 3.00655941 3.12448954
 3.12538636 3.13935774 3.14170827 3.32174445 3.66777567 3.6684816
 3.80048412 3.80659345 5.18541294 9.82978068]
   3 ( 0.000  0.500  0.500)   [-0.2557811  -0.25164481  0.04053449  0.07090502] [0.90377999 0.95975997 1.50714371 1.51356299 1.75081728 1.76487868
 2.0701188  2.07149129 2.32349542 2.33138681 2.84384255 2.85205376
 2.88519111 2.88541019 2.98374035 2.98747666 3.73407835 3.73506871
 5.07674693 5.07936011 6.89535372 6.8972113 ]
    CPU time for vj and vk      2.23 sec, wall time      0.07 sec
E1 = (4.193464130828242-7.109500008643867e-18j)  E_coul = (-2.2411309488389897+7.087455089557355e-18j)
cycle= 4 E= -10.834795963635  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0986
    CPU time for cycle= 4      2.79 sec, wall time      0.09 sec
HOMO = 0.346402404917  LUMO = 0.903766779275
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931314  0.30039902  0.33527025  0.3464024 ] [0.98222376 0.99635851 1.01752276 1.33927264 1.80560453 1.80633885
 1.88475336 2.12078498 2.12320818 2.12656058 2.70777439 2.71058657
 2.71134864 3.56379049 3.56595075 3.56961036 3.69920847 3.70606163
 4.21958645 4.77263084 4.77345788 4.77545414]
   1 (-0.000 -0.000  0.500)   [-0.39529838 -0.25733638  0.18738323  0.218127  ] [1.09804303 1.10892898 1.15168878 1.39901685 1.68518999 1.81228817
 1.846274   1.85198685 2.1194256  2.12557757 3.00652832 3.12448297
 3.12536762 3.13930284 3.14165312 3.32173253 3.66775787 3.66846606
 3.80045205 3.80656141 5.18536046 9.82960531]
   2 ( 0.000  0.500 -0.000)   [-0.39529744 -0.25733652  0.1873846   0.21812462] [1.09803946 1.1089246  1.15169209 1.39900788 1.68519126 1.81229027
 1.84627139 1.85198968 2.11942579 2.12557532 3.00652781 3.12447761
 3.12536907 3.13930599 3.14165332 3.32173663 3.66775634 3.66847243
 3.80045133 3.80656034 5.18537464 9.82960545]
   3 ( 0.000  0.500  0.500)   [-0.25583939 -0.25170084  0.0404829   0.07086749] [0.90376678 0.9597515  1.50709216 1.51353091 1.75075041 1.76481773
 2.07010285 2.07147939 2.32347241 2.33136379 2.84380162 2.85200983
 2.8851818  2.88540681 2.98370865 2.98745776 3.73403622 3.73503099
 5.07672357 5.07933125 6.89526168 6.89713411]
    CPU time for vj and vk      2.16 sec, wall time      0.07 sec
E1 = (4.1934856327683425-7.103747639567808e-18j)  E_coul = (-2.2411524969335406+7.085917567593772e-18j)
cycle= 5 E= -10.8347960097894  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00952
    CPU time for cycle= 5      2.73 sec, wall time      0.09 sec
HOMO = 0.346409395176  LUMO = 0.903767936153
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931037  0.30039994  0.33527077  0.3464094 ] [0.98222519 0.99636003 1.01752353 1.33927431 1.80560519 1.80633956
 1.88475231 2.12078463 2.12320749 2.1265613  2.70777558 2.7105881
 2.71135191 3.56379102 3.56595139 3.56961029 3.69920928 3.70606234
 4.21958748 4.77263174 4.77345855 4.77545485]
   1 (-0.000 -0.000  0.500)   [-0.39529307 -0.25733357  0.18738429  0.21812799] [1.09804382 1.10893044 1.15168822 1.39901604 1.68519116 1.81229042
 1.84627468 1.85198812 2.11942843 2.12557787 3.00653048 3.124484
 3.12536778 3.1393044  3.14165422 3.32173248 3.66775776 3.66846705
 3.80045209 3.80656186 5.18536227 9.82961309]
   2 ( 0.000  0.500 -0.000)   [-0.39529213 -0.25733371  0.18738566  0.21812561] [1.09804025 1.10892606 1.15169153 1.39900707 1.68519243 1.81229252
 1.84627206 1.85199095 2.11942862 2.12557561 3.00652997 3.12447863
 3.12536923 3.13930755 3.14165442 3.32173659 3.66775623 3.66847342
 3.80045137 3.80656079 5.18537645 9.82961322]
   3 ( 0.000  0.500  0.500)   [-0.25583582 -0.25169971  0.04048431  0.07087169] [0.90376794 0.95975107 1.50709374 1.51353562 1.75075076 1.76481663
 2.07010376 2.07147963 2.32347208 2.33136528 2.84380292 2.85201054
 2.88518086 2.88540818 2.98370924 2.98745934 3.73403595 3.73503338
 5.07672484 5.07933228 6.89526404 6.89713939]
    CPU time for vj and vk      2.17 sec, wall time      0.07 sec
E1 = (4.193486210256027-7.104445728306015e-18j)  E_coul = (-2.241153075300796+7.090197219137362e-18j)
Extra cycle  E= -10.834796010669  delta_E= -8.8e-10  |g|= 2.68e-05  |ddm|= 0.00139
    CPU time for scf_cycle     20.32 sec, wall time      0.67 sec
    CPU time for SCF     22.40 sec, wall time      0.74 sec
converged SCF energy = -10.834796010669
**** SCF Summaries ****
Total Energy =                         -10.834796010669010
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193486210256027
Two-electron Energy =                   -2.241153075300796
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89509
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01164
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01166
pop of  1 C 2pz           1.01164
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      1.27 sec, wall time      0.04 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 414 MB)
    CPU time for KMP2      3.43 sec, wall time      0.11 sec
E(KMP2) = -11.0642885793201  E_corr = -0.229492568651092
E(SCS-KMP2) = -11.0587984139925  E_corr = -0.224002403323441
E_corr(same-spin) = -0.0592946296821571
E_corr(oppo-spin) = -0.170197938968935
End time = Tue Jun  3 10:57:49 PM PDT 2025
