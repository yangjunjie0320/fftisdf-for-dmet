SLURMD_NODENAME = hpc-54-38
Start time = Tue Jun  3 10:57:44 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-30/49986237/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-30/49986237/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/50/30/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-30
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-30
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 30.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 30.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =  30.00, nao = 26, nip = 780
Parent grid size = 4913, selected grid size = 780
truncated values = 6.72e+01, estimated error = 3.69e-02
Number of interpolating points is 780.
    CPU time for building inpv_kpt      8.28 sec, wall time      1.69 sec

Out-core version is used for eta_kpt.
disk space required: 2.45e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   2.45e-01 GB
memory needed for each k-point: 6.13e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]     10.46 sec, wall time      0.39 sec
    CPU time for building eta_kpt     11.37 sec, wall time      0.42 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      9.97 sec, wall time      0.96 sec
    CPU time for coul_kpt[ 2 / 4]      9.01 sec, wall time      0.96 sec
    CPU time for coul_kpt[ 3 / 4]      9.02 sec, wall time      0.95 sec
    CPU time for coul_kpt[ 4 / 4]      9.08 sec, wall time      0.97 sec
    CPU time for building coul_kpt     38.24 sec, wall time      3.88 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-30/49986237/e2yelmwv


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-50-30/49986237/tmpl4_k34g_
max_memory 327680 MB (current use 403 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f9108ac6770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.44 sec, wall time      0.11 sec
E1 = (3.6045120653301033+4.538206487447277e-19j)  E_coul = (-4.2381510139535745+2.2082390989768886e-17j)
init E= -13.4207680942477
    CPU time for initialize scf      5.35 sec, wall time      0.18 sec
HOMO = 0.642142555973  LUMO = 0.776528727961
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422289  0.60527246  0.60922792  0.64214256] [0.85981219 0.88582322 0.91019583 1.12520795 1.7910034  1.80523333
 1.8620708  2.08341807 2.0874806  2.09923897 2.64579576 2.64765169
 2.64892993 3.55319425 3.5539215  3.55480538 3.65950812 3.66029214
 4.21017568 4.7349523  4.7354215  4.73596615]
   1 (-0.000 -0.000  0.500)   [-0.7801505  -0.50848255  0.46132922  0.50284459] [0.94786243 1.02143013 1.04032069 1.35354441 1.62942488 1.75601283
 1.81456579 1.82407384 2.1126014  2.11925325 2.95658622 3.06754257
 3.06860566 3.10243003 3.10320169 3.30379756 3.64927499 3.65340539
 3.76724172 3.76775298 5.13924755 9.65011676]
   2 ( 0.000  0.500 -0.000)   [-0.78015046 -0.50848257  0.46132925  0.50284458] [0.94786256 1.02143019 1.04032066 1.3535437  1.6294248  1.75601365
 1.81456562 1.82407352 2.11260138 2.11925311 2.95658701 3.06754285
 3.06860522 3.10243022 3.10320106 3.30379717 3.64927292 3.65340433
 3.76724235 3.76775163 5.13924628 9.65011676]
   3 ( 0.000  0.500  0.500)   [-0.41689243 -0.40450048  0.22475858  0.3106316 ] [0.77652873 0.84136879 1.40153345 1.40348257 1.6777945  1.68165505
 2.07043194 2.07585885 2.3122562  2.31465188 2.79346743 2.80078512
 2.87065874 2.87949553 2.95490264 2.95598354 3.67413346 3.67560875
 5.04760152 5.04820987 6.80918631 6.81464398]
    CPU time for vj and vk      3.55 sec, wall time      0.11 sec
E1 = (4.198007465600016+1.6044026309598466e-18j)  E_coul = (-2.232604481627951+1.394402052458427e-17j)
cycle= 1 E= -10.8217261616522  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      4.00 sec, wall time      0.13 sec
HOMO = 0.352247023507  LUMO = 0.898272309144
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169337  0.30155907  0.34067713  0.35224702] [0.97853093 0.99133329 1.01471718 1.3323248  1.80554189 1.80602146
 1.8840635  2.11998724 2.12202453 2.12538787 2.7080581  2.71165847
 2.71194211 3.56352807 3.56540983 3.56997745 3.69759047 3.70486855
 4.22165202 4.77132048 4.77265011 4.7747335 ]
   1 (-0.000 -0.000  0.500)   [-0.39621618 -0.25657557  0.18712389  0.22273232] [1.0929349  1.1050007  1.15031162 1.39709813 1.68429995 1.81150037
 1.8470881  1.85165201 2.11920442 2.12573884 3.00549529 3.12357406
 3.12502191 3.13811556 3.14098901 3.32109649 3.66804176 3.66810371
 3.79985675 3.80638391 5.18621207 9.83367319]
   2 ( 0.000  0.500 -0.000)   [-0.39621619 -0.25657555  0.18712385  0.22273233] [1.09293494 1.10500092 1.15031179 1.39709746 1.68429988 1.81150177
 1.84708659 1.85165003 2.11920442 2.12573866 3.00549589 3.12357304
 3.12501984 3.13811481 3.14098833 3.3210961  3.66803839 3.66810246
 3.79985614 3.8063816  5.18621092 9.83367459]
   3 ( 0.000  0.500  0.500)   [-0.25545532 -0.25122948  0.0395619   0.07509169] [0.89827231 0.959002   1.50273041 1.50995612 1.74943948 1.76463966
 2.07049158 2.07210201 2.32316402 2.33068261 2.84347569 2.85141782
 2.8850807  2.88514471 2.98374258 2.98719553 3.73224382 3.73350586
 5.07640694 5.07994383 6.89798217 6.89909804]
    CPU time for vj and vk      3.49 sec, wall time      0.11 sec
E1 = (4.194199737501017+3.20511337390011e-18j)  E_coul = (-2.2412695094916173+1.424937704913631e-17j)
cycle= 2 E= -10.8341989176148  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      4.05 sec, wall time      0.13 sec
HOMO = 0.346104422185  LUMO = 0.903474763998
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976053  0.30008178  0.33519334  0.34610442] [0.98176894 0.99581235 1.01711217 1.33875203 1.80541287 1.80618404
 1.88487402 2.12064997 2.12313361 2.12642299 2.70743648 2.71029124
 2.71096105 3.56369935 3.56581913 3.56959341 3.69892225 3.70582102
 4.21953665 4.77235927 4.77325842 4.77523371]
   1 (-0.000 -0.000  0.500)   [-0.39588021 -0.25760943  0.18696873  0.21794527] [1.09766679 1.10849558 1.15152499 1.39893987 1.68507838 1.81195339
 1.84609116 1.85178618 2.11922501 2.12552698 3.00621411 3.12425505
 3.1252371  3.13885659 3.14124514 3.32162828 3.66769469 3.66834785
 3.8002566  3.80639196 5.18509395 9.82853607]
   2 ( 0.000  0.500 -0.000)   [-0.39588022 -0.25760943  0.18696867  0.2179453 ] [1.09766683 1.1084958  1.15152512 1.39893931 1.68507835 1.81195469
 1.84608959 1.85178429 2.11922501 2.12552677 3.00621461 3.12425393
 3.12523507 3.13885607 3.14124436 3.32162798 3.66769284 3.66834494
 3.80025597 3.80638968 5.18509266 9.82853866]
   3 ( 0.000  0.500  0.500)   [-0.25627595 -0.25205205  0.04011606  0.07062999] [0.90347476 0.95976874 1.50636943 1.5127845  1.75053106 1.76460624
 2.07003492 2.07148037 2.32338748 2.33115227 2.84349358 2.85176188
 2.88518062 2.88526956 2.98353772 2.98724399 3.73376589 3.7346044
 5.07649103 5.07920867 6.89483076 6.89651052]
    CPU time for vj and vk      3.49 sec, wall time      0.11 sec
E1 = (4.193434796331507+3.551332766115112e-18j)  E_coul = (-2.2410985147849054+1.4330006039905216e-17j)
cycle= 3 E= -10.8347928640776  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      4.06 sec, wall time      0.13 sec
HOMO = 0.34644597873  LUMO = 0.903779100685
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926028  0.30045578  0.33534752  0.34644598] [0.98225005 0.99639177 1.01755872 1.33932586 1.80561606 1.80636121
 1.88474267 2.12079909 2.12322905 2.12657228 2.70782717 2.71063942
 2.71139765 3.56380408 3.56596063 3.56962953 3.69923703 3.70609239
 4.21959018 4.7726354  4.77350526 4.77546713]
   1 (-0.000 -0.000  0.500)   [-0.39527633 -0.25726867  0.18743289  0.21819158] [1.09808209 1.10895711 1.15171629 1.39901191 1.68521882 1.81232649
 1.84630781 1.85202232 2.11943242 2.12560204 3.00655885 3.12449468
 3.12538535 3.13936238 3.14170339 3.32174437 3.66777987 3.66848685
 3.80048421 3.80659932 5.18540763 9.82978436]
   2 ( 0.000  0.500 -0.000)   [-0.39527634 -0.25726866  0.18743283  0.21819161] [1.09808212 1.10895733 1.15171642 1.39901134 1.68521878 1.8123278
 1.84630625 1.85202044 2.11943243 2.12560183 3.00655936 3.12449355
 3.12538333 3.13936185 3.14170264 3.32174405 3.66777801 3.66848394
 3.8004836  3.80659707 5.18540635 9.82978709]
   3 ( 0.000  0.500  0.500)   [-0.25578266 -0.25164312  0.0405365   0.07090441] [0.9037791  0.95976274 1.50714681 1.51356324 1.75081794 1.76487753
 2.07011998 2.07149102 2.32349641 2.33138714 2.84383935 2.85205295
 2.88519193 2.88541459 2.98373766 2.98746985 3.73407809 3.73506526
 5.07673386 5.07939113 6.89535333 6.89720371]
    CPU time for vj and vk      3.49 sec, wall time      0.11 sec
E1 = (4.193463925806396+3.5705230461336126e-18j)  E_coul = (-2.2411303310598862+1.4336355129320352e-17j)
cycle= 4 E= -10.8347955508777  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      4.04 sec, wall time      0.13 sec
HOMO = 0.346402037725  LUMO = 0.903765893067
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931343  0.30039841  0.33527123  0.34640204] [0.98222631 0.99635813 1.01752279 1.33927066 1.80560379 1.8063383
 1.88475637 2.12078936 2.12320778 2.12655944 2.70777104 2.71058138
 2.71135041 3.56379198 3.56594976 3.56961141 3.69920791 3.70606223
 4.21957338 4.77261097 4.7734765  4.77543792]
   1 (-0.000 -0.000  0.500)   [-0.39529729 -0.25733739  0.18738424  0.21812623] [1.09804008 1.10892811 1.1516921  1.39901736 1.68518966 1.81228627
 1.84626422 1.85198531 2.11942527 2.12557748 3.00652724 3.12448274
 3.12536806 3.13931063 3.14164844 3.32173655 3.66776052 3.66847769
 3.80045142 3.80656619 5.18536931 9.8296091 ]
   2 ( 0.000  0.500 -0.000)   [-0.3952973  -0.25733738  0.18738418  0.21812626] [1.09804012 1.10892833 1.15169223 1.39901679 1.68518962 1.81228757
 1.84626266 1.85198344 2.11942528 2.12557728 3.00652775 3.12448161
 3.12536604 3.1393101  3.14164769 3.32173623 3.66775866 3.66847477
 3.8004508  3.80656395 5.18536803 9.82961182]
   3 ( 0.000  0.500  0.500)   [-0.25584095 -0.25169916  0.04048491  0.07086687] [0.90376589 0.95975426 1.50709524 1.51353115 1.75075105 1.76481656
 2.07010404 2.07147912 2.32347341 2.33136411 2.84379841 2.85200901
 2.88518261 2.88541121 2.98370596 2.98745096 3.73403596 3.73502753
 5.07671053 5.07936225 6.8952613  6.89712649]
    CPU time for vj and vk      3.51 sec, wall time      0.11 sec
E1 = (4.193485428965091+3.57160716972394e-18j)  E_coul = (-2.2411518803764263+1.433227561671091e-17j)
cycle= 5 E= -10.8347955970356  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      4.05 sec, wall time      0.13 sec
HOMO = 0.34640902664  LUMO = 0.903767050313
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931066  0.30039933  0.33527176  0.34640903] [0.98222774 0.99635965 1.01752356 1.33927233 1.80560444 1.80633901
 1.88475533 2.12078901 2.12320709 2.12656016 2.70777223 2.71058291
 2.71135369 3.5637925  3.5659504  3.56961134 3.69920872 3.70606293
 4.21957441 4.77261186 4.77347717 4.77543863]
   1 (-0.000 -0.000  0.500)   [-0.39529198 -0.25733458  0.1873853   0.21812722] [1.09804087 1.10892957 1.15169154 1.39901655 1.68519082 1.81228852
 1.8462649  1.85198658 2.1194281  2.12557778 3.0065294  3.12448376
 3.12536822 3.13931219 3.14164954 3.3217365  3.66776042 3.66847868
 3.80045146 3.80656664 5.18537113 9.82961687]
   2 ( 0.000  0.500 -0.000)   [-0.39529199 -0.25733458  0.18738524  0.21812725] [1.09804091 1.10892979 1.15169167 1.39901598 1.68519079 1.81228982
 1.84626334 1.85198471 2.11942811 2.12557757 3.00652991 3.12448263
 3.1253662  3.13931166 3.14164879 3.32173619 3.66775855 3.66847577
 3.80045084 3.8065644  5.18536984 9.82961959]
   3 ( 0.000  0.500  0.500)   [-0.25583738 -0.25169803  0.04048632  0.07087107] [0.90376705 0.95975383 1.50709683 1.51353585 1.75075141 1.76481546
 2.07010494 2.07147937 2.32347308 2.3313656  2.84379971 2.85200972
 2.88518167 2.88541258 2.98370654 2.98745254 3.73403569 3.73502993
 5.0767118  5.07936328 6.89526365 6.89713178]
    CPU time for vj and vk      3.49 sec, wall time      0.11 sec
E1 = (4.193486005971216+3.571124768330457e-18j)  E_coul = (-2.241152458262121+1.4332455399247168e-17j)
Extra cycle  E= -10.8347955979151  delta_E= -8.8e-10  |g|= 2.68e-05  |ddm|= 0.00139
    CPU time for scf_cycle     29.57 sec, wall time      0.95 sec
    CPU time for SCF     31.60 sec, wall time      1.02 sec
converged SCF energy = -10.8347955979151
**** SCF Summaries ****
Total Energy =                         -10.834795597915146
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193486005971216
Two-electron Energy =                   -2.241152458262121
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89509
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01164
pop of  0 C 2pz           1.01164
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89509
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =     -0.00000
    CPU time for vj and vk      2.57 sec, wall time      0.08 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 444 MB)
    CPU time for KMP2      4.08 sec, wall time      0.13 sec
E(KMP2) = -11.0642904506683  E_corr = -0.229494852753144
E(SCS-KMP2) = -11.0587999118964  E_corr = -0.224004313981227
E_corr(same-spin) = -0.0592955876798598
E_corr(oppo-spin) = -0.170199265073284
End time = Tue Jun  3 10:57:52 PM PDT 2025
