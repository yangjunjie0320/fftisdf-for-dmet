SLURMD_NODENAME = hpc-35-03
Start time = Tue Jun  3 04:49:26 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-150-30/49984423/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-2-2-gth-dzvp-fftisdf-150-30/49984423/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-2-2/gth-dzvp/fftisdf/150/30/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-150-30
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-30
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 30.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 30.0
wrap_around = False

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2303, c0 =  30.00, nao = 26, nip = 780
Parent grid size = 24389, selected grid size = 780
truncated values = 6.97e+01, estimated error = 5.04e-02
Number of interpolating points is 780.
    CPU time for building inpv_kpt     43.47 sec, wall time     35.91 sec

Out-core version is used for eta_kpt.
disk space required: 1.22e+00 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   1.22e+00 GB
memory needed for each k-point: 3.04e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     21.78 sec, wall time      1.79 sec
    CPU time for building eta_kpt     24.80 sec, wall time      1.88 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     22.06 sec, wall time      2.32 sec
    CPU time for coul_kpt[ 2 / 4]     17.11 sec, wall time      2.31 sec
    CPU time for coul_kpt[ 3 / 4]     17.03 sec, wall time      2.31 sec
    CPU time for coul_kpt[ 4 / 4]     17.00 sec, wall time      2.30 sec
    CPU time for building coul_kpt     74.41 sec, wall time      9.28 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-150-30/49984423/qihwtotq


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-2-2-gth-dzvp-fftisdf-150-30/49984423/tmpc9ozjn9b
max_memory 327680 MB (current use 404 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fe494f3e770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      6.49 sec, wall time      0.21 sec
E1 = (3.6045119533033367+4.538206364976298e-19j)  E_coul = (-4.238151368919007+2.340287205767157e-17j)
init E= -13.4207685612399
    CPU time for initialize scf     11.47 sec, wall time      0.37 sec
HOMO = 0.642148640632  LUMO = 0.776527956606
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422404  0.60527267  0.60923104  0.64214864] [0.8598124  0.88582633 0.91020196 1.12520273 1.79100342 1.80523335
 1.86205234 2.08341768 2.08748602 2.09925087 2.64579641 2.64766479
 2.64895272 3.55319807 3.55392357 3.5548031  3.65950818 3.66029216
 4.21012038 4.73494689 4.73542016 4.73595976]
   1 (-0.000 -0.000  0.500)   [-0.78015258 -0.50848296  0.46133114  0.50284986] [0.94785933 1.02143223 1.04032667 1.35354531 1.62942686 1.75601349
 1.814569   1.82408275 2.11260155 2.11925387 2.9565856  3.06755025
 3.06862836 3.10243191 3.10320771 3.30379487 3.64927263 3.65340549
 3.76724367 3.76776241 5.13917474 9.64995878]
   2 ( 0.000  0.500 -0.000)   [-0.78015258 -0.50848295  0.46133107  0.5028499 ] [0.9478592  1.0214321  1.0403267  1.35354532 1.6294269  1.75601342
 1.81456977 1.82408297 2.11260167 2.1192539  2.95658566 3.06754976
 3.06862867 3.10243239 3.10320829 3.30379468 3.64927292 3.653404
 3.76724406 3.76776343 5.1391759  9.64996009]
   3 ( 0.000  0.500  0.500)   [-0.41689396 -0.40450192  0.22475877  0.31063582] [0.77652796 0.84136807 1.40153392 1.40349583 1.67780156 1.68166185
 2.07043209 2.07586522 2.31225619 2.31465187 2.79346789 2.80079978
 2.87065802 2.87949542 2.95490345 2.9559953  3.67413144 3.6756057
 5.04762781 5.04820551 6.80908966 6.81454305]
    CPU time for vj and vk      6.54 sec, wall time      0.21 sec
E1 = (4.198021745119157-4.711837143644256e-18j)  E_coul = (-2.232609284445844+1.470011372078727e-17j)
cycle= 1 E= -10.8217166849509  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      7.08 sec, wall time      0.22 sec
HOMO = 0.352246206239  LUMO = 0.898271205716
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169532  0.30156442  0.34067958  0.35224621] [0.97853061 0.99133811 1.01471962 1.33231893 1.80554184 1.80602104
 1.88404509 2.11998639 2.12203049 2.12540007 2.70808262 2.71167125
 2.71194142 3.56353307 3.56540953 3.5699801  3.69759012 3.70486835
 4.22159809 4.7713084  4.77264282 4.77473374]
   1 (-0.000 -0.000  0.500)   [-0.39621895 -0.25657633  0.18712846  0.2227336 ] [1.0929326  1.10500506 1.15031182 1.39709809 1.68430094 1.81150158
 1.84709026 1.85166016 2.11920459 2.12573944 3.00549352 3.12357432
 3.12502766 3.13812106 3.14101171 3.32109435 3.66803992 3.66810018
 3.79985782 3.80639344 5.18613234 9.83350549]
   2 ( 0.000  0.500 -0.000)   [-0.39621889 -0.25657624  0.18712853  0.22273349] [1.09293259 1.10500505 1.15031139 1.39709839 1.6843009  1.81150154
 1.84709207 1.85166    2.11920498 2.12573915 3.00549455 3.12357528
 3.12502666 3.13812222 3.14101092 3.32109366 3.66803789 3.66809997
 3.79986013 3.80639198 5.1861359  9.83351154]
   3 ( 0.000  0.500  0.500)   [-0.25545713 -0.25123129  0.03956558  0.07509126] [0.89827121 0.95900114 1.50274219 1.5099551  1.74944571 1.76464551
 2.07049136 2.07210868 2.32316365 2.33068231 2.84347553 2.85143222
 2.88508002 2.88514456 2.98375431 2.98719621 3.73224164 3.73350256
 5.07642114 5.0799128  6.89788278 6.89899713]
    CPU time for vj and vk      6.55 sec, wall time      0.21 sec
E1 = (4.194213098083693-1.1351836690946197e-18j)  E_coul = (-2.241273357585251+1.5605370151308068e-17j)
cycle= 2 E= -10.8341894051258  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      7.14 sec, wall time      0.23 sec
HOMO = 0.346103758535  LUMO = 0.903473725305
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976245  0.3000873   0.33519603  0.34610376] [0.98176877 0.99581732 1.01711484 1.33874626 1.80541291 1.80618371
 1.88485559 2.12064925 2.12313958 2.12643537 2.70746136 2.71030413
 2.71096063 3.56370426 3.5658186  3.5695964  3.69892204 3.70582099
 4.21948214 4.77234702 4.77325139 4.77523503]
   1 (-0.000 -0.000  0.500)   [-0.39588296 -0.25761003  0.18697346  0.21794677] [1.0976646  1.10850003 1.15152528 1.39893998 1.68507956 1.81195483
 1.84609335 1.85179457 2.11922529 2.12552766 3.00621246 3.12425525
 3.12524292 3.13886249 3.14126798 3.32162635 3.66769003 3.66834617
 3.80025784 3.80640153 5.18501509 9.82836996]
   2 ( 0.000  0.500 -0.000)   [-0.3958829  -0.25760996  0.18697354  0.21794669] [1.09766459 1.10849999 1.15152485 1.39894024 1.68507947 1.81195462
 1.8460952  1.85179445 2.11922566 2.12552737 3.00621337 3.12425637
 3.12524193 3.13886364 3.14126719 3.32162552 3.66769026 3.66834431
 3.8002602  3.80639987 5.18501825 9.82837595]
   3 ( 0.000  0.500  0.500)   [-0.25627764 -0.25205371  0.0401199   0.0706297 ] [0.90347373 0.95976791 1.50638144 1.51278375 1.75053757 1.76461234
 2.07003482 2.07148716 2.32338718 2.33115209 2.84349356 2.8517765
 2.88517999 2.88526946 2.98354972 2.98724481 3.73376392 3.73460117
 5.07650727 5.0791792  6.8947312  6.89641067]
    CPU time for vj and vk      6.53 sec, wall time      0.21 sec
E1 = (4.193448087957122-6.06958898397116e-19j)  E_coul = (-2.241102291943395+1.5926604700260077e-17j)
cycle= 3 E= -10.8347833496105  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      7.27 sec, wall time      0.23 sec
HOMO = 0.346445282604  LUMO = 0.903778060846
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926221  0.30046127  0.3353502   0.34644528] [0.98224986 0.99639671 1.01756138 1.33932005 1.80561609 1.80636088
 1.88472424 2.12079837 2.123235   2.12658467 2.707852   2.71065229
 2.7113972  3.56380894 3.56596012 3.56963251 3.69923682 3.70609235
 4.21953564 4.7726231  4.77349832 4.77546833]
   1 (-0.000 -0.000  0.500)   [-0.3952791  -0.25726928  0.1874376   0.21819306] [1.09807987 1.10896154 1.15171657 1.39901202 1.68521998 1.81232791
 1.84630999 1.8520307  2.11943269 2.12560271 3.00655718 3.12449487
 3.12539116 3.13936825 3.14172622 3.32174241 3.66777523 3.66848518
 3.80048548 3.80660891 5.18532877 9.82961819]
   2 ( 0.000  0.500 -0.000)   [-0.39527905 -0.2572692   0.18743768  0.21819299] [1.09807986 1.10896149 1.15171613 1.39901227 1.68521989 1.81232772
 1.84631185 1.85203058 2.11943306 2.12560243 3.0065581  3.12449598
 3.12539018 3.13936939 3.14172543 3.3217416  3.66777545 3.66848331
 3.8004878  3.80660726 5.1853319  9.82962419]
   3 ( 0.000  0.500  0.500)   [-0.25578436 -0.2516448   0.04054033  0.0709041 ] [0.90377806 0.95976191 1.50715879 1.51356245 1.75082443 1.76488361
 2.07011987 2.07149781 2.3234961  2.33138694 2.84383931 2.85206755
 2.88519129 2.88541448 2.98374965 2.98747066 3.7340761  3.73506203
 5.07674996 5.07936158 6.89525374 6.89710376]
    CPU time for vj and vk      6.63 sec, wall time      0.21 sec
E1 = (4.193477212321113-5.847060610367806e-19j)  E_coul = (-2.2411341030125094+1.59470220898209e-17j)
cycle= 4 E= -10.8347860363156  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      7.28 sec, wall time      0.23 sec
HOMO = 0.346401340055  LUMO = 0.903764854859
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931536  0.30040391  0.33527391  0.34640134] [0.98222612 0.99636308 1.01752546 1.33926485 1.80560383 1.80633797
 1.88473794 2.12078863 2.12321373 2.12657182 2.70779588 2.71059425
 2.71134996 3.56379684 3.56594926 3.5696144  3.6992077  3.7060622
 4.21951883 4.77259867 4.77346956 4.77543911]
   1 (-0.000 -0.000  0.500)   [-0.39530007 -0.25733799  0.18738896  0.21812771] [1.09803786 1.10893254 1.15169238 1.39901746 1.68519082 1.81228769
 1.8462664  1.8519937  2.11942554 2.12557815 3.00652557 3.12448293
 3.12537387 3.1393165  3.14167128 3.32173459 3.66775588 3.66847601
 3.80045268 3.80657579 5.18529046 9.82944293]
   2 ( 0.000  0.500 -0.000)   [-0.39530002 -0.25733791  0.18738904  0.21812764] [1.09803785 1.10893249 1.15169195 1.39901772 1.68519073 1.81228749
 1.84626826 1.85199358 2.11942591 2.12557788 3.00652649 3.12448405
 3.12537288 3.13931764 3.14167049 3.32173378 3.66775611 3.66847414
 3.80045501 3.80657414 5.18529359 9.82944893]
   3 ( 0.000  0.500  0.500)   [-0.25584266 -0.25170084  0.04048873  0.07086657] [0.90376485 0.95975343 1.50710722 1.51353036 1.75075756 1.76482265
 2.07010392 2.07148591 2.3234731  2.33136392 2.84379837 2.85202362
 2.88518197 2.8854111  2.98371795 2.98745177 3.73403396 3.7350243
 5.07672662 5.07933272 6.89516166 6.89702658]
    CPU time for vj and vk      6.57 sec, wall time      0.21 sec
E1 = (4.193498712655162-5.814208886368658e-19j)  E_coul = (-2.2411556494993765+1.5948484492434997e-17j)
cycle= 5 E= -10.8347860824685  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      7.19 sec, wall time      0.23 sec
HOMO = 0.346408329091  LUMO = 0.903766012539
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931259  0.30040483  0.33527444  0.34640833] [0.98222755 0.9963646  1.01752624 1.33926652 1.80560448 1.80633868
 1.88473689 2.12078829 2.12321304 2.12657255 2.70779707 2.71059578
 2.71135323 3.56379736 3.5659499  3.56961433 3.69920851 3.7060629
 4.21951986 4.77259957 4.77347023 4.77543983]
   1 (-0.000 -0.000  0.500)   [-0.39529475 -0.25733519  0.18739002  0.2181287 ] [1.09803865 1.108934   1.15169182 1.39901665 1.68519198 1.81228993
 1.84626708 1.85199497 2.11942837 2.12557845 3.00652773 3.12448396
 3.12537403 3.13931806 3.14167238 3.32173455 3.66775577 3.668477
 3.80045272 3.80657624 5.18529227 9.82945071]
   2 ( 0.000  0.500 -0.000)   [-0.3952947  -0.25733511  0.1873901   0.21812863] [1.09803864 1.10893395 1.15169139 1.39901691 1.6851919  1.81228974
 1.84626894 1.85199485 2.11942874 2.12557818 3.00652865 3.12448507
 3.12537304 3.1393192  3.14167159 3.32173374 3.667756   3.66847513
 3.80045505 3.80657459 5.1852954  9.82945671]
   3 ( 0.000  0.500  0.500)   [-0.25583908 -0.2516997   0.04049015  0.07087076] [0.90376601 0.959753   1.50710881 1.51353506 1.75075791 1.76482155
 2.07010483 2.07148615 2.32347277 2.3313654  2.84379967 2.85202433
 2.88518103 2.88541247 2.98371853 2.98745335 3.73403369 3.73502669
 5.07672789 5.07933375 6.89516403 6.89703186]
    CPU time for vj and vk      6.58 sec, wall time      0.21 sec
E1 = (4.193499289118317-5.819467173419186e-19j)  E_coul = (-2.241156226841733+1.5948549829234428e-17j)
Extra cycle  E= -10.8347860833477  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     54.53 sec, wall time      1.73 sec
    CPU time for SCF     56.56 sec, wall time      1.80 sec
converged SCF energy = -10.8347860833477
**** SCF Summaries ****
Total Energy =                         -10.834786083347655
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193499289118317
Two-electron Energy =                   -2.241156226841733
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      2.51 sec, wall time      0.08 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 4
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 447 MB)
    CPU time for KMP2      4.98 sec, wall time      0.16 sec
E(KMP2) = -11.0642804031579  E_corr = -0.229494319810221
E(SCS-KMP2) = -11.0587899436987  E_corr = -0.224003860351012
E_corr(same-spin) = -0.0592953731783688
E_corr(oppo-spin) = -0.170198946631852
End time = Tue Jun  3 04:50:17 PM PDT 2025
