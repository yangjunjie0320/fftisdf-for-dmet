SLURMD_NODENAME = hpc-35-07
Start time = Tue Jun  3 10:55:12 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-30/49986201/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-30/49986201/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/100/30/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-100-30
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-30
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 30.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 30.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1194, c0 =  30.00, nao = 26, nip = 780
Parent grid size = 12167, selected grid size = 780
truncated values = 3.95e+01, estimated error = 8.61e-04
Number of interpolating points is 780.
    CPU time for building inpv_kpt     13.31 sec, wall time      6.59 sec

Out-core version is used for eta_kpt.
disk space required: 3.04e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   3.04e-01 GB
memory needed for each k-point: 1.52e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     11.18 sec, wall time      0.46 sec
    CPU time for building eta_kpt     12.83 sec, wall time      0.51 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     14.34 sec, wall time      1.42 sec
    CPU time for coul_kpt[ 2 / 2]     11.78 sec, wall time      1.42 sec
    CPU time for building coul_kpt     26.73 sec, wall time      2.86 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-30/49986201/nwqtt8hr


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-30/49986201/tmp0zn1zw76
max_memory 327680 MB (current use 303 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f7771962770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.13 sec, wall time      0.10 sec
E1 = (3.114871499682802+1.594579776617266e-18j)  E_coul = (-5.359728562592612+2.348040912655445e-17j)
init E= -15.0319862085341
    CPU time for initialize scf      5.70 sec, wall time      0.19 sec
HOMO = 0.634511710613  LUMO = 0.83595180208
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.9546999   0.58526375  0.6345117   0.63451171] [0.8359518  0.90520799 0.90520801 1.12045045 1.80070961 1.80070961
 1.86316011 2.07362658 2.09380953 2.09381015 2.63058546 2.63483464
 2.63483828 3.54995709 3.54995862 3.55202718 3.65113809 3.65113811
 4.20890176 4.72605222 4.72733428 4.72739044]
   1 ( 0.000  0.000  0.500)   [-0.84757875 -0.56898842  0.50108745  0.50108746] [0.96420104 1.0346405  1.03464056 1.35062514 1.61891712 1.75433629
 1.81736006 1.81736013 2.11624996 2.11625032 2.94274246 3.0530113
 3.05301474 3.09654058 3.09654117 3.29651644 3.64894031 3.6489436
 3.75827818 3.75828455 5.12903223 9.60194702]
    CPU time for vj and vk      3.05 sec, wall time      0.10 sec
E1 = (4.411736062196939+9.473975535091216e-18j)  E_coul = (-2.192543287312165+5.031774305854064e-18j)
cycle= 1 E= -10.5679363707395  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      3.50 sec, wall time      0.11 sec
HOMO = 0.365524529024  LUMO = 1.01778983904
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65437069  0.29044412  0.29044418  0.36552453] [1.01778984 1.03924273 1.03924287 1.36689203 1.82549339 1.8254934
 1.8818153  2.12847248 2.13625743 2.1362592  2.72589978 2.72590807
 2.73256825 3.56543982 3.57191518 3.57192182 3.71006061 3.71006085
 4.22689933 4.77817947 4.78312534 4.78322102]
   1 ( 0.000  0.000  0.500)   [-0.37094124 -0.25528128  0.17488665  0.1748867 ] [1.15339488 1.16989338 1.16989381 1.40381451 1.71097553 1.82289496
 1.85612118 1.85612468 2.13419295 2.1341938  3.01196404 3.13040036
 3.13040297 3.15967635 3.15968207 3.32337086 3.67518916 3.67521378
 3.81048497 3.81049894 5.20023649 9.89322568]
    CPU time for vj and vk      3.09 sec, wall time      0.10 sec
E1 = (4.435277960533882+6.283237381943702e-18j)  E_coul = (-2.2292959726739334+4.461254876579759e-18j)
cycle= 2 E= -10.5811471577643  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      3.63 sec, wall time      0.12 sec
HOMO = 0.35127401182  LUMO = 1.01859902771
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660237  0.2842915   0.28429163  0.35127401] [1.01859903 1.03825514 1.03825534 1.36488943 1.82398133 1.82398134
 1.88255976 2.12799078 2.13566287 2.13566447 2.72005434 2.72006253
 2.72507032 3.56450225 3.57065228 3.57065752 3.70812959 3.7081301
 4.22253188 4.77631148 4.78079232 4.78087643]
   1 ( 0.000  0.000  0.500)   [-0.37618574 -0.26019807  0.17066223  0.17066229] [1.15178415 1.16898193 1.16898234 1.40672285 1.70615913 1.81703669
 1.85209712 1.85210154 2.13199541 2.13199652 3.00786252 3.12927831
 3.12928202 3.15470555 3.1547104  3.32339618 3.67354363 3.67356358
 3.80806465 3.80807894 5.19445826 9.86919371]
    CPU time for vj and vk      3.11 sec, wall time      0.10 sec
E1 = (4.437488484589079+6.1781222578896535e-18j)  E_coul = (-2.2321709598424837+4.2470632212630954e-18j)
cycle= 3 E= -10.5818116208776  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      3.67 sec, wall time      0.12 sec
HOMO = 0.351518693518  LUMO = 1.01949714307
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592172  0.28499954  0.28499966  0.35151869] [1.01949714 1.03929269 1.03929288 1.36585499 1.82435315 1.82435317
 1.88248328 2.12829647 2.13594253 2.13594412 2.72084435 2.7208526
 2.72589335 3.56482407 3.57083326 3.57083861 3.70878979 3.70879028
 4.22249437 4.77689054 4.78133017 4.78141511]
   1 ( 0.000  0.000  0.500)   [-0.37571291 -0.25962655  0.17157996  0.17158   ] [1.15226907 1.16960588 1.16960631 1.40684165 1.70674765 1.81796581
 1.8526207  1.85262511 2.13235556 2.13235666 3.00861359 3.12961525
 3.12961895 3.15566369 3.15566853 3.32350393 3.67373307 3.67375293
 3.80857844 3.80859259 5.19492587 9.87131377]
    CPU time for vj and vk      3.17 sec, wall time      0.10 sec
E1 = (4.43733811273292+6.2657467502681915e-18j)  E_coul = (-2.2320292927982766+4.2169370020374936e-18j)
cycle= 4 E= -10.5818203256896  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      3.71 sec, wall time      0.12 sec
HOMO = 0.351486904943  LUMO = 1.0194978764
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593909  0.28497262  0.28497273  0.3514869 ] [1.01949788 1.03930115 1.03930134 1.36580669 1.82435492 1.82435494
 1.88249577 2.12831409 2.13594737 2.13594896 2.72083187 2.72084012
 2.72587601 3.56482667 3.57082987 3.57083525 3.70879024 3.70879073
 4.22247773 4.77689153 4.78132793 4.78141293]
   1 ( 0.000  0.000  0.500)   [-0.37571729 -0.2596484   0.17156625  0.1715663 ] [1.15223825 1.16961205 1.16961248 1.40684529 1.70673753 1.81793901
 1.85260722 1.85261163 2.1323495  2.1323506  3.00862375 3.12961312
 3.12961683 3.15566027 3.15566509 3.32351019 3.67372807 3.6737479
 3.80858012 3.80859427 5.19490905 9.87123235]
    CPU time for vj and vk      3.09 sec, wall time      0.10 sec
E1 = (4.4373298739737645+6.28108177305088e-18j)  E_coul = (-2.232021131512903+4.214471198001541e-18j)
cycle= 5 E= -10.5818204031634  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      3.62 sec, wall time      0.12 sec
HOMO = 0.351492839425  LUMO = 1.01950198946
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593733  0.28497487  0.28497498  0.35149284] [1.01950199 1.03930416 1.03930435 1.36580485 1.82435592 1.82435594
 1.88249567 2.12831257 2.13594781 2.13594939 2.72083456 2.7208428
 2.72587951 3.56482755 3.57083051 3.57083589 3.7087919  3.70879239
 4.22247819 4.77689295 4.78132939 4.78141439]
   1 ( 0.000  0.000  0.500)   [-0.37571578 -0.25964054  0.17156927  0.17156931] [1.1522361  1.1696125  1.16961293 1.40684339 1.70673832 1.81794148
 1.85260921 1.85261362 2.13235368 2.13235478 3.00862874 3.12961286
 3.12961657 3.15566187 3.1556667  3.32350903 3.67372778 3.67374761
 3.80858138 3.80859553 5.19490998 9.87123937]
    CPU time for vj and vk      3.09 sec, wall time      0.10 sec
E1 = (4.437326886353097+6.2834629975335864e-18j)  E_coul = (-2.232018144567837+4.214296746833984e-18j)
Extra cycle  E= -10.581820403839  delta_E= -6.76e-10  |g|= 1.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     27.46 sec, wall time      0.89 sec
    CPU time for SCF     29.42 sec, wall time      0.95 sec
converged SCF energy = -10.581820403839
**** SCF Summaries ****
Total Energy =                         -10.581820403838979
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437326886353097
Two-electron Energy =                   -2.232018144567837
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =     -0.00000
    CPU time for vj and vk      1.27 sec, wall time      0.04 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 515 MB)
    CPU time for KMP2      0.59 sec, wall time      0.02 sec
E(KMP2) = -10.8005941512506  E_corr = -0.218773747411595
E(SCS-KMP2) = -10.799537072302  E_corr = -0.217716668462992
E_corr(same-spin) = -0.0517059558818323
E_corr(oppo-spin) = -0.167067791529762
End time = Tue Jun  3 10:55:24 PM PDT 2025
