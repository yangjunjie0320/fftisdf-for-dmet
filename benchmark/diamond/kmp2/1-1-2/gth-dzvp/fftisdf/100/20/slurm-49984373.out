SLURMD_NODENAME = hpc-34-35
Start time = Tue Jun  3 04:43:56 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-20/49984373/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-20/49984373/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/100/20/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-100-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-20
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1194, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 12167, selected grid size = 520
truncated values = 3.95e+01, estimated error = 1.71e-02
Number of interpolating points is 520.
    CPU time for building inpv_kpt     13.76 sec, wall time      6.84 sec

Out-core version is used for eta_kpt.
disk space required: 2.02e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   2.02e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]      9.78 sec, wall time      0.32 sec
    CPU time for building eta_kpt     11.49 sec, wall time      0.37 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     11.38 sec, wall time      0.68 sec
    CPU time for coul_kpt[ 2 / 2]      9.74 sec, wall time      0.68 sec
    CPU time for building coul_kpt     21.36 sec, wall time      1.37 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-20/49984373/slq87wl7


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-100-20/49984373/tmpcl7cdyuh
max_memory 327680 MB (current use 301 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fd794496770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.62 sec, wall time      0.09 sec
E1 = (3.1148714996828017-7.972898883088343e-19j)  E_coul = (-5.359728514743978+1.601971408416679e-17j)
init E= -15.0319861606854
    CPU time for initialize scf      5.24 sec, wall time      0.18 sec
HOMO = 0.634511759197  LUMO = 0.835951949681
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469989  0.58526364  0.63451169  0.63451176] [0.83595195 0.90520775 0.90520815 1.12045112 1.8007096  1.80070962
 1.86315996 2.07362634 2.09380755 2.09380963 2.63058062 2.63483464
 2.63483796 3.5499472  3.54995323 3.55202616 3.65113814 3.65113823
 4.2088982  4.72603196 4.72733234 4.7273682 ]
   1 ( 0.000  0.000  0.500)   [-0.84757886 -0.56898846  0.50108741  0.50108751] [0.96419932 1.03464025 1.03464075 1.35062266 1.61891731 1.75433883
 1.81736011 1.81736197 2.11624947 2.11625027 2.94274317 3.0530119
 3.05301488 3.09653971 3.0965427  3.29651922 3.64893782 3.64894524
 3.75827888 3.75828361 5.1290537  9.60199746]
    CPU time for vj and vk      2.67 sec, wall time      0.09 sec
E1 = (4.411736811143114+1.1522050504070986e-17j)  E_coul = (-2.1925444710578343-9.602131575825173e-19j)
cycle= 1 E= -10.567936805539  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      3.10 sec, wall time      0.10 sec
HOMO = 0.36552428408  LUMO = 1.01779034227
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65437072  0.29044391  0.29044436  0.36552428] [1.01779034 1.03924254 1.03924283 1.36689038 1.8254932  1.82549338
 1.8818155  2.12846993 2.13625437 2.13625605 2.72590084 2.7259043
 2.73256098 3.56543961 3.57190527 3.57191369 3.71006079 3.71006096
 4.22688635 4.77815185 4.78315936 4.78320634]
   1 ( 0.000  0.000  0.500)   [-0.37094152 -0.25528162  0.17488639  0.17488657] [1.1533945  1.16989288 1.16989438 1.40380308 1.71097601 1.82290329
 1.85612291 1.85612734 2.1341925  2.13419348 3.01196399 3.13040189
 3.13040308 3.15967683 3.15968137 3.32337233 3.67520159 3.675229
 3.8104847  3.81050144 5.20021407 9.89324789]
    CPU time for vj and vk      2.65 sec, wall time      0.09 sec
E1 = (4.435277580172047+1.888651867490397e-17j)  E_coul = (-2.2292956711511698-9.191031306519105e-19j)
cycle= 2 E= -10.5811472366034  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      3.15 sec, wall time      0.10 sec
HOMO = 0.35127410208  LUMO = 1.01859969205
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6566023   0.28429152  0.28429211  0.3512741 ] [1.01859969 1.03825513 1.03825545 1.36488839 1.82398119 1.82398143
 1.88255983 2.12798802 2.13565956 2.13566195 2.72005629 2.72005964
 2.72506393 3.56450202 3.57064181 3.57065108 3.70813012 3.70813031
 4.22252034 4.77628187 4.78082502 4.78086611]
   1 ( 0.000  0.000  0.500)   [-0.3761859  -0.26019828  0.17066228  0.17066248] [1.15178382 1.16898133 1.16898315 1.40671029 1.70615981 1.81704573
 1.852099   1.85210325 2.13199497 2.13199622 3.00786252 3.12928071
 3.12928203 3.15470608 3.15471107 3.32339736 3.67355069 3.67357867
 3.80806329 3.80807935 5.19443645 9.86920311]
    CPU time for vj and vk      2.70 sec, wall time      0.09 sec
E1 = (4.437487757708593+1.9417305576869437e-17j)  E_coul = (-2.2321702998571165-9.516201063335811e-19j)
cycle= 3 E= -10.5818116877728  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      3.25 sec, wall time      0.10 sec
HOMO = 0.351518784436  LUMO = 1.0194978215
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592163  0.28499955  0.28500017  0.35151878] [1.01949782 1.0392927  1.039293   1.36585395 1.82435303 1.82435325
 1.88248332 2.1282937  2.13593925 2.13594154 2.72084633 2.7208497
 2.72588685 3.56482375 3.5708229  3.570832   3.70879032 3.70879051
 4.22248278 4.77686088 4.78136276 4.78140546]
   1 ( 0.000  0.000  0.500)   [-0.37571307 -0.25962674  0.17158     0.17158023] [1.15226873 1.1696053  1.16960712 1.40682918 1.70674834 1.81797478
 1.85262255 1.85262682 2.13235511 2.13235636 3.00861357 3.12961763
 3.12961893 3.15566427 3.15566912 3.32350519 3.67374    3.67376792
 3.80857707 3.80859291 5.19490404 9.87132367]
    CPU time for vj and vk      2.64 sec, wall time      0.08 sec
E1 = (4.437337400539308+1.926989736633845e-17j)  E_coul = (-2.2320286474660365-9.612500364671285e-19j)
cycle= 4 E= -10.581820392551  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      3.14 sec, wall time      0.10 sec
HOMO = 0.351486988685  LUMO = 1.01949854567
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.655939    0.28497261  0.28497324  0.35148699] [1.01949855 1.03930115 1.03930146 1.36580565 1.8243548  1.82435502
 1.88249582 2.12831132 2.1359441  2.13594639 2.72083385 2.72083722
 2.72586951 3.56482635 3.57081954 3.57082865 3.70879076 3.70879095
 4.22246614 4.77686184 4.78136056 4.78140323]
   1 ( 0.000  0.000  0.500)   [-0.37571746 -0.25964859  0.17156629  0.17156652] [1.15223791 1.16961147 1.16961329 1.40683283 1.70673821 1.81794797
 1.85260907 1.85261334 2.13234904 2.13235029 3.00862372 3.12961551
 3.12961681 3.15566083 3.15566568 3.32351144 3.67373497 3.67376291
 3.80857875 3.80859458 5.19488721 9.87124213]
    CPU time for vj and vk      2.66 sec, wall time      0.09 sec
E1 = (4.4373291631385605+1.9242457897013812e-17j)  E_coul = (-2.2320204875385925-9.62785143526526e-19j)
cycle= 5 E= -10.5818204700243  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      3.15 sec, wall time      0.10 sec
HOMO = 0.351492924162  LUMO = 1.01950265969
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593725  0.28497486  0.28497549  0.35149292] [1.01950266 1.03930417 1.03930447 1.36580381 1.8243558  1.82435602
 1.88249572 2.1283098  2.13594453 2.13594682 2.72083653 2.7208399
 2.72587301 3.56482723 3.57082018 3.57082929 3.70879242 3.70879261
 4.22246661 4.77686327 4.78136201 4.78140468]
   1 ( 0.000  0.000  0.500)   [-0.37571595 -0.25964074  0.17156931  0.17156954] [1.15223576 1.16961192 1.16961374 1.40683093 1.70673901 1.81795044
 1.85261106 1.85261533 2.13235323 2.13235448 3.00862871 3.12961524
 3.12961655 3.15566244 3.15566729 3.32351028 3.67373469 3.67376262
 3.80858    3.80859584 5.19488813 9.87124916]
    CPU time for vj and vk      2.64 sec, wall time      0.08 sec
E1 = (4.4373261752299245+1.92409842958261e-17j)  E_coul = (-2.2320175003055986-9.628832813116279e-19j)
Extra cycle  E= -10.5818204706999  delta_E= -6.76e-10  |g|= 1.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     24.19 sec, wall time      0.79 sec
    CPU time for SCF     26.61 sec, wall time      0.87 sec
converged SCF energy = -10.5818204706999
**** SCF Summaries ****
Total Energy =                         -10.581820470699913
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437326175229924
Two-electron Energy =                   -2.232017500305599
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =     -0.00000
    CPU time for vj and vk      0.83 sec, wall time      0.03 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 510 MB)
    CPU time for KMP2      0.58 sec, wall time      0.02 sec
E(KMP2) = -10.8005936204217  E_corr = -0.218773149721834
E(SCS-KMP2) = -10.7995365634401  E_corr = -0.217716092740143
E_corr(same-spin) = -0.0517057926069895
E_corr(oppo-spin) = -0.167067357114844
End time = Tue Jun  3 04:44:07 PM PDT 2025
