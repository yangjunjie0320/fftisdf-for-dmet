SLURMD_NODENAME = hpc-35-07
Start time = Tue Jun  3 10:55:25 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-30/49986207/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-30/49986207/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/150/30/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-150-30
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-30
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 30.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 30.0
wrap_around = False

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1205, c0 =  30.00, nao = 26, nip = 780
Parent grid size = 24389, selected grid size = 780
truncated values = 4.00e+01, estimated error = 9.15e-04
Number of interpolating points is 780.
    CPU time for building inpv_kpt     32.92 sec, wall time     25.69 sec

Out-core version is used for eta_kpt.
disk space required: 6.09e-01 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   6.09e-01 GB
memory needed for each k-point: 3.04e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     16.27 sec, wall time      0.93 sec
    CPU time for building eta_kpt     19.09 sec, wall time      1.02 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     21.51 sec, wall time      2.29 sec
    CPU time for coul_kpt[ 2 / 2]     16.21 sec, wall time      2.29 sec
    CPU time for building coul_kpt     38.29 sec, wall time      4.60 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-30/49986207/2iyg3auv


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-30/49986207/tmpmo0kory_
max_memory 327680 MB (current use 296 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7ff1f29b6770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      4.67 sec, wall time      0.15 sec
E1 = (3.1148715002717724+1.5945797766170073e-18j)  E_coul = (-5.359728561791369+2.076645310111182e-17j)
init E= -15.0319862071438
    CPU time for initialize scf      8.76 sec, wall time      0.29 sec
HOMO = 0.63451172946  LUMO = 0.835951872567
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.9546999   0.58526376  0.63451172  0.63451173] [0.83595187 0.90520802 0.90520805 1.12045058 1.80070961 1.80070963
 1.86316003 2.07362724 2.09380678 2.09380789 2.63058262 2.6348355
 2.63483797 3.54994317 3.54994628 3.55202435 3.65113808 3.65113809
 4.20890169 4.72604175 4.72735494 4.72738291]
   1 ( 0.000  0.000  0.500)   [-0.84757874 -0.56898842  0.50108744  0.50108746] [0.96420062 1.03464051 1.03464068 1.35062742 1.6189172  1.75433932
 1.81735938 1.81736082 2.11624934 2.11624994 2.94274145 3.05300608
 3.05301165 3.09654052 3.09654101 3.29651898 3.64893881 3.64894562
 3.75826919 3.75827834 5.12906459 9.60198276]
    CPU time for vj and vk      4.78 sec, wall time      0.15 sec
E1 = (4.4117360957598875-1.8950828197330588e-18j)  E_coul = (-2.192543369965637+7.032478196457028e-18j)
cycle= 1 E= -10.56793641983  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      5.28 sec, wall time      0.17 sec
HOMO = 0.365524488319  LUMO = 1.01778984252
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65437072  0.29044408  0.29044419  0.36552449] [1.01778984 1.03924299 1.03924315 1.36689298 1.82549339 1.82549345
 1.88181422 2.1284719  2.13625055 2.13625527 2.7258999  2.7259137
 2.73256257 3.56543742 3.57188972 3.57190755 3.71006061 3.71006083
 4.22689521 4.77815311 4.78314682 4.7832877 ]
   1 ( 0.000  0.000  0.500)   [-0.37094122 -0.2552814   0.17488668  0.1748867 ] [1.15339541 1.16989348 1.16989425 1.40381527 1.71097584 1.82289725
 1.85612078 1.85612732 2.1341927  2.13419291 3.01196627 3.13039397
 3.13041189 3.15967275 3.15967393 3.32337694 3.6751874  3.6752312
 3.81048319 3.81048397 5.20025936 9.89321376]
    CPU time for vj and vk      4.82 sec, wall time      0.15 sec
E1 = (4.435278121090634-1.0251635561994326e-18j)  E_coul = (-2.2292962652117394+7.612253445661884e-18j)
cycle= 2 E= -10.5811472897453  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      5.34 sec, wall time      0.17 sec
HOMO = 0.351273808477  LUMO = 1.01859907287
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660244  0.28429143  0.28429155  0.35127381] [1.01859907 1.03825543 1.03825552 1.3648903  1.82398132 1.82398139
 1.88255848 2.1279899  2.13565679 2.13566126 2.72005507 2.72006826
 2.72506477 3.56449809 3.57063024 3.57064482 3.70812971 3.70812993
 4.22253424 4.77628857 4.78082242 4.78094887]
   1 ( 0.000  0.000  0.500)   [-0.37618577 -0.26019829  0.17066219  0.17066226] [1.1517848  1.16898228 1.16898282 1.40672279 1.70615955 1.81704114
 1.85209631 1.85210249 2.13199513 2.13199525 3.0078658  3.12927181
 3.12928986 3.15470261 3.15470287 3.32340329 3.6735402  3.67358031
 3.80806138 3.80806448 5.19447785 9.86917979]
    CPU time for vj and vk      4.87 sec, wall time      0.15 sec
E1 = (4.437488913709075-1.4254896874255237e-18j)  E_coul = (-2.232171530755887+7.891070412683329e-18j)
cycle= 3 E= -10.5818117626711  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      5.48 sec, wall time      0.17 sec
HOMO = 0.351518546776  LUMO = 1.01949716744
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592178  0.28499948  0.28499958  0.35151855] [1.01949717 1.03929296 1.03929306 1.36585583 1.82435315 1.82435322
 1.88248199 2.12829552 2.13593635 2.13594083 2.72084503 2.72085828
 2.72588774 3.56481974 3.57081091 3.57082564 3.7087899  3.70879012
 4.22249537 4.77686694 4.78135899 4.78148697]
   1 ( 0.000  0.000  0.500)   [-0.37571294 -0.25962674  0.17157991  0.17157996] [1.1522697  1.16960622 1.16960677 1.40684165 1.70674806 1.81797016
 1.85261993 1.85262608 2.13235528 2.13235538 3.00861681 3.12960881
 3.12962674 3.15566067 3.155661   3.32351098 3.67372964 3.67376948
 3.80857509 3.80857807 5.19494536 9.87130052]
    CPU time for vj and vk      6.22 sec, wall time      0.20 sec
E1 = (4.43733852751821-1.4669866907054283e-18j)  E_coul = (-2.23202984873343+7.934771912376301e-18j)
cycle= 4 E= -10.5818204668395  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      6.83 sec, wall time      0.22 sec
HOMO = 0.351486750122  LUMO = 1.01949789509
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593916  0.28497255  0.28497264  0.35148675] [1.0194979  1.03930142 1.03930152 1.36580752 1.82435492 1.82435499
 1.88249449 2.12831313 2.13594119 2.13594567 2.72083254 2.7208458
 2.72587039 3.56482233 3.57080754 3.57082225 3.70879034 3.70879056
 4.22247875 4.77686787 4.78135678 4.78148472]
   1 ( 0.000  0.000  0.500)   [-0.37571732 -0.2596486   0.1715662   0.17156625] [1.15223888 1.1696124  1.16961294 1.4068453  1.70673793 1.81794336
 1.85260645 1.8526126  2.13234921 2.13234931 3.00862696 3.12960669
 3.12962462 3.15565725 3.15565756 3.32351724 3.67372463 3.67376448
 3.80857677 3.80857976 5.19492848 9.87121909]
    CPU time for vj and vk      5.13 sec, wall time      0.16 sec
E1 = (4.437330290934921-1.471071302383776e-18j)  E_coul = (-2.2320216896168237+7.938515774035711e-18j)
cycle= 5 E= -10.5818205443061  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      5.77 sec, wall time      0.18 sec
HOMO = 0.351492685861  LUMO = 1.01950200868
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6559374   0.2849748   0.28497489  0.35149269] [1.01950201 1.03930443 1.03930453 1.36580568 1.82435592 1.82435599
 1.88249439 2.12831161 2.13594163 2.1359461  2.72083523 2.72084848
 2.72587389 3.56482321 3.57080818 3.57082289 3.708792   3.70879222
 4.22247921 4.7768693  4.78135823 4.78148617]
   1 ( 0.000  0.000  0.500)   [-0.37571581 -0.25964075  0.17156922  0.17156927] [1.15223673 1.16961285 1.16961339 1.4068434  1.70673873 1.81794582
 1.85260844 1.85261459 2.1323534  2.1323535  3.00863195 3.12960643
 3.12962436 3.15565885 3.15565917 3.32351608 3.67372435 3.67376419
 3.80857802 3.80858101 5.1949294  9.87122612]
    CPU time for vj and vk      5.18 sec, wall time      0.16 sec
E1 = (4.437327303034612-1.4752455976093927e-18j)  E_coul = (-2.2320187023920584+7.93873147044186e-18j)
Extra cycle  E= -10.5818205449817  delta_E= -6.76e-10  |g|= 1.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     43.22 sec, wall time      1.39 sec
    CPU time for SCF     45.28 sec, wall time      1.46 sec
converged SCF energy = -10.5818205449817
**** SCF Summaries ****
Total Energy =                         -10.581820544981685
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437327303034612
Two-electron Energy =                   -2.232018702392058
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =     -0.00000
    CPU time for vj and vk      1.59 sec, wall time      0.05 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 452 MB)
    CPU time for KMP2      0.72 sec, wall time      0.02 sec
E(KMP2) = -10.8005937331491  E_corr = -0.218773188167407
E(SCS-KMP2) = -10.799536750283  E_corr = -0.217716205301363
E_corr(same-spin) = -0.051705715960991
E_corr(oppo-spin) = -0.167067472206416
End time = Tue Jun  3 10:55:59 PM PDT 2025
