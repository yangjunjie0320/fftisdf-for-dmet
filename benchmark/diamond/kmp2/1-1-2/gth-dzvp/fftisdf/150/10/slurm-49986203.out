SLURMD_NODENAME = hpc-54-38
Start time = Tue Jun  3 10:55:17 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-10/49986203/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-10/49986203/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/150/10/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-150-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-10
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 10.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 10.0
wrap_around = False

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1205, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 24389, selected grid size = 260
truncated values = 3.95e+01, estimated error = 4.90e-01
Number of interpolating points is 260.
    CPU time for building inpv_kpt     33.12 sec, wall time     25.69 sec

Out-core version is used for eta_kpt.
disk space required: 2.03e-01 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   2.03e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]      9.91 sec, wall time      0.32 sec
    CPU time for building eta_kpt     13.00 sec, wall time      0.42 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     11.97 sec, wall time      0.42 sec
    CPU time for coul_kpt[ 2 / 2]      9.17 sec, wall time      0.39 sec
    CPU time for building coul_kpt     21.22 sec, wall time      0.81 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-10/49986203/uuz8kud6


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-10/49986203/tmpwt68brpa
max_memory 327680 MB (current use 321 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fbb32fe6770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.70 sec, wall time      0.12 sec
E1 = (3.1148715002717724+3.1891595532339945e-18j)  E_coul = (-5.359687086735874-2.3078782426708447e-17j)
init E= -15.0319447320883
    CPU time for initialize scf      7.27 sec, wall time      0.24 sec
HOMO = 0.634499497651  LUMO = 0.835917455008
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95467714  0.58527552  0.63449097  0.6344995 ] [0.83591746 0.90522385 0.90523121 1.1202526  1.80067349 1.80071467
 1.86323037 2.0740846  2.09366304 2.09377757 2.63055434 2.63482512
 2.63492739 3.54994874 3.55029549 3.55268531 3.65112337 3.65114925
 4.20856964 4.72598089 4.72720579 4.72730437]
   1 ( 0.000  0.000  0.500)   [-0.84755504 -0.56898227  0.5010603   0.50109581] [0.96410443 1.03464484 1.03466665 1.35053551 1.6188953  1.7541906
 1.81733954 1.81749468 2.11622345 2.11628879 2.94270792 3.05288635
 3.05307661 3.0965108  3.0965876  3.29653029 3.64883672 3.64906129
 3.75829918 3.75841708 5.1295196  9.60184343]
    CPU time for vj and vk      3.80 sec, wall time      0.12 sec
E1 = (4.411643475354294+1.8678958319856417e-17j)  E_coul = (-2.1925616462637914-4.5033116289122245e-17j)
cycle= 1 E= -10.5680473165337  delta_E= 4.46  |g|= 0.33  |ddm|= 8.69
    CPU time for cycle= 1      4.19 sec, wall time      0.13 sec
HOMO = 0.365502243054  LUMO = 1.01775904106
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65433154  0.2903577   0.29040384  0.36550224] [1.01775904 1.03925856 1.03930042 1.36679158 1.82547154 1.82548948
 1.88191138 2.12865091 2.13604829 2.1362382  2.72587794 2.72594542
 2.73260039 3.56567743 3.57188883 3.57242651 3.71004415 3.71011346
 4.22683996 4.77791645 4.78254344 4.78283355]
   1 ( 0.000  0.000  0.500)   [-0.37090457 -0.25527066  0.17480743  0.17489951] [1.15338543 1.16988009 1.16992084 1.40382482 1.71093797 1.82289946
 1.85600176 1.85610824 2.13403488 2.13418408 3.01188936 3.13045944
 3.13051953 3.15950315 3.15971554 3.32341276 3.67509149 3.67516282
 3.81043649 3.810904   5.20041176 9.8933022 ]
    CPU time for vj and vk      3.80 sec, wall time      0.12 sec
E1 = (4.435145218059464+2.642520473535513e-17j)  E_coul = (-2.2292754658355327-4.5196871726173793e-17j)
cycle= 2 E= -10.5812593934003  delta_E= -0.0132  |g|= 0.0652  |ddm|= 5.66
    CPU time for cycle= 2      4.28 sec, wall time      0.14 sec
HOMO = 0.351242056603  LUMO = 1.01856863979
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65655143  0.2842089   0.28426797  0.35124206] [1.01856864 1.0382699  1.03830846 1.36480847 1.82396499 1.82397966
 1.88265544 2.12821284 2.1354719  2.13565243 2.72001077 2.72008618
 2.72510225 3.56480094 3.57063117 3.57114023 3.70810937 3.70818665
 4.22250751 4.77605955 4.78023339 4.78053201]
   1 ( 0.000  0.000  0.500)   [-0.37613566 -0.26019427  0.17058521  0.17068627] [1.15179148 1.16896175 1.16901599 1.40675034 1.70613704 1.81707645
 1.85196786 1.8520647  2.13184152 2.13199012 3.00778413 3.12933629
 3.12941093 3.15453377 3.15477809 3.32343321 3.67342965 3.67351729
 3.80800493 3.80846824 5.19463888 9.86927151]
    CPU time for vj and vk      3.82 sec, wall time      0.12 sec
E1 = (4.4373679094746885+2.6800633079946655e-17j)  E_coul = (-2.2321632089220316-4.527081413909102e-17j)
cycle= 3 E= -10.5819244450716  delta_E= -0.000665  |g|= 0.00688  |ddm|= 0.995
    CPU time for cycle= 3      4.29 sec, wall time      0.14 sec
HOMO = 0.351486932123  LUMO = 1.0194655757
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65587319  0.28491242  0.28497035  0.35148693] [1.01946558 1.03930462 1.03934389 1.36577073 1.82433459 1.82434998
 1.88257867 2.12851128 2.13575098 2.1359306  2.72079578 2.72087041
 2.72592321 3.56511674 3.57081115 3.5713182  3.7087677  3.7088443
 4.22247286 4.77663685 4.780768   4.78106786]
   1 ( 0.000  0.000  0.500)   [-0.37566607 -0.25962316  0.17149975  0.17160045] [1.15227469 1.16958247 1.16963712 1.40686974 1.7067222  1.81800146
 1.85248836 1.85258421 2.13220252 2.13234948 3.00853251 3.1296726
 3.12974539 3.15549036 3.15573401 3.32353985 3.67361541 3.67370749
 3.80851656 3.80897839 5.1951053  9.87137944]
    CPU time for vj and vk      3.80 sec, wall time      0.12 sec
E1 = (4.437219713023799+2.6615559247331096e-17j)  E_coul = (-2.232023711220088-4.5285343991627336e-17j)
cycle= 4 E= -10.5819331438205  delta_E= -8.7e-06  |g|= 0.000626  |ddm|= 0.113
    CPU time for cycle= 4      4.28 sec, wall time      0.14 sec
HOMO = 0.351455417577  LUMO = 1.019466529
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65589024  0.2848859   0.28494414  0.35145542] [1.01946653 1.03931332 1.03935254 1.36572298 1.82433647 1.82435186
 1.88259101 2.12852974 2.13575585 2.13593537 2.72078356 2.72085841
 2.72590606 3.56511985 3.57080793 3.57131477 3.70876838 3.70884496
 4.22245672 4.77663825 4.78076629 4.78106633]
   1 ( 0.000  0.000  0.500)   [-0.37567022 -0.25964496  0.17148637  0.17158731] [1.1522444  1.16958871 1.16964365 1.40687359 1.70671244 1.8179749
 1.85247527 1.8525709  2.13219643 2.13234332 3.00854271 3.12967058
 3.12974346 3.15548729 3.15573114 3.32354623 3.67361036 3.67370263
 3.80851857 3.80898016 5.19508858 9.87129917]
    CPU time for vj and vk      3.81 sec, wall time      0.12 sec
E1 = (4.437211355487932+2.658711490870778e-17j)  E_coul = (-2.2320154317441263-4.528735566866718e-17j)
cycle= 5 E= -10.5819332218804  delta_E= -7.81e-08  |g|= 7.55e-05  |ddm|= 0.0175
    CPU time for cycle= 5      4.29 sec, wall time      0.14 sec
HOMO = 0.35146123943  LUMO = 1.01947059651
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65588857  0.28488802  0.28494626  0.35146124] [1.0194706  1.03931629 1.03935551 1.36572097 1.82433744 1.82435284
 1.88259096 2.12852823 2.13575629 2.13593581 2.72078615 2.72086102
 2.72590946 3.56512072 3.57080857 3.57131537 3.70877    3.70884658
 4.22245715 4.77663966 4.78076771 4.78106775]
   1 ( 0.000  0.000  0.500)   [-0.37566878 -0.25963719  0.17148927  0.17159024] [1.15224217 1.16958912 1.16964408 1.4068717  1.70671315 1.81797726
 1.85247717 1.85257281 2.13220061 2.13234747 3.00854767 3.1296703
 3.12974324 3.15548878 3.15573262 3.32354509 3.67361006 3.67370229
 3.80851977 3.80898138 5.19508943 9.87130583]
    CPU time for vj and vk      3.81 sec, wall time      0.12 sec
E1 = (4.437208380179651+2.6585357542499442e-17j)  E_coul = (-2.232012457526118-4.528799829934241e-17j)
Extra cycle  E= -10.5819332229707  delta_E= -1.09e-09  |g|= 2.87e-05  |ddm|= 0.00155
    CPU time for scf_cycle     32.88 sec, wall time      1.05 sec
    CPU time for SCF     34.92 sec, wall time      1.12 sec
converged SCF energy = -10.5819332229707
**** SCF Summaries ****
Total Energy =                         -10.581933222970706
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437208380179651
Two-electron Energy =                   -2.232012457526118
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93322
pop of  0 C 3s            0.00445
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00904
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00997
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93335
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00902
pop of  1 C 2py           1.00912
pop of  1 C 2pz           1.00911
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00997
pop of  1 C 3dyz          0.00997
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00010
charge of    1C =     -0.00010
    CPU time for vj and vk      0.42 sec, wall time      0.01 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 463 MB)
    CPU time for KMP2      0.24 sec, wall time      0.01 sec
E(KMP2) = -10.8007678006937  E_corr = -0.218834577722988
E(SCS-KMP2) = -10.7997007938923  E_corr = -0.217767570921607
E_corr(same-spin) = -0.0517314488607441
E_corr(oppo-spin) = -0.167103128862244
End time = Tue Jun  3 10:55:46 PM PDT 2025
