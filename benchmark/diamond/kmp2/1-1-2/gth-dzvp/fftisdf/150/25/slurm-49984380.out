SLURMD_NODENAME = hpc-35-03
Start time = Tue Jun  3 04:44:33 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-25/49984380/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-25/49984380/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/150/25/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-150-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-25
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 25.0
wrap_around = False

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1205, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 24389, selected grid size = 650
truncated values = 4.00e+01, estimated error = 3.95e-03
Number of interpolating points is 650.
    CPU time for building inpv_kpt     31.95 sec, wall time     24.49 sec

Out-core version is used for eta_kpt.
disk space required: 5.07e-01 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   5.07e-01 GB
memory needed for each k-point: 2.54e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     15.17 sec, wall time      0.75 sec
    CPU time for building eta_kpt     18.14 sec, wall time      0.84 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     18.94 sec, wall time      1.62 sec
    CPU time for coul_kpt[ 2 / 2]     14.57 sec, wall time      1.62 sec
    CPU time for building coul_kpt     33.91 sec, wall time      3.26 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-25/49984380/k9uzr5vk


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-150-25/49984380/tmpvosykoet
max_memory 327680 MB (current use 328 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f1b31566770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      4.40 sec, wall time      0.14 sec
E1 = (3.1148715002717715+2.1526826984329998e-17j)  E_coul = (-5.359728565567627+3.0466300142194495e-17j)
init E= -15.0319862109201
    CPU time for initialize scf      8.37 sec, wall time      0.28 sec
HOMO = 0.634511729169  LUMO = 0.835951856031
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.9546999   0.58526373  0.63451171  0.63451173] [0.83595186 0.90520798 0.90520804 1.12045033 1.80070961 1.80070962
 1.86315996 2.07362769 2.09380673 2.09380755 2.63058221 2.63483391
 2.63483764 3.54994288 3.5499479  3.55202866 3.65113807 3.65113824
 4.20889982 4.72604784 4.72735548 4.72736705]
   1 ( 0.000  0.000  0.500)   [-0.8475788  -0.56898842  0.50108743  0.50108746] [0.96420068 1.03464059 1.03464063 1.35062403 1.61891711 1.75433488
 1.81736009 1.81736047 2.1162496  2.11625013 2.94274178 3.05300923
 3.05301264 3.09654182 3.09654212 3.29651141 3.64894115 3.64894839
 3.75827338 3.75828037 5.12903393 9.60200744]
    CPU time for vj and vk      4.48 sec, wall time      0.14 sec
E1 = (4.411736299321558+1.3424505914525035e-17j)  E_coul = (-2.1925436016572983+8.849141803549688e-18j)
cycle= 1 E= -10.56793644796  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      4.88 sec, wall time      0.16 sec
HOMO = 0.365524463013  LUMO = 1.01778997652
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65437076  0.29044409  0.29044413  0.36552446] [1.01778998 1.03924278 1.03924291 1.36689157 1.8254934  1.8254934
 1.88181516 2.12847037 2.13625039 2.13625129 2.72589937 2.72590901
 2.73256521 3.5654337  3.57189194 3.57189777 3.71006064 3.71006101
 4.22690357 4.77817459 4.78315036 4.78323174]
   1 ( 0.000  0.000  0.500)   [-0.37094129 -0.25528134  0.17488661  0.17488669] [1.15339453 1.16989369 1.16989377 1.40380653 1.71097541 1.82289612
 1.85612167 1.85612492 2.13419307 2.13419371 3.01196215 3.13039821
 3.13040613 3.15967606 3.15968168 3.3233667  3.67519328 3.67522153
 3.81048687 3.8104983  5.20020789 9.89324891]
    CPU time for vj and vk      4.54 sec, wall time      0.14 sec
E1 = (4.435278231181781+1.6621430098350562e-17j)  E_coul = (-2.229296313094396+9.424275734221678e-18j)
cycle= 2 E= -10.5811472275369  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      5.02 sec, wall time      0.16 sec
HOMO = 0.35127392594  LUMO = 1.01859917324
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660246  0.28429147  0.28429155  0.35127393] [1.01859917 1.03825522 1.03825532 1.36488923 1.82398133 1.82398134
 1.88255958 2.12798891 2.13565615 2.13565704 2.72005532 2.720063
 2.72506798 3.56449803 3.57062968 3.57063305 3.70812961 3.70813002
 4.22253509 4.77630755 4.78082073 4.78089193]
   1 ( 0.000  0.000  0.500)   [-0.37618581 -0.26019816  0.17066216  0.17066228] [1.15178373 1.16898216 1.16898238 1.40671452 1.70615893 1.81703907
 1.85209752 1.85210034 2.13199574 2.13199619 3.00786073 3.12927566
 3.1292827  3.15470592 3.15471047 3.32339129 3.6735442  3.67356634
 3.8080658  3.8080758  5.19443339 9.86921408]
    CPU time for vj and vk      4.48 sec, wall time      0.14 sec
E1 = (4.437488821878441+1.639732968579177e-17j)  E_coul = (-2.2321713698881567+9.378624395029757e-18j)
cycle= 3 E= -10.581811693634  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      4.97 sec, wall time      0.16 sec
HOMO = 0.351518638286  LUMO = 1.01949727798
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592181  0.28499951  0.28499959  0.35151864] [1.01949728 1.03929277 1.03929287 1.36585476 1.82435316 1.82435317
 1.88248309 2.12829458 2.13593577 2.1359366  2.7208453  2.72085307
 2.72589092 3.56481964 3.57081061 3.57081414 3.70878981 3.70879023
 4.22249755 4.77688655 4.78135915 4.78142995]
   1 ( 0.000  0.000  0.500)   [-0.37571299 -0.25962662  0.17157989  0.17158   ] [1.15226864 1.16960612 1.16960632 1.40683337 1.70674745 1.8179681
 1.85262106 1.85262392 2.13235588 2.13235635 3.00861177 3.12961254
 3.12961968 3.15566402 3.15566861 3.32349911 3.67373321 3.67375568
 3.80857938 3.8085896  5.19490086 9.8713344 ]
    CPU time for vj and vk      4.46 sec, wall time      0.14 sec
E1 = (4.437338435706016+1.632309501399071e-17j)  E_coul = (-2.232029688338035+9.359463898259447e-18j)
cycle= 4 E= -10.5818203982563  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      4.95 sec, wall time      0.16 sec
HOMO = 0.35148684584  LUMO = 1.0194980083
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593918  0.28497259  0.28497266  0.35148685] [1.01949801 1.03930123 1.03930133 1.36580645 1.82435493 1.82435494
 1.88249558 2.1283122  2.13594062 2.13594145 2.72083282 2.72084059
 2.72587359 3.56482225 3.57080725 3.57081078 3.70879026 3.70879067
 4.22248094 4.77688748 4.78135688 4.78142772]
   1 ( 0.000  0.000  0.500)   [-0.37571737 -0.25964847  0.17156618  0.1715663 ] [1.15223781 1.16961229 1.1696125  1.40683702 1.70673733 1.81794131
 1.85260758 1.85261045 2.13234981 2.13235028 3.00862193 3.12961042
 3.12961756 3.1556606  3.15566518 3.32350537 3.67372821 3.67375066
 3.80858107 3.80859128 5.19488399 9.87125292]
    CPU time for vj and vk      4.48 sec, wall time      0.14 sec
E1 = (4.437330197539+1.631820318559506e-17j)  E_coul = (-2.23202152764301+9.35846156554669e-18j)
cycle= 5 E= -10.5818204757283  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      4.95 sec, wall time      0.16 sec
HOMO = 0.351492780926  LUMO = 1.01950212163
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593742  0.28497484  0.28497491  0.35149278] [1.01950212 1.03930424 1.03930434 1.36580462 1.82435593 1.82435594
 1.88249548 2.12831068 2.13594105 2.13594188 2.7208355  2.72084327
 2.72587708 3.56482313 3.57080789 3.57081142 3.70879192 3.70879233
 4.22248141 4.77688891 4.78135834 4.78142918]
   1 ( 0.000  0.000  0.500)   [-0.37571586 -0.25964061  0.1715692   0.17156931] [1.15223567 1.16961274 1.16961295 1.40683511 1.70673812 1.81794377
 1.85260957 1.85261244 2.132354   2.13235447 3.00862692 3.12961015
 3.1296173  3.15566221 3.15566679 3.32350421 3.67372793 3.67375037
 3.80858232 3.80859253 5.19488491 9.87125994]
    CPU time for vj and vk      4.45 sec, wall time      0.14 sec
E1 = (4.437327209805204+1.631512001008861e-17j)  E_coul = (-2.2320185405847868+9.358436433572842e-18j)
Extra cycle  E= -10.5818204764038  delta_E= -6.76e-10  |g|= 1.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     38.09 sec, wall time      1.22 sec
    CPU time for SCF     40.19 sec, wall time      1.29 sec
converged SCF energy = -10.5818204764038
**** SCF Summaries ****
Total Energy =                         -10.581820476403824
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437327209805204
Two-electron Energy =                   -2.232018540584787
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.05 sec, wall time      0.04 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 453 MB)
    CPU time for KMP2      0.53 sec, wall time      0.02 sec
E(KMP2) = -10.8005939282127  E_corr = -0.218773451808924
E(SCS-KMP2) = -10.7995369897917  E_corr = -0.217716513387921
E_corr(same-spin) = -0.051705725518601
E_corr(oppo-spin) = -0.167067726290323
End time = Tue Jun  3 04:45:05 PM PDT 2025
