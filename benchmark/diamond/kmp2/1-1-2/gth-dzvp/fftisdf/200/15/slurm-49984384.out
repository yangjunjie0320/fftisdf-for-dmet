SLURMD_NODENAME = hpc-35-06
Start time = Tue Jun  3 04:44:47 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-15/49984384/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-15/49984384/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/200/15/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-200-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-15
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 15.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1210, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 35937, selected grid size = 390
truncated values = 4.01e+01, estimated error = 9.05e-02
Number of interpolating points is 390.
    CPU time for building inpv_kpt     63.29 sec, wall time     55.33 sec

Out-core version is used for eta_kpt.
disk space required: 4.48e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   4.48e-01 GB
memory needed for each k-point: 2.24e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     14.25 sec, wall time      0.71 sec
    CPU time for building eta_kpt     18.40 sec, wall time      0.84 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      7.91 sec, wall time      1.03 sec
    CPU time for coul_kpt[ 2 / 2]      2.64 sec, wall time      0.96 sec
    CPU time for building coul_kpt     10.71 sec, wall time      1.99 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-15/49984384/iffl42ew


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-15/49984384/tmpk8_lvit1
max_memory 327680 MB (current use 328 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f48e1576770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.21 sec, wall time      0.17 sec
E1 = (3.1148715002717795-2.4391910308443598e-32j)  E_coul = (-5.359724863340904+2.148346515041879e-17j)
init E= -15.0319825086934
    CPU time for initialize scf      9.82 sec, wall time      0.32 sec
HOMO = 0.634511825122  LUMO = 0.835952136431
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469841  0.58526474  0.63451099  0.63451183] [0.83595214 0.90520612 0.90520848 1.12045673 1.80070884 1.80071042
 1.86315829 2.07363018 2.09378829 2.09381286 2.63058326 2.63482794
 2.63483762 3.54991727 3.54996186 3.5520162  3.65113778 3.6511384
 4.2088732  4.72605715 4.72732194 4.72738332]
   1 ( 0.000  0.000  0.500)   [-0.84757651 -0.56898737  0.50108778  0.50108809] [0.96420825 1.0346396  1.03464287 1.35059815 1.61891595 1.75426568
 1.81735696 1.81736798 2.11624694 2.11625086 2.94273061 3.05300305
 3.05301426 3.09653715 3.09654586 3.29650702 3.64892655 3.64895447
 3.75827207 3.75828954 5.12903682 9.60198945]
    CPU time for vj and vk      5.42 sec, wall time      0.17 sec
E1 = (4.4117356389756015+2.977566414090669e-18j)  E_coul = (-2.192540719323125+6.2726460954576784e-18j)
cycle= 1 E= -10.5679342259718  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      5.87 sec, wall time      0.19 sec
HOMO = 0.365526550415  LUMO = 1.01778642092
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65436907  0.29044007  0.29044174  0.36552655] [1.01778642 1.0392335  1.0392434  1.36689228 1.82549111 1.82549481
 1.88181622 2.12849457 2.13624415 2.13626864 2.72588461 2.72591081
 2.73257923 3.56538817 3.57186101 3.57188339 3.71006102 3.71006254
 4.22688614 4.77814524 4.78315649 4.78319486]
   1 ( 0.000  0.000  0.500)   [-0.37093785 -0.25527998  0.17488704  0.17489069] [1.15339685 1.16988359 1.1698974  1.40380979 1.71097592 1.82285962
 1.85610143 1.85613271 2.13417433 2.13419111 3.01195329 3.13040885
 3.1304179  3.15966239 3.15967854 3.32336055 3.67519751 3.67524419
 3.8104459  3.81048026 5.20021212 9.8932401 ]
    CPU time for vj and vk      6.01 sec, wall time      0.20 sec
E1 = (4.435270532138413+1.1945448341735295e-18j)  E_coul = (-2.22928503594391+5.889994372399266e-18j)
cycle= 2 E= -10.5811436494297  delta_E= -0.0132  |g|= 0.0652  |ddm|= 5.69
    CPU time for cycle= 2      6.61 sec, wall time      0.22 sec
HOMO = 0.351277043462  LUMO = 1.01859678741
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660036  0.28428867  0.28429141  0.35127704] [1.01859679 1.03824709 1.03825661 1.36489109 1.82397896 1.82398343
 1.88256098 2.12801323 2.13565049 2.13567398 2.72003975 2.72006589
 2.72508298 3.56445082 3.570602   3.57061988 3.70813017 3.70813283
 4.22251927 4.77628041 4.78081228 4.78085745]
   1 ( 0.000  0.000  0.500)   [-0.37618151 -0.26019673  0.17066383  0.17066621] [1.15178789 1.16897094 1.16898723 1.40671791 1.70615916 1.81700613
 1.85208027 1.85211151 2.1319805  2.1319943  3.00785216 3.12928401
 3.12929506 3.15469174 3.15470853 3.32338748 3.67354645 3.67359522
 3.808028   3.80805903 5.19443847 9.86920094]
    CPU time for vj and vk      5.80 sec, wall time      0.19 sec
E1 = (4.437482550640465+1.1505292753529296e-18j)  E_coul = (-2.232161591489493+5.7636500302101835e-18j)
cycle= 3 E= -10.5818081864733  delta_E= -0.000665  |g|= 0.00688  |ddm|= 0.996
    CPU time for cycle= 3      6.41 sec, wall time      0.21 sec
HOMO = 0.351522081223  LUMO = 1.01949451355
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65591982  0.28499678  0.2849992   0.35152208] [1.01949451 1.03928438 1.03929381 1.36585639 1.82435072 1.82435512
 1.88248434 2.12831877 2.13592989 2.13595352 2.72082959 2.7208559
 2.72590571 3.56477265 3.57078273 3.57080087 3.70879037 3.7087929
 4.22248259 4.7768592  4.78135048 4.78139563]
   1 ( 0.000  0.000  0.500)   [-0.37570868 -0.25962506  0.1715814   0.17158381] [1.15227262 1.16959459 1.16961098 1.40683613 1.70674754 1.81793545
 1.85260376 1.85263487 2.13234067 2.13235451 3.00860325 3.12962113
 3.1296318  3.15565001 3.15566629 3.32349534 3.67373568 3.67378463
 3.8085414  3.80857247 5.19490635 9.87132104]
    CPU time for vj and vk      5.60 sec, wall time      0.18 sec
E1 = (4.437331917750501+1.1634649398673058e-18j)  E_coul = (-2.232019657430085+5.746750382240091e-18j)
cycle= 4 E= -10.5818168853038  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      6.19 sec, wall time      0.20 sec
HOMO = 0.351490277357  LUMO = 1.01949523321
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593718  0.28496986  0.28497233  0.35149028] [1.01949523 1.03929284 1.03930226 1.36580814 1.82435252 1.82435686
 1.88249682 2.12833641 2.13593475 2.13595837 2.72081711 2.72084346
 2.72588838 3.56477527 3.57077939 3.57079751 3.70879082 3.70879335
 4.22246603 4.7768602  4.78134824 4.7813934 ]
   1 ( 0.000  0.000  0.500)   [-0.37571305 -0.25964694  0.17156769  0.17157013] [1.15224182 1.16960077 1.16961718 1.40683978 1.70673743 1.81790863
 1.85259033 1.85262141 2.1323346  2.13234842 3.00861342 3.12961904
 3.12962969 3.15564661 3.15566287 3.32350163 3.67373068 3.67377962
 3.80854309 3.80857416 5.19488955 9.8712396 ]
    CPU time for vj and vk      5.60 sec, wall time      0.18 sec
E1 = (4.437323662095928+1.1624882746561123e-18j)  E_coul = (-2.2320114792086954+5.7453735446856485e-18j)
cycle= 5 E= -10.581816962737  delta_E= -7.74e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      6.19 sec, wall time      0.20 sec
HOMO = 0.351496212696  LUMO = 1.01949934457
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593543  0.28497211  0.28497458  0.35149621] [1.01949934 1.03929585 1.03930527 1.3658063  1.82435352 1.82435785
 1.88249672 2.12833489 2.13593518 2.1359588  2.72081979 2.72084614
 2.72589188 3.56477615 3.57078004 3.57079815 3.70879248 3.70879501
 4.2224665  4.77686163 4.7813497  4.78139485]
   1 ( 0.000  0.000  0.500)   [-0.37571155 -0.25963908  0.17157071  0.17157315] [1.15223967 1.16960121 1.16961763 1.40683788 1.70673822 1.81791109
 1.85259231 1.8526234  2.13233879 2.13235261 3.0086184  3.12961877
 3.12962943 3.15564822 3.15566447 3.32350046 3.6737304  3.67377933
 3.80854434 3.80857541 5.19489047 9.87124662]
    CPU time for vj and vk      5.62 sec, wall time      0.18 sec
E1 = (4.437320676325652+1.1626733728005076e-18j)  E_coul = (-2.2320084941159934+5.745276404151779e-18j)
Extra cycle  E= -10.5818169634146  delta_E= -6.78e-10  |g|= 1.73e-05  |ddm|= 0.0015
    CPU time for scf_cycle     47.31 sec, wall time      1.52 sec
    CPU time for SCF     49.30 sec, wall time      1.59 sec
converged SCF energy = -10.5818169634146
**** SCF Summaries ****
Total Energy =                         -10.581816963414582
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437320676325652
Two-electron Energy =                   -2.232008494115993
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00906
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00997
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93328
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00908
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00997
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      0.65 sec, wall time      0.02 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 445 MB)
    CPU time for KMP2      0.53 sec, wall time      0.02 sec
E(KMP2) = -10.800591059356  E_corr = -0.218774095941372
E(SCS-KMP2) = -10.799534784925  E_corr = -0.217717821510457
E_corr(same-spin) = -0.0517051080221417
E_corr(oppo-spin) = -0.16706898791923
End time = Tue Jun  3 04:45:49 PM PDT 2025
