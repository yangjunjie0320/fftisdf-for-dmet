SLURMD_NODENAME = hpc-35-02
Start time = Thu Jun  5 09:22:38 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-20/50027074/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-20/50027074/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/200/20/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-200-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-20
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1210, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 35937, selected grid size = 520
truncated values = 4.01e+01, estimated error = 1.83e-02
Number of interpolating points is 520.
    CPU time for building inpv_kpt     62.47 sec, wall time     54.65 sec

Out-core version is used for eta_kpt.
disk space required: 5.98e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   5.98e-01 GB
memory needed for each k-point: 2.99e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     16.26 sec, wall time      0.89 sec
    CPU time for building eta_kpt     20.39 sec, wall time      1.02 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      8.62 sec, wall time      1.43 sec
    CPU time for coul_kpt[ 2 / 2]      3.30 sec, wall time      1.39 sec
    CPU time for building coul_kpt     12.16 sec, wall time      2.82 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-20/50027074/8zvaqd43


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-20/50027074/tmp9q76q9kr
max_memory 327680 MB (current use 339 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f95d0f6ef80>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.68 sec, wall time      0.18 sec
E1 = (3.1148715002717795-3.1891595532340438e-18j)  E_coul = (-5.359728366201157+1.975254666584509e-17j)
init E= -15.0319860115536
    CPU time for initialize scf     11.09 sec, wall time      0.36 sec
HOMO = 0.634511777346  LUMO = 0.835951378492
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469977  0.5852638   0.63451168  0.63451178] [0.83595138 0.905208   0.90520809 1.1204503  1.8007096  1.80070967
 1.86316032 2.07362753 2.09380873 2.09381108 2.63058363 2.63483311
 2.63483645 3.54994646 3.54995752 3.55203221 3.65113799 3.65113818
 4.20890038 4.72603581 4.72734681 4.72736299]
   1 ( 0.000  0.000  0.500)   [-0.84757855 -0.56898833  0.50108743  0.50108753] [0.96419904 1.03464018 1.03464061 1.3506226  1.6189173  1.75433462
 1.81735882 1.81736248 2.11624966 2.11624999 2.94274023 3.05300879
 3.05301164 3.0965409  3.09654207 3.29651735 3.64893859 3.6489427
 3.75827184 3.75827748 5.12904644 9.60202846]
    CPU time for vj and vk      5.82 sec, wall time      0.18 sec
E1 = (4.411735464916433-3.6868236503025584e-18j)  E_coul = (-2.1925422220460624+1.7769604570077415e-18j)
cycle= 1 E= -10.5679359027539  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      6.26 sec, wall time      0.20 sec
HOMO = 0.36552490444  LUMO = 1.01778924458
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65437051  0.29044411  0.29044467  0.3655249 ] [1.01778924 1.0392426  1.03924309 1.36688853 1.82549334 1.82549353
 1.88181531 2.1284751  2.13625216 2.13626444 2.7258995  2.72590535
 2.73256605 3.56544825 3.57188463 3.57192663 3.71006062 3.71006085
 4.22688962 4.77813461 4.78313217 4.78318923]
   1 ( 0.000  0.000  0.500)   [-0.37094093 -0.25528103  0.17488672  0.17488693] [1.15339317 1.16989283 1.16989477 1.40380796 1.7109759  1.82289451
 1.85612282 1.85612607 2.13419179 2.13419328 3.01196273 3.13039741
 3.13040423 3.15967102 3.15967909 3.32337408 3.67519981 3.67521558
 3.81047643 3.81049318 5.20022197 9.89328224]
    CPU time for vj and vk      5.84 sec, wall time      0.19 sec
E1 = (4.435275688588049-3.8296463048247245e-18j)  E_coul = (-2.22929287625637+2.163370529133406e-18j)
cycle= 2 E= -10.5811463332926  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      6.35 sec, wall time      0.20 sec
HOMO = 0.351274530301  LUMO = 1.01859880767
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660207  0.284292    0.28429247  0.35127453] [1.01859881 1.03825521 1.03825571 1.3648864  1.82398134 1.82398157
 1.88255964 2.12799254 2.13565793 2.13566905 2.72005644 2.720061
 2.7250702  3.56450839 3.57062264 3.57066159 3.70812997 3.70813009
 4.2225235  4.77626722 4.78080137 4.78086769]
   1 ( 0.000  0.000  0.500)   [-0.37618512 -0.2601979   0.17066251  0.17066274] [1.15178289 1.16898158 1.16898343 1.40671529 1.70615971 1.81703654
 1.85209917 1.85210252 2.13199445 2.13199586 3.00786119 3.12927718
 3.12928273 3.15470049 3.15470755 3.32339803 3.673548   3.6735658
 3.80805671 3.80807156 5.19444238 9.86923122]
    CPU time for vj and vk      5.80 sec, wall time      0.18 sec
E1 = (4.437486592516852-3.7285893014629495e-18j)  E_coul = (-2.2321682484535876+2.1924992280596447e-18j)
cycle= 3 E= -10.581810801561  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      6.30 sec, wall time      0.20 sec
HOMO = 0.351519315082  LUMO = 1.01949681904
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592145  0.28499999  0.28500046  0.35151932] [1.01949682 1.0392927  1.03929317 1.36585182 1.82435314 1.82435337
 1.88248316 2.12829822 2.13593751 2.13594874 2.72084627 2.72085096
 2.72589313 3.56483023 3.57080347 3.57084284 3.70879012 3.70879025
 4.22248623 4.77684651 4.781339   4.78140433]
   1 ( 0.000  0.000  0.500)   [-0.37571232 -0.25962632  0.17158017  0.17158041] [1.1522677  1.16960545 1.16960734 1.40683403 1.70674816 1.81796555
 1.85262268 1.85262608 2.13235463 2.13235604 3.00861217 3.12961401
 3.12961962 3.15565858 3.1556656  3.32350579 3.67373728 3.67375505
 3.80857038 3.80858514 5.19490999 9.87135137]
    CPU time for vj and vk      5.81 sec, wall time      0.18 sec
E1 = (4.437336189790271-3.738990685276837e-18j)  E_coul = (-2.232026549063088+2.1878791516780657e-18j)
cycle= 4 E= -10.5818195048971  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      6.29 sec, wall time      0.20 sec
HOMO = 0.351487514825  LUMO = 1.01949754523
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593882  0.28497306  0.28497354  0.35148751] [1.01949755 1.03930116 1.03930163 1.36580353 1.82435491 1.82435514
 1.88249566 2.12831584 2.13594237 2.13595358 2.7208338  2.72083848
 2.72587578 3.56483284 3.57080012 3.57083946 3.70879056 3.70879069
 4.22246961 4.77684746 4.78133679 4.78140212]
   1 ( 0.000  0.000  0.500)   [-0.3757167  -0.25964818  0.17156646  0.17156671] [1.15223688 1.16961163 1.16961352 1.40683768 1.70673804 1.81793874
 1.85260921 1.8526126  2.13234856 2.13234997 3.00862233 3.1296119
 3.12961751 3.15565516 3.15566216 3.32351205 3.67373226 3.67375004
 3.80857208 3.80858682 5.19489313 9.87126986]
    CPU time for vj and vk      5.81 sec, wall time      0.18 sec
E1 = (4.437327950396885-3.745495524268801e-18j)  E_coul = (-2.2320183871400725+2.1869659744087625e-18j)
cycle= 5 E= -10.5818195823674  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      6.29 sec, wall time      0.20 sec
HOMO = 0.351493450649  LUMO = 1.01950165807
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593706  0.28497531  0.28497579  0.35149345] [1.01950166 1.03930418 1.03930465 1.36580169 1.82435591 1.82435614
 1.88249556 2.12831432 2.1359428  2.13595401 2.72083649 2.72084116
 2.72587928 3.56483371 3.57080076 3.57084011 3.70879222 3.70879235
 4.22247008 4.77684889 4.78133825 4.78140357]
   1 ( 0.000  0.000  0.500)   [-0.37571519 -0.25964032  0.17156948  0.17156972] [1.15223473 1.16961208 1.16961397 1.40683577 1.70673883 1.8179412
 1.85261119 1.85261459 2.13235275 2.13235416 3.00862732 3.12961164
 3.12961724 3.15565676 3.15566377 3.32351088 3.67373198 3.67374976
 3.80857333 3.80858807 5.19489405 9.87127689]
    CPU time for vj and vk      5.80 sec, wall time      0.18 sec
E1 = (4.437324962881915-3.7455898365584865e-18j)  E_coul = (-2.2320154003006922+2.186916518964887e-18j)
Extra cycle  E= -10.581819583043  delta_E= -6.76e-10  |g|= 1.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     48.89 sec, wall time      1.56 sec
    CPU time for SCF     55.42 sec, wall time      2.26 sec
converged SCF energy = -10.581819583043
**** SCF Summaries ****
Total Energy =                         -10.581819583043018
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437324962881915
Two-electron Energy =                   -2.232015400300692
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00170
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      0.80 sec, wall time      0.03 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 470 MB)
    CPU time for KMP2      0.49 sec, wall time      0.02 sec
E(KMP2) = -10.8005943104548  E_corr = -0.218774727411747
E(SCS-KMP2) = -10.799537255431  E_corr = -0.217717672388025
E_corr(same-spin) = -0.0517061544300822
E_corr(oppo-spin) = -0.167068572981665
    CPU time for vj and vk      5.29 sec, wall time      0.17 sec
using incore ERI storage
End time = Thu Jun  5 09:23:51 PM PDT 2025
