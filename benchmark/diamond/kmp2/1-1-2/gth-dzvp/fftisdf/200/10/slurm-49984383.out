SLURMD_NODENAME = hpc-35-02
Start time = Tue Jun  3 04:44:46 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-10/49984383/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-10/49984383/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/200/10/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-200-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-10
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 10.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 10.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1210, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 35937, selected grid size = 260
truncated values = 3.96e+01, estimated error = 4.99e-01
Number of interpolating points is 260.
    CPU time for building inpv_kpt     62.05 sec, wall time     54.06 sec

Out-core version is used for eta_kpt.
disk space required: 2.99e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   2.99e-01 GB
memory needed for each k-point: 1.49e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     11.52 sec, wall time      0.46 sec
    CPU time for building eta_kpt     15.68 sec, wall time      0.59 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      6.91 sec, wall time      0.66 sec
    CPU time for coul_kpt[ 2 / 2]      1.82 sec, wall time      0.63 sec
    CPU time for building coul_kpt      8.82 sec, wall time      1.30 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-10/49984383/9n814tvi


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-10/49984383/tmplgv2vst8
max_memory 327680 MB (current use 324 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f156567e770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.22 sec, wall time      0.17 sec
E1 = (3.11487150027178+1.9134957319404486e-17j)  E_coul = (-5.359607356900046-8.712601634760402e-17j)
init E= -15.0318650022525
    CPU time for initialize scf     10.47 sec, wall time      0.34 sec
HOMO = 0.634534273772  LUMO = 0.835914920456
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95464988  0.58529039  0.63450633  0.63453427] [0.83591492 0.9051816  0.90523962 1.12033601 1.8006721  1.80069893
 1.86327284 2.07416021 2.09370653 2.09386294 2.63062401 2.63483471
 2.63492823 3.55012377 3.55023764 3.55261524 3.65112866 3.65114999
 4.20829592 4.72599471 4.72713431 4.72731044]
   1 ( 0.000  0.000  0.500)   [-0.84747923 -0.56898192  0.50110565  0.50110982] [0.96421521 1.03460764 1.03464798 1.35028869 1.61888211 1.75359972
 1.81729253 1.81734106 2.11623467 2.116293   2.94264286 3.05282175
 3.05299718 3.09645939 3.09660592 3.29634048 3.6487778  3.6491741
 3.75838596 3.75848787 5.12938101 9.60180577]
    CPU time for vj and vk      5.19 sec, wall time      0.16 sec
E1 = (4.411668411982466+1.1057284090204028e-17j)  E_coul = (-2.192424566151673-8.857315268117976e-17j)
cycle= 1 E= -10.5678852997934  delta_E= 4.46  |g|= 0.33  |ddm|= 8.59
    CPU time for cycle= 1      5.62 sec, wall time      0.18 sec
HOMO = 0.365523819671  LUMO = 1.01776637278
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65429188  0.29037323  0.29045162  0.36552382] [1.01776637 1.03920815 1.03933583 1.36684269 1.82547033 1.82551513
 1.88196979 2.12868328 2.13608285 2.13624059 2.72584831 2.72593932
 2.73262345 3.56577967 3.57224941 3.57232631 3.71005985 3.71007304
 4.22669048 4.77811927 4.78254177 4.78305798]
   1 ( 0.000  0.000  0.500)   [-0.37082814 -0.2552603   0.17485929  0.17493213] [1.15344051 1.16986446 1.16993708 1.40371354 1.71096916 1.82284446
 1.85590289 1.85617664 2.13410811 2.13419693 3.01188865 3.13029121
 3.13047995 3.15937801 3.15957112 3.32334593 3.6750646  3.67531158
 3.81054273 3.81090395 5.20006232 9.89328894]
    CPU time for vj and vk      5.17 sec, wall time      0.16 sec
E1 = (4.435205276563252+1.2599927755920243e-17j)  E_coul = (-2.2291752526160056-9.04091059610461e-17j)
cycle= 2 E= -10.581099121677  delta_E= -0.0132  |g|= 0.0652  |ddm|= 5.66
    CPU time for cycle= 2      5.67 sec, wall time      0.18 sec
HOMO = 0.351267571371  LUMO = 1.0185743384
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65651943  0.28421502  0.28430721  0.35126757] [1.01857434 1.03821846 1.03835571 1.36485681 1.82396155 1.82400754
 1.88270998 2.12821774 2.13550239 2.13564642 2.71999299 2.72008732
 2.72511036 3.56488591 3.57097603 3.57105794 3.70812196 3.7081489
 4.22233147 4.77627469 4.7802489  4.78074824]
   1 ( 0.000  0.000  0.500)   [-0.37605708 -0.26018762  0.1706255   0.17071986] [1.15183717 1.16894792 1.16903679 1.40663479 1.70615386 1.81703131
 1.85189778 1.85217639 2.13191527 2.13199356 3.00778774 3.12915269
 3.12934834 3.15442949 3.15460986 3.32336205 3.67345533 3.67368313
 3.80811666 3.80847955 5.19424558 9.86924788]
    CPU time for vj and vk      5.30 sec, wall time      0.17 sec
E1 = (4.437410230669828+1.2763651405870027e-17j)  E_coul = (-2.232044493417557-9.130578465914267e-17j)
cycle= 3 E= -10.581763408372  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.989
    CPU time for cycle= 3      5.82 sec, wall time      0.19 sec
HOMO = 0.351514622654  LUMO = 1.0194724225
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65583872  0.28492351  0.28501161  0.35151462] [1.01947242 1.03925568 1.03939252 1.36582315 1.82433324 1.82437947
 1.88263215 2.12851766 2.13578166 2.13592645 2.72078121 2.72087719
 2.72593443 3.56520368 3.57115715 3.57123737 3.70878239 3.70880891
 4.22230511 4.77685302 4.78078528 4.78128493]
   1 ( 0.000  0.000  0.500)   [-0.37558577 -0.25961469  0.17154435  0.17163562] [1.15232098 1.1695695  1.16966063 1.40675846 1.70674267 1.81796065
 1.85242097 1.85270089 2.13227772 2.13235597 3.00853908 3.12948944
 3.12968464 3.15538891 3.15556753 3.3234695  3.67364526 3.67386981
 3.80863102 3.80899047 5.19471337 9.87136713]
    CPU time for vj and vk      5.19 sec, wall time      0.16 sec
E1 = (4.437259727192579+1.2650701303995698e-17j)  E_coul = (-2.23190269245098-9.144849351534981e-17j)
cycle= 4 E= -10.5817721108826  delta_E= -8.7e-06  |g|= 0.000626  |ddm|= 0.113
    CPU time for cycle= 4      5.71 sec, wall time      0.18 sec
HOMO = 0.351482863134  LUMO = 1.01947323283
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65585592  0.28489676  0.28498513  0.35148286] [1.01947323 1.03926419 1.03940108 1.36577535 1.82433501 1.82438143
 1.88264458 2.12853588 2.13578641 2.13593142 2.72076887 2.72086485
 2.72591731 3.56520678 3.57115377 3.57123404 3.70878293 3.70880951
 4.22228936 4.77685432 4.7807838  4.78128312]
   1 ( 0.000  0.000  0.500)   [-0.37558999 -0.25963665  0.17153081  0.17162222] [1.15229048 1.16957577 1.16966708 1.40676236 1.70673287 1.81793413
 1.85240781 1.85268776 2.13227156 2.13234971 3.00854914 3.12948724
 3.12968253 3.15538585 3.15556438 3.32347587 3.67364071 3.67386525
 3.80863282 3.80899217 5.19469652 9.87128627]
    CPU time for vj and vk      5.20 sec, wall time      0.17 sec
E1 = (4.43725141516669+1.2630092916307698e-17j)  E_coul = (-2.2318944588087875-9.146106180259096e-17j)
cycle= 5 E= -10.5817721892663  delta_E= -7.84e-08  |g|= 6.74e-05  |ddm|= 0.0175
    CPU time for cycle= 5      5.75 sec, wall time      0.18 sec
HOMO = 0.351488775556  LUMO = 1.01947733635
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6558542   0.28489894  0.28498734  0.35148878] [1.01947734 1.03926719 1.03940408 1.36577346 1.82433601 1.82438242
 1.88264449 2.12853436 2.13578684 2.13593187 2.72077151 2.7208675
 2.72592079 3.56520767 3.5711544  3.57123467 3.70878457 3.70881116
 4.22228982 4.77685572 4.78078526 4.78128453]
   1 ( 0.000  0.000  0.500)   [-0.37558852 -0.25962881  0.17153376  0.17162521] [1.15228831 1.16957618 1.16966753 1.40676048 1.70673363 1.81793661
 1.85240977 1.85268973 2.13227576 2.13235392 3.00855412 3.12948695
 3.12968227 3.15538742 3.15556594 3.32347472 3.67364041 3.67386497
 3.80863405 3.8089934  5.19469742 9.87129318]
    CPU time for vj and vk      5.21 sec, wall time      0.17 sec
E1 = (4.437248446856663+1.2630412691825591e-17j)  E_coul = (-2.23189149160261-9.146152034094234e-17j)
Extra cycle  E= -10.5817721903702  delta_E= -1.1e-09  |g|= 2.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     44.76 sec, wall time      1.43 sec
    CPU time for SCF     47.44 sec, wall time      1.52 sec
converged SCF energy = -10.5817721903702
**** SCF Summaries ****
Total Energy =                         -10.581772190370186
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437248446856663
Two-electron Energy =                   -2.231891491602610
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93322
pop of  0 C 3s            0.00445
pop of  0 C 2px           1.00901
pop of  0 C 2py           1.00897
pop of  0 C 2pz           1.00903
pop of  0 C 3px           0.00168
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00168
pop of  0 C 3dxy          0.00997
pop of  0 C 3dyz          0.00997
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00997
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93335
pop of  1 C 3s            0.00445
pop of  1 C 2px           1.00914
pop of  1 C 2py           1.00920
pop of  1 C 2pz           1.00909
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00995
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00027
charge of    1C =     -0.00027
    CPU time for vj and vk      0.50 sec, wall time      0.02 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 495 MB)
    CPU time for KMP2      0.32 sec, wall time      0.01 sec
E(KMP2) = -10.800560088271  E_corr = -0.218787897900857
E(SCS-KMP2) = -10.7994997174733  E_corr = -0.217727527103136
E_corr(same-spin) = -0.0517130196667991
E_corr(oppo-spin) = -0.167074878234058
End time = Tue Jun  3 04:45:45 PM PDT 2025
