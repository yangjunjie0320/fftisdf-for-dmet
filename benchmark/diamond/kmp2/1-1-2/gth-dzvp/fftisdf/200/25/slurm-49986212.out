SLURMD_NODENAME = hpc-53-05
Start time = Tue Jun  3 10:55:53 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-25/49986212/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-25/49986212/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/200/25/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-200-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-25
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 25.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1210, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 35937, selected grid size = 650
truncated values = 4.01e+01, estimated error = 4.11e-03
Number of interpolating points is 650.
    CPU time for building inpv_kpt     62.69 sec, wall time     54.58 sec

Out-core version is used for eta_kpt.
disk space required: 7.47e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   7.47e-01 GB
memory needed for each k-point: 3.74e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     18.04 sec, wall time      1.13 sec
    CPU time for building eta_kpt     22.15 sec, wall time      1.26 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     10.06 sec, wall time      2.08 sec
    CPU time for coul_kpt[ 2 / 2]      4.42 sec, wall time      2.07 sec
    CPU time for building coul_kpt     14.78 sec, wall time      4.16 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-25/49986212/4n39q3gn


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-200-25/49986212/tmpuruclk8k
max_memory 327680 MB (current use 354 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7ff088eae770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.72 sec, wall time      0.18 sec
E1 = (3.1148715002717795-1.5945797766170959e-18j)  E_coul = (-5.359728552686445+2.9666609671017334e-17j)
init E= -15.0319861980389
    CPU time for initialize scf     10.56 sec, wall time      0.34 sec
HOMO = 0.634511714886  LUMO = 0.835951952333
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469989  0.58526375  0.6345117   0.63451171] [0.83595195 0.90520797 0.90520804 1.12045005 1.80070961 1.80070963
 1.86316035 2.07362789 2.09380741 2.09381089 2.63058186 2.63483403
 2.63483675 3.54994543 3.54996386 3.55202954 3.6511381  3.65113819
 4.20889918 4.72604093 4.72733223 4.72737839]
   1 ( 0.000  0.000  0.500)   [-0.84757881 -0.56898841  0.50108745  0.50108746] [0.9642005  1.0346405  1.03464065 1.3506242  1.61891711 1.75432842
 1.81735879 1.81736034 2.11624979 2.11625004 2.94273912 3.05300968
 3.05301115 3.09653869 3.09654157 3.29651605 3.64893482 3.64893816
 3.75827488 3.75827932 5.12900722 9.60190732]
    CPU time for vj and vk      5.71 sec, wall time      0.18 sec
E1 = (4.411736258688093+6.2436311661642404e-18j)  E_coul = (-2.1925435236769264+8.166122693397493e-18j)
cycle= 1 E= -10.5679364106131  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      6.15 sec, wall time      0.20 sec
HOMO = 0.365524443207  LUMO = 1.01778987863
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6543707   0.2904441   0.29044413  0.36552444] [1.01778988 1.03924277 1.03924289 1.36689202 1.82549338 1.8254934
 1.8818158  2.12847268 2.13625364 2.1362591  2.72589957 2.72590573
 2.73256542 3.56544238 3.57190312 3.57192342 3.71006091 3.71006106
 4.22686718 4.77814782 4.78313805 4.78320576]
   1 ( 0.000  0.000  0.500)   [-0.37094126 -0.25528134  0.17488664  0.17488671] [1.15339491 1.16989332 1.16989377 1.40381017 1.71097539 1.82288744
 1.85612044 1.85612535 2.13419308 2.13419384 3.01196136 3.13039593
 3.13040551 3.15967673 3.15968003 3.32336844 3.67518404 3.67521227
 3.8104871  3.81049797 5.20021737 9.89327151]
    CPU time for vj and vk      5.70 sec, wall time      0.18 sec
E1 = (4.435278073724077+9.100859527315182e-18j)  E_coul = (-2.2292961005370597+9.312674533860223e-18j)
cycle= 2 E= -10.5811471724372  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      6.27 sec, wall time      0.20 sec
HOMO = 0.351273953  LUMO = 1.0185990526
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660237  0.28429149  0.28429159  0.35127395] [1.01859905 1.03825517 1.03825537 1.36488973 1.82398133 1.82398134
 1.88256032 2.1279905  2.13565932 2.1356639  2.72005622 2.72006028
 2.7250683  3.56450355 3.57064113 3.57065882 3.70812995 3.70813018
 4.22249626 4.77628466 4.78081176 4.78087133]
   1 ( 0.000  0.000  0.500)   [-0.37618577 -0.26019814  0.17066226  0.1706623 ] [1.15178419 1.16898176 1.16898237 1.40671765 1.70615885 1.81703213
 1.85209701 1.85210129 2.13199562 2.13199638 3.00785954 3.12927425
 3.12928345 3.15470491 3.15470845 3.32339364 3.67353331 3.67356364
 3.80806554 3.80807452 5.19444304 9.86922186]
    CPU time for vj and vk      5.71 sec, wall time      0.18 sec
E1 = (4.437488545079518+9.568022748018426e-18j)  E_coul = (-2.2321710367617715+9.632270558809302e-18j)
cycle= 3 E= -10.5818116373065  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      6.29 sec, wall time      0.20 sec
HOMO = 0.351518653078  LUMO = 1.01949716901
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592171  0.28499954  0.28499963  0.35151865] [1.01949717 1.03929273 1.03929293 1.36585527 1.82435316 1.82435317
 1.88248382 2.12829618 2.13593892 2.13594357 2.72084605 2.72085031
 2.72589129 3.56482534 3.570822   3.57083974 3.70879016 3.70879038
 4.22245932 4.7768637  4.78134835 4.78140892]
   1 ( 0.000  0.000  0.500)   [-0.37571293 -0.2596266   0.17157998  0.17158003] [1.15226911 1.16960572 1.16960633 1.40683645 1.70674737 1.81796123
 1.85262058 1.85262482 2.13235578 2.13235654 3.00861061 3.12961118
 3.12962036 3.15566309 3.15566662 3.32350135 3.67372257 3.67375276
 3.80857923 3.80858833 5.19491035 9.87134243]
    CPU time for vj and vk      5.67 sec, wall time      0.18 sec
E1 = (4.4373381774188605+9.503674035904283e-18j)  E_coul = (-2.232029373824198+9.669101329096912e-18j)
cycle= 4 E= -10.5818203420296  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      6.23 sec, wall time      0.20 sec
HOMO = 0.35148686139  LUMO = 1.01949789893
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593908  0.28497261  0.2849727   0.35148686] [1.0194979  1.03930119 1.03930139 1.36580697 1.82435493 1.82435494
 1.88249631 2.12831379 2.13594377 2.13594841 2.72083357 2.72083783
 2.72587394 3.56482792 3.57081863 3.57083635 3.7087906  3.70879082
 4.2224427  4.77686465 4.78134611 4.78140667]
   1 ( 0.000  0.000  0.500)   [-0.37571732 -0.25964846  0.17156628  0.17156633] [1.15223828 1.1696119  1.16961251 1.4068401  1.70673725 1.81793443
 1.85260711 1.85261135 2.13234971 2.13235047 3.00862076 3.12960906
 3.12961824 3.15565965 3.15566319 3.32350762 3.67371758 3.67374776
 3.80858091 3.80859001 5.19489345 9.8712608 ]
    CPU time for vj and vk      5.69 sec, wall time      0.18 sec
E1 = (4.437329938703674+9.48874213539635e-18j)  E_coul = (-2.2320212125816505+9.671041327140177e-18j)
cycle= 5 E= -10.5818204195022  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      6.23 sec, wall time      0.20 sec
HOMO = 0.351492796394  LUMO = 1.01950201233
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593733  0.28497486  0.28497495  0.3514928 ] [1.01950201 1.03930421 1.0393044  1.36580513 1.82435593 1.82435594
 1.88249621 2.12831227 2.1359442  2.13594884 2.72083625 2.72084051
 2.72587744 3.5648288  3.57081928 3.57083699 3.70879226 3.70879248
 4.22244317 4.77686608 4.78134756 4.78140812]
   1 ( 0.000  0.000  0.500)   [-0.37571581 -0.2596406   0.17156929  0.17156934] [1.15223614 1.16961235 1.16961296 1.4068382  1.70673805 1.81793689
 1.8526091  1.85261334 2.1323539  2.13235466 3.00862575 3.1296088
 3.12961797 3.15566126 3.1556648  3.32350646 3.67371729 3.67374747
 3.80858216 3.80859126 5.19489436 9.87126782]
    CPU time for vj and vk      5.67 sec, wall time      0.18 sec
E1 = (4.437326951013299+9.490339302734392e-18j)  E_coul = (-2.232018225566886+9.671114228900598e-18j)
Extra cycle  E= -10.5818204201778  delta_E= -6.76e-10  |g|= 1.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     47.93 sec, wall time      1.53 sec
    CPU time for SCF     50.49 sec, wall time      1.62 sec
converged SCF energy = -10.5818204201778
**** SCF Summaries ****
Total Energy =                         -10.581820420177827
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437326951013299
Two-electron Energy =                   -2.232018225566886
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =     -0.00000
    CPU time for vj and vk      0.95 sec, wall time      0.03 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 520 MB)
    CPU time for KMP2      0.54 sec, wall time      0.02 sec
E(KMP2) = -10.8005941921008  E_corr = -0.218773771922975
E(SCS-KMP2) = -10.7995371491104  E_corr = -0.217716728932597
E_corr(same-spin) = -0.0517059200480464
E_corr(oppo-spin) = -0.167067851874929
End time = Tue Jun  3 10:56:57 PM PDT 2025
