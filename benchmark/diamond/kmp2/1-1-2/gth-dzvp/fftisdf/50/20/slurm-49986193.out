SLURMD_NODENAME = hpc-54-32
Start time = Tue Jun  3 10:55:05 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-20/49986193/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-20/49986193/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/50/20/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-20
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1175, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 4913, selected grid size = 520
truncated values = 3.91e+01, estimated error = 1.52e-02
Number of interpolating points is 520.
    CPU time for building inpv_kpt      7.89 sec, wall time      1.34 sec

Out-core version is used for eta_kpt.
disk space required: 8.18e-02 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   8.18e-02 GB
memory needed for each k-point: 4.09e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      4.76 sec, wall time      0.15 sec
    CPU time for building eta_kpt      5.80 sec, wall time      0.18 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      8.83 sec, wall time      0.44 sec
    CPU time for coul_kpt[ 2 / 2]      7.71 sec, wall time      0.43 sec
    CPU time for building coul_kpt     16.88 sec, wall time      0.88 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-20/49986193/eyqamvve


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-20/49986193/tmppth0cecv
max_memory 327680 MB (current use 275 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f528aad2770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.67 sec, wall time      0.06 sec
E1 = (3.114871440699585+2.072953709527327e-17j)  E_coul = (-5.359728347119366+1.706586794596917e-17j)
init E= -15.031986052044
    CPU time for initialize scf      3.60 sec, wall time      0.13 sec
HOMO = 0.634511394102  LUMO = 0.835950741769
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.9546988   0.58526249  0.63450332  0.63451139] [0.83595074 0.90519957 0.90520768 1.12045608 1.80070959 1.80070966
 1.86317767 2.07362642 2.09379334 2.09380782 2.63057809 2.63479952
 2.63483669 3.54994167 3.54994731 3.55202967 3.65113809 3.65113823
 4.20896793 4.72604729 4.72734431 4.72736698]
   1 ( 0.000  0.000  0.500)   [-0.84757666 -0.56898797  0.50108041  0.50108717] [0.9642038  1.03463241 1.03464041 1.35062397 1.61891474 1.7543397
 1.8173475  1.81736074 2.11624881 2.11624981 2.94274389 3.05297569
 3.05300921 3.0965338  3.09654239 3.29652269 3.6489336  3.64894329
 3.75825995 3.75827654 5.12911842 9.6021235 ]
    CPU time for vj and vk      1.49 sec, wall time      0.05 sec
E1 = (4.411717891430759+8.419390963881686e-18j)  E_coul = (-2.192537580075421+8.183251774416022e-19j)
cycle= 1 E= -10.5679488342689  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      1.88 sec, wall time      0.06 sec
HOMO = 0.365524669191  LUMO = 1.01778908418
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6543688   0.29043667  0.29044515  0.36552467] [1.01778908 1.03923629 1.03924254 1.36689814 1.82549353 1.82549394
 1.88183288 2.12846932 2.13623935 2.13625406 2.72586516 2.72590272
 2.732561   3.56543995 3.57189904 3.57190253 3.71006117 3.71006135
 4.2269555  4.77816858 4.78317875 4.78318936]
   1 ( 0.000  0.000  0.500)   [-0.37093873 -0.25528047  0.17488053  0.17488737] [1.15339707 1.16988904 1.16989438 1.40381109 1.71097454 1.82289714
 1.85611272 1.85612673 2.13419205 2.13419325 3.01196598 3.13039091
 3.13040464 3.1596441  3.15967835 3.32337705 3.67519588 3.6752254
 3.81047129 3.81049158 5.20029244 9.89337291]
    CPU time for vj and vk      1.55 sec, wall time      0.05 sec
E1 = (4.4352604512210165+1.0721348567953838e-17j)  E_coul = (-2.2292907281710406+7.768423730796617e-19j)
cycle= 2 E= -10.5811594225743  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      2.03 sec, wall time      0.07 sec
HOMO = 0.351274022471  LUMO = 1.01859827469
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6566005   0.28428388  0.28429246  0.35127402] [1.01859827 1.03824858 1.03825479 1.3648957  1.8239814  1.82398179
 1.88257708 2.12798732 2.13564464 2.13565915 2.72002108 2.72005751
 2.7250635  3.56450152 3.57063426 3.57063762 3.70813018 3.70813036
 4.2225883  4.77630286 4.78084175 4.78084978]
   1 ( 0.000  0.000  0.500)   [-0.37618333 -0.26019735  0.1706559   0.17066307] [1.15178639 1.16897757 1.16898268 1.40671871 1.70615789 1.81703958
 1.85208865 1.85210302 2.1319944  2.13199569 3.00786493 3.12926825
 3.12928276 3.1546726  3.15470612 3.32340129 3.67354387 3.6735738
 3.80804956 3.80807044 5.19451425 9.86933609]
    CPU time for vj and vk      1.90 sec, wall time      0.06 sec
E1 = (4.43747127936701+1.0772646560913544e-17j)  E_coul = (-2.2321660118242885+7.239615474046051e-19j)
cycle= 3 E= -10.5818238780815  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      2.44 sec, wall time      0.08 sec
HOMO = 0.351518714325  LUMO = 1.01949635817
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65591985  0.28499194  0.2850005   0.35151871] [1.01949636 1.03928611 1.03929232 1.36586122 1.82435322 1.82435362
 1.8825006  2.12829302 2.13592427 2.13593878 2.720811   2.7208475
 2.72588641 3.56482327 3.57081537 3.57081853 3.70879036 3.70879054
 4.22255091 4.77688202 4.78137998 4.78138751]
   1 ( 0.000  0.000  0.500)   [-0.37571049 -0.25962583  0.17157362  0.17158077] [1.15227129 1.16960152 1.16960666 1.40683758 1.7067464  1.81796852
 1.85261221 1.85262657 2.13235455 2.13235584 3.00861592 3.12960518
 3.12961973 3.15563068 3.15566426 3.32350911 3.67373309 3.6737632
 3.80856314 3.80858406 5.19498162 9.87145668]
    CPU time for vj and vk      1.46 sec, wall time      0.05 sec
E1 = (4.437320897080168+1.0712278502063398e-17j)  E_coul = (-2.2320243335905574+7.171244329575283e-19j)
cycle= 4 E= -10.5818325821346  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      1.95 sec, wall time      0.06 sec
HOMO = 0.351486923204  LUMO = 1.019497087
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593722  0.28496501  0.28497358  0.35148692] [1.01949709 1.03929457 1.03930078 1.36581292 1.82435498 1.82435539
 1.88251309 2.12831064 2.13592913 2.13594362 2.72079852 2.72083503
 2.72586907 3.56482588 3.57081201 3.57081516 3.70879081 3.70879098
 4.22253428 4.77688295 4.78137777 4.7813853 ]
   1 ( 0.000  0.000  0.500)   [-0.37571487 -0.25964768  0.17155991  0.17156708] [1.15224046 1.1696077  1.16961283 1.40684123 1.70673628 1.81794172
 1.85259874 1.8526131  2.13234849 2.13234977 3.00862607 3.12960306
 3.12961761 3.15562725 3.15566083 3.32351537 3.67372808 3.67375818
 3.80856482 3.80858574 5.19496476 9.87137521]
    CPU time for vj and vk      1.48 sec, wall time      0.05 sec
E1 = (4.437312656135352+1.070145097899935e-17j)  E_coul = (-2.232016170116249+7.098424511057578e-19j)
cycle= 5 E= -10.5818326596051  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      1.98 sec, wall time      0.07 sec
HOMO = 0.351492857739  LUMO = 1.01950120011
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593547  0.28496726  0.28497583  0.35149286] [1.0195012  1.03929758 1.03930379 1.36581108 1.82435598 1.82435639
 1.882513   2.12830912 2.13592956 2.13594406 2.72080121 2.72083772
 2.72587257 3.56482676 3.57081265 3.57081581 3.70879247 3.70879264
 4.22253475 4.77688438 4.78137922 4.78138675]
   1 ( 0.000  0.000  0.500)   [-0.37571336 -0.25963982  0.17156292  0.17157009] [1.15223832 1.16960815 1.16961328 1.40683933 1.70673707 1.81794418
 1.85260073 1.85261509 2.13235267 2.13235396 3.00863106 3.12960279
 3.12961734 3.15562886 3.15566244 3.32351421 3.67372779 3.67375789
 3.80856607 3.80858699 5.19496569 9.87138224]
    CPU time for vj and vk      1.54 sec, wall time      0.05 sec
E1 = (4.437309668555466+1.0701456618906553e-17j)  E_coul = (-2.2320131832129264+7.148447295454418e-19j)
Extra cycle  E= -10.5818326602817  delta_E= -6.77e-10  |g|= 1.73e-05  |ddm|= 0.0015
    CPU time for scf_cycle     15.93 sec, wall time      0.54 sec
    CPU time for SCF     18.70 sec, wall time      0.63 sec
converged SCF energy = -10.5818326602817
**** SCF Summaries ****
Total Energy =                         -10.581832660281700
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437309668555466
Two-electron Energy =                   -2.232013183212926
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00906
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93328
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      1.05 sec, wall time      0.04 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 535 MB)
    CPU time for KMP2      0.65 sec, wall time      0.02 sec
E(KMP2) = -10.800606590756  E_corr = -0.218773930474262
E(SCS-KMP2) = -10.7995494485159  E_corr = -0.217716788234175
E_corr(same-spin) = -0.0517060711556999
E_corr(oppo-spin) = -0.167067859318562
End time = Tue Jun  3 10:55:09 PM PDT 2025
