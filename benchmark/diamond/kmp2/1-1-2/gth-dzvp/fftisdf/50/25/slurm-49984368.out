SLURMD_NODENAME = hpc-35-03
Start time = Tue Jun  3 04:43:48 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-25/49984368/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-25/49984368/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/50/25/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-25
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 25.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1175, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 4913, selected grid size = 650
truncated values = 3.92e+01, estimated error = 3.22e-03
Number of interpolating points is 650.
    CPU time for building inpv_kpt      7.71 sec, wall time      1.18 sec

Out-core version is used for eta_kpt.
disk space required: 1.02e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   1.02e-01 GB
memory needed for each k-point: 5.11e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      5.09 sec, wall time      0.16 sec
    CPU time for building eta_kpt      6.09 sec, wall time      0.19 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      9.20 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 2 / 2]      8.33 sec, wall time      0.63 sec
    CPU time for building coul_kpt     17.98 sec, wall time      1.28 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-25/49984368/kqgcuwfx


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-25/49984368/tmprcohpqm5
max_memory 327680 MB (current use 286 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f12316da770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.92 sec, wall time      0.06 sec
E1 = (3.1148714406995848+8.904587942716483e-27j)  E_coul = (-5.359728388588734+1.8188767026547495e-17j)
init E= -15.0319860935134
    CPU time for initialize scf      3.60 sec, wall time      0.12 sec
HOMO = 0.634511375397  LUMO = 0.835950731264
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469882  0.58526255  0.63450346  0.63451138] [0.83595073 0.90519966 0.90520764 1.12045602 1.80070961 1.80070962
 1.86317795 2.07362596 2.0937922  2.09380845 2.63057774 2.63479993
 2.63483607 3.54993834 3.54995296 3.55202826 3.65113808 3.65113809
 4.20895898 4.72603821 4.72733953 4.72736765]
   1 ( 0.000  0.000  0.500)   [-0.84757676 -0.56898806  0.50108027  0.50108714] [0.96420412 1.03463222 1.03464026 1.35062237 1.61891487 1.754332
 1.81734733 1.81736002 2.11624877 2.11625022 2.94274095 3.05297703
 3.05301407 3.09653056 3.09654147 3.29651519 3.64893521 3.64894324
 3.75826089 3.75828379 5.12909502 9.60209382]
    CPU time for vj and vk      1.89 sec, wall time      0.06 sec
E1 = (4.411718012375766+9.114159513333075e-19j)  E_coul = (-2.1925378023065702+3.56085408957398e-18j)
cycle= 1 E= -10.567948935555  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      2.26 sec, wall time      0.07 sec
HOMO = 0.365524335403  LUMO = 1.01778948321
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65436894  0.29043678  0.29044497  0.36552434] [1.01778948 1.03923674 1.03924315 1.36689737 1.82549357 1.82549386
 1.88183318 2.12847229 2.13623641 2.13625243 2.72586323 2.72590623
 2.73255861 3.56545193 3.5718833  3.57189764 3.71006118 3.71006142
 4.22695246 4.77814608 4.7831374  4.78319671]
   1 ( 0.000  0.000  0.500)   [-0.37093859 -0.2552806   0.17488045  0.17488747] [1.15339824 1.16988773 1.16989334 1.40380353 1.71097452 1.8228934
 1.85611012 1.85612085 2.13419219 2.13419269 3.01196476 3.13039054
 3.13039827 3.15964605 3.15967496 3.32336771 3.6751872  3.67519452
 3.81047543 3.81048285 5.20027286 9.89335116]
    CPU time for vj and vk      1.89 sec, wall time      0.06 sec
E1 = (4.435261246647482-2.4741485151534325e-18j)  E_coul = (-2.229291826191505+3.877622310039843e-18j)
cycle= 2 E= -10.5811597251683  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      2.35 sec, wall time      0.08 sec
HOMO = 0.35127359632  LUMO = 1.01859843609
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660069  0.28428397  0.28429212  0.3512736 ] [1.01859844 1.03824887 1.0382554  1.36489475 1.82398142 1.8239817
 1.88257757 2.12799022 2.13564213 2.13565807 2.72001869 2.72006131
 2.72506164 3.56451454 3.57061908 3.57063439 3.7081301  3.70813044
 4.22258502 4.77628338 4.78080244 4.78085711]
   1 ( 0.000  0.000  0.500)   [-0.37618319 -0.26019758  0.17065577  0.17066285] [1.15178748 1.16897595 1.16898177 1.40671088 1.70615792 1.81703692
 1.85208543 1.85209702 2.13199449 2.13199515 3.00786271 3.12926606
 3.12927707 3.15467347 3.1547038  3.32339177 3.67353518 3.67354247
 3.80805302 3.8080616  5.19450219 9.86931242]
    CPU time for vj and vk      1.88 sec, wall time      0.06 sec
E1 = (4.43747196519017-3.1342721205098664e-18j)  E_coul = (-2.2321670048858593+3.961502161498046e-18j)
cycle= 3 E= -10.5818241853199  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      2.35 sec, wall time      0.08 sec
HOMO = 0.351518276015  LUMO = 1.01949655345
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592003  0.28499201  0.28500017  0.35151828] [1.01949655 1.03928643 1.03929295 1.36586031 1.82435324 1.82435354
 1.88250108 2.12829595 2.13592175 2.13593768 2.72080863 2.72085126
 2.72588453 3.56483629 3.57080023 3.57081544 3.7087903  3.70879063
 4.22254777 4.77686172 4.78134034 4.78139524]
   1 ( 0.000  0.000  0.500)   [-0.37571037 -0.25962606  0.17157349  0.17158058] [1.1522724  1.16959993 1.16960573 1.4068298  1.70674644 1.81796598
 1.85260898 1.8526206  2.13235465 2.1323553  3.00861373 3.12960305
 3.12961398 3.15563164 3.15566194 3.32349958 3.67372471 3.67373172
 3.80856668 3.80857528 5.19496963 9.87143309]
    CPU time for vj and vk      1.90 sec, wall time      0.06 sec
E1 = (4.437321605929972-3.061229684255484e-18j)  E_coul = (-2.2320253504563166+3.968196563183204e-18j)
cycle= 4 E= -10.5818328901506  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      2.38 sec, wall time      0.08 sec
HOMO = 0.351486485272  LUMO = 1.01949728423
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6559374   0.28496508  0.28497324  0.35148649] [1.01949728 1.03929489 1.03930141 1.36581201 1.82435501 1.82435531
 1.88251357 2.12831356 2.1359266  2.13594253 2.72079616 2.72083879
 2.7258672  3.56483887 3.57079686 3.57081209 3.70879075 3.70879108
 4.22253109 4.77686268 4.78133815 4.78139306]
   1 ( 0.000  0.000  0.500)   [-0.37571475 -0.25964791  0.17155978  0.17156687] [1.15224158 1.16960611 1.1696119  1.40683344 1.70673632 1.81793918
 1.8525955  1.85260713 2.13234858 2.13234923 3.00862388 3.12960093
 3.12961186 3.15562821 3.15565851 3.32350584 3.6737197  3.6737267
 3.80856835 3.80857696 5.1949528  9.87135162]
    CPU time for vj and vk      1.87 sec, wall time      0.06 sec
E1 = (4.43731336847115-3.040121896686229e-18j)  E_coul = (-2.232017190466578+3.966604802962111e-18j)
cycle= 5 E= -10.5818329676197  delta_E= -7.75e-08  |g|= 6.04e-05  |ddm|= 0.0176
    CPU time for cycle= 5      2.32 sec, wall time      0.08 sec
HOMO = 0.351492419467  LUMO = 1.01950139729
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593565  0.28496733  0.28497549  0.35149242] [1.0195014  1.03929791 1.03930443 1.36581017 1.82435601 1.82435631
 1.88251347 2.12831204 2.13592703 2.13594296 2.72079884 2.72084147
 2.72587069 3.56483975 3.5707975  3.57081273 3.70879241 3.70879273
 4.22253156 4.77686411 4.78133961 4.78139451]
   1 ( 0.000  0.000  0.500)   [-0.37571324 -0.25964006  0.1715628   0.17156989] [1.15223943 1.16960656 1.16961235 1.40683154 1.70673711 1.81794165
 1.85259749 1.85260911 2.13235277 2.13235342 3.00862887 3.12960066
 3.1296116  3.15562982 3.15566012 3.32350468 3.67371942 3.67372641
 3.80856961 3.80857821 5.19495372 9.87135865]
    CPU time for vj and vk      1.92 sec, wall time      0.06 sec
E1 = (4.437310380806968-3.0362225940806222e-18j)  E_coul = (-2.2320142034791597+3.969993835009977e-18j)
Extra cycle  E= -10.5818329682964  delta_E= -6.77e-10  |g|= 1.73e-05  |ddm|= 0.0015
    CPU time for scf_cycle     17.63 sec, wall time      0.58 sec
    CPU time for SCF     19.64 sec, wall time      0.65 sec
converged SCF energy = -10.5818329682964
**** SCF Summaries ****
Total Energy =                         -10.581832968296432
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437310380806968
Two-electron Energy =                   -2.232014203479160
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00906
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93328
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      1.05 sec, wall time      0.04 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 497 MB)
    CPU time for KMP2      0.56 sec, wall time      0.02 sec
E(KMP2) = -10.8006077235314  E_corr = -0.218774755234945
E(SCS-KMP2) = -10.7995506346383  E_corr = -0.217717666341851
E_corr(same-spin) = -0.0517061999308653
E_corr(oppo-spin) = -0.16706855530408
End time = Tue Jun  3 04:43:53 PM PDT 2025
