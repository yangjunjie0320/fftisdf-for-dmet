SLURMD_NODENAME = hpc-35-07
Start time = Tue Jun  3 10:55:03 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-10/49986191/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-10/49986191/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/50/10/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-10
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 10.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 10.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1175, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 4913, selected grid size = 260
truncated values = 3.87e+01, estimated error = 4.47e-01
Number of interpolating points is 260.
    CPU time for building inpv_kpt      7.95 sec, wall time      1.27 sec

Out-core version is used for eta_kpt.
disk space required: 4.09e-02 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   4.09e-02 GB
memory needed for each k-point: 2.04e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      2.13 sec, wall time      0.07 sec
    CPU time for building eta_kpt      3.39 sec, wall time      0.11 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      3.46 sec, wall time      0.11 sec
    CPU time for coul_kpt[ 2 / 2]      2.95 sec, wall time      0.09 sec
    CPU time for building coul_kpt      6.50 sec, wall time      0.21 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-10/49986191/djp64u56


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-10/49986191/tmpyf8wqjon
max_memory 327680 MB (current use 297 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fee860a6770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.19 sec, wall time      0.04 sec
E1 = (3.114871440699585-7.972898935061429e-19j)  E_coul = (-5.359618324684222+6.399638989018581e-18j)
init E= -15.0318760296089
    CPU time for initialize scf      2.58 sec, wall time      0.09 sec
HOMO = 0.634519916523  LUMO = 0.835981762898
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95464805  0.58526428  0.63448779  0.63451992] [0.83598176 0.90519332 0.90522285 1.1202879  1.80065555 1.80069027
 1.86331503 2.07399812 2.09381495 2.0938633  2.63069823 2.63465819
 2.63485149 3.54987647 3.55009213 3.55238753 3.65113119 3.65114404
 4.20858364 4.72587762 4.72697785 4.72709589]
   1 ( 0.000  0.000  0.500)   [-0.84744745 -0.56899427  0.50106411  0.50109512] [0.96428517 1.03459753 1.03464694 1.35076821 1.6188712  1.75469439
 1.81732701 1.81736357 2.11619952 2.11624277 2.9426467  3.05295252
 3.05306752 3.09645214 3.09654092 3.29657898 3.64882089 3.64892911
 3.75817025 3.75832338 5.12911925 9.60195677]
    CPU time for vj and vk      1.01 sec, wall time      0.03 sec
E1 = (4.411591753169121-1.634285251240845e-17j)  E_coul = (-2.1924336009925294-8.51931455469247e-18j)
cycle= 1 E= -10.5679709934476  delta_E= 4.46  |g|= 0.33  |ddm|=  8.4
    CPU time for cycle= 1      1.39 sec, wall time      0.05 sec
HOMO = 0.365537752498  LUMO = 1.01786418658
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65429675  0.29038865  0.29042816  0.36553775] [1.01786419 1.03924944 1.03929997 1.36683937 1.82545374 1.82550196
 1.88200158 2.12858224 2.13611125 2.13623768 2.72554253 2.72575865
 2.73263457 3.56547196 3.57199902 3.57213492 3.71003689 3.71010193
 4.22695773 4.77786397 4.78322358 4.78343554]
   1 ( 0.000  0.000  0.500)   [-0.37084466 -0.25526608  0.17481541  0.17491096] [1.15347107 1.16988285 1.16995548 1.40382217 1.71094714 1.82298727
 1.85614334 1.85626712 2.1341116  2.13415812 3.01187848 3.13020577
 3.13033278 3.15945229 3.15962674 3.3233569  3.67526066 3.67552229
 3.81045484 3.81066413 5.2001238  9.89343433]
    CPU time for vj and vk      1.05 sec, wall time      0.03 sec
E1 = (4.435038593042679-1.6165072762733402e-17j)  E_coul = (-2.229084720110902-8.31074086149941e-18j)
cycle= 2 E= -10.5811752726925  delta_E= -0.0132  |g|= 0.0652  |ddm|= 5.68
    CPU time for cycle= 2      2.01 sec, wall time      0.07 sec
HOMO = 0.351294577487  LUMO = 1.01868024957
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65651094  0.28424352  0.28430275  0.35129458] [1.01868025 1.03826776 1.03833035 1.36486932 1.82394525 1.82399486
 1.88275528 2.12811927 2.13552636 2.13566394 2.71972795 2.71992611
 2.72513659 3.56454869 3.5707149  3.57085492 3.70811212 3.70815756
 4.22259032 4.77597409 4.78091884 4.78115034]
   1 ( 0.000  0.000  0.500)   [-0.37606428 -0.26018677  0.17060747  0.17071383] [1.15188156 1.16898197 1.16905918 1.40671187 1.70613931 1.81719914
 1.85214736 1.85226183 2.13190766 2.13196451 3.00777714 3.12910064
 3.1292363  3.15452052 3.15468152 3.32337339 3.67360707 3.67388289
 3.80808014 3.80822076 5.19429063 9.86944551]
    CPU time for vj and vk      1.16 sec, wall time      0.04 sec
E1 = (4.437230020330927-1.653524665924362e-17j)  E_coul = (-2.2319400330431973-8.222463170044168e-18j)
cycle= 3 E= -10.5818391583365  delta_E= -0.000664  |g|= 0.00687  |ddm|= 0.99
    CPU time for cycle= 3      1.67 sec, wall time      0.05 sec
HOMO = 0.351540150188  LUMO = 1.01957963676
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65582987  0.28495026  0.28500938  0.35154015] [1.01957964 1.03930642 1.03936722 1.36583384 1.8243165  1.82436745
 1.88267625 2.12842305 2.13580595 2.13594348 2.72051723 2.72071632
 2.72595938 3.56486736 3.57089618 3.57103361 3.70877198 3.70881846
 4.22255079 4.77655428 4.78145948 4.78169094]
   1 ( 0.000  0.000  0.500)   [-0.37558958 -0.25961634  0.1715253   0.17163021] [1.15236531 1.16960715 1.16968312 1.40683257 1.70672982 1.81812268
 1.85267133 1.85278677 2.13226506 2.1323234  3.00852682 3.12943845
 3.12957225 3.15547912 3.1556414  3.32348124 3.6737985  3.6740747
 3.80859371 3.8087369  5.19475984 9.87156892]
    CPU time for vj and vk      1.05 sec, wall time      0.03 sec
E1 = (4.4370809065316426-1.6525955153260915e-17j)  E_coul = (-2.2317995918068627-8.206933239060461e-18j)
cycle= 4 E= -10.5818478308995  delta_E= -8.67e-06  |g|= 0.000629  |ddm|= 0.112
    CPU time for cycle= 4      1.56 sec, wall time      0.05 sec
HOMO = 0.351508504181  LUMO = 1.01958023014
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65584719  0.28492306  0.28498245  0.3515085 ] [1.01958023 1.03931485 1.03937568 1.36578553 1.82431812 1.8243693
 1.88268873 2.12844095 2.13581073 2.13594825 2.72050444 2.7207037
 2.72594223 3.56487033 3.57089266 3.57103018 3.70877234 3.70881871
 4.22253423 4.77655517 4.78145748 4.78168927]
   1 ( 0.000  0.000  0.500)   [-0.37559423 -0.25963798  0.17151154  0.17161654] [1.15233458 1.16961319 1.16968918 1.40683661 1.70671976 1.81809659
 1.85265772 1.85277314 2.13225916 2.13231757 3.00853674 3.12943613
 3.12957022 3.15547565 3.15563778 3.32348709 3.67379355 3.67406975
 3.80859551 3.80873839 5.19474253 9.87148726]
    CPU time for vj and vk      1.06 sec, wall time      0.04 sec
E1 = (4.43707282195405-1.651777998428128e-17j)  E_coul = (-2.231791586487679-8.214834732173939e-18j)
cycle= 5 E= -10.5818479101579  delta_E= -7.93e-08  |g|= 8.35e-05  |ddm|= 0.0175
    CPU time for cycle= 5      1.57 sec, wall time      0.05 sec
HOMO = 0.351514308391  LUMO = 1.01958431101
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6558455   0.2849252   0.28498464  0.35151431] [1.01958431 1.03931784 1.03937869 1.36578358 1.8243191  1.82437033
 1.88268866 2.12843951 2.13581117 2.1359487  2.7205071  2.72070636
 2.72594565 3.56487122 3.57089331 3.5710308  3.70877398 3.70882036
 4.22253465 4.77655659 4.7814589  4.78169072]
   1 ( 0.000  0.000  0.500)   [-0.37559273 -0.25963026  0.17151446  0.17161952] [1.15233237 1.16961369 1.16968961 1.40683474 1.70672052 1.818099
 1.85265968 1.8527751  2.13226325 2.13232171 3.00854169 3.12943587
 3.12957    3.15547727 3.15563935 3.32348599 3.67379326 3.67406945
 3.80859677 3.80873965 5.1947434  9.87149407]
    CPU time for vj and vk      1.05 sec, wall time      0.04 sec
E1 = (4.437069832686816-1.6521046502477427e-17j)  E_coul = (-2.231788598707482-8.209609700438611e-18j)
Extra cycle  E= -10.5818479116449  delta_E= -1.49e-09  |g|= 3.58e-05  |ddm|= 0.00153
    CPU time for scf_cycle     12.32 sec, wall time      0.41 sec
    CPU time for SCF     14.33 sec, wall time      0.48 sec
converged SCF energy = -10.5818479116449
**** SCF Summaries ****
Total Energy =                         -10.581847911644907
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437069832686816
Two-electron Energy =                   -2.231788598707482
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93328
pop of  0 C 3s            0.00445
pop of  0 C 2px           1.00904
pop of  0 C 2py           1.00914
pop of  0 C 2pz           1.00919
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00169
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00995
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00447
pop of  1 C 2px           1.00901
pop of  1 C 2py           1.00905
pop of  1 C 2pz           1.00905
pop of  1 C 3px           0.00168
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00997
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =     -0.00012
charge of    1C =      0.00012
    CPU time for vj and vk      0.33 sec, wall time      0.01 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 511 MB)
    CPU time for KMP2      0.25 sec, wall time      0.01 sec
E(KMP2) = -10.8006749953609  E_corr = -0.21882708371601
E(SCS-KMP2) = -10.7996116666068  E_corr = -0.217763754961939
E_corr(same-spin) = -0.0517254755737768
E_corr(oppo-spin) = -0.167101608142233
End time = Tue Jun  3 10:55:06 PM PDT 2025
