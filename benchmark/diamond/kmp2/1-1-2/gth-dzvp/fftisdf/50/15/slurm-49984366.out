SLURMD_NODENAME = hpc-34-35
Start time = Tue Jun  3 04:43:47 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-15/49984366/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-15/49984366/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/kmp2/1-1-2/gth-dzvp/fftisdf/50/15/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
lno_thresh: 3e-05
density_fitting_method: fftisdf-50-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-15
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 15.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1175, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 4913, selected grid size = 390
truncated values = 3.91e+01, estimated error = 7.94e-02
Number of interpolating points is 390.
    CPU time for building inpv_kpt      7.90 sec, wall time      1.22 sec

Out-core version is used for eta_kpt.
disk space required: 6.13e-02 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   6.13e-02 GB
memory needed for each k-point: 3.07e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      3.12 sec, wall time      0.10 sec
    CPU time for building eta_kpt      4.11 sec, wall time      0.13 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      7.38 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 2 / 2]      7.06 sec, wall time      0.23 sec
    CPU time for building coul_kpt     14.62 sec, wall time      0.47 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-15/49984366/9h4kq409


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-kmp2-1-1-2-gth-dzvp-fftisdf-50-15/49984366/tmp6ntlszez
max_memory 327680 MB (current use 330 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fea11b92770>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.35 sec, wall time      0.05 sec
E1 = (3.1148714406995848-2.391869657500131e-18j)  E_coul = (-5.359726440139776+2.1229207644357672e-17j)
init E= -15.0319841450644
    CPU time for initialize scf      3.11 sec, wall time      0.11 sec
HOMO = 0.634509917351  LUMO = 0.835945282885
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469818  0.58526499  0.63450383  0.63450992] [0.83594528 0.90520015 0.90520831 1.12044357 1.80070911 1.80070939
 1.86317373 2.07363893 2.09378908 2.09381989 2.63058769 2.6348149
 2.63483907 3.54992551 3.54993894 3.55203444 3.65113767 3.65113872
 4.20893587 4.72606047 4.72733092 4.72736684]
   1 ( 0.000  0.000  0.500)   [-0.84757513 -0.56898281  0.50108036  0.50108668] [0.96420342 1.03462996 1.03463862 1.35064349 1.61891648 1.75435812
 1.81734689 1.81735617 2.11624425 2.11624909 2.9427337  3.05298806
 3.05303427 3.09653267 3.09654776 3.29652279 3.64892169 3.64894439
 3.75824032 3.75827887 5.12904424 9.60211742]
    CPU time for vj and vk      1.30 sec, wall time      0.04 sec
E1 = (4.4117061031714-1.3117478830907314e-17j)  E_coul = (-2.192523781204539+6.060284389849009e-18j)
cycle= 1 E= -10.5679468236574  delta_E= 4.46  |g|= 0.33  |ddm|= 8.47
    CPU time for cycle= 1      1.70 sec, wall time      0.06 sec
HOMO = 0.365528897097  LUMO = 1.01778668575
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65436546  0.29043998  0.29044104  0.3655289 ] [1.01778669 1.03924361 1.03925129 1.36689525 1.82549457 1.82549565
 1.88183146 2.12847276 2.13624209 2.13627868 2.72586186 2.72590565
 2.73257222 3.56543619 3.5718214  3.57188132 3.71006317 3.71006519
 4.22695147 4.77818984 4.78315002 4.78320454]
   1 ( 0.000  0.000  0.500)   [-0.37093702 -0.25527539  0.1748845   0.17488856] [1.15340464 1.16988395 1.16989823 1.4038171  1.71098036 1.82289213
 1.85609326 1.8561288  2.13417785 2.13418517 3.01195603 3.13038198
 3.13041011 3.15967979 3.15971306 3.32337366 3.67517525 3.67521895
 3.81039655 3.81048595 5.20027811 9.893393  ]
    CPU time for vj and vk      1.28 sec, wall time      0.04 sec
E1 = (4.435231074761204-1.0791027255691095e-17j)  E_coul = (-2.22925630777796+6.294304746784069e-18j)
cycle= 2 E= -10.581154378641  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      1.78 sec, wall time      0.06 sec
HOMO = 0.351280460153  LUMO = 1.01859878051
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65659499  0.28428971  0.28429401  0.35128046] [1.01859878 1.03825804 1.03826611 1.36489626 1.8239829  1.82398539
 1.88257559 2.12799049 2.13564885 2.13568165 2.7200199  2.7200633
 2.72507618 3.56449333 3.57056223 3.57061826 3.70813343 3.70813605
 4.22258497 4.77632073 4.78081359 4.78087327]
   1 ( 0.000  0.000  0.500)   [-0.37617958 -0.26019011  0.17066241  0.1706673 ] [1.15179592 1.16897325 1.16898855 1.40672152 1.70616601 1.81703468
 1.85207758 1.85210931 2.13198161 2.131987   3.00785289 3.12925933
 3.12928491 3.15471209 3.15474278 3.32339779 3.67352595 3.6735671
 3.80798089 3.80806857 5.19450425 9.8693579 ]
    CPU time for vj and vk      1.31 sec, wall time      0.04 sec
E1 = (4.437443558011344-1.0951487992414115e-17j)  E_coul = (-2.2321332115776547+6.4162232909145355e-18j)
cycle= 3 E= -10.5818187991906  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.998
    CPU time for cycle= 3      1.80 sec, wall time      0.06 sec
HOMO = 0.351525087572  LUMO = 1.01949618091
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65591474  0.28499736  0.28500124  0.35152509] [1.01949618 1.03929505 1.03930296 1.36586126 1.82435462 1.82435696
 1.88249901 2.12829603 2.13592821 2.135961   2.72080927 2.7208528
 2.72589875 3.56481489 3.57074318 3.57079911 3.70879316 3.70879577
 4.22254766 4.77689937 4.7813517  4.78141104]
   1 ( 0.000  0.000  0.500)   [-0.37570688 -0.25961896  0.17157965  0.17158438] [1.15228048 1.16959693 1.169612   1.40684052 1.70675419 1.81796301
 1.85260057 1.85263253 2.13234145 2.13234667 3.00860338 3.129596
 3.12962162 3.15566967 3.15570045 3.32350573 3.67371512 3.67375657
 3.80849415 3.80858173 5.19497175 9.87147706]
    CPU time for vj and vk      1.27 sec, wall time      0.04 sec
E1 = (4.4372933923500035-1.1007923341352632e-17j)  E_coul = (-2.231991740312722+6.4343811474170584e-18j)
cycle= 4 E= -10.581827493587  delta_E= -8.69e-06  |g|= 0.000625  |ddm|= 0.111
    CPU time for cycle= 4      1.77 sec, wall time      0.06 sec
HOMO = 0.351493298735  LUMO = 1.01949689326
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593212  0.28497041  0.28497434  0.3514933 ] [1.01949689 1.03930351 1.03931142 1.36581298 1.8243564  1.82435871
 1.8825115  2.12831366 2.13593307 2.13596584 2.72079678 2.72084032
 2.72588139 3.56481746 3.57073981 3.57079574 3.7087936  3.70879622
 4.22253104 4.77690034 4.78134948 4.78140882]
   1 ( 0.000  0.000  0.500)   [-0.37571129 -0.25964085  0.17156592  0.17157069] [1.1522497  1.16960311 1.16961817 1.4068442  1.70674408 1.81793626
 1.85258712 1.85261905 2.1323354  2.13234058 3.00861349 3.12959386
 3.12961946 3.15566625 3.15569702 3.32351197 3.67371012 3.67375155
 3.80849585 3.80858342 5.19495489 9.87139554]
    CPU time for vj and vk      1.27 sec, wall time      0.04 sec
E1 = (4.4372851625745975-1.101207702694001e-17j)  E_coul = (-2.23198358794122+6.436447851147366e-18j)
cycle= 5 E= -10.5818275709909  delta_E= -7.74e-08  |g|= 6.04e-05  |ddm|= 0.0176
    CPU time for cycle= 5      1.76 sec, wall time      0.06 sec
HOMO = 0.351499231959  LUMO = 1.01950100539
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593036  0.28497266  0.28497659  0.35149923] [1.01950101 1.03930652 1.03931443 1.36581114 1.82435741 1.82435971
 1.8825114  2.12831214 2.13593351 2.13596627 2.72079946 2.72084301
 2.72588489 3.56481834 3.57074046 3.57079638 3.70879526 3.70879788
 4.22253151 4.77690176 4.78135093 4.78141028]
   1 ( 0.000  0.000  0.500)   [-0.37570978 -0.25963299  0.17156893  0.17157371] [1.15224755 1.16960356 1.16961862 1.4068423  1.70674487 1.81793872
 1.85258911 1.85262104 2.13233959 2.13234477 3.00861847 3.1295936
 3.1296192  3.15566785 3.15569862 3.32351081 3.67370983 3.67375127
 3.8084971  3.80858467 5.19495581 9.87140255]
    CPU time for vj and vk      1.25 sec, wall time      0.04 sec
E1 = (4.437282174868571-1.1018493492507522e-17j)  E_coul = (-2.231980600915678+6.438578300876856e-18j)
Extra cycle  E= -10.5818275716713  delta_E= -6.8e-10  |g|= 1.74e-05  |ddm|= 0.00149
    CPU time for scf_cycle     13.65 sec, wall time      0.45 sec
    CPU time for SCF     16.06 sec, wall time      0.54 sec
converged SCF energy = -10.5818275716713
**** SCF Summaries ****
Total Energy =                         -10.581827571671347
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437282174868571
Two-electron Energy =                   -2.231980600915678
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93330
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00905
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00170
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93327
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00908
pop of  1 C 2pz           1.00909
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      0.51 sec, wall time      0.02 sec

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 2
nocc = 4
nmo = 26
with_df_ints = False
max_memory 327680 MB (current use 541 MB)
    CPU time for KMP2      0.45 sec, wall time      0.01 sec
E(KMP2) = -10.8006136007483  E_corr = -0.218786029076941
E(SCS-KMP2) = -10.7995550331882  E_corr = -0.217727461516821
E_corr(same-spin) = -0.0517105077409706
E_corr(oppo-spin) = -0.16707552133597
End time = Tue Jun  3 04:43:50 PM PDT 2025
