SLURMD_NODENAME = hpc-52-34
Start time = Fri Jun  6 05:16:32 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-gth-dzvp-2-2-3-fftisdf-100-10-klno-1e-6/50042766/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-gth-dzvp-2-2-3-fftisdf-100-10-klno-1e-6/50042766/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/gth-dzvp/2-2-3/fftisdf-100-10/klno-1e-6/main.py with:
name: diamond
xc: None
kmesh: 2-2-3
basis: gth-dzvp
pseudo: gth-hf
lno_thresh: 1e-06
density_fitting_method: fftisdf-100-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-10
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 10.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 7.96515)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            1.77123
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.74269
pop of  0 C 2py           0.74269
pop of  0 C 2pz           0.74339
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            1.77123
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.74269
pop of  1 C 2py           0.74269
pop of  1 C 2pz           0.74339
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 12
tol = 1e-08
c0 = 10.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 3294, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 12167, selected grid size = 260
truncated values = 1.32e+02, estimated error = 1.12e+01
Number of interpolating points is 260.
    CPU time for building inpv_kpt     21.07 sec, wall time     14.37 sec

Out-core version is used for eta_kpt.
disk space required: 6.07e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   6.07e-01 GB
memory needed for each k-point: 5.06e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     17.02 sec, wall time      1.03 sec
    CPU time for building eta_kpt     19.00 sec, wall time      1.09 sec

Computing coul_kpt
    CPU time for coul_kpt[  1 / 12]      7.32 sec, wall time      0.23 sec
    CPU time for coul_kpt[  2 / 12]      7.19 sec, wall time      0.23 sec
    CPU time for coul_kpt[  3 / 12]      7.09 sec, wall time      0.22 sec
    CPU time for coul_kpt[  4 / 12]      7.05 sec, wall time      0.22 sec
    CPU time for coul_kpt[  5 / 12]      7.26 sec, wall time      0.23 sec
    CPU time for coul_kpt[  6 / 12]      7.45 sec, wall time      0.23 sec
    CPU time for coul_kpt[  7 / 12]     11.35 sec, wall time      0.37 sec
    CPU time for coul_kpt[  8 / 12]     11.83 sec, wall time      0.38 sec
    CPU time for coul_kpt[  9 / 12]      7.12 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 10 / 12]      6.91 sec, wall time      0.22 sec
    CPU time for coul_kpt[ 11 / 12]      7.22 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 12 / 12]      7.03 sec, wall time      0.22 sec
    CPU time for building coul_kpt     95.42 sec, wall time      3.04 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-gth-dzvp-2-2-3-fftisdf-100-10-klno-1e-6/50042766/pjfb7n6f


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-gth-dzvp-2-2-3-fftisdf-100-10-klno-1e-6/50042766/tmpx1x1nhji
max_memory 327680 MB (current use 486 MB)


******** PBC SCF flags ********
N kpts = 12
kpts = [[ 0.          0.          0.        ]
 [ 0.31072843  0.31072843 -0.31072843]
 [ 0.62145686  0.62145686 -0.62145686]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.77682107 -0.15536421  0.15536421]
 [ 1.0875495   0.15536421 -0.15536421]
 [-0.46609264  0.46609264  0.46609264]
 [-0.15536421  0.77682107  0.15536421]
 [ 0.15536421  1.0875495  -0.15536421]
 [ 0.          0.          0.93218529]
 [ 0.31072843  0.31072843  0.62145686]
 [ 0.62145686  0.62145686  0.31072843]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.2867143428668286
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.14685737147
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f6fc5026f80>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      4.52 sec, wall time      0.14 sec
E1 = (3.9213871941349567+1.0860357200341087e-17j)  E_coul = (-3.4893760082072705-1.4010075419331384e-17j)
init E= -12.3551179596966
