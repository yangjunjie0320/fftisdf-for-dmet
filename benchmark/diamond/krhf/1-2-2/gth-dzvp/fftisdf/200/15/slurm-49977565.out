SLURMD_NODENAME = hpc-35-12
Start time = Tue Jun  3 12:30:05 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49977565/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49977565/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/200/15/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-200-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-15
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 15.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2325, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 35937, selected grid size = 390
truncated values = 6.93e+01, estimated error = 9.09e-01
Number of interpolating points is 390.
    CPU time for building inpv_kpt     90.59 sec, wall time     82.59 sec

Out-core version is used for eta_kpt.
disk space required: 8.97e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   8.97e-01 GB
memory needed for each k-point: 2.24e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     19.73 sec, wall time      1.47 sec
    CPU time for building eta_kpt     24.11 sec, wall time      1.61 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      8.08 sec, wall time      1.05 sec
    CPU time for coul_kpt[ 2 / 4]      2.72 sec, wall time      0.95 sec
    CPU time for coul_kpt[ 3 / 4]      2.71 sec, wall time      0.95 sec
    CPU time for coul_kpt[ 4 / 4]      2.71 sec, wall time      0.95 sec
    CPU time for building coul_kpt     16.68 sec, wall time      3.93 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49977565/a52nkivi


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49977565/tmp0qb756pd
max_memory 327680 MB (current use 379 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f53b6752020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      6.76 sec, wall time      0.21 sec
E1 = (3.6045119533019316-1.8152825459909466e-18j)  E_coul = (-4.238142711651671-1.45041759682586e-17j)
init E= -13.420759903974
    CPU time for initialize scf     17.41 sec, wall time      0.56 sec
HOMO = 0.64214267842  LUMO = 0.776526797253
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97421941  0.60527119  0.60923949  0.64214268] [0.85981568 0.88582925 0.91020665 1.12518354 1.7909957  1.80523863
 1.86204779 2.08341681 2.08746649 2.09926929 2.64579568 2.6476843
 2.64897942 3.55319215 3.5539201  3.55481178 3.65952323 3.66027962
 4.21009158 4.73497208 4.73544962 4.73590587]
   1 (-0.000 -0.000  0.500)   [-0.78014491 -0.50847777  0.46133338  0.50284273] [0.94784386 1.0214354  1.04033174 1.35354633 1.62941904 1.75602065
 1.81457559 1.82410584 2.11261146 2.11924399 2.95658609 3.06753741
 3.06863619 3.10243061 3.10321115 3.30378332 3.64925662 3.65339616
 3.76726776 3.76777364 5.13915785 9.64993784]
   2 ( 0.000  0.500 -0.000)   [-0.78014499 -0.5084786   0.46133687  0.50283847] [0.94784984 1.02143367 1.0403338  1.3535482  1.62942028 1.75600411
 1.8145744  1.82410444 2.11260059 2.11925839 2.95659332 3.06753201
 3.0686457  3.10243534 3.10322291 3.30379935 3.64927212 3.6533931
 3.76725276 3.7677422  5.13916986 9.64993057]
   3 ( 0.000  0.500  0.500)   [-0.41688115 -0.40450288  0.22475506  0.31062667] [0.7765268  0.8413662  1.40153679 1.40350664 1.67779718 1.68164422
 2.07042816 2.07587765 2.31225685 2.31465011 2.79347575 2.80081884
 2.87064823 2.87950053 2.95490596 2.95599228 3.67413258 3.67560128
 5.04759903 5.04820877 6.80905781 6.81451302]
    CPU time for vj and vk      6.54 sec, wall time      0.21 sec
E1 = (4.1980385682322305+4.034478925758743e-19j)  E_coul = (-2.2326332350452236-2.937253656323417e-17j)
cycle= 1 E= -10.8217238124372  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      7.08 sec, wall time      0.22 sec
HOMO = 0.352237314253  LUMO = 0.898270734378
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169461  0.30154447  0.34068711  0.35223731] [0.97853089 0.99132835 1.01471778 1.3323201  1.80553556 1.80602727
 1.88404359 2.11998321 2.12199095 2.12539748 2.70809412 2.71166095
 2.71193591 3.56352704 3.56541779 3.56996315 3.69760061 3.70485633
 4.22156975 4.77136311 4.77269437 4.77464693]
   1 (-0.000 -0.000  0.500)   [-0.39621402 -0.25657104  0.18711207  0.22273184] [1.09292233 1.10500455 1.15031475 1.39711212 1.68430063 1.81148217
 1.84709484 1.85169409 2.11921119 2.12572815 3.00548695 3.12356761
 3.12501905 3.13809403 3.14099697 3.3210668  3.66802947 3.6680899
 3.79987386 3.80639688 5.18610698 9.83347325]
   2 ( 0.000  0.500 -0.000)   [-0.39621444 -0.25657448  0.18710348  0.22273699] [1.09292481 1.10499977 1.15030099 1.39711448 1.68430586 1.81146726
 1.84709725 1.85168396 2.11920314 2.12575022 3.00550717 3.12357103
 3.12505738 3.13808238 3.14102206 3.3210952  3.66802962 3.66810119
 3.79986339 3.80633693 5.18613413 9.8334733 ]
   3 ( 0.000  0.500  0.500)   [-0.25546338 -0.25121965  0.03954363  0.07508949] [0.89827073 0.95900235 1.50274512 1.50995708 1.74944697 1.76465177
 2.07047572 2.0721246  2.32315367 2.33068854 2.84348352 2.85143965
 2.88506858 2.88514604 2.98374577 2.98719424 3.73223957 3.73350172
 5.07638289 5.07985521 6.89785434 6.89894089]
    CPU time for vj and vk      6.81 sec, wall time      0.22 sec
E1 = (4.194227389011392+3.498711212172849e-18j)  E_coul = (-2.241294847274897-3.010501611993448e-17j)
cycle= 2 E= -10.8341966038877  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.06
    CPU time for cycle= 2      7.50 sec, wall time      0.24 sec
HOMO = 0.346095336643  LUMO = 0.903474885049
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976102  0.3000672   0.33520481  0.34609534] [0.9817695  0.9958075  1.01711379 1.33874869 1.80540827 1.80618997
 1.88485304 2.1206448  2.12310168 2.12643228 2.70747119 2.71029579
 2.71095631 3.56369973 3.56582697 3.56958127 3.69893284 3.70580908
 4.21945681 4.77239968 4.77329483 4.77515376]
   1 (-0.000 -0.000  0.500)   [-0.39587775 -0.25760463  0.18695765  0.21794661] [1.09765581 1.10850006 1.15152843 1.39895579 1.6850796  1.81193806
 1.84610015 1.85182475 2.11923189 2.12551592 3.00620519 3.12424973
 3.12523518 3.13883695 3.14125492 3.32159946 3.6676786  3.66834005
 3.80027194 3.80640315 5.18498879 9.82834084]
   2 ( 0.000  0.500 -0.000)   [-0.39587775 -0.25760824  0.1869491   0.21795043] [1.09765782 1.10849406 1.15151351 1.39895669 1.68508467 1.81192279
 1.84610343 1.8518198  2.11922399 2.1255392  3.00622396 3.12425444
 3.12526997 3.13882631 3.14127727 3.32162662 3.66769417 3.66833958
 3.80026152 3.80634825 5.18501664 9.82834003]
   3 ( 0.000  0.500  0.500)   [-0.25628311 -0.2520421   0.04009721  0.07062739] [0.90347489 0.95976935 1.50638283 1.5127853  1.7505396  1.76461937
 2.07001879 2.07150165 2.3233773  2.33115947 2.84350212 2.85178408
 2.88516894 2.8852701  2.98354085 2.98724245 3.73376184 3.73460027
 5.07646699 5.07912646 6.89470266 6.89635527]
    CPU time for vj and vk      6.59 sec, wall time      0.21 sec
E1 = (4.1934623267401765+3.885666585159291e-18j)  E_coul = (-2.2411237280545238-3.0317288814349406e-17j)
cycle= 3 E= -10.8347905469386  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.839
    CPU time for cycle= 3      7.29 sec, wall time      0.23 sec
HOMO = 0.346436723138  LUMO = 0.903779107327
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926079  0.30044107  0.33535898  0.34643672] [0.98225052 0.99638681 1.01756015 1.33932258 1.8056112  1.8063672
 1.88472157 2.12079396 2.12319701 2.12658161 2.70786188 2.71064375
 2.71139273 3.56380432 3.5659683  3.5696173  3.69924748 3.70608047
 4.21951006 4.77267605 4.77354172 4.77538682]
   1 (-0.000 -0.000  0.500)   [-0.3952739  -0.25726399  0.18742163  0.21819296] [1.09807099 1.10896151 1.15171976 1.39902792 1.68521992 1.81231085
 1.84631671 1.85206087 2.11943927 2.12559102 3.00654982 3.12448902
 3.12538354 3.13934267 3.14171313 3.32171541 3.66776361 3.668479
 3.80049923 3.80661056 5.18530257 9.82958888]
   2 ( 0.000  0.500 -0.000)   [-0.39527384 -0.25726766  0.18741306  0.21819682] [1.09807295 1.10895562 1.15170481 1.39902884 1.68522514 1.81229574
 1.84631999 1.85205608 2.11943114 2.12561405 3.0065686  3.1244937
 3.12541831 3.13933202 3.14173546 3.32174276 3.66777914 3.66847875
 3.80048897 3.80655557 5.18533012 9.8295881 ]
   3 ( 0.000  0.500  0.500)   [-0.25578991 -0.25163308  0.04051765  0.07090172] [0.90377911 0.95976333 1.50715997 1.51356395 1.75082638 1.76489072
 2.07010383 2.07151224 2.32348635 2.33139426 2.84384773 2.85207517
 2.8851801  2.88541505 2.98374071 2.9874683  3.73407414 3.73506076
 5.07671011 5.07930917 6.89522514 6.897048  ]
    CPU time for vj and vk      6.72 sec, wall time      0.21 sec
E1 = (4.19349134771952+3.865395637297803e-18j)  E_coul = (-2.2411554350703-3.0325972875180344e-17j)
cycle= 4 E= -10.834793232975  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0989
    CPU time for cycle= 4      7.39 sec, wall time      0.24 sec
HOMO = 0.34639281719  LUMO = 0.903765902632
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931394  0.30038369  0.33528272  0.34639282] [0.98222678 0.99635317 1.01752423 1.33926739 1.80559894 1.80634431
 1.88473526 2.12078423 2.12317577 2.12656877 2.70780572 2.71058575
 2.7113455  3.56379222 3.56595744 3.56959919 3.69921836 3.70605032
 4.21949326 4.77265162 4.77351292 4.77535765]
   1 (-0.000 -0.000  0.500)   [-0.39529487 -0.25733271  0.18737297  0.21812764] [1.09802901 1.10893252 1.15169556 1.39903335 1.68519078 1.81227065
 1.84627315 1.85202382 2.11943211 2.12556647 3.0065182  3.1244771
 3.12536625 3.13929095 3.14165821 3.3217076  3.66774427 3.66846987
 3.80046643 3.80657743 5.18526429 9.82941373]
   2 ( 0.000  0.500 -0.000)   [-0.39529483 -0.25733636  0.1873644   0.21813148] [1.09803096 1.10892661 1.15168062 1.39903428 1.685196   1.81225557
 1.84627642 1.85201909 2.11942399 2.12558952 3.00653699 3.12448176
 3.12540095 3.1392803  3.14168051 3.32173491 3.66775983 3.66846961
 3.80045618 3.80652248 5.18529182 9.82941293]
   3 ( 0.000  0.500  0.500)   [-0.25584818 -0.25168912  0.04046604  0.0708642 ] [0.9037659  0.95975484 1.50710838 1.51353187 1.75075955 1.76482978
 2.0700879  2.07150032 2.32346335 2.33137125 2.8438068  2.85203125
 2.88517077 2.88541167 2.98370902 2.98744941 3.734032   3.73502306
 5.07668679 5.07928041 6.89513305 6.89697092]
    CPU time for vj and vk      6.71 sec, wall time      0.21 sec
E1 = (4.193512841305292+3.864662634067328e-18j)  E_coul = (-2.241176974786885-3.0326409992312776e-17j)
cycle= 5 E= -10.8347932791058  delta_E= -4.61e-08  |g|= 8.46e-05  |ddm|= 0.00953
    CPU time for cycle= 5      7.52 sec, wall time      0.24 sec
HOMO = 0.346399801854  LUMO = 0.903767056274
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931117  0.30038461  0.33528325  0.3463998 ] [0.98222821 0.99635469 1.017525   1.33926905 1.80559959 1.80634502
 1.88473422 2.12078388 2.12317508 2.12656949 2.70780691 2.71058728
 2.71134877 3.56379275 3.56595808 3.56959912 3.69921917 3.70605102
 4.21949428 4.77265251 4.77351359 4.77535836]
   1 (-0.000 -0.000  0.500)   [-0.39528956 -0.2573299   0.18737403  0.21812862] [1.09802979 1.10893398 1.15169501 1.39903254 1.68519194 1.8122729
 1.84627383 1.8520251  2.11943494 2.12556677 3.00652036 3.12447813
 3.12536641 3.13929251 3.1416593  3.32170756 3.66774416 3.66847086
 3.80046646 3.80657788 5.1852661  9.82942149]
   2 ( 0.000  0.500 -0.000)   [-0.39528951 -0.25733356  0.18736546  0.21813246] [1.09803174 1.10892807 1.15168006 1.39903347 1.68519717 1.81225782
 1.84627709 1.85202036 2.11942682 2.12558982 3.00653915 3.12448278
 3.12540112 3.13928186 3.14168161 3.32173486 3.66775972 3.6684706
 3.80045622 3.80652293 5.18529363 9.8294207 ]
   3 ( 0.000  0.500  0.500)   [-0.25584461 -0.25168798  0.04046746  0.07086839] [0.90376706 0.95975441 1.50710996 1.51353658 1.7507599  1.76482868
 2.0700888  2.07150056 2.32346302 2.33137274 2.8438081  2.85203196
 2.88516983 2.88541304 2.9837096  2.98745099 3.73403174 3.73502544
 5.07668806 5.07928144 6.89513544 6.89697616]
    CPU time for vj and vk      6.84 sec, wall time      0.22 sec
E1 = (4.193513420297412+3.865466228752833e-18j)  E_coul = (-2.2411775546625337-3.032640001377835e-17j)
Extra cycle  E= -10.8347932799894  delta_E= -8.84e-10  |g|= 2.69e-05  |ddm|= 0.00139
    CPU time for scf_cycle     61.63 sec, wall time      1.97 sec
    CPU time for SCF     64.25 sec, wall time      2.06 sec
converged SCF energy = -10.8347932799894
**** SCF Summaries ****
Total Energy =                         -10.834793279989361
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193513420297412
Two-electron Energy =                   -2.241177554662534
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01166
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89511
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05198
pop of  1 C 2py           1.01164
pop of  1 C 2pz           1.01163
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00002
charge of    1C =      0.00002
    CPU time for vj and vk      0.85 sec, wall time      0.03 sec
End time = Tue Jun  3 12:31:37 PM PDT 2025
