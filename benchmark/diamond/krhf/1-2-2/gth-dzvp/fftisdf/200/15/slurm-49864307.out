SLURMD_NODENAME = hpc-35-02
Start time = Wed May 28 02:59:29 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49864307/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49864307/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/200/15/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-200-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-15
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 15.0
wrap_around = True

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2325, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 35937, selected grid size = 390
truncated values = 6.93e+01, estimated error = 9.09e-01
Number of interpolating points is 390.
    CPU time for building inpv_kpt     85.05 sec, wall time     76.85 sec

Out-core version is used for eta_kpt.
disk space required: 8.97e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   8.97e-01 GB
memory needed for each k-point: 2.24e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     18.96 sec, wall time      1.34 sec
    CPU time for building eta_kpt     23.42 sec, wall time      1.48 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      7.80 sec, wall time      0.91 sec
    CPU time for coul_kpt[ 2 / 4]      2.44 sec, wall time      0.86 sec
    CPU time for coul_kpt[ 3 / 4]      2.72 sec, wall time      1.19 sec
    CPU time for coul_kpt[ 4 / 4]      2.84 sec, wall time      1.26 sec
    CPU time for building coul_kpt     16.22 sec, wall time      4.23 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49864307/ds2i2bso


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-15/49864307/tmpbb9negqi
max_memory 327680 MB (current use 384 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f6461c32f50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      6.52 sec, wall time      0.21 sec
E1 = (3.604511953301932+7.024221899288094e-32j)  E_coul = (-4.238142712147924-1.672161699573204e-17j)
init E= -13.4207599044702
    CPU time for initialize scf     16.19 sec, wall time      0.52 sec
HOMO = 0.642142677865  LUMO = 0.776526797986
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97421941  0.60527119  0.60923949  0.64214268] [0.85981568 0.88582925 0.91020665 1.12518354 1.7909957  1.80523863
 1.86204779 2.08341679 2.08746649 2.0992693  2.64579567 2.64768431
 2.64897944 3.55319225 3.55392014 3.55481169 3.65952323 3.66027962
 4.21009161 4.73497201 4.73544967 4.735906  ]
   1 ( 0.000  0.000 -0.500)   [-0.78014491 -0.50847777  0.46133338  0.50284273] [0.94784386 1.0214354  1.04033174 1.35354634 1.62941904 1.75602066
 1.81457561 1.82410584 2.11261146 2.119244   2.95658609 3.06753741
 3.06863626 3.10243062 3.10321116 3.30378333 3.64925672 3.65339616
 3.76726773 3.7677737  5.13915784 9.64993798]
   2 (-0.000 -0.500  0.000)   [-0.78014499 -0.5084786   0.46133687  0.50283847] [0.94784984 1.02143367 1.0403338  1.35354819 1.62942028 1.75600411
 1.8145744  1.82410444 2.11260059 2.11925839 2.95659333 3.06753204
 3.0686457  3.10243536 3.10322292 3.30379936 3.64927207 3.65339307
 3.7672528  3.76774224 5.13916982 9.64993065]
   3 ( 0.000 -0.500 -0.500)   [-0.41688115 -0.40450288  0.22475506  0.31062667] [0.7765268  0.8413662  1.40153679 1.40350664 1.67779718 1.68164423
 2.07042815 2.07587768 2.31225685 2.31465011 2.79347574 2.80081888
 2.87064824 2.87950053 2.95490598 2.95599228 3.67413259 3.67560126
 5.04759922 5.04820922 6.80905781 6.81451312]
    CPU time for vj and vk      6.29 sec, wall time      0.20 sec
E1 = (4.198038567609195-7.661838553793602e-18j)  E_coul = (-2.2326332344767765-3.180611370680623e-17j)
cycle= 1 E= -10.8217238124918  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      6.80 sec, wall time      0.22 sec
HOMO = 0.352237314954  LUMO = 0.898270734177
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169461  0.30154447  0.34068711  0.35223731] [0.97853089 0.99132835 1.01471778 1.33232009 1.80553556 1.80602726
 1.8840436  2.1199832  2.12199095 2.12539751 2.70809414 2.71166096
 2.71193589 3.56352707 3.5654177  3.56996331 3.69760061 3.70485633
 4.22156968 4.77136296 4.77269447 4.77464709]
   1 ( 0.000  0.000 -0.500)   [-0.39621402 -0.25657104  0.18711207  0.22273184] [1.09292232 1.10500455 1.15031476 1.39711212 1.68430064 1.81148218
 1.84709488 1.8516941  2.1192112  2.12572817 3.00548698 3.12356763
 3.12501903 3.13809406 3.14099711 3.32106683 3.66802951 3.66809006
 3.79987396 3.80639706 5.18610698 9.83347359]
   2 (-0.000 -0.500  0.000)   [-0.39621444 -0.25657448  0.18710348  0.22273699] [1.09292481 1.10499977 1.150301   1.39711449 1.68430586 1.81146727
 1.84709724 1.85168397 2.11920315 2.12575022 3.00550719 3.12357106
 3.1250574  3.13808238 3.14102205 3.32109524 3.66802974 3.66810116
 3.79986346 3.80633696 5.18613404 9.83347357]
   3 ( 0.000 -0.500 -0.500)   [-0.25546338 -0.25121965  0.03954363  0.07508949] [0.89827073 0.95900235 1.50274511 1.50995709 1.74944696 1.76465178
 2.07047571 2.07212466 2.32315367 2.33068854 2.84348351 2.85143969
 2.88506863 2.88514605 2.98374578 2.98719423 3.73223958 3.73350172
 5.0763829  5.07985564 6.89785451 6.89894098]
    CPU time for vj and vk      6.26 sec, wall time      0.20 sec
E1 = (4.194227388603862-5.8371394195148725e-18j)  E_coul = (-2.2412948467331053-3.252528238661048e-17j)
cycle= 2 E= -10.8341966037535  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.06
    CPU time for cycle= 2      6.84 sec, wall time      0.22 sec
HOMO = 0.346095337896  LUMO = 0.903474884719
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976102  0.3000672   0.33520481  0.34609534] [0.98176949 0.9958075  1.0171138  1.33874869 1.80540828 1.80618997
 1.88485305 2.12064479 2.12310168 2.1264323  2.70747121 2.71029579
 2.7109563  3.56369975 3.56582689 3.56958142 3.69893284 3.70580908
 4.21945677 4.77239956 4.77329496 4.77515392]
   1 ( 0.000  0.000 -0.500)   [-0.39587775 -0.25760463  0.18695765  0.2179466 ] [1.09765581 1.10850006 1.15152843 1.3989558  1.6850796  1.81193806
 1.84610018 1.85182476 2.1192319  2.12551594 3.00620522 3.12424976
 3.12523517 3.13883698 3.14125504 3.32159948 3.66767878 3.6683401
 3.80027203 3.80640333 5.18498879 9.82834119]
   2 (-0.000 -0.500  0.000)   [-0.39587775 -0.25760824  0.1869491   0.21795042] [1.09765781 1.10849406 1.15151351 1.3989567  1.68508468 1.8119228
 1.84610342 1.85181981 2.11922399 2.1255392  3.00622398 3.12425447
 3.12526998 3.13882631 3.14127728 3.32162667 3.66769416 3.66833969
 3.80026159 3.80634828 5.18501655 9.82834029]
   3 ( 0.000 -0.500 -0.500)   [-0.25628311 -0.2520421   0.04009721  0.0706274 ] [0.90347488 0.95976935 1.50638282 1.51278531 1.75053958 1.76461939
 2.07001878 2.07150169 2.3233773  2.33115947 2.84350211 2.85178412
 2.88516899 2.8852701  2.98354086 2.98724244 3.73376185 3.73460026
 5.0764671  5.0791273  6.89470282 6.89635536]
    CPU time for vj and vk      6.28 sec, wall time      0.20 sec
E1 = (4.193462325805145-5.38304336663601e-18j)  E_coul = (-2.241123726968467-3.273071189101962e-17j)
cycle= 3 E= -10.8347905467876  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.839
    CPU time for cycle= 3      6.88 sec, wall time      0.22 sec
HOMO = 0.346436724539  LUMO = 0.903779107034
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926079  0.30044107  0.33535898  0.34643672] [0.98225052 0.99638681 1.01756015 1.33932258 1.80561121 1.8063672
 1.88472158 2.12079394 2.12319701 2.12658164 2.70786191 2.71064376
 2.71139271 3.56380434 3.56596822 3.56961745 3.69924748 3.70608047
 4.21951001 4.77267592 4.77354185 4.77538699]
   1 ( 0.000  0.000 -0.500)   [-0.3952739  -0.25726399  0.18742163  0.21819296] [1.09807099 1.10896151 1.15171977 1.39902793 1.68521992 1.81231085
 1.84631674 1.85206087 2.11943928 2.12559104 3.00654984 3.12448905
 3.12538353 3.13934269 3.14171326 3.32171544 3.6677638  3.66847905
 3.80049933 3.80661073 5.18530257 9.82958923]
   2 (-0.000 -0.500  0.000)   [-0.39527384 -0.25726766  0.18741306  0.21819682] [1.09807295 1.10895562 1.15170482 1.39902885 1.68522515 1.81229575
 1.84631998 1.85205609 2.11943114 2.12561405 3.00656862 3.12449373
 3.12541832 3.13933202 3.14173546 3.32174281 3.66777913 3.66847886
 3.80048904 3.80655561 5.18533003 9.82958837]
   3 ( 0.000 -0.500 -0.500)   [-0.25578991 -0.25163308  0.04051765  0.07090172] [0.90377911 0.95976334 1.50715997 1.51356396 1.75082637 1.76489074
 2.07010382 2.07151228 2.32348635 2.33139426 2.84384772 2.85207521
 2.88518015 2.88541506 2.98374073 2.98746829 3.73407415 3.73506075
 5.07671023 5.07931003 6.89522529 6.89704809]
    CPU time for vj and vk      6.25 sec, wall time      0.20 sec
E1 = (4.193491346825441-5.349227672294535e-18j)  E_coul = (-2.2411554340256346-3.273872288515923e-17j)
cycle= 4 E= -10.8347932328244  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0989
    CPU time for cycle= 4      6.86 sec, wall time      0.22 sec
HOMO = 0.346392818602  LUMO = 0.903765902327
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931394  0.30038369  0.33528272  0.34639282] [0.98222678 0.99635317 1.01752423 1.33926738 1.80559894 1.8063443
 1.88473527 2.12078421 2.12317577 2.12656879 2.70780575 2.71058575
 2.71134548 3.56379224 3.56595736 3.56959935 3.69921836 3.70605032
 4.21949321 4.77265149 4.77351305 4.77535782]
   1 ( 0.000  0.000 -0.500)   [-0.39529487 -0.2573327   0.18737297  0.21812764] [1.098029   1.10893252 1.15169557 1.39903335 1.68519078 1.81227066
 1.84627318 1.85202383 2.11943212 2.12556649 3.00651823 3.12447713
 3.12536624 3.13929098 3.14165833 3.32170762 3.66774445 3.66846991
 3.80046652 3.8065776  5.1852643  9.82941408]
   2 (-0.000 -0.500  0.000)   [-0.39529483 -0.25733636  0.1873644   0.21813148] [1.09803095 1.10892661 1.15168062 1.39903429 1.68519601 1.81225558
 1.84627641 1.8520191  2.119424   2.12558953 3.00653701 3.12448179
 3.12540096 3.13928031 3.14168051 3.32173496 3.66775982 3.66846972
 3.80045625 3.80652251 5.18529173 9.8294132 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25584818 -0.25168912  0.04046604  0.0708642 ] [0.9037659  0.95975484 1.50710837 1.51353188 1.75075954 1.76482979
 2.07008789 2.07150036 2.32346335 2.33137125 2.84380679 2.85203129
 2.88517082 2.88541167 2.98370903 2.9874494  3.73403201 3.73502305
 5.07668692 5.07928128 6.89513321 6.89697101]
    CPU time for vj and vk      6.29 sec, wall time      0.20 sec
E1 = (4.193512840420681-5.346586907677681e-18j)  E_coul = (-2.241176973751707-3.2739092833683534e-17j)
cycle= 5 E= -10.8347932789553  delta_E= -4.61e-08  |g|= 8.46e-05  |ddm|= 0.00953
    CPU time for cycle= 5      6.85 sec, wall time      0.22 sec
HOMO = 0.34639980327  LUMO = 0.903767055968
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931117  0.30038461  0.33528325  0.3463998 ] [0.98222821 0.99635469 1.017525   1.33926905 1.80559959 1.80634501
 1.88473423 2.12078387 2.12317508 2.12656952 2.70780694 2.71058728
 2.71134875 3.56379277 3.565958   3.56959928 3.69921917 3.70605102
 4.21949424 4.77265239 4.77351372 4.77535853]
   1 ( 0.000  0.000 -0.500)   [-0.39528956 -0.2573299   0.18737403  0.21812862] [1.09802979 1.10893398 1.15169501 1.39903254 1.68519195 1.8122729
 1.84627386 1.8520251  2.11943494 2.12556679 3.00652038 3.12447815
 3.12536641 3.13929254 3.14165943 3.32170758 3.66774435 3.6684709
 3.80046656 3.80657805 5.1852661  9.82942184]
   2 (-0.000 -0.500  0.000)   [-0.39528951 -0.25733356  0.18736546  0.21813246] [1.09803174 1.10892807 1.15168007 1.39903348 1.68519717 1.81225783
 1.84627709 1.85202037 2.11942683 2.12558982 3.00653917 3.12448281
 3.12540113 3.13928186 3.14168161 3.32173491 3.66775971 3.66847071
 3.80045629 3.80652296 5.18529354 9.82942096]
   3 ( 0.000 -0.500 -0.500)   [-0.25584461 -0.25168798  0.04046746  0.07086839] [0.90376706 0.95975441 1.50710995 1.51353659 1.75075988 1.76482869
 2.0700888  2.0715006  2.32346302 2.33137274 2.84380809 2.852032
 2.88516988 2.88541305 2.98370961 2.98745098 3.73403175 3.73502543
 5.07668819 5.07928231 6.89513559 6.89697626]
    CPU time for vj and vk      6.24 sec, wall time      0.20 sec
E1 = (4.19351341941433-5.347018196715409e-18j)  E_coul = (-2.241177553628889-3.2739070246164247e-17j)
Extra cycle  E= -10.8347932798388  delta_E= -8.84e-10  |g|= 2.69e-05  |ddm|= 0.00139
    CPU time for scf_cycle     57.21 sec, wall time      1.83 sec
    CPU time for SCF     59.88 sec, wall time      1.92 sec
converged SCF energy = -10.8347932798388
**** SCF Summaries ****
Total Energy =                         -10.834793279838799
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193513419414330
Two-electron Energy =                   -2.241177553628889
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01166
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89511
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05198
pop of  1 C 2py           1.01164
pop of  1 C 2pz           1.01163
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00002
charge of    1C =      0.00002
    CPU time for vj and vk      0.70 sec, wall time      0.02 sec
End time = Wed May 28 03:00:56 PM PDT 2025
