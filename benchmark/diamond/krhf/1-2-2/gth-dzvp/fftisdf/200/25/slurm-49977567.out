SLURMD_NODENAME = hpc-52-41
Start time = Tue Jun  3 12:30:11 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49977567/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49977567/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/200/25/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-200-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-25
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 25.0
wrap_around = False

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2325, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 35937, selected grid size = 650
truncated values = 7.01e+01, estimated error = 1.26e-01
Number of interpolating points is 650.
    CPU time for building inpv_kpt     88.30 sec, wall time     80.25 sec

Out-core version is used for eta_kpt.
disk space required: 1.49e+00 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   1.49e+00 GB
memory needed for each k-point: 3.74e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     21.98 sec, wall time      2.29 sec
    CPU time for building eta_kpt     26.36 sec, wall time      2.43 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     10.09 sec, wall time      2.26 sec
    CPU time for coul_kpt[ 2 / 4]      4.85 sec, wall time      2.29 sec
    CPU time for coul_kpt[ 3 / 4]      5.55 sec, wall time      3.11 sec
    CPU time for coul_kpt[ 4 / 4]      5.44 sec, wall time      2.94 sec
    CPU time for building coul_kpt     26.97 sec, wall time     10.65 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49977567/iez4bilp


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49977567/tmpg9hrf6gh
max_memory 327680 MB (current use 394 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fd8c41f2020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      8.35 sec, wall time      0.26 sec
E1 = (3.6045119533019325-1.3837524828337702e-31j)  E_coul = (-4.23815125782808+2.937750650579624e-17j)
init E= -13.4207684501504
    CPU time for initialize scf     15.94 sec, wall time      0.51 sec
HOMO = 0.642148744423  LUMO = 0.776528055727
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422403  0.60527274  0.60923119  0.64214874] [0.85981241 0.88582618 0.91020203 1.12520367 1.79100339 1.80523343
 1.86205216 2.08341655 2.0874847  2.09925124 2.64579556 2.64766547
 2.64895258 3.5531952  3.55392269 3.55480283 3.6595084  3.66029205
 4.21012051 4.73494958 4.73542357 4.73597035]
   1 (-0.000 -0.000  0.500)   [-0.78015265 -0.50848299  0.4613311   0.50284984] [0.94785989 1.0214325  1.04032661 1.35354583 1.62942668 1.75601358
 1.81456889 1.82408306 2.11260153 2.1192539  2.95658604 3.06755044
 3.06862968 3.10243303 3.10320857 3.30379437 3.64927441 3.65340732
 3.76724507 3.76776123 5.13917422 9.64996254]
   2 ( 0.000  0.500 -0.000)   [-0.78015244 -0.50848288  0.461331    0.50284996] [0.94785961 1.02143188 1.04032679 1.35354563 1.62942662 1.7560126
 1.81456853 1.82408297 2.11260215 2.11925364 2.95658682 3.0675486
 3.06862966 3.10243363 3.10320889 3.30379436 3.64927464 3.65340371
 3.76724528 3.76775984 5.13917525 9.64996395]
   3 ( 0.000  0.500  0.500)   [-0.41689387 -0.40450184  0.22475877  0.31063577] [0.77652806 0.84136816 1.401534   1.40349572 1.67780151 1.68166155
 2.0704321  2.07586524 2.31225621 2.31465187 2.79346738 2.80079922
 2.87065897 2.87949542 2.95490372 2.95599459 3.67413146 3.67560583
 5.04761076 5.04822776 6.80908747 6.81454534]
    CPU time for vj and vk      8.67 sec, wall time      0.28 sec
E1 = (4.198022058964292-3.5383192500825054e-19j)  E_coul = (-2.232609668398925+2.917072795390322e-17j)
cycle= 1 E= -10.8217167550589  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      9.21 sec, wall time      0.29 sec
HOMO = 0.352246216444  LUMO = 0.898271445093
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169535  0.30156399  0.34067984  0.35224622] [0.97853053 0.99133827 1.01471944 1.33231927 1.80554188 1.80602116
 1.88404481 2.11998634 2.12202863 2.12540079 2.70808137 2.71167062
 2.71194099 3.5635341  3.56540787 3.56997595 3.69759027 3.70486826
 4.22159813 4.77131532 4.77264331 4.77473708]
   1 (-0.000 -0.000  0.500)   [-0.39621909 -0.2565763   0.18712824  0.22273336] [1.09293323 1.10500466 1.1503117  1.39709874 1.68430074 1.81150158
 1.84709012 1.85165896 2.11920494 2.12573887 3.00549505 3.12357679
 3.12503059 3.1381207  3.14101283 3.32109359 3.66804317 3.66810293
 3.79986036 3.80638997 5.18613437 9.83351645]
   2 ( 0.000  0.500 -0.000)   [-0.3962188  -0.25657621  0.18712842  0.22273343] [1.09293274 1.10500563 1.15031079 1.39709888 1.68430094 1.8114991
 1.8470902  1.85165906 2.1192052  2.12573827 3.00549491 3.12357701
 3.12502911 3.13811982 3.14101223 3.32109377 3.66803617 3.66810303
 3.79985984 3.80638847 5.18613392 9.83351717]
   3 ( 0.000  0.500  0.500)   [-0.25545708 -0.25123123  0.03956542  0.07509131] [0.89827145 0.95900097 1.50274157 1.50995551 1.74944597 1.76464519
 2.07049156 2.07210818 2.32316361 2.3306823  2.84347558 2.85143124
 2.88508009 2.88514462 2.98375315 2.98719733 3.73224068 3.7335025
 5.07640115 5.07992815 6.89787998 6.89899944]
    CPU time for vj and vk      8.35 sec, wall time      0.26 sec
E1 = (4.194213126267001+4.0383707982929e-18j)  E_coul = (-2.241273405136801+2.98993934110031e-17j)
cycle= 2 E= -10.834189424494  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      9.03 sec, wall time      0.29 sec
HOMO = 0.346103853241  LUMO = 0.903473990221
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976247  0.30008687  0.33519638  0.34610385] [0.98176877 0.9958175  1.01711476 1.33874664 1.80541296 1.8061839
 1.88485523 2.12064941 2.12313792 2.12643598 2.70746014 2.71030383
 2.71096031 3.56370513 3.56581707 3.56959206 3.69892233 3.70582098
 4.21948207 4.77235428 4.77325182 4.77523737]
   1 (-0.000 -0.000  0.500)   [-0.39588304 -0.25760993  0.18697331  0.21794663] [1.09766525 1.10849965 1.15152521 1.39894069 1.68507948 1.8119548
 1.84609338 1.85179346 2.11922561 2.12552717 3.00621397 3.12425786
 3.12524608 3.13886214 3.14126913 3.32162547 3.66769305 3.66834976
 3.80026023 3.80639808 5.18501669 9.8283807 ]
   2 ( 0.000  0.500 -0.000)   [-0.39588281 -0.25760991  0.18697343  0.21794672] [1.09766479 1.1085006  1.15152429 1.39894078 1.68507962 1.81195243
 1.84609336 1.85179352 2.11922591 2.1255265  3.00621387 3.12425812
 3.12524449 3.13886147 3.14126862 3.3216257  3.66769323 3.66834276
 3.80025974 3.8063969  5.18501605 9.82838145]
   3 ( 0.000  0.500  0.500)   [-0.25627755 -0.25205359  0.04011978  0.07062982] [0.90347399 0.9597677  1.50638087 1.51278435 1.75053797 1.76461225
 2.0700351  2.07148657 2.32338718 2.33115211 2.84349371 2.85177556
 2.88518018 2.88526952 2.98354849 2.98724597 3.73376292 3.73460137
 5.07648882 5.07919429 6.89472859 6.89641304]
    CPU time for vj and vk      8.18 sec, wall time      0.26 sec
E1 = (4.193448114808057+4.763961462330474e-18j)  E_coul = (-2.2411023383296547+3.011310411296809e-17j)
cycle= 3 E= -10.8347833691458  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      8.85 sec, wall time      0.28 sec
HOMO = 0.346445374274  LUMO = 0.903778323961
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926224  0.30046082  0.33535054  0.34644537] [0.98224985 0.99639687 1.01756128 1.33932041 1.80561614 1.80636105
 1.88472388 2.12079851 2.12323333 2.12658527 2.70785077 2.71065197
 2.71139687 3.56380985 3.56595856 3.56962815 3.6992371  3.70609233
 4.21953559 4.77263039 4.77349862 4.7754707 ]
   1 (-0.000 -0.000  0.500)   [-0.39527919 -0.25726917  0.18743743  0.21819292] [1.0980805  1.10896116 1.15171648 1.39901273 1.68521988 1.81232786
 1.84631001 1.85202958 2.11943301 2.12560223 3.0065587  3.12449748
 3.12539432 3.13936788 3.14172736 3.32174154 3.66777822 3.66848873
 3.80048782 3.80660545 5.18533035 9.82962887]
   2 ( 0.000  0.500 -0.000)   [-0.39527896 -0.25726915  0.18743755  0.21819302] [1.09808004 1.10896211 1.15171556 1.39901281 1.68522002 1.8123255
 1.84631    1.85202964 2.11943331 2.12560156 3.00655858 3.12449773
 3.12539272 3.13936721 3.14172684 3.32174177 3.66777839 3.66848176
 3.80048735 3.80660427 5.18532971 9.82962961]
   3 ( 0.000  0.500  0.500)   [-0.25578428 -0.25164468  0.04054019  0.07090422] [0.90377832 0.95976169 1.50715819 1.51356302 1.75082481 1.7648835
 2.07012015 2.07149722 2.3234961  2.33138696 2.84383945 2.8520666
 2.88519147 2.88541453 2.98374841 2.98747182 3.73407509 3.7350622
 5.07673178 5.07937647 6.89525111 6.89710609]
    CPU time for vj and vk      7.94 sec, wall time      0.25 sec
E1 = (4.193477233681354+4.778888697816597e-18j)  E_coul = (-2.2411341438891625+3.012330897710851e-17j)
cycle= 4 E= -10.834786055832  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      8.61 sec, wall time      0.27 sec
HOMO = 0.346401429772  LUMO = 0.90376511968
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931539  0.30040346  0.33527426  0.34640143] [0.9822261  0.99636324 1.01752536 1.33926521 1.80560388 1.80633815
 1.88473758 2.12078878 2.12321206 2.12657242 2.70779464 2.71059393
 2.71134963 3.56379775 3.5659477  3.56961004 3.69920798 3.70606217
 4.21951878 4.77260597 4.77346986 4.77544149]
   1 (-0.000 -0.000  0.500)   [-0.39530016 -0.25733789  0.18738879  0.21812758] [1.09803849 1.10893216 1.15169229 1.39901818 1.68519072 1.81228764
 1.84626642 1.85199258 2.11942586 2.12557768 3.00652709 3.12448555
 3.12537703 3.13931613 3.14167241 3.32173372 3.66775888 3.66847956
 3.80045503 3.80657234 5.18529204 9.82945361]
   2 ( 0.000  0.500 -0.000)   [-0.39529993 -0.25733787  0.1873889   0.21812767] [1.09803804 1.10893311 1.15169137 1.39901825 1.68519086 1.81228528
 1.84626641 1.85199264 2.11942616 2.12557701 3.00652698 3.1244858
 3.12537543 3.13931546 3.14167189 3.32173395 3.66775905 3.66847259
 3.80045455 3.80657115 5.1852914  9.82945435]
   3 ( 0.000  0.500  0.500)   [-0.25584257 -0.25170072  0.0404886   0.07086669] [0.90376512 0.95975321 1.50710663 1.51353092 1.75075793 1.76482254
 2.0701042  2.07148533 2.32347309 2.33136394 2.84379851 2.85202266
 2.88518215 2.88541115 2.98371671 2.98745292 3.73403296 3.73502448
 5.07670844 5.07934761 6.89515904 6.89702892]
    CPU time for vj and vk      7.89 sec, wall time      0.25 sec
E1 = (4.193498731701437+4.7804745951083566e-18j)  E_coul = (-2.2411556880598886+3.012374349966844e-17j)
cycle= 5 E= -10.8347861019827  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00954
    CPU time for cycle= 5      8.53 sec, wall time      0.27 sec
HOMO = 0.346408418546  LUMO = 0.903766277598
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931262  0.30040438  0.33527478  0.34640842] [0.98222753 0.99636476 1.01752614 1.33926688 1.80560453 1.80633886
 1.88473654 2.12078843 2.12321137 2.12657315 2.70779583 2.71059546
 2.7113529  3.56379827 3.56594834 3.56960997 3.69920879 3.70606287
 4.21951981 4.77260686 4.77347053 4.7754422 ]
   1 (-0.000 -0.000  0.500)   [-0.39529485 -0.25733508  0.18738985  0.21812857] [1.09803928 1.10893362 1.15169173 1.39901737 1.68519189 1.81228988
 1.8462671  1.85199385 2.11942869 2.12557798 3.00652925 3.12448657
 3.12537719 3.13931769 3.14167351 3.32173368 3.66775877 3.66848056
 3.80045506 3.80657278 5.18529385 9.82946139]
   2 ( 0.000  0.500 -0.000)   [-0.39529461 -0.25733506  0.18738997  0.21812866] [1.09803883 1.10893457 1.15169082 1.39901744 1.68519203 1.81228752
 1.84626709 1.85199391 2.11942899 2.1255773  3.00652913 3.12448682
 3.12537559 3.13931702 3.14167299 3.32173391 3.66775894 3.66847358
 3.80045459 3.8065716  5.18529321 9.82946213]
   3 ( 0.000  0.500  0.500)   [-0.255839   -0.25169958  0.04049001  0.07087088] [0.90376628 0.95975278 1.50710821 1.51353563 1.75075828 1.76482144
 2.07010511 2.07148557 2.32347276 2.33136543 2.84379982 2.85202338
 2.88518121 2.88541253 2.98371729 2.9874545  3.73403268 3.73502687
 5.07670971 5.07934864 6.89516141 6.89703419]
    CPU time for vj and vk      8.03 sec, wall time      0.25 sec
E1 = (4.193499307789833+4.780910427615954e-18j)  E_coul = (-2.2411562650274086+3.012374674475024e-17j)
Extra cycle  E= -10.8347861028618  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     68.86 sec, wall time      2.19 sec
    CPU time for SCF     71.43 sec, wall time      2.28 sec
converged SCF energy = -10.8347861028618
**** SCF Summaries ****
Total Energy =                         -10.834786102861816
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193499307789833
Two-electron Energy =                   -2.241156265027409
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      2.07 sec, wall time      0.07 sec
End time = Tue Jun  3 12:31:49 PM PDT 2025
