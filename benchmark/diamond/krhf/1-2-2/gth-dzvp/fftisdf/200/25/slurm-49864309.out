SLURMD_NODENAME = hpc-34-23
Start time = Wed May 28 03:00:19 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49864309/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49864309/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/200/25/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-200-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-200-25
ke_cutoff = 200.0, mesh = [33 33 33]
Using ke_cutoff = 200.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 25.0
wrap_around = True

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2325, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 35937, selected grid size = 650
truncated values = 7.01e+01, estimated error = 1.26e-01
Number of interpolating points is 650.
    CPU time for building inpv_kpt     88.13 sec, wall time     79.92 sec

Out-core version is used for eta_kpt.
disk space required: 1.49e+00 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   1.49e+00 GB
memory needed for each k-point: 3.74e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     22.61 sec, wall time      2.29 sec
    CPU time for building eta_kpt     27.01 sec, wall time      2.43 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      9.86 sec, wall time      2.12 sec
    CPU time for coul_kpt[ 2 / 4]      4.37 sec, wall time      2.11 sec
    CPU time for coul_kpt[ 3 / 4]      4.67 sec, wall time      2.16 sec
    CPU time for coul_kpt[ 4 / 4]      4.85 sec, wall time      2.19 sec
    CPU time for building coul_kpt     24.76 sec, wall time      8.61 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49864309/3kml2s3p


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-200-25/49864309/tmpsln7292h
max_memory 327680 MB (current use 393 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f5910f46f50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      7.61 sec, wall time      0.24 sec
E1 = (3.604511953301932+2.981125334991222e-32j)  E_coul = (-4.238151259485173+2.5534948836132775e-17j)
init E= -13.4207684518075
    CPU time for initialize scf     14.92 sec, wall time      0.48 sec
HOMO = 0.642148741062  LUMO = 0.776528064823
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422403  0.60527274  0.60923119  0.64214874] [0.8598124  0.88582618 0.91020202 1.12520367 1.79100339 1.80523343
 1.86205218 2.08341647 2.08748466 2.09925115 2.64579567 2.64766543
 2.64895241 3.55319478 3.55392256 3.55480273 3.65950839 3.66029203
 4.21012099 4.73494987 4.73542402 4.73596899]
   1 ( 0.000  0.000 -0.500)   [-0.78015265 -0.50848299  0.4613311   0.50284984] [0.94785989 1.02143249 1.04032661 1.35354582 1.6294267  1.75601349
 1.81456896 1.82408301 2.11260151 2.11925386 2.9565861  3.06755029
 3.06862947 3.10243314 3.10320845 3.30379437 3.64927433 3.6534072
 3.76724488 3.76776097 5.13917274 9.64996383]
   2 (-0.000 -0.500  0.000)   [-0.78015244 -0.50848288  0.461331    0.50284996] [0.94785962 1.02143187 1.04032679 1.35354563 1.62942662 1.7560125
 1.81456854 1.82408293 2.11260217 2.11925362 2.95658684 3.06754868
 3.06862934 3.10243351 3.10320884 3.30379435 3.64927452 3.65340373
 3.76724514 3.76775933 5.1391752  9.64996401]
   3 ( 0.000 -0.500 -0.500)   [-0.41689387 -0.40450184  0.22475878  0.31063577] [0.77652806 0.84136814 1.40153403 1.40349571 1.67780151 1.68166156
 2.07043211 2.07586511 2.31225622 2.31465187 2.79346737 2.80079905
 2.87065883 2.87949542 2.95490367 2.95599444 3.67413149 3.67560583
 5.04760635 5.04822316 6.80908718 6.81454492]
    CPU time for vj and vk      7.70 sec, wall time      0.24 sec
E1 = (4.198022059982227-4.60493372315584e-18j)  E_coul = (-2.232609678375519+2.5668368113779924e-17j)
cycle= 1 E= -10.8217167640175  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      8.56 sec, wall time      0.27 sec
HOMO = 0.352246205235  LUMO = 0.898271453963
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169535  0.30156398  0.34067983  0.35224621] [0.97853052 0.99133825 1.01471944 1.33231931 1.80554188 1.80602116
 1.88404485 2.11998645 2.1220286  2.1254009  2.70808119 2.71167069
 2.711941   3.56353381 3.56540853 3.5699761  3.69759025 3.70486823
 4.22159868 4.77131491 4.77264439 4.77473671]
   1 ( 0.000  0.000 -0.500)   [-0.39621909 -0.2565763   0.18712824  0.22273334] [1.09293322 1.10500468 1.1503117  1.39709884 1.68430079 1.81150161
 1.84709028 1.85165896 2.11920488 2.12573883 3.00549512 3.12357685
 3.1250304  3.13812049 3.14101275 3.32109369 3.66804356 3.66810284
 3.79985995 3.80639028 5.18613438 9.83351781]
   2 (-0.000 -0.500  0.000)   [-0.3962188  -0.25657621  0.18712842  0.22273343] [1.09293275 1.10500563 1.15031075 1.3970987  1.68430094 1.8114988
 1.84709012 1.85165915 2.1192052  2.12573825 3.00549487 3.12357661
 3.12502914 3.13811967 3.14101188 3.32109366 3.66803679 3.66810152
 3.79985961 3.80638784 5.1861335  9.83351753]
   3 ( 0.000 -0.500 -0.500)   [-0.25545708 -0.25123124  0.03956543  0.07509131] [0.89827145 0.95900094 1.50274155 1.50995553 1.74944598 1.76464525
 2.07049155 2.07210804 2.32316361 2.33068231 2.8434755  2.85143105
 2.88507986 2.88514461 2.98375328 2.98719728 3.73224073 3.73350245
 5.07639886 5.07992808 6.89787971 6.89899839]
    CPU time for vj and vk      7.80 sec, wall time      0.25 sec
E1 = (4.1942131351017276-5.883612344344599e-18j)  E_coul = (-2.241273422782798+2.6239234286464117e-17j)
cycle= 2 E= -10.8341894333053  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      8.61 sec, wall time      0.27 sec
HOMO = 0.34610384095  LUMO = 0.903473999034
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976247  0.30008686  0.33519637  0.34610384] [0.98176877 0.99581748 1.01711476 1.33874667 1.80541296 1.8061839
 1.88485527 2.12064949 2.12313789 2.12643611 2.70746    2.71030385
 2.71096033 3.5637048  3.56581772 3.56959232 3.69892233 3.70582093
 4.21948256 4.77235376 4.77325245 4.77523686]
   1 ( 0.000  0.000 -0.500)   [-0.39588305 -0.25760993  0.1869733   0.21794661] [1.09766524 1.10849967 1.15152521 1.39894078 1.68507952 1.81195483
 1.84609355 1.85179348 2.11922556 2.12552713 3.00621403 3.12425793
 3.12524594 3.13886194 3.14126907 3.32162557 3.66769284 3.66835045
 3.80025988 3.80639839 5.18501673 9.82838183]
   2 (-0.000 -0.500  0.000)   [-0.39588281 -0.25760991  0.18697343  0.21794672] [1.0976648  1.1085006  1.15152425 1.39894061 1.68507963 1.81195214
 1.84609328 1.85179358 2.11922591 2.12552649 3.00621384 3.12425776
 3.12524451 3.1388613  3.14126829 3.32162561 3.66769177 3.66834334
 3.80025956 3.80639634 5.18501581 9.8283817 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25627755 -0.2520536   0.04011978  0.07062982] [0.903474   0.95976768 1.50638085 1.51278436 1.75053798 1.76461231
 2.0700351  2.07148644 2.32338718 2.33115211 2.84349362 2.85177538
 2.88517997 2.88526954 2.98354863 2.98724595 3.73376294 3.7346013
 5.07648705 5.07919591 6.89472826 6.89641202]
    CPU time for vj and vk      7.77 sec, wall time      0.25 sec
E1 = (4.193448124259769-5.9320787754550994e-18j)  E_coul = (-2.2411023565615737+2.640958524110694e-17j)
cycle= 3 E= -10.834783377926  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      9.18 sec, wall time      0.29 sec
HOMO = 0.34644536205  LUMO = 0.903778332764
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926224  0.30046082  0.33535053  0.34644536] [0.98224985 0.99639686 1.01756128 1.33932044 1.80561614 1.80636106
 1.88472392 2.1207986  2.12323331 2.1265854  2.70785063 2.710652
 2.71139688 3.56380952 3.56595921 3.56962841 3.69923709 3.70609228
 4.21953607 4.77262991 4.77349927 4.77547021]
   1 ( 0.000  0.000 -0.500)   [-0.3952792  -0.25726917  0.18743742  0.21819291] [1.09808049 1.10896117 1.15171648 1.39901282 1.68521992 1.81232788
 1.84631018 1.8520296  2.11943295 2.12560219 3.00655876 3.12449755
 3.12539418 3.13936767 3.1417273  3.32174164 3.66777802 3.66848942
 3.80048747 3.80660576 5.18533038 9.82963   ]
   2 (-0.000 -0.500  0.000)   [-0.39527896 -0.25726915  0.18743755  0.21819302] [1.09808005 1.1089621  1.15171553 1.39901264 1.68522002 1.81232521
 1.84630992 1.85202971 2.11943332 2.12560154 3.00655855 3.12449737
 3.12539275 3.13936704 3.14172651 3.32174168 3.66777694 3.66848233
 3.80048716 3.80660371 5.18532948 9.82962987]
   3 ( 0.000 -0.500 -0.500)   [-0.25578428 -0.25164469  0.0405402   0.07090422] [0.90377833 0.95976166 1.50715817 1.51356304 1.75082482 1.76488356
 2.07012015 2.07149709 2.3234961  2.33138696 2.84383936 2.85206642
 2.88519126 2.88541456 2.98374855 2.98747179 3.73407511 3.73506215
 5.07673002 5.07937815 6.89525079 6.89710508]
    CPU time for vj and vk      7.94 sec, wall time      0.25 sec
E1 = (4.193477243066714-5.907629883009979e-18j)  E_coul = (-2.241134162054567+2.6417693985370735e-17j)
cycle= 4 E= -10.8347860646121  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      8.60 sec, wall time      0.27 sec
HOMO = 0.346401417547  LUMO = 0.903765128473
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931539  0.30040346  0.33527425  0.34640142] [0.9822261  0.99636323 1.01752536 1.33926524 1.80560388 1.80633815
 1.88473762 2.12078886 2.12321204 2.12657255 2.7077945  2.71059396
 2.71134964 3.56379742 3.56594834 3.5696103  3.69920797 3.70606213
 4.21951927 4.77260548 4.77347052 4.77544099]
   1 ( 0.000  0.000 -0.500)   [-0.39530016 -0.25733789  0.18738878  0.21812756] [1.09803848 1.10893218 1.15169229 1.39901826 1.68519076 1.81228766
 1.84626659 1.8519926  2.1194258  2.12557764 3.00652715 3.12448562
 3.12537689 3.13931592 3.14167236 3.32173382 3.66775868 3.66848026
 3.80045468 3.80657264 5.18529207 9.82945474]
   2 (-0.000 -0.500  0.000)   [-0.39529993 -0.25733787  0.18738891  0.21812767] [1.09803805 1.1089331  1.15169134 1.39901809 1.68519087 1.81228499
 1.84626633 1.85199271 2.11942616 2.12557699 3.00652695 3.12448543
 3.12537545 3.13931529 3.14167157 3.32173386 3.66775759 3.66847316
 3.80045436 3.80657059 5.18529117 9.82945461]
   3 ( 0.000 -0.500 -0.500)   [-0.25584257 -0.25170073  0.0404886   0.07086669] [0.90376513 0.95975318 1.50710661 1.51353094 1.75075794 1.7648226
 2.0701042  2.07148519 2.32347309 2.33136394 2.84379842 2.85202248
 2.88518194 2.88541118 2.98371685 2.9874529  3.73403298 3.73502442
 5.07670669 5.0793493  6.89515871 6.89702791]
    CPU time for vj and vk      8.91 sec, wall time      0.28 sec
E1 = (4.193498741108213-5.905461618253967e-18j)  E_coul = (-2.241155706246697+2.6417988867621042e-17j)
cycle= 5 E= -10.8347861107627  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00954
    CPU time for cycle= 5      9.59 sec, wall time      0.30 sec
HOMO = 0.346408406328  LUMO = 0.903766286388
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931262  0.30040438  0.33527477  0.34640841] [0.98222753 0.99636474 1.01752614 1.33926691 1.80560453 1.80633886
 1.88473658 2.12078852 2.12321135 2.12657327 2.70779569 2.71059549
 2.71135292 3.56379794 3.56594898 3.56961023 3.69920878 3.70606283
 4.2195203  4.77260638 4.77347119 4.77544171]
   1 ( 0.000  0.000 -0.500)   [-0.39529485 -0.25733508  0.18738984  0.21812855] [1.09803927 1.10893364 1.15169173 1.39901745 1.68519193 1.81228991
 1.84626727 1.85199387 2.11942863 2.12557794 3.00652931 3.12448664
 3.12537705 3.13931748 3.14167346 3.32173377 3.66775857 3.66848125
 3.80045472 3.80657309 5.18529389 9.82946252]
   2 (-0.000 -0.500  0.000)   [-0.39529461 -0.25733506  0.18738997  0.21812866] [1.09803884 1.10893456 1.15169078 1.39901728 1.68519203 1.81228724
 1.84626701 1.85199398 2.11942899 2.12557729 3.00652911 3.12448646
 3.12537561 3.13931686 3.14167267 3.32173382 3.66775748 3.66847415
 3.8004544  3.80657104 5.18529298 9.82946239]
   3 ( 0.000 -0.500 -0.500)   [-0.255839   -0.25169959  0.04049002  0.07087088] [0.90376629 0.95975275 1.50710819 1.51353564 1.75075829 1.7648215
 2.07010511 2.07148543 2.32347276 2.33136543 2.84379973 2.8520232
 2.885181   2.88541255 2.98371743 2.98745448 3.73403271 3.73502681
 5.07670796 5.07935032 6.89516108 6.89703318]
    CPU time for vj and vk      7.99 sec, wall time      0.25 sec
E1 = (4.19349931719772-5.904329502114107e-18j)  E_coul = (-2.24115628321533+2.64179842701721e-17j)
Extra cycle  E= -10.8347861116419  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     68.08 sec, wall time      2.16 sec
    CPU time for SCF     70.21 sec, wall time      2.23 sec
converged SCF energy = -10.8347861116419
**** SCF Summaries ****
Total Energy =                         -10.834786111641851
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193499317197720
Two-electron Energy =                   -2.241156283215330
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.95 sec, wall time      0.06 sec
End time = Wed May 28 03:01:54 PM PDT 2025
