SLURMD_NODENAME = hpc-35-03
Start time = Wed May 28 02:58:06 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-10/49864300/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-10/49864300/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/150/10/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-150-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-10
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 10.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 10.0
wrap_around = True

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2303, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 24389, selected grid size = 260
truncated values = 6.69e+01, estimated error = 2.80e+00
Number of interpolating points is 260.
    CPU time for building inpv_kpt     43.41 sec, wall time     35.89 sec

Out-core version is used for eta_kpt.
disk space required: 4.06e-01 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   4.06e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     13.40 sec, wall time      0.62 sec
    CPU time for building eta_kpt     16.43 sec, wall time      0.71 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     10.65 sec, wall time      0.37 sec
    CPU time for coul_kpt[ 2 / 4]      9.22 sec, wall time      0.38 sec
    CPU time for coul_kpt[ 3 / 4]      9.09 sec, wall time      0.38 sec
    CPU time for coul_kpt[ 4 / 4]      9.26 sec, wall time      0.39 sec
    CPU time for building coul_kpt     38.41 sec, wall time      1.53 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-10/49864300/18vh10wb


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-10/49864300/tmp3gy3g269
max_memory 327680 MB (current use 365 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f4fe2452f50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      4.46 sec, wall time      0.14 sec
E1 = (3.6045119533033363-9.076412729953922e-19j)  E_coul = (-4.237935738851816-8.340571035837786e-17j)
init E= -13.4205529311727
    CPU time for initialize scf      9.62 sec, wall time      0.31 sec
HOMO = 0.64217434445  LUMO = 0.776582279902
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97409821  0.60528248  0.60915283  0.64217434] [0.85983107 0.88588688 0.91021285 1.12504236 1.79092205 1.80516918
 1.8621769  2.08333523 2.08740582 2.09913584 2.64579226 2.64760329
 2.64876244 3.55328768 3.55379219 3.55466445 3.65956894 3.6602399
 4.2101582  4.73494245 4.73549932 4.7358673 ]
   1 ( 0.000  0.000 -0.500)   [-0.78001802 -0.50847946  0.46132074  0.50289564] [0.94787712 1.02142366 1.04032317 1.35352493 1.62937391 1.75598244
 1.814501   1.82398383 2.11254978 2.11925702 2.9566218  3.06761168
 3.06856819 3.10237945 3.10313913 3.30377313 3.64916573 3.65326058
 3.76723218 3.7676743  5.13896393 9.64998648]
   2 (-0.000 -0.500  0.000)   [-0.78000851 -0.50842364  0.46130385  0.50287165] [0.94780683 1.02137308 1.04031735 1.35356798 1.62934008 1.75603567
 1.8144964  1.82400391 2.11257761 2.11918202 2.95648575 3.06764298
 3.06845632 3.10236575 3.10307987 3.30373913 3.64916185 3.65321344
 3.76727413 3.76782612 5.13903373 9.64990148]
   3 ( 0.000 -0.500 -0.500)   [-0.41682434 -0.40441374  0.22472238  0.31068024] [0.77658228 0.84130028 1.40158544 1.40349986 1.67780082 1.68154216
 2.07037351 2.07582527 2.31223575 2.31452646 2.79345456 2.8007401
 2.87056141 2.87951493 2.95476826 2.95579506 3.67395859 3.67549091
 5.04770996 5.0481286  6.80911349 6.81450758]
    CPU time for vj and vk      4.61 sec, wall time      0.15 sec
E1 = (4.197995276458429-2.105761066139608e-17j)  E_coul = (-2.232584945515105-9.731845262584604e-17j)
cycle= 1 E= -10.8217188146809  delta_E=  2.6  |g|= 0.446  |ddm|= 14.9
    CPU time for cycle= 1      5.08 sec, wall time      0.16 sec
HOMO = 0.352232127096  LUMO = 0.898315722358
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67153371  0.30150995  0.34054907  0.35223213] [0.97853966 0.99133448 1.01479981 1.33226268 1.80546409 1.80599389
 1.88417975 2.11986705 2.12188297 2.12532338 2.7078668  2.7116353
 2.71193398 3.56347335 3.56538991 3.57003404 3.69766386 3.70483678
 4.22172939 4.77122526 4.77242081 4.77447214]
   1 ( 0.000  0.000 -0.500)   [-0.39607146 -0.2566129   0.1870983   0.22268969] [1.09302954 1.10497781 1.15033358 1.39698809 1.68422222 1.81154671
 1.84702856 1.85160166 2.11914818 2.12569262 3.00553212 3.12344735
 3.12509007 3.13806439 3.1410002  3.32111552 3.66779979 3.66815979
 3.79985116 3.80630886 5.18612767 9.83359795]
   2 (-0.000 -0.500  0.000)   [-0.39610987 -0.2565146   0.18704613  0.22263162] [1.092937   1.10499388 1.1503412  1.39705721 1.68422569 1.81154544
 1.84702397 1.85164502 2.11922973 2.12564227 3.00541912 3.12347511
 3.12492924 3.13810896 3.1409195  3.32105046 3.66779593 3.66802635
 3.79993375 3.8063037  5.1860536  9.83357648]
   3 ( 0.000 -0.500 -0.500)   [-0.25537731 -0.25117233  0.03951609  0.07504623] [0.89831572 0.95902635 1.50278238 1.50999795 1.74942034 1.76454242
 2.0704989  2.071981   2.32319942 2.33057543 2.8433809  2.85143501
 2.88501089 2.88508697 2.98365438 2.9870635  3.73210457 3.73335176
 5.07650942 5.07947089 6.89798068 6.89901585]
    CPU time for vj and vk      4.56 sec, wall time      0.15 sec
E1 = (4.194246796075208-2.2779678251441837e-17j)  E_coul = (-2.241318050814259-9.768765427567328e-17j)
cycle= 2 E= -10.8342004003633  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.27
    CPU time for cycle= 2      5.14 sec, wall time      0.16 sec
HOMO = 0.346067797977  LUMO = 0.903511228826
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66960361  0.30001905  0.33504316  0.3460678 ] [0.98176936 0.99581181 1.0171793  1.3386993  1.80532803 1.80615126
 1.8850004  2.12051175 2.1229894  2.12636263 2.70722124 2.7102571
 2.7109371  3.56363733 3.56577795 3.56964307 3.69898963 3.705784
 4.21962924 4.77226136 4.7730508  4.77503598]
   1 ( 0.000  0.000 -0.500)   [-0.39573453 -0.25765697  0.18693276  0.21788003] [1.09776111 1.10846781 1.15155013 1.39882856 1.68498589 1.81199938
 1.84601898 1.85172993 2.11915799 2.12548188 3.0062456  3.12410908
 3.12529303 3.13878188 3.14124316 3.32164885 3.66759608 3.6683105
 3.80024891 3.8063231  5.18503057 9.82840754]
   2 (-0.000 -0.500  0.000)   [-0.39577148 -0.25756398  0.18688108  0.21782479] [1.09766701 1.1084912  1.15155475 1.39890195 1.68499843 1.8119773
 1.84601874 1.85176987 2.11923678 2.12541944 3.006124   3.12415042
 3.12514656 3.13882816 3.14117218 3.32158526 3.66758699 3.66817594
 3.80032579 3.80629763 5.184929   9.82838744]
   3 ( 0.000 -0.500 -0.500)   [-0.25620243 -0.25199785  0.040064    0.07056973] [0.90351123 0.95980094 1.506409   1.51281112 1.75049584 1.76450227
 2.07002585 2.07135177 2.3234174  2.33104565 2.84339215 2.85178308
 2.88511459 2.88520865 2.98344254 2.98710778 3.73361123 3.73444505
 5.07657143 5.07879221 6.89480695 6.89642853]
    CPU time for vj and vk      4.58 sec, wall time      0.15 sec
E1 = (4.193489237253477-2.2566173324030624e-17j)  E_coul = (-2.2411550782749656-9.77193657814258e-17j)
cycle= 3 E= -10.8347949866457  delta_E= -0.000595  |g|= 0.00537  |ddm|= 0.841
    CPU time for cycle= 3      5.17 sec, wall time      0.16 sec
HOMO = 0.346411014165  LUMO = 0.903815988031
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6691025   0.30039428  0.33519819  0.34641101] [0.98225137 0.99639331 1.01762675 1.3392763  1.80553148 1.80632874
 1.8848701  2.1206617  2.1230848  2.12651213 2.70761373 2.71060693
 2.7113748  3.56374241 3.56592083 3.56967935 3.69930456 3.70605618
 4.21968245 4.77253636 4.77329843 4.77526866]
   1 ( 0.000  0.000 -0.500)   [-0.39512935 -0.25731594  0.18739807  0.21812792] [1.09817852 1.10893142 1.15174204 1.39890099 1.68512773 1.81237356
 1.84623777 1.85196699 2.11936507 2.12555646 3.006591   3.12434989
 3.12544208 3.13928801 3.1417023  3.32176502 3.66768425 3.66844689
 3.80047747 3.80653217 5.18534587 9.82966171]
   2 (-0.000 -0.500  0.000)   [-0.39516651 -0.25722235  0.18734666  0.21807161] [1.09808392 1.10895313 1.15174697 1.39897373 1.68514071 1.81235285
 1.84623606 1.85200766 2.11944492 2.12549575 3.00647023 3.12439077
 3.12529613 3.13933426 3.14163195 3.32170088 3.66767415 3.66831402
 3.80055285 3.80650672 5.18524398 9.82964127]
   3 ( 0.000 -0.500 -0.500)   [-0.25570819 -0.25158799  0.04048583  0.07084489] [0.90381599 0.95979581 1.50718837 1.5135923  1.75078422 1.76477631
 2.07011216 2.07136258 2.3235267  2.33128043 2.84373878 2.8520749
 2.88512806 2.88535097 2.98364362 2.9873342  3.73392538 3.73490628
 5.07681366 5.07897459 6.89533189 6.89712445]
    CPU time for vj and vk      4.58 sec, wall time      0.15 sec
E1 = (4.19351906276704-2.2462507151638504e-17j)  E_coul = (-2.2411876029337026-9.772825631883854e-17j)
cycle= 4 E= -10.8347976857909  delta_E= -2.7e-06  |g|= 0.000626  |ddm|= 0.102
    CPU time for cycle= 4      5.21 sec, wall time      0.17 sec
HOMO = 0.34636700726  LUMO = 0.903802609823
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66915558  0.30033688  0.33512169  0.34636701] [0.98222757 0.99635955 1.01759063 1.33922127 1.80551919 1.80630578
 1.88488372 2.12065195 2.12306339 2.12649917 2.70755755 2.71054872
 2.7113273  3.56373025 3.5659098  3.56966106 3.69927537 3.70602594
 4.21966562 4.77251194 4.77326977 4.77523988]
   1 ( 0.000  0.000 -0.500)   [-0.39515023 -0.25738474  0.18734941  0.2180624 ] [1.09813641 1.10890224 1.15171785 1.39890641 1.68509839 1.81233326
 1.8461941  1.85192992 2.11935785 2.12553185 3.00655941 3.12433777
 3.12542469 3.13923612 3.14164719 3.32175707 3.66766556 3.66843721
 3.80044468 3.80649911 5.18530747 9.82948611]
   2 (-0.000 -0.500  0.000)   [-0.3951873  -0.25729131  0.18729796  0.21800609] [1.09804198 1.10892408 1.15172284 1.39897909 1.68511142 1.81231238
 1.84619227 1.85197056 2.11943765 2.12547103 3.00643841 3.12437873
 3.12527891 3.13928235 3.14157692 3.32169304 3.66765535 3.66830478
 3.80051988 3.80647358 5.18520557 9.8294657 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25576645 -0.25164416  0.04043415  0.07080731] [0.90380261 0.95978754 1.5071367  1.51356012 1.75071714 1.76471499
 2.07009614 2.07135064 2.32350367 2.33125733 2.84369772 2.8520308
 2.88511842 2.88534789 2.98361185 2.98731521 3.73388385 3.73486778
 5.07679028 5.07894652 6.89524007 6.89704687]
    CPU time for vj and vk      4.53 sec, wall time      0.14 sec
E1 = (4.193540842311421-2.2456572852133993e-17j)  E_coul = (-2.2412094319148066-9.77319095290719e-17j)
cycle= 5 E= -10.8347977352276  delta_E= -4.94e-08  |g|= 0.000107  |ddm|= 0.00955
    CPU time for cycle= 5      5.12 sec, wall time      0.16 sec
HOMO = 0.346373970488  LUMO = 0.903803732703
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66915287  0.30033773  0.33512212  0.34637397] [0.98222895 0.996361   1.01759134 1.33922288 1.80551981 1.80630645
 1.8848827  2.12065159 2.12306266 2.12649987 2.70755868 2.7105502
 2.7113305  3.56373076 3.56591042 3.56966099 3.69927614 3.7060266
 4.21966663 4.77251278 4.77327037 4.77524052]
   1 ( 0.000  0.000 -0.500)   [-0.39514496 -0.25738201  0.1873504   0.21806332] [1.09813716 1.10890364 1.15171724 1.39890561 1.68509952 1.81233547
 1.84619474 1.85193115 2.11936067 2.12553211 3.00656152 3.12433876
 3.12542482 3.1392376  3.14164823 3.321757   3.66766549 3.66843811
 3.80044468 3.80649952 5.18530922 9.82949369]
   2 (-0.000 -0.500  0.000)   [-0.39518201 -0.25728859  0.18729895  0.21800701] [1.09804273 1.10892548 1.15172226 1.39897825 1.68511255 1.81231457
 1.84619289 1.85197179 2.11944045 2.1254713  3.00644051 3.12437971
 3.12527906 3.13928385 3.14157794 3.32169298 3.66765526 3.66830571
 3.80051987 3.80647399 5.18520734 9.82947329]
   3 ( 0.000 -0.500 -0.500)   [-0.25576299 -0.25164307  0.04043549  0.07081147] [0.90380373 0.95978712 1.50713819 1.51356478 1.75071731 1.76471393
 2.07009705 2.07135086 2.32350332 2.33125877 2.84369896 2.85203146
 2.88511766 2.88534905 2.9836124  2.98731675 3.73388311 3.73487051
 5.07679151 5.07894747 6.89524221 6.89705219]
    CPU time for vj and vk      4.59 sec, wall time      0.15 sec
E1 = (4.193541487917527-2.245871525888221e-17j)  E_coul = (-2.2412100792469682-9.773349077788998e-17j)
Extra cycle  E= -10.8347977369537  delta_E= -1.73e-09  |g|= 4.68e-05  |ddm|= 0.0017
    CPU time for scf_cycle     40.47 sec, wall time      1.29 sec
    CPU time for SCF     42.39 sec, wall time      1.36 sec
converged SCF energy = -10.8347977369537
**** SCF Summaries ****
Total Energy =                         -10.834797736953682
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193541487917527
Two-electron Energy =                   -2.241210079246968
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89499
pop of  0 C 3s            0.00353
pop of  0 C 2px           1.05202
pop of  0 C 2py           1.01182
pop of  0 C 2pz           1.01155
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89503
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05214
pop of  1 C 2py           1.01154
pop of  1 C 2pz           1.01172
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00219
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00651
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00003
charge of    1C =     -0.00003
    CPU time for vj and vk      0.62 sec, wall time      0.02 sec
End time = Wed May 28 02:58:47 PM PDT 2025
