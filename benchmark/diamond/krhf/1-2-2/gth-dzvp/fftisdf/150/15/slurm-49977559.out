SLURMD_NODENAME = hpc-54-17
Start time = Tue Jun  3 12:29:21 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-15/49977559/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-15/49977559/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/150/15/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-150-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-15
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 15.0
wrap_around = False

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2303, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 24389, selected grid size = 390
truncated values = 6.88e+01, estimated error = 8.87e-01
Number of interpolating points is 390.
    CPU time for building inpv_kpt     44.19 sec, wall time     36.70 sec

Out-core version is used for eta_kpt.
disk space required: 6.09e-01 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   6.09e-01 GB
memory needed for each k-point: 1.52e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     17.13 sec, wall time      0.93 sec
    CPU time for building eta_kpt     20.17 sec, wall time      1.03 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     13.59 sec, wall time      0.70 sec
    CPU time for coul_kpt[ 2 / 4]     11.27 sec, wall time      0.71 sec
    CPU time for coul_kpt[ 3 / 4]     11.54 sec, wall time      0.72 sec
    CPU time for coul_kpt[ 4 / 4]     11.55 sec, wall time      0.72 sec
    CPU time for building coul_kpt     48.39 sec, wall time      2.87 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-15/49977559/l2zbfwzy


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-15/49977559/tmp8pwrmv_9
max_memory 327680 MB (current use 377 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f83eb9a2020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.22 sec, wall time      0.17 sec
E1 = (3.6045119533033367+1.3160798458434105e-17j)  E_coul = (-4.238139947034207+1.074202822519783e-17j)
init E= -13.4207571393551
    CPU time for initialize scf     10.77 sec, wall time      0.35 sec
HOMO = 0.642152803002  LUMO = 0.776537750261
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.9742178   0.60528073  0.60923243  0.6421528 ] [0.85980759 0.88582649 0.91019824 1.12519338 1.79100238 1.80523533
 1.86205994 2.08340701 2.08748703 2.099265   2.64578601 2.64767743
 2.64895778 3.55318587 3.55393254 3.55476203 3.65951113 3.66028493
 4.2100961  4.73496106 4.73539484 4.7359865 ]
   1 (-0.000 -0.000  0.500)   [-0.78014269 -0.50847951  0.46133125  0.5028559 ] [0.94785424 1.02143852 1.04032586 1.35354651 1.62942416 1.75597643
 1.81458339 1.8240914  2.11260379 2.11925246 2.95658124 3.06755466
 3.06861349 3.10243824 3.1032156  3.30379855 3.64929724 3.65341444
 3.76723071 3.76776547 5.13918562 9.64997682]
   2 ( 0.000  0.500 -0.000)   [-0.78014236 -0.50848179  0.4613325   0.50285166] [0.9478508  1.02143978 1.04033502 1.35354367 1.6294216  1.75599105
 1.81457245 1.824088   2.11260642 2.11924792 2.95657588 3.06754813
 3.0686122  3.1024441  3.1032063  3.30379327 3.64926925 3.65339133
 3.76723785 3.76775478 5.13918967 9.64997761]
   3 ( 0.000  0.500  0.500)   [-0.41688197 -0.40450372  0.22476318  0.31063738] [0.77653775 0.84136636 1.40153105 1.40350087 1.67778939 1.6816626
 2.0704239  2.07586373 2.31225311 2.31465319 2.79347036 2.80080112
 2.8706382  2.87949182 2.95489331 2.9560046  3.67412309 3.67560044
 5.04767339 5.04824013 6.80910236 6.81455132]
    CPU time for vj and vk      5.25 sec, wall time      0.17 sec
E1 = (4.1980533744668405+3.744733833045255e-18j)  E_coul = (-2.2326486164752426-2.5218717846068375e-18j)
cycle= 1 E= -10.8217243876326  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      5.78 sec, wall time      0.18 sec
HOMO = 0.352240799745  LUMO = 0.898280887635
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67168499  0.30152983  0.34066908  0.3522408 ] [0.97851621 0.9913233  1.01471073 1.33231489 1.80553959 1.806021
 1.88406105 2.11997784 2.12204053 2.12544697 2.7080955  2.71166236
 2.7119271  3.56353222 3.56535753 3.56994272 3.69758801 3.70485752
 4.22159192 4.77131888 4.77260129 4.77473709]
   1 (-0.000 -0.000  0.500)   [-0.39620499 -0.25657267  0.18710196  0.22272123] [1.09293223 1.10499732 1.15030541 1.39711172 1.6842864  1.81146107
 1.84709581 1.85168282 2.11920471 2.12574679 3.00549832 3.12358025
 3.1250186  3.13812004 3.14102981 3.32110374 3.66803928 3.66813629
 3.79981728 3.80637534 5.18613587 9.83348775]
   2 ( 0.000  0.500 -0.000)   [-0.39620743 -0.25657707  0.18709842  0.22272526] [1.09292276 1.10500736 1.15030367 1.3971103  1.68429031 1.81147682
 1.84707256 1.85168691 2.11921097 2.12571687 3.00549494 3.12360339
 3.12501263 3.13811806 3.14102485 3.32109074 3.66799425 3.66808201
 3.79983808 3.80640047 5.18614116 9.83350401]
   3 ( 0.000  0.500  0.500)   [-0.25545729 -0.25121741  0.03954395  0.075093  ] [0.89828089 0.958991   1.50274329 1.50994366 1.74942347 1.76463282
 2.07047664 2.07209398 2.32315547 2.33068118 2.84347761 2.85145317
 2.88507616 2.88513695 2.98375151 2.98717999 3.73223812 3.73350272
 5.07644493 5.07990519 6.89789884 6.89899174]
    CPU time for vj and vk      5.31 sec, wall time      0.17 sec
E1 = (4.194243907036557+7.533770736355336e-18j)  E_coul = (-2.2413126748826295-2.0084958767955422e-18j)
cycle= 2 E= -10.8341979134703  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.06
    CPU time for cycle= 2      6.03 sec, wall time      0.19 sec
HOMO = 0.346099316455  LUMO = 0.903484484417
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66975145  0.30005213  0.33518506  0.34609932] [0.98175564 0.99580335 1.01710553 1.33874301 1.80541159 1.80618465
 1.88487221 2.12063862 2.12315129 2.12647806 2.70747161 2.71029478
 2.71094864 3.5637049  3.56576628 3.56955919 3.69892051 3.70581222
 4.21947837 4.77235604 4.77320968 4.77524065]
   1 (-0.000 -0.000  0.500)   [-0.39586906 -0.25760551  0.18694611  0.21793396] [1.09766705 1.10849339 1.15151693 1.39895521 1.68506383 1.81191841
 1.8461     1.85181763 2.11922578 2.12553705 3.00621771 3.1242622
 3.12523306 3.13886173 3.1412822  3.32163482 3.66772235 3.66835086
 3.80021891 3.80638631 5.18501743 9.8283548 ]
   2 ( 0.000  0.500 -0.000)   [-0.39587079 -0.25761079  0.18694375  0.21793717] [1.09765632 1.10850362 1.1515147  1.39895222 1.68506865 1.8119322
 1.84607507 1.85182119 2.11923222 2.12550785 3.00621441 3.12428727
 3.12522622 3.13886129 3.14127714 3.32162226 3.66766983 3.66830578
 3.80023823 3.80640686 5.18502565 9.82836941]
   3 ( 0.000  0.500  0.500)   [-0.25627598 -0.25204122  0.04009793  0.07063102] [0.90348448 0.95975622 1.50638177 1.51277309 1.75051633 1.76459919
 2.07001991 2.0714748  2.32337901 2.33115333 2.84349783 2.85179532
 2.88517553 2.88526337 2.98354565 2.9872295  3.733759   3.73460263
 5.07652122 5.07917068 6.89474829 6.89640713]
    CPU time for vj and vk      5.26 sec, wall time      0.17 sec
E1 = (4.193477614355571+8.081875786621633e-18j)  E_coul = (-2.2411403790531024-1.889038349364351e-18j)
cycle= 3 E= -10.8347919103218  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.839
    CPU time for cycle= 3      5.98 sec, wall time      0.19 sec
HOMO = 0.346440929194  LUMO = 0.903788722581
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66925108  0.3004264   0.33533951  0.34644093] [0.98223686 0.99638271 1.01755218 1.3393172  1.80561482 1.80636197
 1.88474074 2.12078801 2.12324675 2.12662739 2.70786275 2.71064314
 2.71138551 3.56380958 3.56590772 3.56959538 3.69923542 3.70608365
 4.2195318  4.77263212 4.77345661 4.77547351]
   1 (-0.000 -0.000  0.500)   [-0.39526489 -0.25726484  0.18741029  0.21818043] [1.09808244 1.10895488 1.15170847 1.39902732 1.68520457 1.8122914
 1.84631672 1.85205423 2.11943308 2.12561193 3.00656241 3.12450179
 3.12538148 3.1393679  3.14174077 3.32175094 3.66780755 3.66848963
 3.80044664 3.8065937  5.1853315  9.82960374]
   2 ( 0.000  0.500 -0.000)   [-0.39526674 -0.2572699   0.18740799  0.21818354] [1.09807168 1.10896506 1.15170629 1.39902437 1.68520943 1.81230551
 1.84629164 1.85205764 2.1194395  2.12558287 3.00655933 3.12452681
 3.1253746  3.13936742 3.14173558 3.3217384  3.66775505 3.66844465
 3.8004659  3.80661439 5.18533948 9.82961837]
   3 ( 0.000  0.500  0.500)   [-0.25578268 -0.2516318   0.04051859  0.07090548] [0.90378872 0.95975024 1.50715917 1.5135521  1.75080328 1.76487105
 2.07010512 2.0714852  2.32348828 2.33138802 2.84384364 2.8520868
 2.8851873  2.88540818 2.98374571 2.98745541 3.73407158 3.73506338
 5.07676384 5.07935224 6.89527101 6.89710075]
    CPU time for vj and vk      5.30 sec, wall time      0.17 sec
E1 = (4.193506595763468+8.118992224662688e-18j)  E_coul = (-2.241172046593066-1.8805783485986145e-18j)
cycle= 4 E= -10.8347945964538  delta_E= -2.69e-06  |g|= 0.000615  |ddm|= 0.0989
    CPU time for cycle= 4      6.01 sec, wall time      0.19 sec
HOMO = 0.346397061854  LUMO = 0.903775545921
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6693042   0.30036903  0.33526328  0.34639706] [0.98221315 0.9963491  1.0175163  1.33926204 1.80560255 1.80633909
 1.88475439 2.12077827 2.1232255  2.12661453 2.70780659 2.71058513
 2.71133832 3.56379745 3.56589688 3.56957728 3.69920633 3.70605352
 4.21951498 4.7726077  4.77342787 4.77544433]
   1 (-0.000 -0.000  0.500)   [-0.39528585 -0.2573335   0.18736164  0.21811513] [1.09804046 1.10892589 1.15168426 1.39903275 1.68517544 1.81225124
 1.84627315 1.85201727 2.11942597 2.1255874  3.00653084 3.12448987
 3.12536417 3.13931619 3.14168579 3.32174309 3.66778824 3.66848044
 3.80041387 3.8065606  5.1852932  9.82942863]
   2 ( 0.000  0.500 -0.000)   [-0.39528768 -0.25733858  0.18735935  0.21811824] [1.09802972 1.10893609 1.15168209 1.39902982 1.6851803  1.81226534
 1.84624809 1.85202065 2.11943236 2.12555834 3.00652776 3.12451489
 3.12535729 3.13931573 3.14168061 3.32173056 3.6677357  3.66843553
 3.80043313 3.80658127 5.18530119 9.82944325]
   3 ( 0.000  0.500  0.500)   [-0.25584089 -0.25168784  0.04046701  0.07086799] [0.90377555 0.95974172 1.50710761 1.51352007 1.75073649 1.76481011
 2.07008919 2.07147328 2.32346529 2.33136504 2.84380273 2.85204288
 2.88517793 2.88540485 2.98371399 2.98743654 3.73402945 3.73502569
 5.07674052 5.07932339 6.89517908 6.89702352]
    CPU time for vj and vk      5.25 sec, wall time      0.17 sec
E1 = (4.19352806587447+8.12486228391996e-18j)  E_coul = (-2.241193562907674-1.8789784424142335e-18j)
cycle= 5 E= -10.8347946426574  delta_E= -4.62e-08  |g|= 8.52e-05  |ddm|= 0.00955
    CPU time for cycle= 5      5.92 sec, wall time      0.19 sec
HOMO = 0.346404037982  LUMO = 0.903776699992
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66930144  0.30036994  0.3352638   0.34640404] [0.98221457 0.99635061 1.01751707 1.33926369 1.8056032  1.8063398
 1.88475335 2.12077792 2.12322481 2.12661526 2.70780777 2.71058665
 2.71134159 3.56379797 3.56589752 3.5695772  3.69920714 3.70605422
 4.21951601 4.77260859 4.77342854 4.77544504]
   1 (-0.000 -0.000  0.500)   [-0.39528054 -0.2573307   0.18736269  0.2181161 ] [1.09804124 1.10892735 1.1516837  1.39903195 1.68517661 1.81225348
 1.84627382 1.85201853 2.1194288  2.12558769 3.00653299 3.12449088
 3.12536433 3.13931775 3.14168688 3.32174305 3.66778813 3.66848142
 3.8004139  3.80656104 5.185295   9.82943637]
   2 ( 0.000  0.500 -0.000)   [-0.39528238 -0.25733578  0.1873604   0.21811922] [1.0980305  1.10893754 1.15168153 1.39902901 1.68518147 1.81226758
 1.84624876 1.85202191 2.11943519 2.12555863 3.00652991 3.12451591
 3.12535745 3.13931728 3.14168171 3.32173052 3.66773559 3.66843652
 3.80043317 3.80658171 5.18530299 9.82945099]
   3 ( 0.000  0.500  0.500)   [-0.25583732 -0.25168672  0.04046841  0.07087217] [0.9037767  0.95974129 1.50710919 1.51352476 1.75073683 1.76480901
 2.0700901  2.07147352 2.32346496 2.33136652 2.84380403 2.85204359
 2.88517701 2.88540621 2.98371457 2.98743812 3.73402917 3.73502808
 5.07674178 5.07932441 6.89518136 6.89702886]
    CPU time for vj and vk      5.25 sec, wall time      0.17 sec
E1 = (4.193528645633956+8.124688738020289e-18j)  E_coul = (-2.241194143560669-1.878784938929913e-18j)
Extra cycle  E= -10.834794643551  delta_E= -8.94e-10  |g|= 2.73e-05  |ddm|= 0.00139
    CPU time for scf_cycle     46.38 sec, wall time      1.49 sec
    CPU time for SCF     48.91 sec, wall time      1.57 sec
converged SCF energy = -10.834794643551
**** SCF Summaries ****
Total Energy =                         -10.834794643550953
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193528645633956
Two-electron Energy =                   -2.241194143560669
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89507
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05200
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01170
pop of  0 C 3px           0.00286
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89512
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05198
pop of  1 C 2py           1.01163
pop of  1 C 2pz           1.01160
pop of  1 C 3px           0.00286
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00004
charge of    1C =      0.00004
    CPU time for vj and vk      1.09 sec, wall time      0.04 sec
End time = Tue Jun  3 12:30:05 PM PDT 2025
