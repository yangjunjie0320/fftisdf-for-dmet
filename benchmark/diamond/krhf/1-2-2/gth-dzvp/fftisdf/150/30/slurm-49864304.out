SLURMD_NODENAME = hpc-35-03
Start time = Wed May 28 02:58:47 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-30/49864304/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-30/49864304/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/150/30/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-150-30
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-30
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 30.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 30.0
wrap_around = True

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2303, c0 =  30.00, nao = 26, nip = 780
Parent grid size = 24389, selected grid size = 780
truncated values = 6.97e+01, estimated error = 5.04e-02
Number of interpolating points is 780.
    CPU time for building inpv_kpt     43.63 sec, wall time     36.02 sec

Out-core version is used for eta_kpt.
disk space required: 1.22e+00 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   1.22e+00 GB
memory needed for each k-point: 3.04e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     21.45 sec, wall time      1.77 sec
    CPU time for building eta_kpt     24.50 sec, wall time      1.87 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     21.83 sec, wall time      2.31 sec
    CPU time for coul_kpt[ 2 / 4]     16.91 sec, wall time      2.31 sec
    CPU time for coul_kpt[ 3 / 4]     17.18 sec, wall time      2.31 sec
    CPU time for coul_kpt[ 4 / 4]     16.92 sec, wall time      2.30 sec
    CPU time for building coul_kpt     74.07 sec, wall time      9.27 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-30/49864304/sunlc2ej


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-30/49864304/tmp2o1v858x
max_memory 327680 MB (current use 405 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f764ee06f50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      6.43 sec, wall time      0.20 sec
E1 = (3.604511953303336+1.134551591244321e-17j)  E_coul = (-4.238151363551015+2.5113973701873848e-17j)
init E= -13.4207685558719
    CPU time for initialize scf     11.63 sec, wall time      0.37 sec
HOMO = 0.642148635186  LUMO = 0.776527960635
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422404  0.60527267  0.60923105  0.64214864] [0.85981241 0.88582633 0.91020197 1.12520276 1.79100343 1.80523334
 1.86205231 2.08341775 2.08748617 2.09925084 2.64579645 2.64766476
 2.6489528  3.55319816 3.55392445 3.55480351 3.6595082  3.66029216
 4.21012065 4.73494805 4.73542137 4.73596207]
   1 ( 0.000  0.000 -0.500)   [-0.78015258 -0.50848296  0.46133114  0.50284986] [0.94785936 1.02143224 1.04032667 1.35354528 1.62942687 1.75601352
 1.81456903 1.82408291 2.11260156 2.11925383 2.95658574 3.06755017
 3.06862824 3.10243198 3.10320795 3.30379473 3.6492734  3.65340625
 3.76724398 3.76776198 5.13917451 9.64996005]
   2 (-0.000 -0.500  0.000)   [-0.78015258 -0.50848295  0.46133107  0.5028499 ] [0.94785923 1.0214321  1.04032668 1.35354534 1.6294269  1.75601329
 1.81456972 1.82408299 2.11260168 2.11925394 2.95658575 3.06755004
 3.06862904 3.10243238 3.10320837 3.30379471 3.6492729  3.65340471
 3.76724459 3.76776351 5.13917469 9.64995964]
   3 ( 0.000 -0.500 -0.500)   [-0.41689396 -0.40450192  0.22475877  0.31063582] [0.77652796 0.8413681  1.40153393 1.40349579 1.67780154 1.68166176
 2.07043211 2.07586518 2.3122562  2.31465186 2.79346791 2.80079977
 2.87065799 2.87949545 2.95490344 2.95599536 3.6741315  3.67560571
 5.04762802 5.04820009 6.80908906 6.81454265]
    CPU time for vj and vk      6.66 sec, wall time      0.21 sec
E1 = (4.198021750813395+9.992088467092283e-18j)  E_coul = (-2.232609289025196+1.6558649669746107e-17j)
cycle= 1 E= -10.821716683836  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      7.12 sec, wall time      0.23 sec
HOMO = 0.352246190855  LUMO = 0.898271209861
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169533  0.30156442  0.34067959  0.35224619] [0.97853063 0.99133812 1.01471963 1.33231898 1.80554185 1.80602104
 1.88404504 2.11998655 2.12203067 2.12539993 2.70808266 2.71167102
 2.71194111 3.56353461 3.56540975 3.56998099 3.69759017 3.70486837
 4.22159894 4.77130653 4.77264215 4.7747342 ]
   1 ( 0.000  0.000 -0.500)   [-0.39621895 -0.25657634  0.18712846  0.22273361] [1.0929326  1.10500507 1.15031185 1.39709803 1.68430091 1.81150153
 1.84709017 1.85166025 2.1192046  2.12573943 3.00549365 3.12357441
 3.12502751 3.13812111 3.14101132 3.32109436 3.66804064 3.66810052
 3.7998588  3.80639336 5.18613217 9.83350879]
   2 (-0.000 -0.500  0.000)   [-0.3962189  -0.25657624  0.18712852  0.2227335 ] [1.09293258 1.10500502 1.1503114  1.39709825 1.68430091 1.8115012
 1.84709202 1.85166012 2.11920502 2.12573918 3.00549435 3.12357534
 3.12502692 3.13812263 3.14101114 3.32109381 3.66803833 3.66809998
 3.79986038 3.8063919  5.18613469 9.83351011]
   3 ( 0.000 -0.500 -0.500)   [-0.25545713 -0.2512313   0.03956559  0.07509127] [0.89827121 0.95900116 1.50274217 1.50995514 1.74944568 1.76464544
 2.07049147 2.0721086  2.32316365 2.33068231 2.84347561 2.85143217
 2.88507989 2.88514453 2.98375417 2.9871965  3.73224172 3.73350244
 5.07642854 5.07990237 6.89788217 6.89899764]
    CPU time for vj and vk      6.53 sec, wall time      0.21 sec
E1 = (4.1942130759811045+9.57322041226994e-18j)  E_coul = (-2.241273330408266+1.7406602837897063e-17j)
cycle= 2 E= -10.8341894000514  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      7.09 sec, wall time      0.22 sec
HOMO = 0.34610374729  LUMO = 0.903473729234
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976244  0.3000873   0.33519604  0.34610375] [0.9817688  0.99581733 1.01711485 1.33874631 1.80541292 1.80618371
 1.88485552 2.12064943 2.12313972 2.12643521 2.70746133 2.71030386
 2.71096036 3.56370573 3.56581888 3.56959728 3.69892211 3.70582101
 4.21948279 4.7723451  4.77325055 4.77523472]
   1 ( 0.000  0.000 -0.500)   [-0.39588296 -0.25761003  0.18697348  0.21794678] [1.0976646  1.10850004 1.15152532 1.3989399  1.68507954 1.8119548
 1.84609328 1.85179465 2.1192253  2.12552765 3.00621259 3.12425534
 3.12524275 3.13886256 3.14126759 3.32162632 3.66769037 3.66834674
 3.8002588  3.80640146 5.18501483 9.82837305]
   2 (-0.000 -0.500  0.000)   [-0.3958829  -0.25760995  0.18697355  0.2179467 ] [1.09766459 1.10849997 1.15152486 1.39894008 1.6850795  1.81195429
 1.84609515 1.85179455 2.1192257  2.12552741 3.00621318 3.12425637
 3.12524217 3.13886399 3.14126747 3.32162566 3.66769031 3.66834456
 3.80026042 3.80639992 5.18501674 9.82837461]
   3 ( 0.000 -0.500 -0.500)   [-0.25627763 -0.25205371  0.04011991  0.07062971] [0.90347373 0.95976793 1.50638142 1.5127838  1.75053755 1.76461227
 2.07003493 2.07148709 2.32338718 2.33115209 2.84349366 2.85177649
 2.88517987 2.88526941 2.98354959 2.98724512 3.733764   3.7346011
 5.0765158  5.07916806 6.89473074 6.896411  ]
    CPU time for vj and vk      6.51 sec, wall time      0.21 sec
E1 = (4.193448064594982+9.452527434891274e-18j)  E_coul = (-2.2411022632951756+1.7699161039770522e-17j)
cycle= 3 E= -10.8347833443244  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      7.14 sec, wall time      0.23 sec
HOMO = 0.346445270692  LUMO = 0.903778064342
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926221  0.30046127  0.33535021  0.34644527] [0.98224989 0.99639672 1.01756139 1.33932009 1.8056161  1.80636087
 1.88472417 2.12079854 2.12323515 2.12658451 2.70785198 2.71065203
 2.71139691 3.56381043 3.56596041 3.56963339 3.69923689 3.70609237
 4.21953629 4.77262117 4.77349744 4.77546809]
   1 ( 0.000  0.000 -0.500)   [-0.3952791  -0.25726928  0.18743761  0.21819308] [1.09807987 1.10896155 1.1517166  1.39901194 1.68521995 1.81232788
 1.84630992 1.85203078 2.1194327  2.1256027  3.00655731 3.12449496
 3.12539099 3.13936832 3.14172583 3.32174239 3.66777555 3.66848573
 3.80048643 3.80660884 5.1853285  9.82962129]
   2 (-0.000 -0.500  0.000)   [-0.39527905 -0.25726919  0.18743768  0.218193  ] [1.09807985 1.10896148 1.15171614 1.39901211 1.68521991 1.81232738
 1.8463118  1.85203068 2.1194331  2.12560247 3.00655791 3.12449599
 3.12539041 3.13936975 3.14172571 3.32174174 3.6677755  3.66848357
 3.80048802 3.80660731 5.18533041 9.82962283]
   3 ( 0.000 -0.500 -0.500)   [-0.25578436 -0.25164481  0.04054034  0.07090411] [0.90377806 0.95976193 1.50715877 1.5135625  1.75082441 1.76488354
 2.07011998 2.07149774 2.32349611 2.33138694 2.8438394  2.85206753
 2.88519116 2.88541444 2.98374952 2.98747098 3.73407618 3.73506195
 5.07675873 5.07935046 6.89525327 6.89710409]
    CPU time for vj and vk      6.76 sec, wall time      0.21 sec
E1 = (4.193477189310121+9.444262498172604e-18j)  E_coul = (-2.2411340747126465+1.7717862761562362e-17j)
cycle= 4 E= -10.8347860310268  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      7.34 sec, wall time      0.23 sec
HOMO = 0.346401328099  LUMO = 0.903764858293
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931536  0.30040391  0.33527392  0.34640133] [0.98222614 0.99636309 1.01752547 1.3392649  1.80560384 1.80633797
 1.88473787 2.12078881 2.12321387 2.12657166 2.70779585 2.71059398
 2.71134967 3.56379832 3.56594955 3.56961527 3.69920776 3.70606221
 4.21951948 4.77259674 4.77346868 4.77543887]
   1 ( 0.000  0.000 -0.500)   [-0.39530007 -0.25733799  0.18738897  0.21812773] [1.09803786 1.10893255 1.15169242 1.39901739 1.6851908  1.81228766
 1.84626633 1.85199378 2.11942555 2.12557815 3.00652571 3.12448302
 3.12537369 3.13931657 3.14167089 3.32173457 3.6677562  3.66847656
 3.80045364 3.80657573 5.18529019 9.82944603]
   2 (-0.000 -0.500  0.000)   [-0.39530002 -0.25733791  0.18738904  0.21812765] [1.09803785 1.10893248 1.15169195 1.39901756 1.68519075 1.81228716
 1.84626821 1.85199368 2.11942595 2.12557792 3.00652631 3.12448405
 3.12537312 3.139318   3.14167076 3.32173392 3.66775615 3.6684744
 3.80045523 3.80657419 5.18529209 9.82944757]
   3 ( 0.000 -0.500 -0.500)   [-0.25584265 -0.25170084  0.04048875  0.07086658] [0.90376486 0.95975345 1.5071072  1.5135304  1.75075753 1.76482257
 2.07010404 2.07148584 2.3234731  2.33136392 2.84379846 2.8520236
 2.88518184 2.88541106 2.98371782 2.98745208 3.73403405 3.73502423
 5.07673539 5.07932159 6.89516119 6.89702692]
    CPU time for vj and vk      6.73 sec, wall time      0.21 sec
E1 = (4.19349868962636+9.44265173161435e-18j)  E_coul = (-2.241155621181631+1.7719424507182818e-17j)
cycle= 5 E= -10.8347860771795  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      7.46 sec, wall time      0.24 sec
HOMO = 0.346408317133  LUMO = 0.903766015974
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931259  0.30040483  0.33527445  0.34640832] [0.98222757 0.99636461 1.01752624 1.33926656 1.80560449 1.80633868
 1.88473683 2.12078847 2.12321319 2.12657238 2.70779704 2.71059552
 2.71135295 3.56379885 3.56595019 3.56961521 3.69920858 3.70606292
 4.21952051 4.77259764 4.77346935 4.77543959]
   1 ( 0.000  0.000 -0.500)   [-0.39529475 -0.25733519  0.18739003  0.21812871] [1.09803865 1.10893401 1.15169186 1.39901658 1.68519196 1.81228991
 1.84626701 1.85199505 2.11942838 2.12557844 3.00652786 3.12448404
 3.12537385 3.13931813 3.14167199 3.32173452 3.6677561  3.66847755
 3.80045368 3.80657617 5.185292   9.82945381]
   2 (-0.000 -0.500  0.000)   [-0.3952947  -0.2573351   0.1873901   0.21812864] [1.09803864 1.10893394 1.1516914  1.39901675 1.68519192 1.81228941
 1.84626889 1.85199495 2.11942878 2.12557821 3.00652846 3.12448507
 3.12537328 3.13931956 3.14167187 3.32173388 3.66775605 3.66847539
 3.80045526 3.80657464 5.1852939  9.82945535]
   3 ( 0.000 -0.500 -0.500)   [-0.25583908 -0.25169971  0.04049016  0.07087077] [0.90376602 0.95975302 1.50710879 1.51353511 1.75075789 1.76482148
 2.07010494 2.07148608 2.32347277 2.33136541 2.84379977 2.85202431
 2.8851809  2.88541243 2.9837184  2.98745366 3.73403377 3.73502662
 5.07673666 5.07932261 6.89516356 6.89703219]
    CPU time for vj and vk      6.53 sec, wall time      0.21 sec
E1 = (4.193499266088698+9.442433407443865e-18j)  E_coul = (-2.2411561985231727+1.7719527568268322e-17j)
Extra cycle  E= -10.8347860780587  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     54.85 sec, wall time      1.74 sec
    CPU time for SCF     56.81 sec, wall time      1.81 sec
converged SCF energy = -10.8347860780587
**** SCF Summaries ****
Total Energy =                         -10.834786078058714
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193499266088698
Two-electron Energy =                   -2.241156198523173
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      2.58 sec, wall time      0.08 sec
End time = Wed May 28 02:59:38 PM PDT 2025
