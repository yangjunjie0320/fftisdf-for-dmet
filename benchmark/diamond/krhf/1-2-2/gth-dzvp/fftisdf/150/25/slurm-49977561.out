SLURMD_NODENAME = hpc-35-03
Start time = Tue Jun  3 12:29:26 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49977561/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49977561/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/150/25/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-150-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-25
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 25.0
wrap_around = False

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2303, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 24389, selected grid size = 650
truncated values = 6.96e+01, estimated error = 1.23e-01
Number of interpolating points is 650.
    CPU time for building inpv_kpt     44.65 sec, wall time     36.93 sec

Out-core version is used for eta_kpt.
disk space required: 1.01e+00 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   1.01e+00 GB
memory needed for each k-point: 2.54e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     20.16 sec, wall time      1.49 sec
    CPU time for building eta_kpt     23.25 sec, wall time      1.58 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     19.19 sec, wall time      1.65 sec
    CPU time for coul_kpt[ 2 / 4]     14.94 sec, wall time      1.64 sec
    CPU time for coul_kpt[ 3 / 4]     14.64 sec, wall time      1.63 sec
    CPU time for coul_kpt[ 4 / 4]     15.00 sec, wall time      1.64 sec
    CPU time for building coul_kpt     64.72 sec, wall time      6.60 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49977561/teql6ltq


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49977561/tmpfho8avz4
max_memory 327680 MB (current use 389 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f223194dff0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.71 sec, wall time      0.18 sec
E1 = (3.6045119533033367-4.084385728479699e-18j)  E_coul = (-4.238150939589059+6.763353001530449e-18j)
init E= -13.42076813191
    CPU time for initialize scf     10.88 sec, wall time      0.35 sec
HOMO = 0.642148887944  LUMO = 0.776528304143
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422372  0.60527281  0.60923088  0.64214889] [0.85981204 0.88582615 0.91020186 1.12520373 1.79100345 1.80523334
 1.86205302 2.08341907 2.08748701 2.09925138 2.64579821 2.64766348
 2.64895306 3.55319589 3.55392248 3.55480388 3.65950818 3.6602922
 4.21011984 4.73495057 4.73542339 4.73596524]
   1 (-0.000 -0.000  0.500)   [-0.78015221 -0.50848295  0.46133089  0.50284999] [0.94785901 1.02143256 1.04032692 1.35354543 1.62942696 1.75601309
 1.81456889 1.82408303 2.11260174 2.11925369 2.95658502 3.06755061
 3.06862918 3.10243209 3.10320834 3.30379506 3.64927558 3.65340281
 3.76724456 3.7677628  5.13917499 9.64996112]
   2 ( 0.000  0.500 -0.000)   [-0.78015231 -0.50848285  0.4613309   0.50285007] [0.94785925 1.02143191 1.04032652 1.35354568 1.62942678 1.75601242
 1.81456992 1.82408355 2.11260176 2.11925333 2.9565864  3.06755033
 3.06862907 3.10243214 3.10320838 3.30379422 3.64927448 3.6534064
 3.76724519 3.76776176 5.13917609 9.64996163]
   3 ( 0.000  0.500  0.500)   [-0.41689379 -0.40450196  0.22475913  0.31063596] [0.7765283  0.84136867 1.4015341  1.40349558 1.67780102 1.68166111
 2.07043235 2.07586536 2.31225616 2.31465184 2.79346737 2.80080049
 2.87065854 2.87949513 2.95490237 2.95599525 3.67413141 3.67560562
 5.04761695 5.04823698 6.80908874 6.81454405]
    CPU time for vj and vk      5.91 sec, wall time      0.19 sec
E1 = (4.198022473739221+6.131057775414693e-18j)  E_coul = (-2.232609501447464-1.840183329398922e-18j)
cycle= 1 E= -10.8217161733325  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      6.38 sec, wall time      0.20 sec
HOMO = 0.352245965749  LUMO = 0.89827140492
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169496  0.30156448  0.34067917  0.35224597] [0.9785293  0.99133801 1.01471943 1.33231975 1.8055419  1.806021
 1.884046   2.11998747 2.12203233 2.12540096 2.7080829  2.71166925
 2.71194514 3.56353277 3.56541071 3.56997912 3.69759019 3.70486818
 4.22159828 4.77131228 4.77264427 4.77473858]
   1 (-0.000 -0.000  0.500)   [-0.39621879 -0.25657635  0.18712876  0.2227335 ] [1.0929316  1.1050057  1.15031211 1.39709917 1.68430081 1.81149938
 1.84709106 1.85165903 2.11920438 2.12573809 3.00549311 3.12357396
 3.12502597 3.13812161 3.14101131 3.32109491 3.66803396 3.66810393
 3.79985904 3.80639224 5.18613388 9.83351534]
   2 ( 0.000  0.500 -0.000)   [-0.39621887 -0.25657608  0.18712883  0.22273311] [1.09293189 1.10500511 1.15031105 1.39709982 1.68430112 1.81149737
 1.84709242 1.8516606  2.1192053  2.12573783 3.00549502 3.12357439
 3.12502767 3.13812383 3.14101291 3.32109317 3.66804192 3.6681009
 3.7998584  3.80639148 5.1861337  9.83351115]
   3 ( 0.000  0.500  0.500)   [-0.25545722 -0.25123121  0.03956586  0.07509157] [0.8982714  0.95900155 1.5027421  1.50995523 1.74944433 1.76464481
 2.07049164 2.07210983 2.32316357 2.3306823  2.8434747  2.8514334
 2.88508048 2.88514413 2.98375322 2.98719463 3.73224152 3.73350172
 5.07643047 5.07996272 6.89788321 6.89899611]
    CPU time for vj and vk      5.88 sec, wall time      0.19 sec
E1 = (4.194213431858862+9.458725751651807e-18j)  E_coul = (-2.2412730872232247-2.0817302685509083e-18j)
cycle= 2 E= -10.8341888009886  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      6.45 sec, wall time      0.20 sec
HOMO = 0.346103609462  LUMO = 0.903473903801
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976205  0.30008742  0.33519566  0.34610361] [0.98176757 0.99581728 1.0171147  1.33874717 1.80541298 1.80618373
 1.88485644 2.12065032 2.12314136 2.12643611 2.70746176 2.71030234
 2.71096462 3.56370392 3.56582008 3.56959527 3.6989222  3.70582086
 4.21948243 4.77235081 4.77325304 4.77524005]
   1 (-0.000 -0.000  0.500)   [-0.39588274 -0.25761004  0.18697389  0.21794675] [1.09766367 1.1085007  1.15152562 1.39894091 1.68507951 1.81195258
 1.8460942  1.85179358 2.119225   2.12552631 3.00621212 3.12425512
 3.12524143 3.13886324 3.14126779 3.32162684 3.66769439 3.66834076
 3.80025903 3.80640043 5.18501633 9.82837997]
   2 ( 0.000  0.500 -0.000)   [-0.39588287 -0.25760974  0.18697396  0.21794634] [1.09766401 1.10850005 1.15152451 1.3989415  1.68507975 1.81195066
 1.84609538 1.85179497 2.11922601 2.12552607 3.00621407 3.12425542
 3.125243   3.13886514 3.14126931 3.32162499 3.66769096 3.66834856
 3.80025858 3.80639965 5.18501606 9.82837591]
   3 ( 0.000  0.500  0.500)   [-0.25627763 -0.25205357  0.04012029  0.07063014] [0.9034739  0.95976827 1.50638136 1.51278405 1.75053629 1.76461165
 2.07003512 2.07148823 2.32338716 2.33115212 2.8434929  2.85177762
 2.88518044 2.88526908 2.98354853 2.98724323 3.73376374 3.7346005
 5.07651321 5.07922569 6.89473146 6.89640986]
    CPU time for vj and vk      5.80 sec, wall time      0.18 sec
E1 = (4.193448419729061+9.76934926049479e-18j)  E_coul = (-2.2411020202352625-2.11881970043595e-18j)
cycle= 3 E= -10.8347827461304  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      6.39 sec, wall time      0.20 sec
HOMO = 0.346445117034  LUMO = 0.903778229252
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926183  0.30046139  0.33534983  0.34644512] [0.98224864 0.99639665 1.01756123 1.33932092 1.80561616 1.80636088
 1.8847251  2.12079943 2.12323681 2.12658541 2.7078524  2.71065047
 2.71140119 3.56380863 3.56596157 3.56963138 3.69923697 3.70609221
 4.21953595 4.77262694 4.77349985 4.77547333]
   1 (-0.000 -0.000  0.500)   [-0.3952789  -0.25726927  0.18743802  0.21819304] [1.09807891 1.10896219 1.15171691 1.39901294 1.6852199  1.81232565
 1.84631083 1.85202971 2.1194324  2.12560137 3.00655683 3.12449472
 3.12538966 3.13936899 3.14172603 3.3217429  3.66777955 3.66847974
 3.80048664 3.80660781 5.18532996 9.82962815]
   2 ( 0.000  0.500 -0.000)   [-0.39527902 -0.25726899  0.18743808  0.21819264] [1.09807925 1.10896156 1.15171579 1.39901353 1.68522015 1.81232373
 1.84631203 1.85203109 2.11943339 2.1256011  3.00655877 3.12449505
 3.12539124 3.13937089 3.14172754 3.32174108 3.66777614 3.66848755
 3.80048617 3.80660703 5.18532972 9.82962409]
   3 ( 0.000  0.500  0.500)   [-0.25578437 -0.25164467  0.04054069  0.07090452] [0.90377823 0.95976228 1.50715869 1.51356271 1.75082311 1.76488292
 2.07012017 2.07149888 2.32349608 2.33138696 2.84383863 2.85206866
 2.88519174 2.88541409 2.98374845 2.98746908 3.73407591 3.73506133
 5.07675619 5.0794077  6.895254   6.89710292]
    CPU time for vj and vk      5.90 sec, wall time      0.19 sec
E1 = (4.193477547116423+9.730683493414444e-18j)  E_coul = (-2.241133834219742-2.119431044078154e-18j)
cycle= 4 E= -10.8347854327276  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      6.49 sec, wall time      0.21 sec
HOMO = 0.346401172905  LUMO = 0.903765023584
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931498  0.30040402  0.33527355  0.34640117] [0.9822249  0.99636302 1.01752531 1.33926572 1.8056039  1.80633797
 1.88473879 2.12078969 2.12321554 2.12657256 2.70779628 2.71059243
 2.71135394 3.56379653 3.56595071 3.56961327 3.69920785 3.70606205
 4.21951914 4.77260251 4.7734711  4.77544411]
   1 (-0.000 -0.000  0.500)   [-0.39529987 -0.25733799  0.18738937  0.21812769] [1.09803691 1.10893319 1.15169273 1.39901839 1.68519074 1.81228543
 1.84626724 1.85199271 2.11942524 2.12557682 3.00652523 3.12448278
 3.12537236 3.13931723 3.14167109 3.32173508 3.66776021 3.66847058
 3.80045385 3.80657469 5.18529165 9.8294529 ]
   2 ( 0.000  0.500 -0.000)   [-0.39529999 -0.25733771  0.18738944  0.21812729] [1.09803725 1.10893256 1.1516916  1.39901897 1.68519099 1.81228352
 1.84626844 1.85199409 2.11942624 2.12557655 3.00652717 3.12448311
 3.12537395 3.13931913 3.14167259 3.32173325 3.6677568  3.66847839
 3.80045338 3.80657391 5.18529141 9.82944883]
   3 ( 0.000  0.500  0.500)   [-0.25584267 -0.25170071  0.0404891   0.07086699] [0.90376502 0.9597538  1.50710712 1.51353062 1.75075624 1.76482196
 2.07010422 2.07148698 2.32347307 2.33136394 2.84379769 2.85202473
 2.88518242 2.88541071 2.98371675 2.98745018 3.73403378 3.7350236
 5.07673284 5.07937883 6.89516192 6.89702574]
    CPU time for vj and vk      5.87 sec, wall time      0.19 sec
E1 = (4.193499045962042+9.727507888051397e-18j)  E_coul = (-2.2411553792147805-2.119306768041414e-18j)
cycle= 5 E= -10.834785478877  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      6.44 sec, wall time      0.20 sec
HOMO = 0.346408161836  LUMO = 0.903766181391
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6693122   0.30040494  0.33527407  0.34640816] [0.98222633 0.99636454 1.01752608 1.33926739 1.80560455 1.80633868
 1.88473775 2.12078935 2.12321485 2.12657329 2.70779747 2.71059396
 2.71135722 3.56379706 3.56595135 3.5696132  3.69920866 3.70606275
 4.21952017 4.77260341 4.77347177 4.77544483]
   1 (-0.000 -0.000  0.500)   [-0.39529456 -0.25733518  0.18739044  0.21812868] [1.0980377  1.10893465 1.15169217 1.39901758 1.68519191 1.81228768
 1.84626792 1.85199398 2.11942807 2.12557711 3.00652738 3.1244838
 3.12537252 3.13931879 3.14167219 3.32173504 3.6677601  3.66847157
 3.80045389 3.80657514 5.18529347 9.82946068]
   2 ( 0.000  0.500 -0.000)   [-0.39529468 -0.2573349   0.1873905   0.21812828] [1.09803804 1.10893402 1.15169105 1.39901816 1.68519216 1.81228576
 1.84626912 1.85199536 2.11942907 2.12557685 3.00652933 3.12448413
 3.12537411 3.13932069 3.14167369 3.32173321 3.66775669 3.66847938
 3.80045341 3.80657436 5.18529322 9.82945661]
   3 ( 0.000  0.500  0.500)   [-0.25583909 -0.25169958  0.04049052  0.07087119] [0.90376618 0.95975337 1.50710871 1.51353532 1.75075659 1.76482087
 2.07010513 2.07148722 2.32347274 2.33136543 2.843799   2.85202544
 2.88518148 2.88541208 2.98371733 2.98745176 3.73403351 3.735026
 5.07673411 5.07937986 6.89516429 6.89703102]
    CPU time for vj and vk      5.79 sec, wall time      0.18 sec
E1 = (4.193499622319136+9.727411250696831e-18j)  E_coul = (-2.241155956451067-2.119254640458287e-18j)
Extra cycle  E= -10.8347854797562  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     49.36 sec, wall time      1.57 sec
    CPU time for SCF     51.41 sec, wall time      1.64 sec
converged SCF energy = -10.8347854797562
**** SCF Summaries ****
Total Energy =                         -10.834785479756171
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193499622319136
Two-electron Energy =                   -2.241155956451067
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.80 sec, wall time      0.06 sec
End time = Tue Jun  3 12:30:15 PM PDT 2025
