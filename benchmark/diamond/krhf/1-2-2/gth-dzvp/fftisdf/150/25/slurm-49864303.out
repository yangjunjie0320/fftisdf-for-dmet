SLURMD_NODENAME = hpc-35-02
Start time = Wed May 28 02:58:41 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49864303/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49864303/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/150/25/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-150-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-25
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 25.0
wrap_around = True

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2303, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 24389, selected grid size = 650
truncated values = 6.96e+01, estimated error = 1.23e-01
Number of interpolating points is 650.
    CPU time for building inpv_kpt     43.88 sec, wall time     36.31 sec

Out-core version is used for eta_kpt.
disk space required: 1.01e+00 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   1.01e+00 GB
memory needed for each k-point: 2.54e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     19.90 sec, wall time      1.51 sec
    CPU time for building eta_kpt     22.94 sec, wall time      1.60 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     18.95 sec, wall time      1.64 sec
    CPU time for coul_kpt[ 2 / 4]     14.68 sec, wall time      1.64 sec
    CPU time for coul_kpt[ 3 / 4]     14.99 sec, wall time      1.65 sec
    CPU time for coul_kpt[ 4 / 4]     16.12 sec, wall time      1.69 sec
    CPU time for building coul_kpt     65.68 sec, wall time      6.65 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49864303/qhud1k4r


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-150-25/49864303/tmp78zhdfip
max_memory 327680 MB (current use 390 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f013f356f50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.65 sec, wall time      0.18 sec
E1 = (3.6045119533033363-2.7229238189864227e-18j)  E_coul = (-4.238150940313509+7.848854191120731e-18j)
init E= -13.4207681326344
    CPU time for initialize scf     10.78 sec, wall time      0.35 sec
HOMO = 0.642148885493  LUMO = 0.776528301848
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422372  0.60527281  0.60923087  0.64214889] [0.85981203 0.88582615 0.91020186 1.12520375 1.79100345 1.80523334
 1.86205301 2.08341902 2.08748704 2.09925177 2.64579824 2.64766342
 2.64895309 3.55319717 3.55392256 3.5548038  3.65950822 3.66029221
 4.21011892 4.73495061 4.73542246 4.73596604]
   1 ( 0.000  0.000 -0.500)   [-0.7801522  -0.50848295  0.46133089  0.50284999] [0.94785903 1.02143256 1.04032692 1.35354546 1.62942698 1.75601318
 1.81456894 1.824083   2.11260175 2.11925375 2.95658511 3.06755061
 3.0686296  3.10243217 3.10320828 3.30379512 3.64927573 3.65340284
 3.7672447  3.76776325 5.13917537 9.6499612 ]
   2 (-0.000 -0.500  0.000)   [-0.78015231 -0.50848285  0.4613309   0.50285007] [0.94785927 1.02143191 1.04032652 1.35354573 1.62942678 1.75601257
 1.81456983 1.82408354 2.11260174 2.11925341 2.95658648 3.06755021
 3.06862971 3.10243205 3.10320838 3.30379417 3.64927442 3.65340657
 3.76724531 3.76776273 5.13917614 9.64996111]
   3 ( 0.000 -0.500 -0.500)   [-0.41689379 -0.40450196  0.22475913  0.31063596] [0.7765283  0.84136867 1.40153408 1.40349557 1.67780099 1.6816611
 2.07043241 2.0758655  2.31225616 2.31465184 2.79346743 2.80080077
 2.87065855 2.87949512 2.95490242 2.95599539 3.6741314  3.67560563
 5.04761862 5.04824003 6.80908846 6.81454372]
    CPU time for vj and vk      5.87 sec, wall time      0.19 sec
E1 = (4.198022481543196-2.177994058678638e-17j)  E_coul = (-2.232609514625957-6.653957388678717e-19j)
cycle= 1 E= -10.821716178707  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      6.34 sec, wall time      0.20 sec
HOMO = 0.352245956544  LUMO = 0.898271403098
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169496  0.30156448  0.34067916  0.35224596] [0.97852931 0.991338   1.01471943 1.33231978 1.8055419  1.806021
 1.88404595 2.11998752 2.12203231 2.12540123 2.7080822  2.71166927
 2.71194507 3.5635324  3.56541102 3.56998017 3.69759022 3.70486822
 4.22159752 4.77131208 4.77264499 4.77473422]
   1 ( 0.000  0.000 -0.500)   [-0.39621879 -0.25657635  0.18712876  0.22273349] [1.09293159 1.10500568 1.15031211 1.39709923 1.68430081 1.81149948
 1.84709108 1.85165899 2.11920441 2.12573816 3.00549322 3.12357394
 3.12502582 3.13812161 3.1410118  3.32109523 3.6680337  3.66810422
 3.7998592  3.8063931  5.18613451 9.83351558]
   2 (-0.000 -0.500  0.000)   [-0.39621888 -0.25657608  0.18712883  0.2227331 ] [1.09293189 1.10500509 1.15031106 1.39709985 1.68430111 1.81149743
 1.84709238 1.85166049 2.11920522 2.12573788 3.0054951  3.12357445
 3.12502778 3.1381235  3.14101329 3.32109334 3.66804159 3.66810159
 3.79985822 3.80639226 5.18613358 9.83350992]
   3 ( 0.000 -0.500 -0.500)   [-0.25545722 -0.25123121  0.03956585  0.07509157] [0.8982714  0.95900156 1.50274207 1.5099552  1.74944428 1.76464478
 2.07049167 2.07211003 2.32316357 2.33068229 2.84347473 2.8514337
 2.88508066 2.88514407 2.98375338 2.98719477 3.73224142 3.73350172
 5.07643654 5.07996454 6.89788378 6.89899621]
    CPU time for vj and vk      5.86 sec, wall time      0.19 sec
E1 = (4.194213433042144-2.2313161884050194e-17j)  E_coul = (-2.241273092382783-7.964788399453034e-19j)
cycle= 2 E= -10.8341888049649  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      6.43 sec, wall time      0.20 sec
HOMO = 0.346103603287  LUMO = 0.90347390198
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976205  0.30008743  0.33519566  0.3461036 ] [0.98176758 0.99581726 1.01711469 1.3387472  1.80541298 1.80618372
 1.88485638 2.12065039 2.12314135 2.12643635 2.70746113 2.71030233
 2.71096452 3.56370357 3.56582045 3.5695962  3.69892221 3.70582089
 4.2194816  4.7723503  4.77325364 4.7752364 ]
   1 ( 0.000  0.000 -0.500)   [-0.39588274 -0.25761003  0.18697389  0.21794675] [1.09766366 1.10850068 1.15152561 1.39894098 1.68507952 1.81195268
 1.84609421 1.85179355 2.11922503 2.12552637 3.00621221 3.12425513
 3.12524129 3.13886325 3.14126827 3.32162718 3.66769479 3.66834056
 3.80025923 3.80640132 5.18501687 9.82838007]
   2 (-0.000 -0.500  0.000)   [-0.39588287 -0.25760973  0.18697396  0.21794633] [1.09766401 1.10850004 1.15152451 1.39894152 1.68507974 1.81195071
 1.84609536 1.85179487 2.11922594 2.12552611 3.00621417 3.12425549
 3.12524308 3.13886482 3.14126964 3.32162518 3.6676918  3.66834839
 3.80025849 3.80640034 5.18501593 9.82837454]
   3 ( 0.000 -0.500 -0.500)   [-0.25627763 -0.25205357  0.04012028  0.07063013] [0.9034739  0.95976828 1.50638134 1.51278403 1.75053624 1.76461162
 2.07003516 2.07148843 2.32338717 2.33115211 2.84349293 2.85177792
 2.88518064 2.88526904 2.98354868 2.98724337 3.73376364 3.73460052
 5.07651985 5.07922762 6.89473193 6.89640989]
    CPU time for vj and vk      5.79 sec, wall time      0.18 sec
E1 = (4.193448414146814-2.2008205593069667e-17j)  E_coul = (-2.2411020183961057-7.975779049655152e-19j)
cycle= 3 E= -10.8347827498735  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      6.39 sec, wall time      0.20 sec
HOMO = 0.346445111437  LUMO = 0.90377822798
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926183  0.30046139  0.33534983  0.34644511] [0.98224865 0.99639663 1.01756123 1.33932096 1.80561616 1.80636088
 1.88472504 2.12079949 2.12323679 2.12658566 2.70785177 2.71065046
 2.71140108 3.56380828 3.56596194 3.56963233 3.69923698 3.70609224
 4.21953511 4.77262644 4.77350045 4.77546964]
   1 ( 0.000  0.000 -0.500)   [-0.3952789  -0.25726927  0.18743801  0.21819304] [1.0980789  1.10896217 1.15171691 1.39901301 1.68521991 1.81232575
 1.84631084 1.85202968 2.11943243 2.12560143 3.00655692 3.12449472
 3.12538951 3.139369   3.14172651 3.32174324 3.66777995 3.66847954
 3.80048684 3.80660868 5.1853305  9.82962824]
   2 (-0.000 -0.500  0.000)   [-0.39527902 -0.25726899  0.18743808  0.21819263] [1.09807925 1.10896154 1.1517158  1.39901355 1.68522014 1.81232378
 1.84631201 1.852031   2.11943332 2.12560115 3.00655887 3.12449511
 3.12539132 3.13937057 3.14172788 3.32174126 3.66777698 3.66848736
 3.80048609 3.80660772 5.18532958 9.82962272]
   3 ( 0.000 -0.500 -0.500)   [-0.25578437 -0.25164467  0.04054069  0.07090452] [0.90377823 0.95976228 1.50715866 1.51356269 1.75082307 1.76488289
 2.07012021 2.07149908 2.32349608 2.33138696 2.84383866 2.85206896
 2.88519194 2.88541404 2.98374861 2.98746922 3.73407582 3.73506135
 5.07676281 5.07940968 6.89525449 6.89710295]
    CPU time for vj and vk      5.86 sec, wall time      0.19 sec
E1 = (4.19347754126173-2.1895997449363772e-17j)  E_coul = (-2.2411338321072707-7.963786499234341e-19j)
cycle= 4 E= -10.8347854364698  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      6.45 sec, wall time      0.20 sec
HOMO = 0.346401167219  LUMO = 0.903765022322
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931498  0.30040403  0.33527354  0.34640117] [0.9822249  0.996363   1.01752531 1.33926576 1.8056039  1.80633797
 1.88473873 2.12078976 2.12321552 2.12657281 2.70779565 2.71059242
 2.71135384 3.56379618 3.56595108 3.56961422 3.69920786 3.70606208
 4.21951831 4.77260201 4.7734717  4.77544043]
   1 ( 0.000  0.000 -0.500)   [-0.39529987 -0.25733799  0.18738937  0.21812769] [1.0980369  1.10893317 1.15169272 1.39901845 1.68519075 1.81228552
 1.84626726 1.85199268 2.11942528 2.12557688 3.00652531 3.12448279
 3.12537222 3.13931724 3.14167156 3.32173542 3.6677606  3.66847038
 3.80045405 3.80657556 5.18529219 9.82945299]
   2 (-0.000 -0.500  0.000)   [-0.39529999 -0.25733771  0.18738944  0.21812728] [1.09803725 1.10893254 1.15169161 1.399019   1.68519098 1.81228356
 1.84626842 1.851994   2.11942617 2.1255766  3.00652727 3.12448317
 3.12537403 3.13931881 3.14167293 3.32173344 3.66775764 3.6684782
 3.80045329 3.8065746  5.18529127 9.82944746]
   3 ( 0.000 -0.500 -0.500)   [-0.25584266 -0.25170071  0.0404891   0.07086699] [0.90376502 0.9597538  1.5071071  1.51353059 1.75075619 1.76482193
 2.07010426 2.07148718 2.32347308 2.33136393 2.84379773 2.85202502
 2.88518262 2.88541066 2.98371691 2.98745032 3.73403369 3.73502363
 5.07673946 5.07938081 6.89516241 6.89702578]
    CPU time for vj and vk      5.88 sec, wall time      0.19 sec
E1 = (4.193499040074995-2.1886145921132542e-17j)  E_coul = (-2.241155377069954-7.9615267765476595e-19j)
cycle= 5 E= -10.8347854826192  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      6.49 sec, wall time      0.21 sec
HOMO = 0.346408156131  LUMO = 0.903766180133
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931221  0.30040495  0.33527407  0.34640816] [0.98222633 0.99636452 1.01752608 1.33926742 1.80560455 1.80633868
 1.88473769 2.12078942 2.12321483 2.12657353 2.70779684 2.71059396
 2.71135711 3.5637967  3.56595172 3.56961415 3.69920867 3.70606279
 4.21951934 4.77260291 4.77347237 4.77544114]
   1 ( 0.000  0.000 -0.500)   [-0.39529456 -0.25733518  0.18739043  0.21812868] [1.09803769 1.10893463 1.15169216 1.39901764 1.68519192 1.81228777
 1.84626794 1.85199395 2.11942811 2.12557717 3.00652747 3.12448381
 3.12537238 3.13931881 3.14167266 3.32173538 3.6677605  3.66847137
 3.80045409 3.80657601 5.185294   9.82946077]
   2 (-0.000 -0.500  0.000)   [-0.39529468 -0.2573349   0.1873905   0.21812827] [1.09803804 1.108934   1.15169105 1.39901819 1.68519215 1.81228581
 1.8462691  1.85199527 2.119429   2.12557689 3.00652943 3.1244842
 3.12537419 3.13932037 3.14167403 3.32173339 3.66775753 3.66847919
 3.80045333 3.80657505 5.18529308 9.82945524]
   3 ( 0.000 -0.500 -0.500)   [-0.25583909 -0.25169957  0.04049051  0.07087119] [0.90376618 0.95975337 1.50710869 1.5135353  1.75075654 1.76482084
 2.07010517 2.07148742 2.32347275 2.33136542 2.84379903 2.85202574
 2.88518168 2.88541204 2.98371749 2.9874519  3.73403341 3.73502602
 5.07674073 5.07938184 6.89516478 6.89703105]
    CPU time for vj and vk      5.84 sec, wall time      0.19 sec
E1 = (4.193499616429913-2.188726305846966e-17j)  E_coul = (-2.2411559543040704-7.960902711883003e-19j)
Extra cycle  E= -10.8347854834984  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     49.30 sec, wall time      1.57 sec
    CPU time for SCF     51.28 sec, wall time      1.64 sec
converged SCF energy = -10.8347854834984
**** SCF Summaries ****
Total Energy =                         -10.834785483498397
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193499616429913
Two-electron Energy =                   -2.241155954304070
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.85 sec, wall time      0.06 sec
End time = Wed May 28 02:59:29 PM PDT 2025
