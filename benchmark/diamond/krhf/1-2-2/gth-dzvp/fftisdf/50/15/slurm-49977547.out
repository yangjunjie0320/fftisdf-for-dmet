SLURMD_NODENAME = hpc-34-15
Start time = Tue Jun  3 12:28:59 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49977547/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49977547/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/50/15/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-50-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-15
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 15.0
wrap_around = False

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 4913, selected grid size = 390
truncated values = 6.65e+01, estimated error = 7.56e-01
Number of interpolating points is 390.
    CPU time for building inpv_kpt      8.27 sec, wall time      1.68 sec

Out-core version is used for eta_kpt.
disk space required: 1.23e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   1.23e-01 GB
memory needed for each k-point: 3.07e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      6.27 sec, wall time      0.21 sec
    CPU time for building eta_kpt      7.24 sec, wall time      0.24 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      7.37 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 2 / 4]      6.92 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 3 / 4]      6.92 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 4 / 4]      6.95 sec, wall time      0.23 sec
    CPU time for building coul_kpt     28.46 sec, wall time      0.92 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49977547/zww301ha


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49977547/tmp4vvwuf_b
max_memory 327680 MB (current use 429 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f3af2c12020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.48 sec, wall time      0.05 sec
E1 = (3.6045120653301033+1.179933656035277e-17j)  E_coul = (-4.23815542493105+1.730117559032778e-17j)
init E= -13.4207725052252
    CPU time for initialize scf      3.15 sec, wall time      0.11 sec
HOMO = 0.642140740724  LUMO = 0.776532095337
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422512  0.60527477  0.60922439  0.64214074] [0.85980724 0.88583003 0.91018352 1.1252156  1.7909989  1.80523472
 1.86206848 2.08339299 2.08747958 2.09923792 2.6457881  2.6476445
 2.64895226 3.55322294 3.55392942 3.55479518 3.65950287 3.66028427
 4.21016457 4.73496694 4.73543214 4.73596115]
   1 (-0.000 -0.000  0.500)   [-0.78015498 -0.50848154  0.46132715  0.50284761] [0.94786066 1.02142898 1.04031343 1.35354023 1.62941828 1.7560155
 1.81454998 1.8240848  2.11259914 2.11926047 2.95659483 3.06750511
 3.06864513 3.10242011 3.10320205 3.30379501 3.64926272 3.65339225
 3.76723832 3.7677846  5.1392556  9.65014185]
   2 ( 0.000  0.500 -0.000)   [-0.78015528 -0.50848419  0.46133497  0.50284548] [0.94785526 1.02142078 1.04031448 1.35354017 1.62942239 1.75601106
 1.81455297 1.82408767 2.11260402 2.1192587  2.9565924  3.06753861
 3.06862985 3.10243803 3.10318704 3.30380257 3.64926272 3.65340391
 3.76725641 3.76777273 5.13926855 9.65013841]
   3 ( 0.000  0.500  0.500)   [-0.416894   -0.40450667  0.22475541  0.31063752] [0.7765321  0.8413632  1.40153414 1.40347104 1.67779607 1.68165165
 2.07043237 2.0758769  2.31225682 2.31465091 2.79346627 2.80080238
 2.8706489  2.87949027 2.95489836 2.9559954  3.67414334 3.67561359
 5.0475789  5.04820515 6.80920043 6.81465759]
    CPU time for vj and vk      1.50 sec, wall time      0.05 sec
E1 = (4.198006041522425-5.3417971066008606e-18j)  E_coul = (-2.2326398359878183+4.94547078026019e-18j)
cycle= 1 E= -10.8217629400896  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      1.96 sec, wall time      0.06 sec
HOMO = 0.352239610613  LUMO = 0.898281807975
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169272  0.30152139  0.34065378  0.35223961] [0.97852096 0.99131966 1.01472333 1.33234007 1.80553998 1.80602018
 1.8840708  2.11995679 2.12201995 2.12538443 2.70807732 2.71163007
 2.71194088 3.56352116 3.56540185 3.57004724 3.69758541 3.70487107
 4.22166866 4.7713433  4.77266161 4.77470181]
   1 (-0.000 -0.000  0.500)   [-0.39621803 -0.25656887  0.18710169  0.22270895] [1.0929369  1.10500368 1.15030383 1.39709398 1.68430008 1.81149437
 1.84706532 1.85166573 2.11920433 2.12575648 3.00551518 3.12356666
 3.12500305 3.13805628 3.14100331 3.3210868  3.66801259 3.66807037
 3.79984838 3.80642669 5.18622084 9.83369703]
   2 ( 0.000  0.500 -0.000)   [-0.39621937 -0.25657705  0.1871032   0.22272729] [1.09294252 1.10498908 1.15029965 1.39710126 1.68428393 1.81148428
 1.84708641 1.85167949 2.11920557 2.12576471 3.00552516 3.12357948
 3.12500853 3.13810732 3.14100528 3.32109941 3.66801586 3.66808009
 3.79986503 3.80639829 5.1862155  9.83369255]
   3 ( 0.000  0.500  0.500)   [-0.25545064 -0.25123464  0.03955369  0.07508824] [0.89828181 0.95899283 1.50272458 1.5099558  1.74941954 1.76463814
 2.07048835 2.07214709 2.32317216 2.3306835  2.84347282 2.85141841
 2.88508651 2.88513556 2.98377115 2.98719551 3.73226713 3.73352927
 5.07635329 5.079876   6.89799749 6.89912002]
    CPU time for vj and vk      1.56 sec, wall time      0.05 sec
E1 = (4.194220462424535-3.9605442367227116e-18j)  E_coul = (-2.2413311373611258+5.22263943230417e-18j)
cycle= 2 E= -10.8342398205608  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.06
    CPU time for cycle= 2      2.30 sec, wall time      0.08 sec
HOMO = 0.34609164168  LUMO = 0.903484263396
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976249  0.30004001  0.33516355  0.34609164] [0.98175536 0.99579717 1.01711406 1.33876287 1.80541071 1.8061802
 1.88488385 2.12061517 2.12313088 2.12641685 2.70744648 2.71025639
 2.71095355 3.56369381 3.56580925 3.56965813 3.69891457 3.70582099
 4.21955445 4.77237584 4.7732698  4.7752086 ]
   1 (-0.000 -0.000  0.500)   [-0.39588582 -0.25760619  0.1869435   0.21791624] [1.0976666  1.10849635 1.15151454 1.39893648 1.68507413 1.81194381
 1.84606459 1.85179722 2.1192233  2.12554277 3.00623004 3.12424783
 3.12521475 3.13879234 3.1412528  3.32161781 3.66766274 3.66832661
 3.80024589 3.80643019 5.18509844 9.8285441 ]
   2 ( 0.000  0.500 -0.000)   [-0.39588729 -0.25761393  0.18694491  0.21793434] [1.09767173 1.10848206 1.15151186 1.39894267 1.68505726 1.81193435
 1.8460851  1.85180881 2.11922487 2.12555094 3.00624046 3.12426132
 3.12522066 3.13884367 3.14125604 3.32163078 3.66766537 3.66833373
 3.80026573 3.80640031 5.18509275 9.82854142]
   3 ( 0.000  0.500  0.500)   [-0.25627549 -0.25206074  0.04010409  0.07062092] [0.90348426 0.95975987 1.50636063 1.51277765 1.75050611 1.76459788
 2.07002855 2.07152254 2.32339267 2.33115294 2.84348619 2.85175853
 2.88518699 2.88525912 2.98356082 2.98724264 3.73378428 3.73462752
 5.07642606 5.07914568 6.89483801 6.89652485]
    CPU time for vj and vk      1.52 sec, wall time      0.05 sec
E1 = (4.193455763675061-3.5157693764493134e-18j)  E_coul = (-2.2411606178796064+5.286454581255652e-18j)
cycle= 3 E= -10.8348339998288  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.839
    CPU time for cycle= 3      2.13 sec, wall time      0.07 sec
HOMO = 0.346434297156  LUMO = 0.903788945848
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926149  0.30041506  0.3353184   0.3464343 ] [0.98223737 0.99637718 1.01756141 1.33933781 1.80561421 1.80635778
 1.88475202 2.12076476 2.12322663 2.12656637 2.70783814 2.71060575
 2.71139139 3.56379875 3.56595122 3.56969477 3.69922986 3.70609299
 4.21960819 4.77265286 4.77351678 4.77544247]
   1 (-0.000 -0.000  0.500)   [-0.39528122 -0.25726463  0.18740845  0.21816317] [1.09808267 1.10895846 1.1517062  1.39900866 1.68521543 1.81231808
 1.84628196 1.85203416 2.11943124 2.12561815 3.00657558 3.1244877
 3.12536337 3.13929915 3.14171191 3.32173412 3.66774799 3.66846595
 3.80047401 3.80663815 5.1854128  9.82979601]
   2 ( 0.000  0.500 -0.000)   [-0.3952826  -0.25727249  0.18740981  0.21818162] [1.09808777 1.10894418 1.1517036  1.39901485 1.68519835 1.8123084
 1.84630264 1.85204573 2.11943265 2.12562628 3.00658607 3.12450124
 3.12536944 3.13935063 3.14171527 3.32174717 3.66775067 3.66847321
 3.80049379 3.80660805 5.18540725 9.82979332]
   3 ( 0.000  0.500  0.500)   [-0.25578134 -0.25165119  0.04052528  0.07089623] [0.90378895 0.95975391 1.50713933 1.51355784 1.75079402 1.76487017
 2.07011413 2.07153334 2.32350208 2.3313881  2.84383284 2.8520504
 2.88520071 2.88540215 2.98376144 2.98746913 3.73409723 3.73508904
 5.0766693  5.07932799 6.8953623  6.89721953]
    CPU time for vj and vk      1.57 sec, wall time      0.05 sec
E1 = (4.193484667628819-3.4441948339123836e-18j)  E_coul = (-2.241192208410421+5.295299882039623e-18j)
cycle= 4 E= -10.8348366864058  delta_E= -2.69e-06  |g|= 0.000615  |ddm|= 0.0988
    CPU time for cycle= 4      2.16 sec, wall time      0.07 sec
HOMO = 0.34639037516  LUMO = 0.903775709117
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931464  0.30035764  0.33524208  0.34639038] [0.98221365 0.99634354 1.01752547 1.33928257 1.80560194 1.80633487
 1.88476572 2.12075503 2.12320535 2.12655349 2.70778192 2.71054768
 2.71134412 3.56378663 3.56594034 3.56967661 3.69920072 3.70606281
 4.21959136 4.7726284  4.77348804 4.77541333]
   1 (-0.000 -0.000  0.500)   [-0.39530217 -0.25733335  0.18735976  0.21809781] [1.09804067 1.10892945 1.15168199 1.39901413 1.68518625 1.81227786
 1.84623836 1.85199715 2.11942407 2.12559358 3.00654393 3.12447575
 3.12534605 3.1392474  3.1416569  3.3217263  3.66772867 3.66845684
 3.80044121 3.80660499 5.18537447 9.82962066]
   2 ( 0.000  0.500 -0.000)   [-0.39530356 -0.2573412   0.18736112  0.21811626] [1.09804574 1.10891518 1.15167943 1.3990203  1.68516916 1.81226818
 1.84625903 1.85200869 2.1194255  2.1256017  3.00655442 3.12448929
 3.12535213 3.13929886 3.14166027 3.32173934 3.66773131 3.66846408
 3.800461   3.80657489 5.18536892 9.82961798]
   3 ( 0.000  0.500  0.500)   [-0.25583964 -0.25170722  0.04047366  0.07085871] [0.90377571 0.95974543 1.50708773 1.51352577 1.75072711 1.76480919
 2.07009817 2.07152136 2.32347907 2.33136507 2.84379187 2.85200644
 2.88519128 2.88539885 2.9837297  2.98745022 3.73405508 3.7350513
 5.07664594 5.07929915 6.8952701  6.89714239]
    CPU time for vj and vk      1.53 sec, wall time      0.05 sec
E1 = (4.193506161998178-3.4355923623369853e-18j)  E_coul = (-2.2412137489840203+5.29808984592349e-18j)
cycle= 5 E= -10.8348367326101  delta_E= -4.62e-08  |g|= 8.48e-05  |ddm|= 0.00955
    CPU time for cycle= 5      2.20 sec, wall time      0.07 sec
HOMO = 0.346397359435  LUMO = 0.903776864238
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931188  0.30035854  0.33524259  0.34639736] [0.98221508 0.99634505 1.01752624 1.33928423 1.80560259 1.80633558
 1.88476468 2.12075469 2.12320466 2.12655421 2.7077831  2.71054921
 2.71134739 3.56378715 3.56594098 3.56967655 3.69920153 3.70606351
 4.21959238 4.77262929 4.7734887  4.77541404]
   1 (-0.000 -0.000  0.500)   [-0.39529687 -0.25733055  0.18736081  0.21809879] [1.09804145 1.10893091 1.15168143 1.39901333 1.68518742 1.8122801
 1.84623904 1.85199841 2.11942689 2.12559388 3.00654608 3.12447677
 3.12534621 3.13924895 3.14165799 3.32172626 3.66772856 3.66845782
 3.80044124 3.80660544 5.18537628 9.82962842]
   2 ( 0.000  0.500 -0.000)   [-0.39529826 -0.25733841  0.18736217  0.21811724] [1.09804652 1.10891663 1.15167887 1.39901949 1.68517033 1.81227042
 1.8462597  1.85200996 2.11942833 2.125602   3.00655657 3.12449031
 3.12535229 3.13930041 3.14166136 3.3217393  3.6677312  3.66846506
 3.80046103 3.80657533 5.18537073 9.82962574]
   3 ( 0.000  0.500  0.500)   [-0.25583608 -0.2517061   0.04047506  0.0708629 ] [0.90377686 0.959745   1.50708931 1.51353047 1.75072746 1.76480809
 2.07009907 2.07152161 2.32347874 2.33136656 2.84379317 2.85200714
 2.88519041 2.88540016 2.98373028 2.9874518  3.7340548  3.73505369
 5.07664721 5.07930017 6.8952725  6.89714761]
    CPU time for vj and vk      1.50 sec, wall time      0.05 sec
E1 = (4.193506741198689-3.4374466427763878e-18j)  E_coul = (-2.241214329071761+5.298519992766715e-18j)
Extra cycle  E= -10.8348367334973  delta_E= -8.87e-10  |g|= 2.7e-05  |ddm|= 0.00139
    CPU time for scf_cycle     16.28 sec, wall time      0.54 sec
    CPU time for SCF     18.34 sec, wall time      0.61 sec
converged SCF energy = -10.8348367334973
**** SCF Summaries ****
Total Energy =                         -10.834836733497312
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193506741198689
Two-electron Energy =                   -2.241214329071761
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89507
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01163
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00286
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89511
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00003
charge of    1C =     -0.00003
    CPU time for vj and vk      0.70 sec, wall time      0.02 sec
End time = Tue Jun  3 12:29:04 PM PDT 2025
