SLURMD_NODENAME = hpc-35-04
Start time = Wed May 28 02:57:33 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49864289/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49864289/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/50/15/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-50-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-15
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 15.0
wrap_around = True

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 4913, selected grid size = 390
truncated values = 6.65e+01, estimated error = 7.56e-01
Number of interpolating points is 390.
    CPU time for building inpv_kpt      8.38 sec, wall time      1.68 sec

Out-core version is used for eta_kpt.
disk space required: 1.23e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   1.23e-01 GB
memory needed for each k-point: 3.07e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      6.19 sec, wall time      0.21 sec
    CPU time for building eta_kpt      7.17 sec, wall time      0.24 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      7.38 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 2 / 4]      7.13 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 3 / 4]      7.08 sec, wall time      0.23 sec
    CPU time for coul_kpt[ 4 / 4]      7.09 sec, wall time      0.23 sec
    CPU time for building coul_kpt     28.96 sec, wall time      0.92 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49864289/pd7pbaii


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-15/49864289/tmpigs6iwvt
max_memory 327680 MB (current use 433 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7ff0aa24d030>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      1.48 sec, wall time      0.05 sec
E1 = (3.6045120653301033+1.0891695278904144e-17j)  E_coul = (-4.238155425499581+1.807919252320124e-17j)
init E= -13.4207725057937
    CPU time for initialize scf      3.15 sec, wall time      0.11 sec
HOMO = 0.642140741222  LUMO = 0.776532096353
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422512  0.60527477  0.60922439  0.64214074] [0.85980724 0.88583003 0.91018352 1.1252156  1.7909989  1.80523472
 1.86206848 2.08339301 2.08747958 2.09923791 2.64578809 2.6476445
 2.64895223 3.55322292 3.55392943 3.5547952  3.65950288 3.66028429
 4.21016456 4.7349669  4.73543211 4.73596087]
   1 ( 0.000  0.000 -0.500)   [-0.78015498 -0.50848154  0.46132715  0.50284761] [0.94786066 1.02142898 1.04031343 1.35354023 1.62941828 1.7560155
 1.81454998 1.82408481 2.11259914 2.11926046 2.95659482 3.06750513
 3.06864512 3.1024201  3.10320205 3.30379501 3.64926267 3.65339232
 3.76723831 3.76778456 5.13925551 9.65014176]
   2 (-0.000 -0.500  0.000)   [-0.78015528 -0.50848419  0.46133497  0.50284548] [0.94785526 1.02142078 1.04031449 1.35354017 1.62942238 1.75601106
 1.81455298 1.82408766 2.11260402 2.1192587  2.95659241 3.06753858
 3.06862983 3.10243805 3.10318703 3.30380258 3.64926279 3.65340395
 3.76725636 3.76777267 5.13926864 9.65013834]
   3 ( 0.000 -0.500 -0.500)   [-0.416894   -0.40450667  0.22475541  0.31063752] [0.7765321  0.8413632  1.40153414 1.40347104 1.67779607 1.68165164
 2.07043238 2.0758769  2.31225682 2.31465091 2.79346629 2.80080238
 2.8706489  2.87949027 2.95489835 2.95599541 3.67414334 3.67561359
 5.04757933 5.04820536 6.80920041 6.81465761]
    CPU time for vj and vk      1.43 sec, wall time      0.05 sec
E1 = (4.198006041475653+8.659532348746287e-18j)  E_coul = (-2.2326398363243136+5.634974921747312e-18j)
cycle= 1 E= -10.8217629404729  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      1.90 sec, wall time      0.06 sec
HOMO = 0.352239608043  LUMO = 0.898281809803
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169272  0.30152139  0.34065378  0.35223961] [0.97852096 0.99131966 1.01472333 1.33234006 1.80553998 1.80602018
 1.88407079 2.11995682 2.12201996 2.1253844  2.70807721 2.71163008
 2.71194089 3.56352122 3.56540189 3.57004723 3.69758542 3.70487109
 4.2216686  4.77134345 4.77266155 4.77470094]
   1 ( 0.000  0.000 -0.500)   [-0.39621803 -0.25656887  0.18710169  0.22270895] [1.0929369  1.10500368 1.15030384 1.39709398 1.68430007 1.81149439
 1.84706533 1.85166574 2.11920433 2.12575649 3.00551516 3.12356667
 3.12500303 3.13805625 3.14100337 3.32108682 3.66801256 3.66807042
 3.79984832 3.80642679 5.1862208  9.83369647]
   2 (-0.000 -0.500  0.000)   [-0.39621937 -0.25657705  0.1871032   0.22272729] [1.09294251 1.10498908 1.15029965 1.39710125 1.68428393 1.8114843
 1.84708643 1.85167946 2.11920558 2.12576471 3.00552515 3.12357949
 3.12500857 3.13810731 3.14100528 3.3210994  3.66801585 3.66808021
 3.79986504 3.80639832 5.18621557 9.83369248]
   3 ( 0.000 -0.500 -0.500)   [-0.25545064 -0.25123464  0.03955369  0.07508824] [0.89828181 0.95899283 1.50272458 1.50995579 1.74941954 1.76463814
 2.07048836 2.07214712 2.32317216 2.3306835  2.84347285 2.85141848
 2.8850865  2.88513556 2.98377114 2.98719551 3.73226717 3.73352924
 5.07635319 5.07987597 6.89799755 6.89911999]
    CPU time for vj and vk      1.50 sec, wall time      0.05 sec
E1 = (4.194220461652765+7.690132925578141e-18j)  E_coul = (-2.241331137084278+5.909213635438143e-18j)
cycle= 2 E= -10.8342398210558  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.06
    CPU time for cycle= 2      2.06 sec, wall time      0.07 sec
HOMO = 0.34609163946  LUMO = 0.903484265815
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976249  0.30004001  0.33516355  0.34609164] [0.98175535 0.99579717 1.01711406 1.33876287 1.8054107  1.8061802
 1.88488384 2.1206152  2.12313089 2.12641682 2.70744638 2.7102564
 2.71095356 3.56369387 3.56580927 3.56965812 3.69891457 3.70582101
 4.21955439 4.772376   4.77326971 4.77520782]
   1 ( 0.000  0.000 -0.500)   [-0.39588582 -0.25760619  0.18694349  0.21791624] [1.09766659 1.10849635 1.15151454 1.39893648 1.68507413 1.81194382
 1.8460646  1.85179722 2.1192233  2.12554278 3.00623003 3.12424784
 3.12521472 3.13879232 3.14125285 3.32161783 3.66766279 3.6683266
 3.80024584 3.80643029 5.1850984  9.82854359]
   2 (-0.000 -0.500  0.000)   [-0.39588729 -0.25761393  0.18694491  0.21793434] [1.09767173 1.10848206 1.15151186 1.39894267 1.68505727 1.81193437
 1.84608512 1.85180879 2.11922487 2.12555094 3.00624046 3.12426132
 3.1252207  3.13884366 3.14125604 3.32163077 3.66766549 3.66833372
 3.80026575 3.80640034 5.18509281 9.82854135]
   3 ( 0.000 -0.500 -0.500)   [-0.25627549 -0.25206074  0.04010409  0.07062092] [0.90348427 0.95975987 1.50636063 1.51277765 1.75050611 1.76459788
 2.07002856 2.07152257 2.32339267 2.33115294 2.84348621 2.8517586
 2.88518697 2.88525912 2.98356081 2.98724264 3.73378433 3.73462749
 5.07642587 5.07914579 6.89483805 6.89652483]
    CPU time for vj and vk      1.50 sec, wall time      0.05 sec
E1 = (4.193455762866678+7.443739499143628e-18j)  E_coul = (-2.2411606175800394+5.973988817963373e-18j)
cycle= 3 E= -10.8348340003376  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.839
    CPU time for cycle= 3      2.06 sec, wall time      0.07 sec
HOMO = 0.346434294859  LUMO = 0.903788948268
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6692615   0.30041506  0.3353184   0.34643429] [0.98223737 0.99637718 1.01756141 1.33933781 1.80561421 1.80635778
 1.88475201 2.12076479 2.12322663 2.12656634 2.70783804 2.71060576
 2.7113914  3.56379881 3.56595125 3.56969476 3.69922986 3.70609301
 4.21960813 4.77265303 4.77351668 4.77544168]
   1 ( 0.000  0.000 -0.500)   [-0.39528122 -0.25726463  0.18740845  0.21816317] [1.09808266 1.10895846 1.1517062  1.39900866 1.68521543 1.81231809
 1.84628197 1.85203416 2.11943124 2.12561816 3.00657556 3.12448771
 3.12536334 3.13929913 3.14171196 3.32173414 3.66774805 3.66846595
 3.80047397 3.80663825 5.18541275 9.82979549]
   2 (-0.000 -0.500  0.000)   [-0.3952826  -0.25727249  0.18740981  0.21818162] [1.09808777 1.10894418 1.15170359 1.39901484 1.68519835 1.81230842
 1.84630265 1.8520457  2.11943266 2.12562628 3.00658607 3.12450124
 3.12536948 3.13935063 3.14171528 3.32174716 3.66775079 3.6684732
 3.80049381 3.80660808 5.1854073  9.82979325]
   3 ( 0.000 -0.500 -0.500)   [-0.25578134 -0.2516512   0.04052528  0.07089623] [0.90378895 0.95975391 1.50713933 1.51355783 1.75079402 1.76487017
 2.07011413 2.07153336 2.32350208 2.3313881  2.84383286 2.85205047
 2.88520069 2.88540216 2.98376143 2.98746913 3.73409727 3.73508901
 5.07666913 5.07932809 6.89536234 6.89721951]
    CPU time for vj and vk      1.51 sec, wall time      0.05 sec
E1 = (4.193484666792268+7.433559852634033e-18j)  E_coul = (-2.2411922080828037+5.979310781702265e-18j)
cycle= 4 E= -10.8348366869148  delta_E= -2.69e-06  |g|= 0.000615  |ddm|= 0.0988
    CPU time for cycle= 4      2.10 sec, wall time      0.07 sec
HOMO = 0.346390372871  LUMO = 0.903775711548
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931464  0.30035764  0.33524208  0.34639037] [0.98221365 0.99634354 1.01752547 1.33928257 1.80560194 1.80633487
 1.88476571 2.12075506 2.12320536 2.12655346 2.70778182 2.71054769
 2.71134413 3.56378669 3.56594036 3.56967661 3.69920073 3.70606283
 4.2195913  4.77262856 4.77348794 4.77541254]
   1 ( 0.000  0.000 -0.500)   [-0.39530217 -0.25733335  0.18735976  0.21809781] [1.09804066 1.10892945 1.15168199 1.39901414 1.68518625 1.81227787
 1.84623837 1.85199715 2.11942406 2.12559359 3.00654391 3.12447576
 3.12534603 3.13924738 3.14165694 3.32172632 3.66772872 3.66845683
 3.80044116 3.80660509 5.18537443 9.82962015]
   2 (-0.000 -0.500  0.000)   [-0.39530356 -0.2573412   0.18736112  0.21811626] [1.09804574 1.10891518 1.15167942 1.39902029 1.68516916 1.8122682
 1.84625905 1.85200867 2.1194255  2.1256017  3.00655442 3.12448929
 3.12535217 3.13929886 3.14166028 3.32173933 3.66773143 3.66846407
 3.80046101 3.80657491 5.18536898 9.82961791]
   3 ( 0.000 -0.500 -0.500)   [-0.25583964 -0.25170722  0.04047366  0.07085871] [0.90377571 0.95974543 1.50708773 1.51352576 1.75072711 1.76480919
 2.07009818 2.07152139 2.32347907 2.33136507 2.84379189 2.8520065
 2.88519126 2.88539886 2.98372969 2.98745023 3.73405512 3.73505126
 5.07664576 5.07929925 6.89527014 6.89714237]
    CPU time for vj and vk      1.51 sec, wall time      0.05 sec
E1 = (4.193506161156134+7.431124581211888e-18j)  E_coul = (-2.2412137486509174+5.982036496916992e-18j)
cycle= 5 E= -10.834836733119  delta_E= -4.62e-08  |g|= 8.48e-05  |ddm|= 0.00955
    CPU time for cycle= 5      2.07 sec, wall time      0.07 sec
HOMO = 0.346397357146  LUMO = 0.903776866669
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931188  0.30035854  0.33524259  0.34639736] [0.98221508 0.99634505 1.01752624 1.33928422 1.80560259 1.80633558
 1.88476467 2.12075471 2.12320467 2.12655418 2.707783   2.71054922
 2.7113474  3.56378722 3.565941   3.56967654 3.69920153 3.70606353
 4.21959232 4.77262946 4.77348861 4.77541325]
   1 ( 0.000  0.000 -0.500)   [-0.39529687 -0.25733055  0.18736081  0.21809879] [1.09804144 1.10893091 1.15168143 1.39901333 1.68518742 1.81228012
 1.84623905 1.85199841 2.11942689 2.12559389 3.00654607 3.12447678
 3.12534619 3.13924893 3.14165803 3.32172628 3.66772861 3.66845782
 3.80044119 3.80660553 5.18537623 9.8296279 ]
   2 (-0.000 -0.500  0.000)   [-0.39529826 -0.25733841  0.18736217  0.21811724] [1.09804652 1.10891664 1.15167886 1.39901948 1.68517033 1.81227044
 1.84625972 1.85200993 2.11942833 2.125602   3.00655657 3.12449031
 3.12535233 3.13930041 3.14166137 3.32173929 3.66773132 3.66846505
 3.80046105 3.80657536 5.18537078 9.82962566]
   3 ( 0.000 -0.500 -0.500)   [-0.25583608 -0.2517061   0.04047506  0.0708629 ] [0.90377687 0.959745   1.5070893  1.51353047 1.75072746 1.76480808
 2.07009908 2.07152163 2.32347874 2.33136655 2.84379319 2.85200721
 2.88519039 2.88540016 2.98373027 2.9874518  3.73405484 3.73505366
 5.07664703 5.07930027 6.89527254 6.89714759]
    CPU time for vj and vk      1.57 sec, wall time      0.05 sec
E1 = (4.193506740355691+7.43068302186115e-18j)  E_coul = (-2.241214328737699+5.981726834099865e-18j)
Extra cycle  E= -10.8348367340062  delta_E= -8.87e-10  |g|= 2.7e-05  |ddm|= 0.00139
    CPU time for scf_cycle     15.43 sec, wall time      0.51 sec
    CPU time for SCF     17.44 sec, wall time      0.58 sec
converged SCF energy = -10.8348367340062
**** SCF Summaries ****
Total Energy =                         -10.834836734006249
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193506740355691
Two-electron Energy =                   -2.241214328737699
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89507
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01163
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00286
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89511
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00003
charge of    1C =     -0.00003
    CPU time for vj and vk      0.72 sec, wall time      0.02 sec
End time = Wed May 28 02:57:37 PM PDT 2025
