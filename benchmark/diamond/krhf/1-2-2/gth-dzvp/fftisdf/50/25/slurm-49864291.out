SLURMD_NODENAME = hpc-35-04
Start time = Wed May 28 02:57:38 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-25/49864291/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-25/49864291/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/50/25/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-50-25
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-25
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 25.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 25.0
wrap_around = True

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =  25.00, nao = 26, nip = 650
Parent grid size = 4913, selected grid size = 650
truncated values = 6.72e+01, estimated error = 9.44e-02
Number of interpolating points is 650.
    CPU time for building inpv_kpt      8.27 sec, wall time      1.68 sec

Out-core version is used for eta_kpt.
disk space required: 2.04e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   2.04e-01 GB
memory needed for each k-point: 5.11e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      9.75 sec, wall time      0.32 sec
    CPU time for building eta_kpt     10.72 sec, wall time      0.35 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      9.02 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 2 / 4]      8.19 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 3 / 4]      8.28 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 4 / 4]      8.30 sec, wall time      0.64 sec
    CPU time for building coul_kpt     34.62 sec, wall time      2.56 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-25/49864291/jer4dcmj


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-25/49864291/tmp3k8qk7mz
max_memory 327680 MB (current use 390 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f990804ef50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.71 sec, wall time      0.09 sec
E1 = (3.604512065330103+1.8152825404930638e-18j)  E_coul = (-4.238150976812037+2.3321041046376154e-17j)
init E= -13.4207680571062
    CPU time for initialize scf      4.39 sec, wall time      0.14 sec
HOMO = 0.642142397754  LUMO = 0.776528518534
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422286  0.60527262  0.60922827  0.6421424 ] [0.85981203 0.88582312 0.910196   1.12520816 1.79100343 1.80523338
 1.8620708  2.08341795 2.08748084 2.09923844 2.64579547 2.64765097
 2.64892768 3.55319089 3.5539211  3.55480564 3.65950782 3.66029216
 4.21017802 4.73495305 4.73541957 4.735963  ]
   1 ( 0.000  0.000 -0.500)   [-0.78015069 -0.50848224  0.46132961  0.50284462] [0.94786263 1.02143011 1.04032072 1.3535441  1.62942501 1.75601256
 1.81456549 1.82407337 2.11260116 2.11925337 2.95658508 3.06754226
 3.06860417 3.10243017 3.10320105 3.30379725 3.64927419 3.65340456
 3.76724283 3.76774987 5.13924766 9.65011861]
   2 (-0.000 -0.500  0.000)   [-0.78015066 -0.50848258  0.46132942  0.50284456] [0.94786165 1.02143013 1.04032069 1.35354342 1.62942479 1.75601325
 1.81456573 1.82407338 2.11260138 2.11925283 2.95658622 3.06754199
 3.06860435 3.10243114 3.10320098 3.30379708 3.64927359 3.6534046
 3.76724017 3.76775076 5.13924841 9.65011746]
   3 ( 0.000 -0.500 -0.500)   [-0.41689271 -0.40449995  0.22475862  0.31063167] [0.77652852 0.84136907 1.40153319 1.40348219 1.67779425 1.68165487
 2.07043196 2.07585834 2.3122562  2.31465186 2.79346693 2.80078479
 2.87065773 2.87949515 2.95490284 2.95598315 3.67413332 3.67560854
 5.04762959 5.04820431 6.80918765 6.814645  ]
    CPU time for vj and vk      2.69 sec, wall time      0.09 sec
E1 = (4.198007087775088-4.261671241399926e-18j)  E_coul = (-2.232603437213174+1.1460752483771411e-17j)
cycle= 1 E= -10.8217254950623  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      3.15 sec, wall time      0.10 sec
HOMO = 0.352247282719  LUMO = 0.898272248159
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169319  0.30155892  0.34067791  0.35224728] [0.97853085 0.99133345 1.01471716 1.33232443 1.80554188 1.80602156
 1.88406376 2.11998753 2.12202614 2.12538972 2.7080549  2.71165665
 2.71194158 3.56353058 3.56541363 3.56997526 3.69759016 3.70486858
 4.22165607 4.77131759 4.77264387 4.7747327 ]
   1 ( 0.000  0.000 -0.500)   [-0.39621604 -0.25657531  0.18712397  0.22273282] [1.09293511 1.10500102 1.1503117  1.39709793 1.68430044 1.81150114
 1.84708756 1.8516504  2.11920445 2.12573888 3.00549467 3.12357369
 3.12501967 3.13811515 3.14099047 3.32109656 3.6680367  3.66810518
 3.79985839 3.80638237 5.18621165 9.83367428]
   2 (-0.000 -0.500  0.000)   [-0.39621618 -0.25657542  0.18712392  0.22273287] [1.09293456 1.10500058 1.15031174 1.3970961  1.68429974 1.8115025
 1.84708702 1.85165061 2.11920447 2.12573833 3.00549558 3.12357537
 3.12502014 3.13811476 3.14098991 3.32109707 3.66803929 3.6681017
 3.79985735 3.80638369 5.18621064 9.8336743 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25545501 -0.2512295   0.03956202  0.07509184] [0.89827225 0.95900247 1.50272936 1.50995555 1.74943972 1.76463943
 2.07049189 2.07210185 2.32316406 2.3306826  2.84347582 2.85141838
 2.88507952 2.88514404 2.98374208 2.9871961  3.73224429 3.73350597
 5.07643954 5.07990546 6.89798555 6.89909964]
    CPU time for vj and vk      2.68 sec, wall time      0.09 sec
E1 = (4.194199457146549-3.967587214349506e-18j)  E_coul = (-2.2412686053915025+1.1776250262020397e-17j)
cycle= 2 E= -10.8341982938692  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      3.24 sec, wall time      0.10 sec
HOMO = 0.346104620681  LUMO = 0.903474728726
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976033  0.30008158  0.33519409  0.34610462] [0.98176882 0.99581249 1.01711211 1.33875167 1.80541282 1.80618415
 1.88487437 2.12065036 2.12313503 2.12642464 2.7074335  2.71028948
 2.71096046 3.56370154 3.56582279 3.56959099 3.69892186 3.70582104
 4.21954013 4.77235561 4.77325366 4.77523458]
   1 ( 0.000  0.000 -0.500)   [-0.39588006 -0.25760917  0.18696875  0.21794572] [1.09766699 1.10849585 1.15152511 1.39893973 1.6850789  1.81195402
 1.84609045 1.8517846  2.11922503 2.12552702 3.00621363 3.12425471
 3.12523499 3.13885621 3.14124622 3.32162829 3.6676956  3.66834343
 3.80025792 3.8063902  5.18509376 9.82853762]
   2 (-0.000 -0.500  0.000)   [-0.39588018 -0.25760937  0.18696871  0.21794578] [1.09766658 1.10849547 1.15152504 1.39893782 1.68507817 1.81195532
 1.84608996 1.85178481 2.11922501 2.12552637 3.00621426 3.12425628
 3.12523545 3.13885598 3.14124578 3.3216288  3.66769201 3.66834567
 3.80025708 3.80639166 5.18509269 9.82853749]
   3 ( 0.000 -0.500 -0.500)   [-0.25627567 -0.25205201  0.0401162   0.07063009] [0.90347473 0.9597692  1.50636833 1.51278392 1.75053128 1.76460592
 2.07003515 2.07148021 2.32338752 2.33115226 2.84349369 2.85176231
 2.88517967 2.88526883 2.98353729 2.9872445  3.73376632 3.73460438
 5.07651874 5.07917364 6.89483393 6.89651204]
    CPU time for vj and vk      2.76 sec, wall time      0.09 sec
E1 = (4.193434494895589-3.793186987239452e-18j)  E_coul = (-2.2410975890626954+1.1868381948839283e-17j)
cycle= 3 E= -10.8347922397913  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      3.32 sec, wall time      0.11 sec
HOMO = 0.34644618387  LUMO = 0.903779072837
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926008  0.30045558  0.33534827  0.34644618] [0.98224994 0.99639191 1.01755867 1.33932551 1.80561601 1.80636133
 1.88474302 2.12079949 2.12323047 2.12657396 2.70782417 2.71063766
 2.71139707 3.56380627 3.56596434 3.56962713 3.69923665 3.70609242
 4.21959365 4.77263182 4.77350049 4.77546787]
   1 ( 0.000  0.000 -0.500)   [-0.39527616 -0.25726841  0.18743292  0.21819204] [1.0980823  1.10895741 1.15171641 1.39901176 1.68521934 1.81232713
 1.84630712 1.85202074 2.11943244 2.12560208 3.00655837 3.12449435
 3.12538325 3.139362   3.1417045  3.32174438 3.66778079 3.66848245
 3.80048556 3.80659759 5.18540745 9.82978599]
   2 (-0.000 -0.500  0.000)   [-0.39527629 -0.2572686   0.18743288  0.21819208] [1.09808187 1.10895701 1.15171635 1.39900987 1.6852186  1.81232845
 1.84630662 1.85202095 2.11943243 2.12560145 3.00655901 3.12449591
 3.12538369 3.13936177 3.14170407 3.32174488 3.66777718 3.66848463
 3.80048471 3.80659905 5.18540639 9.82978581]
   3 ( 0.000 -0.500 -0.500)   [-0.25578237 -0.25164309  0.04053665  0.07090451] [0.90377907 0.9597632  1.50714572 1.51356267 1.75081817 1.76487721
 2.07012021 2.07149086 2.32349645 2.33138712 2.84383947 2.85205339
 2.88519097 2.88541386 2.98373723 2.98747037 3.73407853 3.73506526
 5.07676192 5.07935568 6.89535653 6.89720519]
    CPU time for vj and vk      2.74 sec, wall time      0.09 sec
E1 = (4.193463624715532-3.75503488414788e-18j)  E_coul = (-2.2411294057184312+1.1872214651433456e-17j)
cycle= 4 E= -10.8347949266271  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0986
    CPU time for cycle= 4      3.37 sec, wall time      0.11 sec
HOMO = 0.346402241803  LUMO = 0.903765864951
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931323  0.30039821  0.33527198  0.34640224] [0.9822262  0.99635828 1.01752274 1.33927031 1.80560374 1.80633841
 1.88475671 2.12078976 2.12320919 2.12656111 2.70776804 2.71057961
 2.71134982 3.56379417 3.56595347 3.56960902 3.69920753 3.70606226
 4.21957684 4.77260738 4.77347174 4.77543866]
   1 ( 0.000  0.000 -0.500)   [-0.39529713 -0.25733713  0.18738428  0.21812669] [1.09804029 1.10892841 1.15169222 1.39901721 1.68519017 1.81228691
 1.84626353 1.85198374 2.11942529 2.12557753 3.00652676 3.12448242
 3.12536595 3.13931024 3.14164955 3.32173655 3.66776145 3.66847329
 3.80045277 3.80656447 5.18536913 9.82961073]
   2 (-0.000 -0.500  0.000)   [-0.39529725 -0.25733732  0.18738424  0.21812673] [1.09803987 1.10892801 1.15169215 1.39901531 1.68518944 1.81228822
 1.84626303 1.85198395 2.11942528 2.12557689 3.0065274  3.12448397
 3.12536639 3.13931002 3.14164912 3.32173706 3.66775784 3.66847547
 3.80045192 3.80656593 5.18536807 9.82961054]
   3 ( 0.000 -0.500 -0.500)   [-0.25584066 -0.25169912  0.04048506  0.07086698] [0.90376586 0.95975473 1.50709415 1.51353058 1.75075129 1.76481625
 2.07010426 2.07147896 2.32347345 2.3313641  2.84379852 2.85200945
 2.88518165 2.88541047 2.98370553 2.98745147 3.73403639 3.73502753
 5.07673856 5.07932684 6.89526449 6.89712797]
    CPU time for vj and vk      2.70 sec, wall time      0.09 sec
E1 = (4.193485128678633-3.756180374199901e-18j)  E_coul = (-2.241150955840508+1.1878994882893491e-17j)
cycle= 5 E= -10.8347949727861  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      3.28 sec, wall time      0.10 sec
HOMO = 0.346409230868  LUMO = 0.903767022178
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931045  0.30039913  0.3352725   0.34640923] [0.98222763 0.9963598  1.01752352 1.33927198 1.8056044  1.80633912
 1.88475567 2.12078941 2.1232085  2.12656183 2.70776923 2.71058115
 2.7113531  3.56379469 3.56595411 3.56960895 3.69920834 3.70606296
 4.21957787 4.77260828 4.77347241 4.77543938]
   1 ( 0.000  0.000 -0.500)   [-0.39529181 -0.25733432  0.18738534  0.21812767] [1.09804108 1.10892987 1.15169166 1.3990164  1.68519134 1.81228916
 1.84626421 1.85198501 2.11942812 2.12557782 3.00652892 3.12448344
 3.12536611 3.1393118  3.14165065 3.32173651 3.66776134 3.66847428
 3.8004528  3.80656492 5.18537095 9.82961851]
   2 (-0.000 -0.500  0.000)   [-0.39529194 -0.25733451  0.1873853   0.21812772] [1.09804066 1.10892947 1.1516916  1.3990145  1.68519061 1.81229047
 1.84626371 1.85198522 2.11942811 2.12557719 3.00652956 3.12448499
 3.12536655 3.13931158 3.14165022 3.32173702 3.66775773 3.66847646
 3.80045195 3.80656638 5.18536988 9.82961832]
   3 ( 0.000 -0.500 -0.500)   [-0.25583709 -0.25169799  0.04048647  0.07087118] [0.90376702 0.9597543  1.50709574 1.51353528 1.75075164 1.76481515
 2.07010517 2.07147921 2.32347312 2.33136559 2.84379983 2.85201016
 2.88518071 2.88541185 2.98370611 2.98745305 3.73403612 3.73502992
 5.07673983 5.07932787 6.89526683 6.89713326]
    CPU time for vj and vk      2.71 sec, wall time      0.09 sec
E1 = (4.19348570573469-3.7577864487567494e-18j)  E_coul = (-2.2411515337761667+1.1881087662767948e-17j)
Extra cycle  E= -10.8347949736657  delta_E= -8.8e-10  |g|= 2.68e-05  |ddm|= 0.00139
    CPU time for scf_cycle     23.98 sec, wall time      0.77 sec
    CPU time for SCF     25.87 sec, wall time      0.84 sec
converged SCF energy = -10.8347949736657
**** SCF Summaries ****
Total Energy =                         -10.834794973665716
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193485705734690
Two-electron Energy =                   -2.241151533776167
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89509
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01164
pop of  0 C 2pz           1.01164
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89509
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      1.77 sec, wall time      0.06 sec
End time = Wed May 28 02:57:44 PM PDT 2025
