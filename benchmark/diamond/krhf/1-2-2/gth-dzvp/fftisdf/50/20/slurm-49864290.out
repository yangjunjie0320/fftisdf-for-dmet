SLURMD_NODENAME = hpc-34-23
Start time = Wed May 28 02:57:34 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-20/49864290/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-20/49864290/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/50/20/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-50-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-50-20
ke_cutoff = 50.0, mesh = [17 17 17]
Using ke_cutoff = 50.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [17 17 17] (4913 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = True

WARN: ke_cutoff/mesh (50 / [17 17 17]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 7.7 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2114, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 4913, selected grid size = 520
truncated values = 6.70e+01, estimated error = 2.55e-01
Number of interpolating points is 520.
    CPU time for building inpv_kpt      8.27 sec, wall time      1.71 sec

Out-core version is used for eta_kpt.
disk space required: 1.64e-01 GB.
blksize = 4913, ngrid = 4913
memory needed for each block:   1.64e-01 GB
memory needed for each k-point: 4.09e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[    0: 4913]      8.61 sec, wall time      0.28 sec
    CPU time for building eta_kpt      9.54 sec, wall time      0.31 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      8.35 sec, wall time      0.40 sec
    CPU time for coul_kpt[ 2 / 4]      7.60 sec, wall time      0.41 sec
    CPU time for coul_kpt[ 3 / 4]      7.63 sec, wall time      0.41 sec
    CPU time for coul_kpt[ 4 / 4]      7.66 sec, wall time      0.41 sec
    CPU time for building coul_kpt     31.80 sec, wall time      1.65 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-20/49864290/r01ofnl7


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-50-20/49864290/tmpcd1k3cty
max_memory 327680 MB (current use 392 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f5b3c215030>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.27 sec, wall time      0.08 sec
E1 = (3.6045120653301033+8.872416043855374e-27j)  E_coul = (-4.2381510108502+2.0186775481968085e-17j)
init E= -13.4207680911443
    CPU time for initialize scf      3.99 sec, wall time      0.14 sec
HOMO = 0.642143159208  LUMO = 0.776528114273
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422293  0.60527286  0.60922785  0.64214316] [0.85981066 0.88582313 0.91019588 1.12520975 1.79100379 1.80523394
 1.8620662  2.08341525 2.08747734 2.09923779 2.6457973  2.64765381
 2.64892785 3.55319521 3.55392298 3.55480232 3.65950769 3.66029092
 4.21018487 4.7349602  4.73541699 4.73598058]
   1 ( 0.000  0.000 -0.500)   [-0.78015191 -0.50848133  0.46133102  0.50284396] [0.94786413 1.02142875 1.04031998 1.35354181 1.62942477 1.75601443
 1.81456843 1.82407623 2.11260227 2.11925442 2.95658492 3.06753699
 3.06860702 3.10243187 3.10320156 3.30379552 3.64927151 3.65340076
 3.76724204 3.76774862 5.1392448  9.65011509]
   2 (-0.000 -0.500  0.000)   [-0.78015058 -0.50848188  0.46132835  0.50284457] [0.94785852 1.02143079 1.04032075 1.35353913 1.6294252  1.75600949
 1.81456831 1.824074   2.11260106 2.11925227 2.95658399 3.06753785
 3.068605   3.10242983 3.10319703 3.30379724 3.64927507 3.6534095
 3.76724686 3.76774602 5.13925263 9.65011471]
   3 ( 0.000 -0.500 -0.500)   [-0.41689289 -0.40449948  0.22475811  0.31063122] [0.77652811 0.84136817 1.4015331  1.4034815  1.67779313 1.68165479
 2.07043172 2.07585761 2.31225564 2.31465148 2.79346708 2.80078416
 2.8706555  2.87949438 2.95490549 2.9559847  3.6741317  3.67560928
 5.04762257 5.04820599 6.80918911 6.81464678]
    CPU time for vj and vk      2.20 sec, wall time      0.07 sec
E1 = (4.198007980385586+2.223896426509672e-17j)  E_coul = (-2.2326051962651983+8.906564101735336e-18j)
cycle= 1 E= -10.8217263615039  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      2.72 sec, wall time      0.09 sec
HOMO = 0.352247255566  LUMO = 0.898272921087
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169325  0.3015596   0.34067629  0.35224726] [0.97852822 0.99133347 1.0147171  1.33232613 1.80554246 1.80602205
 1.88406025 2.11998262 2.1220244  2.12538905 2.70806169 2.7116635
 2.71194026 3.56352643 3.5654113  3.56997701 3.69759089 3.70486767
 4.22166586 4.7713424  4.77262872 4.77474926]
   1 ( 0.000  0.000 -0.500)   [-0.39621729 -0.25657461  0.18712288  0.2227331 ] [1.09293769 1.10500157 1.15030814 1.39709748 1.68430014 1.81150217
 1.84709763 1.8516537  2.11920473 2.12573912 3.00549666 3.12357431
 3.12502141 3.13810727 3.14099425 3.32109257 3.66802755 3.66810206
 3.79985658 3.80637905 5.18620331 9.83366992]
   2 (-0.000 -0.500  0.000)   [-0.39621641 -0.25657476  0.1871243   0.22273111] [1.09293357 1.104997   1.15031138 1.39708861 1.68430146 1.81150446
 1.84709568 1.85165664 2.1192051  2.12573665 3.00549582 3.12356926
 3.12502286 3.13811049 3.14099461 3.32109662 3.66803442 3.66810116
 3.79985668 3.80637798 5.18621761 9.83366894]
   3 ( 0.000 -0.500 -0.500)   [-0.25545375 -0.25123116  0.03955993  0.07509224] [0.89827292 0.95899889 1.50272705 1.50995567 1.74943922 1.76464077
 2.0704904  2.07210218 2.32316298 2.33068218 2.84347863 2.85141916
 2.88507991 2.88514046 2.98374521 2.98720214 3.73224399 3.73350899
 5.07642033 5.07991976 6.89798286 6.89910566]
    CPU time for vj and vk      2.24 sec, wall time      0.07 sec
E1 = (4.194199462161296+2.1352474718613108e-17j)  E_coul = (-2.2412696268877017+8.872729963836235e-18j)
cycle= 2 E= -10.8341993103506  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      2.84 sec, wall time      0.09 sec
HOMO = 0.346104803988  LUMO = 0.903475738257
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976019  0.30008249  0.33519249  0.3461048 ] [0.98176646 0.99581282 1.01711223 1.33875416 1.80541368 1.80618461
 1.884871   2.12064564 2.12313404 2.12642406 2.70744009 2.71029633
 2.71095938 3.5636977  3.56582    3.56959234 3.69892287 3.70582052
 4.21955    4.77237973 4.7732385  4.77524976]
   1 ( 0.000  0.000 -0.500)   [-0.39588125 -0.25760839  0.1869678   0.21794612] [1.09766985 1.10849653 1.15152175 1.39893932 1.6850788  1.81195531
 1.8461009  1.8517878  2.11922535 2.1255271  3.00621529 3.12425525
 3.12523669 3.13884886 3.14124983 3.32162435 3.66769173 3.66833632
 3.80025668 3.80638703 5.18508523 9.82853404]
   2 (-0.000 -0.500  0.000)   [-0.39588031 -0.25760851  0.18696918  0.21794371] [1.09766624 1.10849213 1.15152505 1.39893044 1.68507999 1.81195752
 1.84609832 1.85179057 2.11922558 2.12552488 3.0062148  3.12425013
 3.12523806 3.13885216 3.14125017 3.3216284  3.66769052 3.6683427
 3.8002565  3.80638603 5.18509965 9.82853305]
   3 ( 0.000 -0.500 -0.500)   [-0.25627432 -0.25205367  0.04011413  0.07063063] [0.90347574 0.959766   1.5063665  1.51278435 1.75053056 1.76460744
 2.07003377 2.07148069 2.32338653 2.33115199 2.84349698 2.85176278
 2.88517982 2.88526531 2.9835405  2.98725073 3.7337662  3.73460797
 5.07650039 5.07918278 6.89483125 6.89651892]
    CPU time for vj and vk      2.26 sec, wall time      0.07 sec
E1 = (4.193434996167494+2.06777324811117e-17j)  E_coul = (-2.241099131182276+8.867298786407092e-18j)
cycle= 3 E= -10.834793280639  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      2.86 sec, wall time      0.09 sec
HOMO = 0.346446336155  LUMO = 0.903779983854
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66925999  0.30045638  0.33534653  0.34644634] [0.9822475  0.99639213 1.01755866 1.33932784 1.8056168  1.80636175
 1.88473966 2.12079469 2.12322941 2.12657332 2.70783066 2.71064447
 2.71139593 3.56380243 3.5659615  3.56962845 3.69923757 3.70609181
 4.21960352 4.77265588 4.77348526 4.77548302]
   1 ( 0.000  0.000 -0.500)   [-0.39527742 -0.25726766  0.18743187  0.21819235] [1.09808504 1.10895797 1.15171296 1.39901137 1.68521918 1.81232839
 1.84631753 1.85202387 2.11943274 2.12560213 3.00655997 3.12449486
 3.1253849  3.13935447 3.141708   3.32174038 3.66777681 3.66847527
 3.80048425 3.80659435 5.18539879 9.82978203]
   2 (-0.000 -0.500  0.000)   [-0.39527648 -0.25726781  0.18743324  0.21818996] [1.09808147 1.1089536  1.15171627 1.39900246 1.68522038 1.81233057
 1.84631493 1.85202663 2.11943296 2.12559987 3.00655944 3.12448973
 3.12538631 3.1393578  3.14170834 3.32174449 3.66777565 3.66848164
 3.80048408 3.80659335 5.1854133  9.82978106]
   3 ( 0.000 -0.500 -0.500)   [-0.2557811  -0.25164481  0.04053448  0.07090502] [0.90377998 0.95975998 1.50714371 1.51356298 1.75081733 1.76487866
 2.0701188  2.07149127 2.32349543 2.33138681 2.84384263 2.85205378
 2.88519117 2.88541022 2.98374041 2.98747657 3.73407827 3.73506871
 5.07674333 5.07936501 6.89535373 6.89721182]
    CPU time for vj and vk      2.27 sec, wall time      0.07 sec
E1 = (4.193464136089015+2.054489787298728e-17j)  E_coul = (-2.241130957613872+8.87151402126048e-18j)
cycle= 4 E= -10.8347959671491  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0985
    CPU time for cycle= 4      2.86 sec, wall time      0.09 sec
HOMO = 0.346402406536  LUMO = 0.903766774574
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931314  0.30039902  0.33527024  0.34640241] [0.98222376 0.9963585  1.01752274 1.33927266 1.80560454 1.80633884
 1.88475336 2.12078497 2.12320814 2.12656047 2.70777454 2.71058643
 2.71134869 3.56379033 3.56595064 3.56961034 3.69920845 3.70606166
 4.21958672 4.77263145 4.77345651 4.77545381]
   1 ( 0.000  0.000 -0.500)   [-0.39529838 -0.25733638  0.18738323  0.218127  ] [1.09804304 1.10892898 1.15168878 1.39901681 1.68519003 1.81228818
 1.84627394 1.85198688 2.11942559 2.12557758 3.00652837 3.12448292
 3.12536761 3.13930272 3.14165306 3.32173256 3.66775747 3.66846611
 3.80045146 3.80656124 5.18536048 9.8296068 ]
   2 (-0.000 -0.500  0.000)   [-0.39529744 -0.25733653  0.1873846   0.21812461] [1.09803947 1.1089246  1.15169209 1.39900791 1.68519123 1.81229035
 1.84627134 1.85198963 2.1194258  2.12557532 3.00652784 3.1244778
 3.12536902 3.13930605 3.14165339 3.32173667 3.66775631 3.66847247
 3.80045129 3.80656023 5.18537499 9.82960583]
   3 ( 0.000 -0.500 -0.500)   [-0.2558394  -0.25170084  0.0404829   0.07086749] [0.90376677 0.95975151 1.50709215 1.5135309  1.75075046 1.76481771
 2.07010286 2.07147937 2.32347242 2.33136379 2.84380169 2.85200984
 2.88518186 2.88540684 2.98370872 2.98745767 3.73403614 3.73503099
 5.07671997 5.07933614 6.89526168 6.89713464]
    CPU time for vj and vk      2.24 sec, wall time      0.07 sec
E1 = (4.1934856380272745+2.0535509734926322e-17j)  E_coul = (-2.2411525057066046+8.870931194970754e-18j)
cycle= 5 E= -10.8347960133036  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00952
    CPU time for cycle= 5      2.84 sec, wall time      0.09 sec
HOMO = 0.346409396794  LUMO = 0.903767931452
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931037  0.30039994  0.33527077  0.3464094 ] [0.98222519 0.99636002 1.01752352 1.33927433 1.80560519 1.80633955
 1.88475232 2.12078462 2.12320745 2.12656119 2.70777573 2.71058796
 2.71135196 3.56379086 3.56595127 3.56961027 3.69920927 3.70606236
 4.21958774 4.77263234 4.77345718 4.77545452]
   1 ( 0.000  0.000 -0.500)   [-0.39529307 -0.25733357  0.18738429  0.21812799] [1.09804383 1.10893044 1.15168822 1.399016   1.6851912  1.81229042
 1.84627462 1.85198815 2.11942842 2.12557788 3.00653052 3.12448395
 3.12536778 3.13930428 3.14165416 3.32173252 3.66775736 3.6684671
 3.8004515  3.80656169 5.18536229 9.82961458]
   2 (-0.000 -0.500  0.000)   [-0.39529213 -0.25733372  0.18738566  0.2181256 ] [1.09804026 1.10892606 1.15169153 1.3990071  1.6851924  1.8122926
 1.84627202 1.8519909  2.11942863 2.12557562 3.00653    3.12447882
 3.12536918 3.13930761 3.14165449 3.32173663 3.66775621 3.66847346
 3.80045133 3.80656068 5.1853768  9.8296136 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25583582 -0.25169971  0.04048431  0.07087169] [0.90376793 0.95975108 1.50709374 1.5135356  1.75075081 1.76481661
 2.07010377 2.07147961 2.32347209 2.33136527 2.843803   2.85201056
 2.88518092 2.88540821 2.9837093  2.98745925 3.73403587 3.73503338
 5.07672125 5.07933717 6.89526404 6.89713992]
    CPU time for vj and vk      2.30 sec, wall time      0.07 sec
E1 = (4.193486215513465+2.0536414618817667e-17j)  E_coul = (-2.2411530840723635+8.86921429113652e-18j)
Extra cycle  E= -10.8347960141831  delta_E= -8.8e-10  |g|= 2.68e-05  |ddm|= 0.00139
    CPU time for scf_cycle     20.95 sec, wall time      0.68 sec
    CPU time for SCF     22.94 sec, wall time      0.75 sec
converged SCF energy = -10.8347960141831
**** SCF Summaries ****
Total Energy =                         -10.834796014183139
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193486215513465
Two-electron Energy =                   -2.241153084072363
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89509
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01164
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01166
pop of  1 C 2pz           1.01164
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      1.32 sec, wall time      0.04 sec
End time = Wed May 28 02:57:39 PM PDT 2025
