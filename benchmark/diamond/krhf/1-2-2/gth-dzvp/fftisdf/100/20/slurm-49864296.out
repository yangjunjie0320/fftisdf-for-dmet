SLURMD_NODENAME = hpc-35-03
Start time = Wed May 28 02:57:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-20/49864296/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-20/49864296/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/100/20/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-100-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-20
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 20.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = True

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2235, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 12167, selected grid size = 520
truncated values = 6.84e+01, estimated error = 2.98e-01
Number of interpolating points is 520.
    CPU time for building inpv_kpt     15.96 sec, wall time      8.99 sec

Out-core version is used for eta_kpt.
disk space required: 4.05e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   4.05e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     13.28 sec, wall time      0.61 sec
    CPU time for building eta_kpt     15.00 sec, wall time      0.66 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     11.38 sec, wall time      0.66 sec
    CPU time for coul_kpt[ 2 / 4]      9.80 sec, wall time      0.67 sec
    CPU time for coul_kpt[ 3 / 4]      9.91 sec, wall time      0.67 sec
    CPU time for coul_kpt[ 4 / 4]      9.76 sec, wall time      0.67 sec
    CPU time for building coul_kpt     41.40 sec, wall time      2.69 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-20/49864296/r83doya0


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-20/49864296/tmpcdft9c3g
max_memory 327680 MB (current use 397 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f46ea162f50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.54 sec, wall time      0.11 sec
E1 = (3.6045119526610745-1.815282545991114e-18j)  E_coul = (-4.238149770173503+3.5257429547084287e-17j)
init E= -13.4207669631367
    CPU time for initialize scf      6.81 sec, wall time      0.22 sec
HOMO = 0.642146553383  LUMO = 0.77652811583
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422329  0.60527194  0.60923088  0.64214655] [0.85981293 0.88582616 0.91020369 1.12520331 1.79100423 1.80523357
 1.86205442 2.08341899 2.08748901 2.09925332 2.645797   2.64766347
 2.64895017 3.55319143 3.55392089 3.55480232 3.65950689 3.66029296
 4.21011406 4.73494677 4.73542976 4.73597481]
   1 ( 0.000  0.000 -0.500)   [-0.78015154 -0.5084825   0.46133072  0.50284963] [0.94785986 1.02143207 1.04032649 1.35354119 1.62942734 1.75601563
 1.81456892 1.82408051 2.11260189 2.11925058 2.9565891  3.06755566
 3.06863241 3.1024346  3.10320932 3.30379153 3.64927858 3.65341302
 3.7672478  3.76776464 5.13917253 9.6499626 ]
   2 (-0.000 -0.500  0.000)   [-0.78015074 -0.508483    0.46133119  0.50284951] [0.94785929 1.0214325  1.04032772 1.35354411 1.62942578 1.75601431
 1.81456879 1.82408024 2.11260085 2.11925081 2.95658611 3.06755318
 3.0686336  3.102432   3.10320857 3.30379518 3.64927994 3.65340953
 3.76724475 3.7677554  5.13917071 9.64996094]
   3 ( 0.000 -0.500 -0.500)   [-0.41689228 -0.40450287  0.22475992  0.31063613] [0.77652812 0.84136892 1.40153207 1.40349526 1.67780019 1.68166089
 2.0704334  2.07585882 2.31225578 2.31465143 2.7934648  2.80080399
 2.87066009 2.8794961  2.95490742 2.95599443 3.67413112 3.67560401
 5.04761132 5.0482445  6.80908199 6.81454327]
    CPU time for vj and vk      3.68 sec, wall time      0.12 sec
E1 = (4.198017837856454-2.5099700280023147e-18j)  E_coul = (-2.2326075064096447+2.193858145900685e-17j)
cycle= 1 E= -10.8217188141774  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      4.18 sec, wall time      0.13 sec
HOMO = 0.352244542377  LUMO = 0.898271138475
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169389  0.30155993  0.34067953  0.35224454] [0.9785318  0.99134167 1.01472034 1.33231781 1.80554252 1.80602217
 1.88404623 2.11998875 2.12203572 2.12540372 2.70807105 2.71166926
 2.71194387 3.5635198  3.56540398 3.56995399 3.69758975 3.7048701
 4.22159722 4.7713069  4.77265938 4.77474321]
   1 ( 0.000  0.000 -0.500)   [-0.39621693 -0.25657475  0.18712789  0.22273239] [1.0929321  1.10500459 1.15031271 1.3970904  1.68430204 1.81150778
 1.8470938  1.85165897 2.11920481 2.12573232 3.00550099 3.12358073
 3.12503019 3.13812966 3.14101976 3.3210869  3.66804524 3.66810613
 3.79986222 3.80639077 5.18613059 9.83351117]
   2 (-0.000 -0.500  0.000)   [-0.39621716 -0.25657629  0.18712891  0.22273333] [1.09293381 1.105009   1.15031106 1.39709806 1.68430167 1.8115011
 1.84708984 1.85165282 2.11920163 2.1257291  3.00549564 3.1235749
 3.1250215  3.13812348 3.14102421 3.32109125 3.66805195 3.66811424
 3.79985616 3.80637293 5.18613363 9.83351022]
   3 ( 0.000 -0.500 -0.500)   [-0.25545755 -0.2512309   0.03956678  0.07509196] [0.89827114 0.95900274 1.50274191 1.50995308 1.74944225 1.76464584
 2.07049274 2.07209352 2.32316365 2.33068306 2.8434728  2.85144313
 2.88508112 2.88514405 2.98375177 2.9872009  3.73224221 3.73350341
 5.07640944 5.07995266 6.89787891 6.89900029]
    CPU time for vj and vk      3.69 sec, wall time      0.12 sec
E1 = (4.194202246351948-3.552248990849113e-18j)  E_coul = (-2.2412638107740888+2.224900138310578e-17j)
cycle= 2 E= -10.8341907100464  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      4.29 sec, wall time      0.14 sec
HOMO = 0.346103281443  LUMO = 0.903473570317
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976     0.30008442  0.33519754  0.34610328] [0.98177123 0.9958219  1.01711637 1.338747   1.80541402 1.80618585
 1.88485658 2.12065244 2.12314521 2.12643954 2.70745194 2.71030355
 2.71096454 3.56369227 3.56581358 3.5695705  3.6989225  3.70582355
 4.2194825  4.77234532 4.77326875 4.77524458]
   1 ( 0.000  0.000 -0.500)   [-0.39587963 -0.25760782  0.18697424  0.21794662] [1.09766509 1.1085005  1.15152737 1.39893274 1.68508161 1.81196229
 1.84609727 1.85179521 2.11922561 2.12552088 3.00622071 3.1242622
 3.12524617 3.13887261 3.14127779 3.32161897 3.66769649 3.66835182
 3.80026306 3.80640041 5.18501359 9.82838109]
   2 (-0.000 -0.500  0.000)   [-0.39588006 -0.25760936  0.18697569  0.21794763] [1.09766674 1.10850476 1.15152565 1.39894001 1.68508178 1.81195571
 1.84609348 1.85178878 2.11922256 2.12551789 3.0062154  3.1242565
 3.12523798 3.13886728 3.14128246 3.32162343 3.66770297 3.66835962
 3.80025723 3.80638247 5.18501744 9.82838012]
   3 ( 0.000 -0.500 -0.500)   [-0.25627718 -0.25205228  0.04012246  0.07063162] [0.90347357 0.95977026 1.50638321 1.5127838  1.75053588 1.76461437
 2.07003659 2.07147277 2.32338834 2.33115324 2.84349216 2.85178851
 2.88518096 2.88526913 2.98354811 2.98725016 3.73376547 3.73460313
 5.07649524 5.0792154  6.8947301  6.89641615]
    CPU time for vj and vk      3.71 sec, wall time      0.12 sec
E1 = (4.1934377265368985-3.603125674740075e-18j)  E_coul = (-2.2410932266689603+2.233061104133702e-17j)
cycle= 3 E= -10.8347846457563  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      4.32 sec, wall time      0.14 sec
HOMO = 0.346444625854  LUMO = 0.903777744101
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926003  0.30045801  0.33535135  0.34644463] [0.98225199 0.99640092 1.01756261 1.33932027 1.80561707 1.80636283
 1.88472526 2.1208014  2.1232405  2.12658872 2.70784223 2.71065133
 2.71140071 3.56379697 3.56595497 3.56960644 3.69923703 3.70609465
 4.21953595 4.77262126 4.77351538 4.7754777 ]
   1 ( 0.000  0.000 -0.500)   [-0.39527604 -0.25726724  0.18743803  0.21819265] [1.09808004 1.10896172 1.15171841 1.3990047  1.68522174 1.81233503
 1.8463137  1.85203105 2.11943292 2.12559581 3.00656512 3.12450166
 3.12539429 3.13937795 3.14173563 3.32173492 3.66778156 3.66849062
 3.80049047 3.80660752 5.18532694 9.82962805]
   2 (-0.000 -0.500  0.000)   [-0.39527647 -0.25726876  0.1874395   0.21819365] [1.09808169 1.10896596 1.15171666 1.39901198 1.68522187 1.81232851
 1.84630989 1.85202462 2.11942987 2.12559282 3.00655981 3.12449596
 3.12538605 3.1393726  3.14174029 3.32173937 3.66778804 3.6684985
 3.80048463 3.8065896  5.18533079 9.82962708]
   3 ( 0.000 -0.500 -0.500)   [-0.2557841  -0.25164369  0.04054258  0.07090585] [0.90377774 0.95976418 1.50715996 1.51356204 1.75082228 1.76488518
 2.07012155 2.07148336 2.32349702 2.33138797 2.84383756 2.85207923
 2.88519218 2.88541406 2.98374784 2.98747584 3.73407729 3.73506365
 5.07673787 5.07939736 6.89525208 6.89710863]
    CPU time for vj and vk      3.71 sec, wall time      0.12 sec
E1 = (4.193466899264316-3.590614324665264e-18j)  E_coul = (-2.2411250856104807+2.2336635923201254e-17j)
cycle= 4 E= -10.8347873319704  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0986
    CPU time for cycle= 4      4.32 sec, wall time      0.14 sec
HOMO = 0.346400686423  LUMO = 0.903764536112
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931319  0.30040067  0.33527507  0.34640069] [0.98222825 0.99636729 1.01752669 1.33926508 1.8056048  1.80633992
 1.88473897 2.12079168 2.12321923 2.12657588 2.70778613 2.71059331
 2.71135348 3.56378487 3.5659441  3.56958835 3.69920792 3.70606449
 4.21951915 4.77259683 4.77348663 4.7754485 ]
   1 ( 0.000  0.000 -0.500)   [-0.39529702 -0.25733597  0.1873894   0.2181273 ] [1.09803804 1.10893272 1.15169424 1.39901014 1.6851926  1.81229482
 1.84627012 1.85199407 2.11942577 2.12557126 3.00653352 3.12448972
 3.125377   3.13932621 3.1416807  3.32172711 3.66776222 3.66848146
 3.80045768 3.80657441 5.18528864 9.82945284]
   2 (-0.000 -0.500  0.000)   [-0.39529745 -0.25733749  0.18739088  0.2181283 ] [1.09803969 1.10893696 1.15169248 1.39901743 1.68519274 1.8122883
 1.84626631 1.85198764 2.11942272 2.12556828 3.00652821 3.12448401
 3.12536876 3.13932086 3.14168535 3.32173155 3.66776869 3.66848932
 3.80045185 3.8065565  5.18529249 9.82945187]
   3 ( 0.000 -0.500 -0.500)   [-0.25584241 -0.25169973  0.040491    0.07086832] [0.90376454 0.95975571 1.50710841 1.51352996 1.75075542 1.76482424
 2.07010561 2.07147149 2.32347403 2.33136495 2.84379663 2.85203531
 2.88518287 2.88541068 2.98371615 2.98745695 3.73403517 3.73502593
 5.07671453 5.07936849 6.89516003 6.89703147]
    CPU time for vj and vk      3.72 sec, wall time      0.12 sec
E1 = (4.193488398905567-3.590541363062135e-18j)  E_coul = (-2.241146631390034+2.2337511656319512e-17j)
cycle= 5 E= -10.8347873781087  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00952
    CPU time for cycle= 5      4.34 sec, wall time      0.14 sec
HOMO = 0.346407678383  LUMO = 0.903765694372
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931041  0.30040159  0.33527559  0.34640768] [0.98222968 0.99636881 1.01752746 1.33926675 1.80560546 1.80634063
 1.88473792 2.12079134 2.12321854 2.1265766  2.70778732 2.71059484
 2.71135675 3.5637854  3.56594474 3.56958828 3.69920873 3.7060652
 4.21952018 4.77259773 4.7734873  4.77544921]
   1 ( 0.000  0.000 -0.500)   [-0.3952917  -0.25733316  0.18739046  0.21812829] [1.09803883 1.10893418 1.15169369 1.39900933 1.68519377 1.81229706
 1.8462708  1.85199534 2.1194286  2.12557156 3.00653568 3.12449075
 3.12537716 3.13932777 3.1416818  3.32172707 3.66776212 3.66848245
 3.80045771 3.80657486 5.18529045 9.82946062]
   2 (-0.000 -0.500  0.000)   [-0.39529214 -0.25733467  0.18739194  0.21812929] [1.09804048 1.10893842 1.15169192 1.39901662 1.6851939  1.81229055
 1.84626699 1.85198891 2.11942555 2.12556858 3.00653037 3.12448504
 3.12536892 3.13932242 3.14168646 3.32173151 3.66776858 3.66849031
 3.80045189 3.80655695 5.18529431 9.82945965]
   3 ( 0.000 -0.500 -0.500)   [-0.25583883 -0.25169859  0.04049241  0.07087252] [0.90376569 0.95975529 1.50711    1.51353466 1.75075577 1.76482314
 2.07010652 2.07147173 2.3234737  2.33136644 2.84379794 2.85203602
 2.88518193 2.88541205 2.98371673 2.98745853 3.73403489 3.73502833
 5.0767158  5.07936952 6.8951624  6.89703675]
    CPU time for vj and vk      3.72 sec, wall time      0.12 sec
E1 = (4.193488975209906-3.590257383356737e-18j)  E_coul = (-2.2411472085738064+2.233762432259165e-17j)
Extra cycle  E= -10.8347873789881  delta_E= -8.79e-10  |g|= 2.68e-05  |ddm|= 0.00139
    CPU time for scf_cycle     32.54 sec, wall time      1.05 sec
    CPU time for SCF     34.86 sec, wall time      1.13 sec
converged SCF energy = -10.8347873789881
**** SCF Summaries ****
Total Energy =                         -10.834787378988141
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193488975209906
Two-electron Energy =                   -2.241147208573806
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89509
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.52 sec, wall time      0.05 sec
End time = Wed May 28 02:58:05 PM PDT 2025
