SLURMD_NODENAME = hpc-35-02
Start time = Wed May 28 02:57:46 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-15/49864295/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-15/49864295/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/100/15/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-100-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-15
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 15.0
wrap_around = True

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2235, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 12167, selected grid size = 390
truncated values = 6.79e+01, estimated error = 8.30e-01
Number of interpolating points is 390.
    CPU time for building inpv_kpt     16.02 sec, wall time      9.09 sec

Out-core version is used for eta_kpt.
disk space required: 3.04e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   3.04e-01 GB
memory needed for each k-point: 7.59e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     11.55 sec, wall time      0.47 sec
    CPU time for building eta_kpt     13.32 sec, wall time      0.53 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      9.99 sec, wall time      0.41 sec
    CPU time for coul_kpt[ 2 / 4]      8.76 sec, wall time      0.41 sec
    CPU time for coul_kpt[ 3 / 4]      8.88 sec, wall time      0.42 sec
    CPU time for coul_kpt[ 4 / 4]      8.81 sec, wall time      0.42 sec
    CPU time for building coul_kpt     36.66 sec, wall time      1.67 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-15/49864295/jqeirzjo


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-15/49864295/tmpq0wbq12m
max_memory 327680 MB (current use 405 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f2090b12f50>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.61 sec, wall time      0.08 sec
E1 = (3.604511952661072-2.2691031824885323e-18j)  E_coul = (-4.238124036792688+7.555415899383792e-18j)
init E= -13.4207412297559
    CPU time for initialize scf      5.62 sec, wall time      0.18 sec
HOMO = 0.642144871424  LUMO = 0.77654166229
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97421362  0.60526934  0.60923496  0.64214487] [0.85981406 0.88583463 0.91020827 1.12521883 1.79100816 1.8052332
 1.86207905 2.08341495 2.08747493 2.09920951 2.64580382 2.64768126
 2.64891039 3.5531833  3.55396231 3.5547963  3.6595007  3.66028858
 4.21009502 4.73493322 4.73541465 4.73596799]
   1 ( 0.000  0.000 -0.500)   [-0.78013548 -0.5084756   0.46132567  0.50284751] [0.94786975 1.02143874 1.04033145 1.35353751 1.62942389 1.75603172
 1.81457151 1.82407535 2.11260807 2.11924711 2.95660046 3.06755654
 3.06855985 3.10242295 3.10319305 3.30379903 3.64928915 3.65343132
 3.76725966 3.76773886 5.13920035 9.64994228]
   2 (-0.000 -0.500  0.000)   [-0.78013417 -0.50847738  0.46133926  0.50285069] [0.94787038 1.02143575 1.04032533 1.35353196 1.62942866 1.75604574
 1.81456895 1.82407564 2.11260472 2.1192512  2.95659949 3.06753687
 3.06856737 3.10242301 3.10319418 3.30380332 3.64926259 3.65339871
 3.76726497 3.76771682 5.13915704 9.6499501 ]
   3 ( 0.000 -0.500 -0.500)   [-0.41687679 -0.40449992  0.2247575   0.31063905] [0.77654166 0.84137729 1.40154052 1.40348413 1.67780604 1.68165641
 2.07043584 2.07583362 2.31225425 2.3146563  2.79346733 2.80077554
 2.87065351 2.87951569 2.9549123  2.9559761  3.67414594 3.67561957
 5.04760798 5.04816309 6.80906642 6.81453704]
    CPU time for vj and vk      2.61 sec, wall time      0.08 sec
E1 = (4.198020390033605-3.831664432974868e-18j)  E_coul = (-2.2326022314523972-3.684923008495395e-18j)
cycle= 1 E= -10.821710987043  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      3.06 sec, wall time      0.10 sec
HOMO = 0.352230398015  LUMO = 0.898284411037
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67168396  0.30156011  0.34067179  0.3522304 ] [0.97852585 0.99135583 1.01473509 1.3323443  1.80555056 1.80602183
 1.88406401 2.11996929 2.12203235 2.12534524 2.7080127  2.71167908
 2.7119468  3.56356668 3.56539349 3.56992504 3.69758617 3.70486793
 4.22159666 4.77131057 4.77256867 4.77471793]
   1 ( 0.000  0.000 -0.500)   [-0.39620362 -0.2565676   0.18712988  0.22271906] [1.09292966 1.10501501 1.15031569 1.39711251 1.684299   1.81149606
 1.84708705 1.85166248 2.11921029 2.12572806 3.00551234 3.12358367
 3.12499613 3.13814142 3.14094625 3.32109626 3.66804781 3.66814336
 3.79986363 3.8063854  5.18613461 9.8334857 ]
   2 (-0.000 -0.500  0.000)   [-0.39620762 -0.25657739  0.18713152  0.22272975] [1.09294226 1.10500837 1.15031519 1.39708741 1.68430122 1.81151979
 1.84709392 1.85166743 2.11921636 2.12572512 3.00551408 3.12357508
 3.1250072  3.138102   3.14096406 3.32109891 3.66800736 3.66808242
 3.7998805  3.80628275 5.18611432 9.83349983]
   3 ( 0.000 -0.500 -0.500)   [-0.2554508  -0.25121922  0.0395732   0.07508748] [0.89828441 0.95900867 1.50273172 1.50996318 1.74944373 1.76464278
 2.0704907  2.0720494  2.32316632 2.33068657 2.84347131 2.85143693
 2.88506423 2.88515128 2.9837221  2.98720996 3.73225817 3.73350835
 5.07638792 5.07980238 6.89785579 6.89898479]
    CPU time for vj and vk      2.65 sec, wall time      0.09 sec
E1 = (4.194201288044894-5.8124302131292586e-18j)  E_coul = (-2.241255803315364-3.259892636841135e-18j)
cycle= 2 E= -10.8341836608947  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      3.26 sec, wall time      0.11 sec
HOMO = 0.346088853456  LUMO = 0.903487415198
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66974924  0.30008585  0.33519     0.34608885] [0.98176541 0.99583756 1.01713161 1.33877377 1.80542278 1.80618681
 1.88487459 2.12062981 2.12314545 2.1263824  2.70739888 2.71031376
 2.71096817 3.56373994 3.5658006  3.56954449 3.69891817 3.70582185
 4.21948619 4.77234946 4.77317834 4.775223  ]
   1 ( 0.000  0.000 -0.500)   [-0.39586582 -0.25760151  0.18697662  0.21793283] [1.09766359 1.10851323 1.15152997 1.39895524 1.68507951 1.81195347
 1.84608885 1.85180289 2.11923099 2.12551636 3.0062309  3.12426671
 3.12521463 3.1388842  3.14120965 3.32162867 3.66770858 3.66838668
 3.80026486 3.80639848 5.18501861 9.82835894]
   2 (-0.000 -0.500  0.000)   [-0.39586988 -0.25761068  0.18697917  0.21794478] [1.09767694 1.10850639 1.15153066 1.39892989 1.68508209 1.81197557
 1.84609711 1.85180749 2.11923722 2.12551479 3.00623213 3.12425764
 3.12522656 3.13884674 3.14122843 3.32163058 3.66766211 3.66832719
 3.80028017 3.80629779 5.18499753 9.82837242]
   3 ( 0.000 -0.500 -0.500)   [-0.2562705  -0.25203976  0.04013004  0.07062641] [0.90348742 0.95977527 1.50637614 1.51279433 1.75053989 1.76461254
 2.07003501 2.07142944 2.32339263 2.33115687 2.84348813 2.85178693
 2.88516176 2.88527553 2.9835195  2.98725932 3.73377998 3.73460825
 5.07646788 5.07907632 6.89470784 6.89640204]
    CPU time for vj and vk      2.63 sec, wall time      0.08 sec
E1 = (4.193437562550679-5.993228464387718e-18j)  E_coul = (-2.241086099603204-3.1295567861875687e-18j)
cycle= 3 E= -10.8347776826768  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.84
    CPU time for cycle= 3      3.22 sec, wall time      0.10 sec
HOMO = 0.346430516423  LUMO = 0.9037915601
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66924943  0.30045901  0.33534385  0.34643052] [0.98224598 0.99641627 1.01757759 1.33934665 1.80562561 1.80636368
 1.88474304 2.12077884 2.12324059 2.12653151 2.70778874 2.7106613
 2.71140429 3.5638445  3.56594213 3.56958043 3.69923249 3.70609282
 4.21953933 4.77262551 4.77342473 4.77545615]
   1 ( 0.000  0.000 -0.500)   [-0.39526244 -0.25726085  0.18744007  0.21817887] [1.09807835 1.10897412 1.15172068 1.39902725 1.68521951 1.81232611
 1.84630525 1.85203851 2.11943837 2.12559141 3.00657525 3.12450613
 3.12536246 3.13938921 3.14166703 3.32174435 3.66779376 3.66852519
 3.80049219 3.8066055  5.18533173 9.82960509]
   2 (-0.000 -0.500  0.000)   [-0.39526647 -0.25727001  0.18744256  0.21819085] [1.09809166 1.10896743 1.1517213  1.39900189 1.68522203 1.81234808
 1.84631348 1.85204306 2.11944458 2.12558979 3.00657653 3.12449704
 3.12537443 3.1393519  3.14168593 3.32174628 3.66774711 3.668466
 3.80050734 3.80650487 5.18531078 9.82961867]
   3 ( 0.000 -0.500 -0.500)   [-0.25577726 -0.25163151  0.0405498   0.07090084] [0.90379156 0.95976898 1.50715255 1.51357233 1.75082613 1.76488297
 2.07012009 2.07144002 2.32350108 2.33139166 2.84383339 2.85207741
 2.88517339 2.88542009 2.98371915 2.9874849  3.73409167 3.73506849
 5.07671027 5.07925821 6.89522915 6.89709433]
    CPU time for vj and vk      2.66 sec, wall time      0.09 sec
E1 = (4.193466764346944-5.959274313595496e-18j)  E_coul = (-2.241117986226544-3.1209598356749133e-18j)
cycle= 4 E= -10.8347803675038  delta_E= -2.68e-06  |g|= 0.000614  |ddm|= 0.0986
    CPU time for cycle= 4      3.23 sec, wall time      0.10 sec
HOMO = 0.346386552901  LUMO = 0.90377831728
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66930262  0.30040169  0.33526756  0.34638655] [0.98222223 0.99638263 1.01754166 1.33929144 1.80561333 1.80634078
 1.88475675 2.12076914 2.12321934 2.12651869 2.70773269 2.71060327
 2.71135705 3.56383237 3.56593125 3.56956234 3.69920336 3.70606266
 4.21952252 4.77260109 4.77339599 4.77542696]
   1 ( 0.000  0.000 -0.500)   [-0.39528345 -0.25732963  0.18739145  0.2181135 ] [1.09803635 1.10894513 1.15169654 1.39903269 1.68519039 1.8122859
 1.84626166 1.85200156 2.11943118 2.12556686 3.00654363 3.12449421
 3.12534521 3.13933745 3.14161216 3.32173655 3.66777444 3.66851603
 3.8004594  3.8065724  5.18529343 9.82942989]
   2 (-0.000 -0.500  0.000)   [-0.39528749 -0.25733876  0.18739394  0.21812547] [1.09804964 1.10893843 1.15169715 1.39900733 1.68519291 1.81230786
 1.8462699  1.85200612 2.11943741 2.12556526 3.00654492 3.12448509
 3.12535717 3.13930017 3.14163105 3.32173845 3.66772776 3.66845683
 3.80047453 3.80647183 5.18527248 9.82944347]
   3 ( 0.000 -0.500 -0.500)   [-0.25583562 -0.25168758  0.04049822  0.07086328] [0.90377832 0.95976053 1.50710102 1.51354022 1.75075928 1.76482205
 2.07010416 2.07142817 2.3234781  2.33136861 2.84379246 2.85203353
 2.8851641  2.88541666 2.98368746 2.987466   3.73404958 3.73503073
 5.07668695 5.07922942 6.8951371  6.89701716]
    CPU time for vj and vk      2.64 sec, wall time      0.08 sec
E1 = (4.193488260343335-5.9562031667563754e-18j)  E_coul = (-2.2411395283887443-3.1202341826469146e-18j)
cycle= 5 E= -10.8347804136696  delta_E= -4.62e-08  |g|= 8.48e-05  |ddm|= 0.0095
    CPU time for cycle= 5      3.21 sec, wall time      0.10 sec
HOMO = 0.346393546065  LUMO = 0.903779477337
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66929984  0.30040261  0.33526809  0.34639355] [0.98222366 0.99638415 1.01754243 1.33929311 1.80561399 1.80634149
 1.8847557  2.12076879 2.12321865 2.12651942 2.70773388 2.71060481
 2.71136033 3.56383289 3.56593189 3.56956227 3.69920417 3.70606337
 4.21952355 4.77260199 4.77339666 4.77542767]
   1 ( 0.000  0.000 -0.500)   [-0.39527814 -0.25732682  0.18739251  0.21811449] [1.09803715 1.10894659 1.15169598 1.39903188 1.68519155 1.81228815
 1.84626234 1.85200282 2.11943402 2.12556716 3.00654579 3.12449523
 3.12534536 3.13933901 3.14161326 3.32173651 3.66777434 3.66851702
 3.80045943 3.80657285 5.18529525 9.82943767]
   2 (-0.000 -0.500  0.000)   [-0.39528218 -0.25733595  0.187395    0.21812646] [1.09805044 1.10893989 1.15169658 1.39900651 1.68519408 1.81231011
 1.84627058 1.85200739 2.11944024 2.12556556 3.00654708 3.12448611
 3.12535733 3.13930173 3.14163215 3.3217384  3.66772766 3.66845782
 3.80047457 3.80647228 5.18527429 9.82945124]
   3 ( 0.000 -0.500 -0.500)   [-0.25583204 -0.25168645  0.04049964  0.07086747] [0.90377948 0.9597601  1.5071026  1.51354492 1.75075963 1.76482096
 2.07010507 2.07142841 2.32347777 2.3313701  2.84379376 2.85203424
 2.88516315 2.88541805 2.98368804 2.98746758 3.7340493  3.73503313
 5.07668822 5.07923045 6.89513946 6.89702244]
    CPU time for vj and vk      2.67 sec, wall time      0.09 sec
E1 = (4.193488837395164-5.9555123177780825e-18j)  E_coul = (-2.241140106334584-3.1201547173506556e-18j)
Extra cycle  E= -10.8347804145637  delta_E= -8.94e-10  |g|= 2.73e-05  |ddm|= 0.00139
    CPU time for scf_cycle     24.83 sec, wall time      0.80 sec
    CPU time for SCF     26.79 sec, wall time      0.87 sec
converged SCF energy = -10.8347804145637
**** SCF Summaries ****
Total Energy =                         -10.834780414563660
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193488837395164
Two-electron Energy =                   -2.241140106334584
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05198
pop of  0 C 2py           1.01163
pop of  0 C 2pz           1.01163
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89508
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05201
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01167
pop of  1 C 3px           0.00286
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00004
charge of    1C =     -0.00004
    CPU time for vj and vk      0.75 sec, wall time      0.03 sec
End time = Wed May 28 02:58:00 PM PDT 2025
