SLURMD_NODENAME = hpc-53-14
Start time = Tue Jun  3 12:29:17 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-30/49977556/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-30/49977556/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/100/30/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-100-30
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-30
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 30.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 30.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2235, c0 =  30.00, nao = 26, nip = 780
Parent grid size = 12167, selected grid size = 780
truncated values = 6.87e+01, estimated error = 4.51e-02
Number of interpolating points is 780.
    CPU time for building inpv_kpt     18.53 sec, wall time     11.49 sec

Out-core version is used for eta_kpt.
disk space required: 6.07e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   6.07e-01 GB
memory needed for each k-point: 1.52e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     17.97 sec, wall time      1.08 sec
    CPU time for building eta_kpt     19.73 sec, wall time      1.13 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     16.29 sec, wall time      1.59 sec
    CPU time for coul_kpt[ 2 / 4]     13.54 sec, wall time      1.60 sec
    CPU time for coul_kpt[ 3 / 4]     12.75 sec, wall time      1.63 sec
    CPU time for coul_kpt[ 4 / 4]     13.40 sec, wall time      1.63 sec
    CPU time for building coul_kpt     57.41 sec, wall time      6.50 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-30/49977556/4k39kngm


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-30/49977556/tmp3lt2maov
max_memory 327680 MB (current use 427 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f73b938a020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.23 sec, wall time      0.17 sec
E1 = (3.6045119526610727+2.2691031824884653e-18j)  E_coul = (-4.238151402662578+3.730542291460756e-17j)
init E= -13.4207685956257
    CPU time for initialize scf      8.87 sec, wall time      0.29 sec
HOMO = 0.64214867022  LUMO = 0.776528036551
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422407  0.60527275  0.60923106  0.64214867] [0.85981262 0.88582628 0.91020211 1.125202   1.79100341 1.80523334
 1.86205227 2.08341768 2.08748587 2.09925044 2.6457961  2.64766415
 2.64895338 3.55319792 3.55392242 3.55480303 3.65950816 3.66029221
 4.21012186 4.73495028 4.73541757 4.73596467]
   1 (-0.000 -0.000  0.500)   [-0.7801526  -0.50848296  0.46133113  0.50284986] [0.9478592  1.02143203 1.04032666 1.35354495 1.62942682 1.7560138
 1.8145689  1.82408308 2.11260156 2.11925402 2.95658542 3.06755081
 3.06862926 3.10243196 3.10320875 3.30379491 3.64927421 3.65340463
 3.76724394 3.76776442 5.13917512 9.64996193]
   2 ( 0.000  0.500 -0.000)   [-0.78015261 -0.50848296  0.46133116  0.50284987] [0.94785951 1.02143206 1.04032668 1.35354489 1.62942681 1.75601449
 1.81456908 1.82408269 2.11260163 2.11925383 2.9565855  3.06755111
 3.06862959 3.1024326  3.10320853 3.30379507 3.64927191 3.65340671
 3.76724639 3.76776315 5.1391756  9.64996526]
   3 ( 0.000  0.500  0.500)   [-0.41689401 -0.40450195  0.22475874  0.3106358 ] [0.77652804 0.8413682  1.40153365 1.40349572 1.67780157 1.68166169
 2.07043201 2.07586532 2.31225621 2.31465187 2.79346753 2.80080012
 2.87065821 2.87949495 2.95490356 2.95599615 3.67413149 3.67560513
 5.04763734 5.04823668 6.80908674 6.81454541]
    CPU time for vj and vk      4.99 sec, wall time      0.16 sec
E1 = (4.198021648581423-1.0444485771371868e-17j)  E_coul = (-2.2326091667321264+2.982342127420643e-17j)
cycle= 1 E= -10.8217166637749  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      5.48 sec, wall time      0.17 sec
HOMO = 0.352246326766  LUMO = 0.898271272792
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169533  0.3015645   0.34067962  0.35224633] [0.97853093 0.99133832 1.01471959 1.33231822 1.80554182 1.80602108
 1.884045   2.11998678 2.12203019 2.12540009 2.708083   2.71166937
 2.7119406  3.56352981 3.56540875 3.56997938 3.69759022 3.70486837
 4.22159652 4.77131209 4.77264203 4.77473305]
   1 (-0.000 -0.000  0.500)   [-0.39621886 -0.25657632  0.18712846  0.22273355] [1.09293252 1.10500524 1.15031151 1.39709754 1.68430083 1.81150151
 1.84709068 1.85165982 2.11920462 2.12573923 3.00549397 3.1235743
 3.12502792 3.13812311 3.14101161 3.32109407 3.66803853 3.66810549
 3.79986002 3.80639507 5.1861347  9.83350724]
   2 ( 0.000  0.500 -0.000)   [-0.39621895 -0.25657631  0.18712855  0.22273364] [1.09293273 1.10500519 1.15031155 1.39709761 1.68430087 1.8115019
 1.84709038 1.85165841 2.11920458 2.12573896 3.00549359 3.12357472
 3.12502797 3.13812201 3.14101172 3.32109402 3.6680409  3.66809736
 3.79985939 3.80639229 5.1861355  9.83351236]
   3 ( 0.000  0.500  0.500)   [-0.25545713 -0.2512312   0.03956554  0.07509127] [0.89827127 0.95900115 1.50274233 1.50995468 1.74944565 1.76464545
 2.07049122 2.07210847 2.32316372 2.33068234 2.84347498 2.85143252
 2.88507921 2.88514395 2.98375582 2.98719639 3.73224142 3.73350151
 5.07643088 5.07996947 6.89788047 6.89899421]
    CPU time for vj and vk      5.02 sec, wall time      0.16 sec
E1 = (4.194212679910976-7.983728700485669e-18j)  E_coul = (-2.2412728553202133+3.0810303486792956e-17j)
cycle= 2 E= -10.8341893210335  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      5.62 sec, wall time      0.18 sec
HOMO = 0.34610393746  LUMO = 0.903473799863
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976242  0.30008747  0.33519618  0.34610394] [0.98176914 0.99581759 1.01711485 1.33874561 1.80541291 1.80618379
 1.88485547 2.12064962 2.12313939 2.1264353  2.70746179 2.71030248
 2.71095997 3.56370101 3.56581781 3.56959535 3.69892221 3.70582104
 4.21948108 4.77235115 4.773251   4.77523336]
   1 (-0.000 -0.000  0.500)   [-0.39588283 -0.25760998  0.18697357  0.2179468 ] [1.09766456 1.10850026 1.15152504 1.39893941 1.68507954 1.81195478
 1.84609391 1.85179435 2.1192253  2.12552745 3.00621294 3.12425545
 3.12524333 3.13886456 3.14126788 3.32162598 3.66769603 3.66834478
 3.80025983 3.80640306 5.18501701 9.82837235]
   2 ( 0.000  0.500 -0.000)   [-0.39588292 -0.25760998  0.18697362  0.2179469 ] [1.09766478 1.1085002  1.15152506 1.39893948 1.68507956 1.81195513
 1.84609356 1.8517929  2.11922527 2.12552721 3.00621257 3.12425585
 3.12524327 3.13886355 3.14126817 3.32162593 3.6676878  3.66834713
 3.80025937 3.80640061 5.1850179  9.82837652]
   3 ( 0.000  0.500  0.500)   [-0.25627761 -0.25205355  0.04011992  0.07062976] [0.9034738  0.95976794 1.50638169 1.51278342 1.75053756 1.7646124
 2.07003469 2.07148694 2.3233873  2.33115212 2.84349305 2.85177687
 2.88517924 2.88526888 2.98355117 2.98724511 3.73376371 3.73460024
 5.07651412 5.07923413 6.89472908 6.89640826]
    CPU time for vj and vk      5.02 sec, wall time      0.16 sec
E1 = (4.193447663872495-7.421254205113185e-18j)  E_coul = (-2.2411017804876963+3.107732622331993e-17j)
cycle= 3 E= -10.8347832622394  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      5.65 sec, wall time      0.18 sec
HOMO = 0.346445456412  LUMO = 0.903778130531
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6692622   0.30046142  0.33535034  0.34644546] [0.98225022 0.99639697 1.01756138 1.33931937 1.80561609 1.80636095
 1.88472412 2.12079872 2.12323481 2.12658459 2.70785242 2.71065062
 2.71139652 3.5638057  3.56595931 3.56963144 3.69923698 3.70609239
 4.2195346  4.7726273  4.77349797 4.77546664]
   1 (-0.000 -0.000  0.500)   [-0.39527899 -0.25726922  0.18743769  0.21819309] [1.09807982 1.10896176 1.15171631 1.39901144 1.68521994 1.81232786
 1.84631054 1.85203048 2.1194327  2.12560251 3.00655766 3.12449506
 3.12539157 3.1393703  3.14172612 3.32174204 3.6677812  3.66848378
 3.80048741 3.80661042 5.18533068 9.82962054]
   2 ( 0.000  0.500 -0.000)   [-0.39527908 -0.25726923  0.18743774  0.21819319] [1.09808003 1.1089617  1.15171634 1.39901151 1.68521996 1.81232821
 1.8463102  1.85202902 2.11943267 2.12560226 3.00655728 3.12449546
 3.1253915  3.1393693  3.14172641 3.321742   3.66777297 3.66848608
 3.80048699 3.80660798 5.18533156 9.82962469]
   3 ( 0.000  0.500  0.500)   [-0.25578434 -0.25164466  0.04054033  0.07090415] [0.90377813 0.95976194 1.50715901 1.51356211 1.75082441 1.76488365
 2.07011973 2.07149758 2.32349621 2.33138697 2.84383878 2.8520679
 2.88519053 2.8854139  2.9837511  2.98747095 3.73407588 3.73506107
 5.07675718 5.07941604 6.89525162 6.89710127]
    CPU time for vj and vk      5.04 sec, wall time      0.16 sec
E1 = (4.193476788895389-7.352077178424433e-18j)  E_coul = (-2.241133592174856+3.109035456669627e-17j)
cycle= 4 E= -10.8347859489037  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      5.66 sec, wall time      0.18 sec
HOMO = 0.346401513924  LUMO = 0.903764924602
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931535  0.30040406  0.33527405  0.34640151] [0.98222648 0.99636333 1.01752547 1.33926418 1.80560382 1.80633804
 1.88473782 2.12078899 2.12321353 2.12657175 2.7077963  2.71059258
 2.71134928 3.56379359 3.56594844 3.56961332 3.69920786 3.70606223
 4.2195178  4.77260287 4.77346921 4.77543742]
   1 (-0.000 -0.000  0.500)   [-0.39529996 -0.25733794  0.18738905  0.21812774] [1.09803781 1.10893276 1.15169213 1.39901689 1.68519078 1.81228764
 1.84626696 1.85199348 2.11942555 2.12557796 3.00652605 3.12448313
 3.12537427 3.13931855 3.14167117 3.32173422 3.66776186 3.66847462
 3.80045462 3.8065773  5.18529237 9.82944529]
   2 ( 0.000  0.500 -0.000)   [-0.39530004 -0.25733794  0.1873891   0.21812784] [1.09803802 1.1089327  1.15169215 1.39901696 1.68519081 1.81228799
 1.84626661 1.85199202 2.11942552 2.12557771 3.00652567 3.12448352
 3.1253742  3.13931755 3.14167146 3.32173417 3.66775363 3.66847692
 3.8004542  3.80657486 5.18529326 9.82944944]
   3 ( 0.000  0.500  0.500)   [-0.25584263 -0.25170069  0.04048874  0.07086662] [0.90376492 0.95975346 1.50710745 1.51353001 1.75075753 1.76482269
 2.07010379 2.07148568 2.32347321 2.33136395 2.84379784 2.85202397
 2.88518122 2.88541052 2.9837194  2.98745206 3.73403375 3.73502335
 5.07673382 5.07938712 6.89515955 6.8970241 ]
    CPU time for vj and vk      5.01 sec, wall time      0.16 sec
E1 = (4.1934982889955545-7.345224505340512e-18j)  E_coul = (-2.2411551384272506+3.109088746988298e-17j)
cycle= 5 E= -10.8347859950559  delta_E= -4.62e-08  |g|= 8.44e-05  |ddm|= 0.00953
    CPU time for cycle= 5      5.62 sec, wall time      0.18 sec
HOMO = 0.346408502856  LUMO = 0.903766082281
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931257  0.30040498  0.33527458  0.3464085 ] [0.98222791 0.99636485 1.01752624 1.33926584 1.80560447 1.80633875
 1.88473678 2.12078864 2.12321285 2.12657247 2.70779749 2.71059411
 2.71135255 3.56379412 3.56594908 3.56961325 3.69920867 3.70606294
 4.21951883 4.77260377 4.77346988 4.77543813]
   1 (-0.000 -0.000  0.500)   [-0.39529464 -0.25733513  0.18739011  0.21812873] [1.0980386  1.10893422 1.15169157 1.39901607 1.68519195 1.81228989
 1.84626764 1.85199475 2.11942838 2.12557825 3.00652821 3.12448415
 3.12537444 3.13932011 3.14167227 3.32173418 3.66776175 3.66847561
 3.80045466 3.80657775 5.18529418 9.82945306]
   2 ( 0.000  0.500 -0.000)   [-0.39529473 -0.25733514  0.18739016  0.21812883] [1.09803881 1.10893416 1.15169159 1.39901615 1.68519197 1.81229024
 1.84626729 1.85199329 2.11942835 2.12557801 3.00652783 3.12448454
 3.12537436 3.13931911 3.14167256 3.32173413 3.66775352 3.66847791
 3.80045423 3.80657531 5.18529507 9.82945722]
   3 ( 0.000  0.500  0.500)   [-0.25583906 -0.25169956  0.04049016  0.07087082] [0.90376608 0.95975303 1.50710904 1.51353472 1.75075789 1.7648216
 2.07010469 2.07148593 2.32347288 2.33136544 2.84379915 2.85202468
 2.88518027 2.88541189 2.98371998 2.98745364 3.73403348 3.73502574
 5.07673509 5.07938815 6.89516191 6.89702937]
    CPU time for vj and vk      5.02 sec, wall time      0.16 sec
E1 = (4.193498865478687-7.346454696411869e-18j)  E_coul = (-2.2411557157895827+3.109085365341495e-17j)
Extra cycle  E= -10.8347859959351  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00138
    CPU time for scf_cycle     42.50 sec, wall time      1.36 sec
    CPU time for SCF     46.33 sec, wall time      1.50 sec
converged SCF energy = -10.8347859959351
**** SCF Summaries ****
Total Energy =                         -10.834785995935135
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193498865478687
Two-electron Energy =                   -2.241155715789583
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89510
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01165
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      2.84 sec, wall time      0.09 sec
End time = Tue Jun  3 12:29:39 PM PDT 2025
