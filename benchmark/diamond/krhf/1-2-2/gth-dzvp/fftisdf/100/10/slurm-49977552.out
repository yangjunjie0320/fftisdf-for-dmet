SLURMD_NODENAME = hpc-54-17
Start time = Tue Jun  3 12:29:08 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-10/49977552/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-10/49977552/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-2-2/gth-dzvp/fftisdf/100/10/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-100-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-10
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 10.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 10.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 2235, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 12167, selected grid size = 260
truncated values = 6.61e+01, estimated error = 2.66e+00
Number of interpolating points is 260.
    CPU time for building inpv_kpt     16.34 sec, wall time      9.42 sec

Out-core version is used for eta_kpt.
disk space required: 2.02e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   2.02e-01 GB
memory needed for each k-point: 5.06e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     10.02 sec, wall time      0.34 sec
    CPU time for building eta_kpt     11.79 sec, wall time      0.40 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      7.04 sec, wall time      0.22 sec
    CPU time for coul_kpt[ 2 / 4]      6.99 sec, wall time      0.22 sec
    CPU time for coul_kpt[ 3 / 4]      6.99 sec, wall time      0.22 sec
    CPU time for coul_kpt[ 4 / 4]      7.11 sec, wall time      0.22 sec
    CPU time for building coul_kpt     28.26 sec, wall time      0.89 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-10/49977552/jkxu4kvt


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-2-2-gth-dzvp-fftisdf-100-10/49977552/tmpezgte0zm
max_memory 327680 MB (current use 408 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]
 [ 0.46609264 -0.46609264  0.46609264]
 [ 0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f5825fba020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.54 sec, wall time      0.08 sec
E1 = (3.6045119526610727+9.076412729954652e-19j)  E_coul = (-4.2378901762212795-3.976389929581816e-17j)
init E= -13.4205073691844
    CPU time for initialize scf      5.59 sec, wall time      0.19 sec
HOMO = 0.642183776789  LUMO = 0.776591551271
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97411689  0.60528095  0.60931513  0.64218378] [0.85979524 0.88576715 0.9101558  1.12535094 1.79093665 1.80520963
 1.86228338 2.08355699 2.08747962 2.09918783 2.64564194 2.64748217
 2.64870328 3.55319161 3.55403739 3.55500665 3.65951711 3.66026631
 4.2098421  4.73483046 4.73517609 4.73570586]
   1 (-0.000 -0.000  0.500)   [-0.77996951 -0.50843738  0.4613346   0.50288502] [0.94797318 1.02142989 1.04031092 1.3535628  1.62933695 1.7559552
 1.81460211 1.82399205 2.11257724 2.11916187 2.95662777 3.06751413
 3.06849388 3.10243117 3.10300983 3.30378225 3.64940477 3.65336657
 3.76726304 3.76758547 5.13934965 9.64985576]
   2 ( 0.000  0.500 -0.000)   [-0.78001352 -0.50848546  0.46138835  0.50289355] [0.94800907 1.02146686 1.04027885 1.35353596 1.62935518 1.75605302
 1.81460853 1.8240296  2.11260835 2.11918352 2.95667653 3.06749352
 3.06844531 3.10241973 3.10307859 3.30387193 3.64930796 3.65328991
 3.76717377 3.76772477 5.13917045 9.64989105]
   3 ( 0.000  0.500  0.500)   [-0.41672918 -0.40442533  0.22470217  0.31068892] [0.77659155 0.84150184 1.40159095 1.40344301 1.67772065 1.68157163
 2.07043795 2.07571214 2.31221322 2.31463939 2.79352234 2.80070943
 2.8705838  2.879482   2.95478938 2.95576649 3.67428565 3.6756484
 5.04744256 5.04767858 6.8090886  6.81438846]
    CPU time for vj and vk      2.73 sec, wall time      0.09 sec
E1 = (4.197945834805383-1.6108796009734267e-17j)  E_coul = (-2.2323522682022836-4.472138885131741e-17j)
cycle= 1 E= -10.8215355790211  delta_E=  2.6  |g|= 0.446  |ddm|= 14.9
    CPU time for cycle= 1      3.20 sec, wall time      0.10 sec
HOMO = 0.352246046206  LUMO = 0.898335160735
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6715432   0.30154814  0.34076024  0.35224605] [0.97851165 0.9913077  1.01466547 1.33247492 1.80545219 1.80599497
 1.88426955 2.120084   2.12197713 2.12538068 2.70789229 2.71169051
 2.71188329 3.56356526 3.56555192 3.57000911 3.69754043 3.70483845
 4.22149119 4.77114947 4.77226036 4.77423125]
   1 (-0.000 -0.000  0.500)   [-0.39605442 -0.25653098  0.18711174  0.22275316] [1.09302113 1.10499097 1.15033597 1.3971218  1.68421086 1.81156554
 1.84728322 1.8516116  2.11919077 2.12564651 3.00549889 3.12356546
 3.12481795 3.1382258  3.14090184 3.32108834 3.66790193 3.66798766
 3.79993371 3.80634214 5.18622013 9.83349992]
   2 ( 0.000  0.500 -0.000)   [-0.39605794 -0.25661033  0.18712866  0.222823  ] [1.0930294  1.10499412 1.15033568 1.39709443 1.68428363 1.81158704
 1.84719759 1.85167569 2.11922535 2.12568622 3.00560184 3.12358128
 3.12497568 3.13811112 3.14089061 3.32110099 3.66775391 3.66788953
 3.79971677 3.80625671 5.18613689 9.83355488]
   3 ( 0.000  0.500  0.500)   [-0.25537434 -0.25107776  0.03956738  0.07504801] [0.89833516 0.95907427 1.50276869 1.51005168 1.74945214 1.76458562
 2.07048127 2.07197546 2.323156   2.3306448  2.84355995 2.85136443
 2.88488866 2.88510572 2.98362168 2.98714164 3.73233737 3.73349222
 5.07622467 5.0790819  6.89792932 6.89890206]
    CPU time for vj and vk      2.72 sec, wall time      0.09 sec
E1 = (4.194255264391297-1.2279209577469946e-17j)  E_coul = (-2.2411562489336396-4.4580176762036e-17j)
cycle= 2 E= -10.8340301301666  delta_E= -0.0125  |g|= 0.0896  |ddm|= 4.19
    CPU time for cycle= 2      3.31 sec, wall time      0.11 sec
HOMO = 0.346072655524  LUMO = 0.903542727047
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66962016  0.30003717  0.33525112  0.34607266] [0.98172412 0.99577516 1.01703748 1.33888721 1.80530314 1.80613659
 1.88508895 2.12074386 2.12308066 2.12641376 2.7072576  2.71029911
 2.71086921 3.56371813 3.5659465  3.56960627 3.69885492 3.70577457
 4.21937948 4.77218207 4.77289052 4.7747403 ]
   1 (-0.000 -0.000  0.500)   [-0.3957287  -0.2575793   0.1869283   0.21793723] [1.09773865 1.10847688 1.15153464 1.3989603  1.68497333 1.81200136
 1.84627613 1.85174978 2.11920646 2.12543322 3.00620065 3.12422751
 3.12501257 3.13891926 3.14113495 3.3216185  3.66758458 3.66821062
 3.8003188  3.8063431  5.1850719  9.82827102]
   2 ( 0.000  0.500 -0.000)   [-0.39573529 -0.25766156  0.18694795  0.21800588] [1.0977412  1.108488   1.15153337 1.39892995 1.68504259 1.812012
 1.8461944  1.85179857 2.11923113 2.12546535 3.00630571 3.1242453
 3.12517495 3.13882145 3.14112558 3.321628   3.66746987 3.66807299
 3.80010673 3.8062578  5.18499312 9.82832616]
   3 ( 0.000  0.500  0.500)   [-0.25620835 -0.2519182   0.0400958   0.07055711] [0.90354273 0.95983954 1.5063993  1.51283644 1.75051855 1.76453162
 2.07001373 2.07135376 2.3233586  2.33110908 2.84355634 2.85169227
 2.88497297 2.8852209  2.98340546 2.9871819  3.73381001 3.73458655
 5.07627179 5.07839315 6.89474276 6.89627107]
    CPU time for vj and vk      2.67 sec, wall time      0.09 sec
E1 = (4.193504544051275-1.1459342952948266e-17j)  E_coul = (-2.2410007564466077-4.444102544918667e-17j)
cycle= 3 E= -10.8346253580196  delta_E= -0.000595  |g|= 0.00537  |ddm|= 0.848
    CPU time for cycle= 3      3.27 sec, wall time      0.10 sec
HOMO = 0.346415183323  LUMO = 0.903848442904
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66911811  0.30041397  0.33540924  0.34641518] [0.98220758 0.9963579  1.01748659 1.33946617 1.80550748 1.80631556
 1.8849562  2.12089318 2.12317643 2.12656369 2.70765271 2.7106509
 2.71130905 3.56382387 3.56608807 3.56964338 3.69917206 3.70604789
 4.21943414 4.77245933 4.77313883 4.77497634]
   1 (-0.000 -0.000  0.500)   [-0.39512267 -0.25723786  0.18739493  0.21818596] [1.0981565  1.10894152 1.15172793 1.39903229 1.6851152  1.81237599
 1.84649491 1.85198874 2.11941425 2.12550904 3.00654744 3.12446774
 3.12516276 3.13942899 3.14159623 3.3217353  3.6676693  3.66834923
 3.80054845 3.8065537  5.18538774 9.82952955]
   2 ( 0.000  0.500 -0.000)   [-0.39512932 -0.25731903  0.18741496  0.21825393] [1.0981591  1.10895174 1.15172653 1.39900243 1.68518529 1.81238771
 1.84641224 1.85203727 2.11943957 2.12554151 3.00665226 3.12448492
 3.12532594 3.13933044 3.14158717 3.32174414 3.66755516 3.66821148
 3.80033676 3.80646636 5.18530837 9.82958482]
   3 ( 0.000  0.500  0.500)   [-0.25571313 -0.25150642  0.04051898  0.07083216] [0.90384844 0.95983402 1.50718176 1.51361855 1.75080982 1.76480716
 2.07009967 2.07136488 2.3234696  2.33134512 2.84390367 2.85198526
 2.88498933 2.88536346 2.98360656 2.98740879 3.73412801 3.73504543
 5.07651653 5.0785795  6.89526828 6.89697088]
    CPU time for vj and vk      2.69 sec, wall time      0.09 sec
E1 = (4.193533492909392-1.1380618979148204e-17j)  E_coul = (-2.2410323996643498-4.4432674594701535e-17j)
cycle= 4 E= -10.8346280523792  delta_E= -2.69e-06  |g|= 0.000618  |ddm|= 0.0988
    CPU time for cycle= 4      3.29 sec, wall time      0.11 sec
HOMO = 0.346371301538  LUMO = 0.903835350852
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66917101  0.30035655  0.33533314  0.3463713 ] [0.98218389 0.99632438 1.01745078 1.33941114 1.80549517 1.80629264
 1.88496982 2.1208834  2.12315522 2.12655085 2.70759665 2.7105929
 2.71126184 3.56381179 3.56607708 3.56962516 3.69914294 3.70601776
 4.21941724 4.77243492 4.77311055 4.77494714]
   1 (-0.000 -0.000  0.500)   [-0.39514339 -0.25730639  0.1873463   0.21812074] [1.09811455 1.10891261 1.15170372 1.39903765 1.6850859  1.81233574
 1.84645135 1.85195192 2.1194072  2.12548451 3.00651599 3.12445577
 3.12514554 3.13937725 3.14154126 3.32172744 3.66765016 3.66834006
 3.80051561 3.80652054 5.18534935 9.82935457]
   2 ( 0.000  0.500 -0.000)   [-0.39514994 -0.25738769  0.18736635  0.21818873] [1.09811726 1.10892289 1.15170227 1.39900783 1.68515608 1.81234738
 1.8463687  1.85200029 2.11943233 2.12551686 3.00662077 3.12447298
 3.12530861 3.13927886 3.14153219 3.32173629 3.667536   3.66820247
 3.80030393 3.80643334 5.18527001 9.8294098 ]
   3 ( 0.000  0.500  0.500)   [-0.25577114 -0.25156226  0.04046741  0.07079468] [0.90383535 0.95982549 1.50713046 1.51358651 1.75074303 1.76474615
 2.07008373 2.07135291 2.32344661 2.33132209 2.8438628  2.85194132
 2.88497948 2.88536056 2.98357492 2.98738991 3.73408679 3.7350069
 5.07649338 5.07855077 6.89517776 6.89689254]
    CPU time for vj and vk      2.67 sec, wall time      0.09 sec
E1 = (4.193555115448876-1.137351463148302e-17j)  E_coul = (-2.2410540689592993-4.443507353091034e-17j)
cycle= 5 E= -10.8346280991347  delta_E= -4.68e-08  |g|= 8.96e-05  |ddm|= 0.00964
    CPU time for cycle= 5      3.25 sec, wall time      0.10 sec
HOMO = 0.346378211942  LUMO = 0.903836486834
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66916833  0.30035738  0.33533359  0.34637821] [0.98218526 0.99632585 1.0174515  1.33941273 1.80549579 1.80629332
 1.88496879 2.12088303 2.12315451 2.12655155 2.70759776 2.71059436
 2.71126503 3.56381229 3.56607769 3.56962507 3.6991437  3.70601842
 4.21941824 4.77243576 4.77311116 4.7749478 ]
   1 (-0.000 -0.000  0.500)   [-0.39513813 -0.25730369  0.18734727  0.21812166] [1.09811529 1.10891403 1.15170312 1.39903685 1.68508701 1.81233792
 1.84645196 1.85195312 2.11941    2.12548478 3.00651808 3.12445676
 3.12514563 3.13937875 3.14154233 3.32172739 3.66765002 3.66834103
 3.8005156  3.80652094 5.1853511  9.82936209]
   2 ( 0.000  0.500 -0.000)   [-0.39514469 -0.25738497  0.18736733  0.21818963] [1.09811799 1.10892429 1.15170166 1.39900703 1.6851572  1.81234958
 1.84636931 1.85200151 2.11943514 2.12551714 3.00662287 3.12447398
 3.12530872 3.13928034 3.14153324 3.32173622 3.66753585 3.66820342
 3.80030392 3.80643375 5.18527174 9.82941731]
   3 ( 0.000  0.500  0.500)   [-0.25576765 -0.25156122  0.04046875  0.07079881] [0.90383649 0.95982504 1.50713195 1.51359113 1.75074331 1.76474498
 2.0700846  2.07135315 2.32344622 2.33132357 2.84386404 2.85194196
 2.88497885 2.88536159 2.98357546 2.98739145 3.73408605 3.73500964
 5.0764946  5.07855172 6.89517932 6.89689837]
    CPU time for vj and vk      2.54 sec, wall time      0.08 sec
E1 = (4.1935557245433435-1.1375111954540048e-17j)  E_coul = (-2.2410546790406634-4.443530920595869e-17j)
Extra cycle  E= -10.8346281001216  delta_E= -9.87e-10  |g|= 3.04e-05  |ddm|= 0.00146
    CPU time for scf_cycle     24.98 sec, wall time      0.81 sec
    CPU time for SCF     27.17 sec, wall time      0.88 sec
converged SCF energy = -10.8346281001216
**** SCF Summaries ****
Total Energy =                         -10.834628100121559
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193555724543343
Two-electron Energy =                   -2.241054679040663
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89489
pop of  0 C 3s            0.00353
pop of  0 C 2px           1.05206
pop of  0 C 2py           1.01166
pop of  0 C 2pz           1.01154
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00651
pop of  0 C 3dyz          0.00557
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89507
pop of  1 C 3s            0.00354
pop of  1 C 2px           1.05208
pop of  1 C 2py           1.01166
pop of  1 C 2pz           1.01181
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00219
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =      0.00022
charge of    1C =     -0.00022
    CPU time for vj and vk      0.57 sec, wall time      0.02 sec
End time = Tue Jun  3 12:29:21 PM PDT 2025
