SLURMD_NODENAME = hpc-35-02
Start time = Tue Jun  3 12:26:20 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-1-2-gth-dzvp-fftisdf-150-15/49977517/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-1-2-gth-dzvp-fftisdf-150-15/49977517/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-1-2/gth-dzvp/fftisdf/150/15/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-150-15
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-150-15
ke_cutoff = 150.0, mesh = [29 29 29]
Using ke_cutoff = 150.0, c0 = 15.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [29 29 29] (24389 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 15.0
wrap_around = False

WARN: ke_cutoff/mesh (150 / [29 29 29]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.042 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1205, c0 =  15.00, nao = 26, nip = 390
Parent grid size = 24389, selected grid size = 390
truncated values = 3.99e+01, estimated error = 9.02e-02
Number of interpolating points is 390.
    CPU time for building inpv_kpt     32.47 sec, wall time     25.04 sec

Out-core version is used for eta_kpt.
disk space required: 3.04e-01 GB.
blksize = 24389, ngrid = 24389
memory needed for each block:   3.04e-01 GB
memory needed for each k-point: 1.52e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 24389]     11.52 sec, wall time      0.46 sec
    CPU time for building eta_kpt     14.57 sec, wall time      0.56 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     14.00 sec, wall time      0.91 sec
    CPU time for coul_kpt[ 2 / 2]     11.31 sec, wall time      0.94 sec
    CPU time for building coul_kpt     25.46 sec, wall time      1.85 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-1-2-gth-dzvp-fftisdf-150-15/49977517/49vhia17


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-1-2-gth-dzvp-fftisdf-150-15/49977517/tmpkfocfn69
max_memory 327680 MB (current use 333 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f7085462020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.79 sec, wall time      0.12 sec
E1 = (3.114871500271772+2.3918696649254148e-18j)  E_coul = (-5.359724342077848+1.9005727897159087e-17j)
init E= -15.0319819874303
    CPU time for initialize scf      7.67 sec, wall time      0.25 sec
HOMO = 0.634512534078  LUMO = 0.835953685554
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469808  0.58526514  0.63451122  0.63451253] [0.83595369 0.90520577 0.90520779 1.12043649 1.80070866 1.80070912
 1.86315789 2.07363209 2.09379693 2.09381198 2.63058396 2.63482871
 2.63483602 3.54991446 3.54996375 3.55204351 3.6511381  3.65113891
 4.20890818 4.72602389 4.72734012 4.72738683]
   1 ( 0.000  0.000  0.500)   [-0.84757641 -0.56898919  0.50108802  0.50108854] [0.96418834 1.03463819 1.0346421  1.35062651 1.61891694 1.75432343
 1.81735222 1.81736356 2.11624739 2.11625426 2.94274217 3.05300683
 3.05301684 3.09652998 3.09654419 3.29651691 3.64893616 3.6489614
 3.75825307 3.75827629 5.12903373 9.60196939]
    CPU time for vj and vk      3.84 sec, wall time      0.12 sec
E1 = (4.4117416220181065+1.2590770676758071e-17j)  E_coul = (-2.1925527419945996+1.5801599908616278e-18j)
cycle= 1 E= -10.5679402656007  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      4.24 sec, wall time      0.14 sec
HOMO = 0.36552144295  LUMO = 1.01778830645
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65436828  0.29043719  0.29043958  0.36552144] [1.01778831 1.03923488 1.03923933 1.3668817  1.82549067 1.82549239
 1.88181667 2.12846396 2.13625601 2.13627201 2.72590138 2.72591699
 2.73257039 3.56547203 3.57179645 3.57191372 3.71006204 3.71006374
 4.22688692 4.77814028 4.78315455 4.78324478]
   1 ( 0.000  0.000  0.500)   [-0.3709408  -0.25528256  0.17488284  0.17488919] [1.15338571 1.16988606 1.16989931 1.40381828 1.71097427 1.82286972
 1.85610521 1.85615468 2.13417003 2.13420279 3.01196809 3.13037102
 3.13041645 3.15967518 3.15970847 3.32338466 3.67517455 3.67522472
 3.81042751 3.81047344 5.2002178  9.89321508]
    CPU time for vj and vk      3.85 sec, wall time      0.12 sec
E1 = (4.435290674017067+1.808616891181351e-17j)  E_coul = (-2.229313851331698+2.067601039936383e-18j)
cycle= 2 E= -10.5811523229389  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      4.31 sec, wall time      0.14 sec
HOMO = 0.351269236666  LUMO = 1.01859657938
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660085  0.28428202  0.28428746  0.35126924] [1.01859658 1.03824762 1.03824977 1.36487804 1.82397906 1.82397988
 1.8825615  2.12798432 2.13565787 2.13567538 2.72005551 2.72006898
 2.72507171 3.56453692 3.5705335  3.57065499 3.70813062 3.70813299
 4.22252156 4.77626344 4.78082068 4.7809092 ]
   1 ( 0.000  0.000  0.500)   [-0.37618612 -0.26020025  0.17065679  0.17066197] [1.15177444 1.16897477 1.16898518 1.40672411 1.70615625 1.81701494
 1.85208143 1.8521285  2.13197359 2.13200549 3.00786463 3.12924755
 3.12929168 3.15470294 3.15473271 3.3234082  3.67352078 3.67357264
 3.80800587 3.80805421 5.19444157 9.86916897]
    CPU time for vj and vk      3.89 sec, wall time      0.12 sec
E1 = (4.437501540297091+1.854056790601833e-17j)  E_coul = (-2.2321892939445274+2.1759830586099856e-18j)
cycle= 3 E= -10.5818168992717  delta_E= -0.000665  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      4.35 sec, wall time      0.14 sec
HOMO = 0.351514158059  LUMO = 1.01949490271
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65591999  0.28499047  0.28499544  0.35151416] [1.0194949  1.0392853  1.03928766 1.36584394 1.82435095 1.82435187
 1.88248493 2.12828981 2.13593755 2.1359552  2.72084587 2.7208591
 2.7258951  3.56485881 3.57071487 3.57083633 3.70879101 3.70879326
 4.22248454 4.77684339 4.78135911 4.78144748]
   1 ( 0.000  0.000  0.500)   [-0.37571293 -0.25962877  0.17157455  0.1715801 ] [1.15225952 1.16959882 1.16960947 1.40684301 1.70674515 1.81794417
 1.85260501 1.85265237 2.13233371 2.13236552 3.00861586 3.12958483
 3.12962866 3.15566144 3.15569138 3.32351632 3.67371047 3.67376194
 3.80851973 3.80856807 5.19490954 9.87129053]
    CPU time for vj and vk      3.91 sec, wall time      0.12 sec
E1 = (4.437351236177655+1.843038562218252e-17j)  E_coul = (-2.232047696044816+2.184440649346373e-18j)
cycle= 4 E= -10.5818256054914  delta_E= -8.71e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      4.42 sec, wall time      0.14 sec
HOMO = 0.351482397675  LUMO = 1.0194956335
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593737  0.28496352  0.28496852  0.3514824 ] [1.01949563 1.03929377 1.03929612 1.36579562 1.82435272 1.82435363
 1.88249741 2.12830745 2.13594239 2.13596004 2.72083336 2.72084661
 2.72587775 3.56486142 3.57071152 3.57083296 3.70879146 3.70879371
 4.22246793 4.7768443  4.78135694 4.78144526]
   1 ( 0.000  0.000  0.500)   [-0.37571733 -0.2596506   0.17156085  0.17156636] [1.15222869 1.16960498 1.16961563 1.40684668 1.70673502 1.81791737
 1.85259154 1.8526389  2.13232767 2.13235946 3.008626   3.12958271
 3.12962651 3.155658   3.15568793 3.32352255 3.67370544 3.6737569
 3.80852142 3.80856975 5.19489271 9.87120897]
    CPU time for vj and vk      3.85 sec, wall time      0.12 sec
E1 = (4.4373429960047455+1.8407890867048377e-17j)  E_coul = (-2.23203953335714+2.184507874484907e-18j)
cycle= 5 E= -10.5818256829766  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0177
    CPU time for cycle= 5      4.33 sec, wall time      0.14 sec
HOMO = 0.351488328917  LUMO = 1.01949974803
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593561  0.28496577  0.28497077  0.35148833] [1.01949975 1.03929678 1.03929914 1.36579379 1.82435372 1.82435464
 1.88249731 2.12830594 2.13594282 2.13596047 2.72083604 2.7208493
 2.72588125 3.5648623  3.57071216 3.5708336  3.70879312 3.70879537
 4.22246839 4.77684574 4.7813584  4.78144672]
   1 ( 0.000  0.000  0.500)   [-0.37571582 -0.25964275  0.17156386  0.17156938] [1.15222655 1.16960544 1.16961608 1.40684478 1.70673581 1.81791983
 1.85259353 1.85264089 2.13233185 2.13236364 3.00863099 3.12958244
 3.12962625 3.1556596  3.15568954 3.32352139 3.67370515 3.67375662
 3.80852268 3.808571   5.19489363 9.871216  ]
    CPU time for vj and vk      3.87 sec, wall time      0.12 sec
E1 = (4.437340008503185+1.8406402566587706e-17j)  E_coul = (-2.2320365465341494+2.1845217475246504e-18j)
Extra cycle  E= -10.5818256836552  delta_E= -6.79e-10  |g|= 1.73e-05  |ddm|= 0.0015
    CPU time for scf_cycle     33.68 sec, wall time      1.08 sec
    CPU time for SCF     36.37 sec, wall time      1.17 sec
converged SCF energy = -10.5818256836552
**** SCF Summaries ****
Total Energy =                         -10.581825683655204
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437340008503185
Two-electron Energy =                   -2.232036546534149
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00908
pop of  0 C 2py           1.00906
pop of  0 C 2pz           1.00906
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00170
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00997
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93328
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00906
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00997
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =     -0.00001
charge of    1C =      0.00001
    CPU time for vj and vk      0.48 sec, wall time      0.02 sec
End time = Tue Jun  3 12:26:50 PM PDT 2025
