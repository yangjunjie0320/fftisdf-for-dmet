SLURMD_NODENAME = hpc-52-41
Start time = Tue Jun  3 12:26:08 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-1-2-gth-dzvp-fftisdf-100-10/49977510/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond-krhf-1-1-2-gth-dzvp-fftisdf-100-10/49977510/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond/krhf/1-1-2/gth-dzvp/fftisdf/100/10/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
density_fitting_method: fftisdf-100-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Using FFTISDF, method = fftisdf-100-10
ke_cutoff = 100.0, mesh = [23 23 23]
Using ke_cutoff = 100.0, c0 = 10.0
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 10.0
wrap_around = False

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Cholesky rank = 1194, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 12167, selected grid size = 260
truncated values = 3.91e+01, estimated error = 4.70e-01
Number of interpolating points is 260.
    CPU time for building inpv_kpt     14.72 sec, wall time      7.75 sec

Out-core version is used for eta_kpt.
disk space required: 1.01e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   1.01e-01 GB
memory needed for each k-point: 5.06e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]      5.23 sec, wall time      0.16 sec
    CPU time for building eta_kpt      7.04 sec, wall time      0.22 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      7.09 sec, wall time      0.22 sec
    CPU time for coul_kpt[ 2 / 2]      7.13 sec, wall time      0.22 sec
    CPU time for building coul_kpt     14.31 sec, wall time      0.45 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond-krhf-1-1-2-gth-dzvp-fftisdf-100-10/49977510/xz9p674t


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond-krhf-1-1-2-gth-dzvp-fftisdf-100-10/49977510/tmp8irgcep0
max_memory 327680 MB (current use 293 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46609264  0.46609264 -0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fc7ee5ca020>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.26 sec, wall time      0.07 sec
E1 = (3.1148714996828017+1.5945797766170843e-18j)  E_coul = (-5.359646750550883-4.282337547560776e-18j)
init E= -15.0319043964923
    CPU time for initialize scf      5.01 sec, wall time      0.17 sec
HOMO = 0.634541321283  LUMO = 0.835925896755
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95466783  0.58532854  0.6345134   0.63454132] [0.8359259  0.90521442 0.90521899 1.12031784 1.8006988  1.80071059
 1.86333387 2.07404291 2.09369046 2.09383724 2.63058782 2.63478655
 2.63490992 3.55006697 3.55018915 3.55257221 3.65108232 3.65114318
 4.20848506 4.72613141 4.72705584 4.7271731 ]
   1 ( 0.000  0.000  0.500)   [-0.84749648 -0.56899525  0.5010942   0.5011002 ] [0.96422458 1.03462448 1.03465836 1.35059124 1.61886861 1.75441518
 1.81729434 1.81738362 2.1162259  2.1162759  2.94268415 3.05289536
 3.05305835 3.09644724 3.09655819 3.29661693 3.64878543 3.64887769
 3.7584173  3.75849072 5.12908957 9.60179066]
    CPU time for vj and vk      2.19 sec, wall time      0.07 sec
E1 = (4.411689790881991+2.185203851352206e-17j)  E_coul = (-2.192410322033485-2.3475383403606265e-17j)
cycle= 1 E= -10.5678496767757  delta_E= 4.46  |g|= 0.33  |ddm|= 8.51
    CPU time for cycle= 1      2.63 sec, wall time      0.09 sec
HOMO = 0.365578769662  LUMO = 1.01778578611
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65432121  0.29042342  0.29044846  0.36557877] [1.01778579 1.03923455 1.0392665  1.3668309  1.82548586 1.82552844
 1.88200902 2.12855885 2.13613772 2.1362899  2.72575513 2.72606866
 2.73257397 3.56548372 3.57191404 3.57227326 3.70998826 3.71005699
 4.22683468 4.77783255 4.78255185 4.78309617]
   1 ( 0.000  0.000  0.500)   [-0.37083556 -0.25526563  0.17485924  0.17491233] [1.15345457 1.16986675 1.16989919 1.40370407 1.71094061 1.82298813
 1.85605503 1.85623425 2.13413193 2.13423199 3.01183951 3.13030476
 3.13049791 3.15952479 3.15972711 3.32341279 3.67500647 3.67522903
 3.8104966  3.81082082 5.20011817 9.89315923]
    CPU time for vj and vk      2.34 sec, wall time      0.08 sec
E1 = (4.435256627794345+2.7628055745487836e-17j)  E_coul = (-2.229202602628246-2.3604522697566516e-17j)
cycle= 2 E= -10.5810751204581  delta_E= -0.0132  |g|= 0.0652  |ddm|= 5.68
    CPU time for cycle= 2      2.89 sec, wall time      0.09 sec
HOMO = 0.351317798885  LUMO = 1.01858985583
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65655097  0.2842557   0.28429374  0.3513178 ] [1.01858986 1.03824417 1.03827245 1.36482961 1.8239666  1.82400558
 1.88277055 2.12809879 2.13555465 2.13569253 2.71991259 2.72019347
 2.72507535 3.56457017 3.57065144 3.57097669 3.7080523  3.70813247
 4.22249882 4.77596778 4.78022477 4.78081149]
   1 ( 0.000  0.000  0.500)   [-0.37608005 -0.2601911   0.17062285  0.17069034] [1.15185024 1.16894582 1.16899673 1.40662173 1.70612773 1.8171471
 1.85205227 1.85219842 2.13194911 2.13203925 3.00774059 3.12916184
 3.12933679 3.1545762  3.15474503 3.32343723 3.67337226 3.67359397
 3.80811856 3.80837055 5.19431519 9.86910428]
    CPU time for vj and vk      2.25 sec, wall time      0.07 sec
E1 = (4.437472617255654+2.8195727305513376e-17j)  E_coul = (-2.2320832772448767-2.3673193375797826e-17j)
cycle= 3 E= -10.5817398056135  delta_E= -0.000665  |g|= 0.00688  |ddm|= 0.995
    CPU time for cycle= 3      2.78 sec, wall time      0.09 sec
HOMO = 0.351564014289  LUMO = 1.01948727493
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65587067  0.28496267  0.28499942  0.35156401] [1.01948727 1.03928129 1.03931003 1.36579522 1.82433871 1.82437755
 1.8826933  2.12840006 2.1358355  2.13597189 2.7207006  2.72098446
 2.72589856 3.56488786 3.57083175 3.57115793 3.70871172 3.70879081
 4.222463   4.77654733 4.78076148 4.7813496 ]
   1 ( 0.000  0.000  0.500)   [-0.37560852 -0.25961841  0.17154038  0.17160602] [1.15233297 1.16956896 1.16961946 1.4067449  1.70671516 1.8180747
 1.85257495 1.85272194 2.13230912 2.13240033 3.00849092 3.12950133
 3.12967338 3.15553251 3.15570197 3.32354387 3.67356055 3.67378327
 3.8086309  3.80888555 5.19478411 9.87122179]
    CPU time for vj and vk      2.27 sec, wall time      0.07 sec
E1 = (4.437322371466648+2.8057877360075286e-17j)  E_coul = (-2.2319417372990613-2.3685317900961045e-17j)
cycle= 4 E= -10.5817485114567  delta_E= -8.71e-06  |g|= 0.000629  |ddm|= 0.112
    CPU time for cycle= 4      2.83 sec, wall time      0.09 sec
HOMO = 0.351532411304  LUMO = 1.01948814467
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65588773  0.28493611  0.28497302  0.35153241] [1.01948814 1.03929002 1.03931864 1.3657477  1.82434061 1.82437939
 1.88270563 2.12841831 2.13584038 2.13597679 2.72068865 2.72097218
 2.72588168 3.56489099 3.57082855 3.57115449 3.70871236 3.7087915
 4.22244679 4.77654875 4.78075965 4.78134791]
   1 ( 0.000  0.000  0.500)   [-0.37561261 -0.25964028  0.17152689  0.17159278] [1.15230254 1.16957542 1.16962587 1.40674901 1.70670558 1.81804839
 1.85256191 1.8527088  2.132303   2.13239408 3.00850095 3.12949945
 3.12967142 3.15552953 3.15569886 3.32355036 3.67355584 3.67377858
 3.8086329  3.80888733 5.19476734 9.87114161]
    CPU time for vj and vk      2.30 sec, wall time      0.07 sec
E1 = (4.437314068720045+2.8027490447767173e-17j)  E_coul = (-2.231933512966631-2.3686478616419362e-17j)
cycle= 5 E= -10.5817485898708  delta_E= -7.84e-08  |g|= 8.17e-05  |ddm|= 0.0175
    CPU time for cycle= 5      2.86 sec, wall time      0.09 sec
HOMO = 0.351538194259  LUMO = 1.01949218336
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6558861   0.28493816  0.2849751   0.35153819] [1.01949218 1.03929299 1.0393216  1.36574561 1.82434159 1.82438035
 1.8827056  2.12841684 2.13584081 2.13597722 2.72069122 2.72097473
 2.72588503 3.56489185 3.57082918 3.57115512 3.70871397 3.70879311
 4.22244719 4.77655014 4.78076103 4.78134931]
   1 ( 0.000  0.000  0.500)   [-0.37561118 -0.25963255  0.17152975  0.17159567] [1.15230024 1.16957583 1.16962628 1.40674713 1.70670628 1.81805071
 1.8525638  1.85271069 2.13230715 2.13239825 3.00850591 3.12949915
 3.12967113 3.15553105 3.15570032 3.32354921 3.67355553 3.67377825
 3.8086341  3.80888855 5.19476815 9.87114811]
    CPU time for vj and vk      2.27 sec, wall time      0.07 sec
E1 = (4.4373110923007495+2.8026249128724405e-17j)  E_coul = (-2.231930537767771-2.368696551995484e-17j)
Extra cycle  E= -10.5817485910913  delta_E= -1.22e-09  |g|= 3.23e-05  |ddm|= 0.00153
    CPU time for scf_cycle     21.77 sec, wall time      0.71 sec
    CPU time for SCF     24.18 sec, wall time      0.79 sec
converged SCF energy = -10.5817485910913
**** SCF Summaries ****
Total Energy =                         -10.581748591091262
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437311092300749
Two-electron Energy =                   -2.231930537767771
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93330
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00908
pop of  0 C 2py           1.00917
pop of  0 C 2pz           1.00898
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00170
pop of  0 C 3pz           0.00170
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00997
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93327
pop of  1 C 3s            0.00445
pop of  1 C 2px           1.00903
pop of  1 C 2py           1.00905
pop of  1 C 2pz           1.00910
pop of  1 C 3px           0.00169
pop of  1 C 3py           0.00169
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00998
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00997
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =     -0.00004
charge of    1C =      0.00004
    CPU time for vj and vk      0.46 sec, wall time      0.02 sec
End time = Tue Jun  3 12:26:19 PM PDT 2025
