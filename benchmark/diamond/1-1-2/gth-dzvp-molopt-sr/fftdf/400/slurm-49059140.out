SLURMD_NODENAME = hpc-53-20
Start time = Wed Apr 30 12:42:38 PM PDT 2025
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49059140/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49059140/

Running /resnick/groups/changroup/members/junjiey/fftisdf-with-dmet/benchmark/diamond/1-1-2/gth-dzvp-molopt-sr/fftdf/400/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp-molopt-sr
pseudo: gth-pbe
ke_cutoff: 400.0
density_fitting_method: fftdf
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.37995)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.29908
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.56697
pop of  0 C 2py           0.56697
pop of  0 C 2pz           0.56697
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.29908
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.56697
pop of  1 C 2py           0.56697
pop of  1 C 2pz           0.56697
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000

WARN: ke_cutoff/mesh (400 / [45 45 45]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 1.6e-05 Eh.
Recommended ke_cutoff/mesh are 569.817 / [53 53 53].



******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49059140/tmpa0tlvtuz
max_memory 327680 MB (current use 193 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = None
Smearing method = fermi
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x7f22257a6350>
Overwritten attributes  energy_tot get_grad get_occ  of <class 'pyscf.pbc.scf.khf.KRHF'>
Set gradient conv threshold to 0.001
    CPU time for vj and vk     56.09 sec, wall time      4.25 sec
E1 = (3.744095700407411+4.192523397800516e-32j)  E_coul = (-0.7790985272198119+1.3705717649465445e-18j)
init E= -9.82213197243664
    CPU time for initialize scf     70.94 sec, wall time      4.88 sec
HOMO = 0.782263773583  LUMO = 0.943831382125
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.21298321  0.73347721  0.78226377  0.78226377] [0.94383138 1.01050973 1.01050973 1.26663441 1.94106857 1.94106857
 2.46796223 2.47998865 2.47998865 2.75217121 2.7540404  2.7540404
 3.87032565 3.87032565 4.05893836 4.05893836 4.06295803 4.96742421
 4.96742421 4.96774975 7.0104114  9.35624756]
   1 ( 0.000  0.000 -0.500)   [-0.08575099  0.09975645  0.66803947  0.66803947] [1.0814416  1.12789698 1.12789698 1.51372353 1.76560545 2.02596346
 2.02596346 2.04795095 2.28212208 2.28212208 3.00353559 3.15136148
 3.21300977 3.21300977 3.26912403 3.26912403 3.92318066 3.92318066
 4.81068608 4.81068608 9.19763289 9.36250802]
    Fermi level 0.8665207468528525  Sum mo_occ_kpts = 16.00000000000005  should equal nelec = 16
    sigma = 0.01  Optimized mu = 0.8665207468528525  entropy = 0.0080029556885
    CPU time for vj and vk     48.17 sec, wall time      2.17 sec
E1 = (4.4125161120480145+4.94942949509683e-18j)  E_coul = (-0.3319133221131929+4.650401228631435e-18j)
    Total E(T) = -8.70652635568942  Free energy = -8.7066063852463  E0 = -8.70656637046786
cycle= 1 E= -8.70652635568942  delta_E= 1.12  |g|= 0.165  |ddm|= 4.89
    CPU time for cycle= 1     48.53 sec, wall time      2.18 sec
HOMO = 0.832266626051  LUMO = 1.01495342135
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18739854  0.75503274  0.75503274  0.83226663] [1.01495342 1.03769223 1.03769223 1.40811703 1.94821647 1.94821647
 2.50331898 2.51269914 2.51269914 2.77889075 2.77889075 2.78535321
 3.90043212 3.90043212 4.08490321 4.08490321 4.08563554 4.99745709
 5.00422538 5.00422538 7.0579924  9.4349137 ]
   1 ( 0.000  0.000 -0.500)   [0.09043992 0.2157558  0.63984264 0.63984264] [1.15749666 1.17899758 1.17899758 1.549478   1.79629469 2.03336798
 2.03336798 2.08112663 2.28368058 2.28368058 3.01754269 3.18589712
 3.24817714 3.24817714 3.28535421 3.28535421 3.94753772 3.94753772
 4.84491856 4.84491856 9.27405993 9.44137519]
    Fermi level 0.9226784507757366  Sum mo_occ_kpts = 16.0  should equal nelec = 16
    sigma = 0.01  Optimized mu = 0.9226784507757366  entropy = 0.00244910133754
    CPU time for vj and vk     47.32 sec, wall time      2.17 sec
E1 = (4.417768162215711+4.569425041277799e-18j)  E_coul = (-0.34507410753404055+1.1376969293765618e-17j)
    Total E(T) = -8.71443509094257  Free energy = -8.71445958195594  E0 = -8.71444733644926
cycle= 2 E= -8.71443509094257  delta_E= -0.00791  |g|= 0.0131  |ddm|= 0.32
    CPU time for cycle= 2     48.18 sec, wall time      2.21 sec
HOMO = 0.822706618825  LUMO = 1.0189494641
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18614102  0.75320087  0.75320087  0.82270662] [1.01894946 1.04052601 1.04052601 1.41193601 1.9490402  1.9490402
 2.50538221 2.51280878 2.51280878 2.77785254 2.77785254 2.78223601
 3.90055268 3.90055268 4.0833157  4.08403512 4.08403512 4.99761852
 5.00376996 5.00376996 7.05483059 9.43021915]
   1 ( 0.000  0.000 -0.500)   [0.09200177 0.21216073 0.64016036 0.64016036] [1.15870584 1.18115676 1.18115676 1.55169818 1.79495176 2.03252458
 2.03252458 2.07933326 2.28135006 2.28135006 3.01861173 3.18410465
 3.24817539 3.24817539 3.2861901  3.2861901  3.94741448 3.94741448
 4.84410923 4.84410923 9.26940278 9.43676776]
    Fermi level 0.9197975986299022  Sum mo_occ_kpts = 16.0  should equal nelec = 16
    sigma = 0.01  Optimized mu = 0.9197975986299022  entropy = 0.00134111032224
    CPU time for vj and vk     47.31 sec, wall time      2.20 sec
E1 = (4.4174914519133734+4.562463868030415e-18j)  E_coul = (-0.34484297429609645+5.949353022240995e-18j)
    Total E(T) = -8.71448066800696  Free energy = -8.71449407911019  E0 = -8.71448737355857
cycle= 3 E= -8.71448066800696  delta_E= -4.56e-05  |g|= 0.00228  |ddm|= 0.0246
    CPU time for cycle= 3     48.20 sec, wall time      2.24 sec
HOMO = 0.823052815978  LUMO = 1.01908750526
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18612084  0.75311439  0.75311439  0.82305282] [1.01908751 1.04065036 1.04065036 1.41192173 1.94901272 1.94901272
 2.50520095 2.51301675 2.51301675 2.77780704 2.77780704 2.78250321
 3.90066862 3.90066862 4.08357408 4.083963   4.083963   4.99774374
 5.00384727 5.00384727 7.0548747  9.43027572]
   1 ( 0.000  0.000 -0.500)   [0.09175249 0.21256231 0.64011227 0.64011227] [1.15869663 1.18108194 1.18108194 1.55206389 1.79499473 2.0326795
 2.0326795  2.07959979 2.2816381  2.2816381  3.01829607 3.18444873
 3.24821601 3.24821601 3.28601463 3.28601463 3.94743248 3.94743248
 4.84426204 4.84426204 9.26945783 9.43681007]
    Fermi level 0.920038025768077  Sum mo_occ_kpts = 16.0  should equal nelec = 16
    sigma = 0.01  Optimized mu = 0.920038025768077  entropy = 0.00135396234172
    CPU time for vj and vk     47.31 sec, wall time      2.19 sec
E1 = (4.417661492587327+4.563167015455069e-18j)  E_coul = (-0.3450139338223573+9.708466150778267e-18j)
    Total E(T) = -8.71448158685927  Free energy = -8.71449512648269  E0 = -8.71448835667098
cycle= 4 E= -8.71448158685927  delta_E= -9.19e-07  |g|= 0.000172  |ddm|= 0.0032
    CPU time for cycle= 4     48.16 sec, wall time      2.22 sec
HOMO = 0.823040745188  LUMO = 1.01907142719
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18613313  0.75310863  0.75310863  0.82304075] [1.01907143 1.04064289 1.04064289 1.41192988 1.94900677 1.94900677
 2.50520706 2.5129997  2.5129997  2.7777938  2.7777938  2.78247429
 3.90065584 3.90065584 4.08354241 4.0839539  4.0839539  4.99772541
 5.00383285 5.00383285 7.05484332 9.43023046]
   1 ( 0.000  0.000 -0.500)   [0.09176772 0.21251891 0.6401049  0.6401049 ] [1.15870561 1.18109357 1.18109357 1.55205124 1.79498295 2.03265681
 2.03265681 2.07956089 2.28159835 2.28159835 3.01831468 3.1844106
 3.24820954 3.24820954 3.28602246 3.28602246 3.94742157 3.94742157
 4.84424076 4.84424076 9.26941317 9.43676617]
    Fermi level 0.9200247660214576  Sum mo_occ_kpts = 16.0  should equal nelec = 16
    sigma = 0.01  Optimized mu = 0.9200247660214576  entropy = 0.00135409319837
    CPU time for vj and vk     48.14 sec, wall time      2.42 sec
E1 = (4.417638938516856+4.56576273697003e-18j)  E_coul = (-0.3449913836203041+8.626249621774109e-18j)
    Total E(T) = -8.71448159072769  Free energy = -8.71449513165967  E0 = -8.71448836119368
Extra cycle  E= -8.71448159072769  delta_E= -3.87e-09  |g|= 3.75e-05  |ddm|= 0.000284
    CPU time for scf_cycle    312.72 sec, wall time     16.19 sec
    CPU time for SCF    313.99 sec, wall time     16.23 sec
converged SCF energy = -8.71448159072769
**** SCF Summaries ****
Total Energy =                          -8.714481590727686
One-electron Energy =                    4.417638938516856
Two-electron Energy =                   -0.344991383620304
(Electronic) Entropy                     0.001354093198368
(Electronic) Zero Point Energy          -8.714488361193679
Free Energy =                           -8.714495131659669
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.96874
pop of  0 C 3s            0.00007
pop of  0 C 2px           0.99933
pop of  0 C 2py           0.99933
pop of  0 C 2pz           0.99933
pop of  0 C 3px           0.00165
pop of  0 C 3py           0.00165
pop of  0 C 3pz           0.00165
pop of  0 C 3dxy          0.00938
pop of  0 C 3dyz          0.00938
pop of  0 C 3dz^2         0.00005
pop of  0 C 3dxz          0.00938
pop of  0 C 3dx2-y2       0.00005
pop of  1 C 2s            0.96874
pop of  1 C 3s            0.00007
pop of  1 C 2px           0.99933
pop of  1 C 2py           0.99933
pop of  1 C 2pz           0.99933
pop of  1 C 3px           0.00165
pop of  1 C 3py           0.00165
pop of  1 C 3pz           0.00165
pop of  1 C 3dxy          0.00938
pop of  1 C 3dyz          0.00938
pop of  1 C 3dz^2         0.00005
pop of  1 C 3dxz          0.00938
pop of  1 C 3dx2-y2       0.00005
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =     -0.00000
    CPU time for vj and vk     31.27 sec, wall time      1.63 sec

IAO construction with fractional occupation.
------------------------------------------------------------------------------------------------------------------------
IAO info   ncore                  0        nval                   8        nvirt                  18       nao  26   
------------------------------------------------------------------------------------------------------------------------
 element   core shell                      valence shell                   virtual shell                           
       C                                   2s 2p                           3s 3p 3d                                
------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------
IAO valence
0 C 2s    
0 C 2px   
0 C 2py   
0 C 2pz   
1 C 2s    
1 C 2px   
1 C 2py   
1 C 2pz   
    CPU time for vj and vk     58.21 sec, wall time      4.34 sec

@---------------------------------------------------------------------------------------------------@
|****************************************** DMET SETTINGS ******************************************|
@---------------------------------------------------------------------------------------------------@

nkpts          =               2
nao            =              26
nlo            =              26
nelec per cell =               8
smearing beta  =          1000.0
frac occ orbs  =            None
h0             =      -12.787129
tol_energy     =           1e-06
tol_rdm1       =          0.0001
max_cycle      =              50
number of impurity problems =     1

@-------------------------------------------------------------------------------@
|-------------------------------- Impurity     0 -------------------------------|
@-------------------------------------------------------------------------------@

DMET lattice information:
---------------------------------------------------------------------------------
DMET solver information:
solver = <libdmet.solver.cc_solver.CCSolver object at 0x7f22257a75b0>
---------------------------------------------------------------------------------
DMET vcor information:
<class 'libdmet.mean_field.vcor.RVcor'>
norb = 26 
idx_range = 0-25 length = 26
res = True bogo = False bogo_res = False
[[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]
  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
   0. 0. 0.]]]
*****************************************************************************************************
    CPU time for initialize dmet kernel      0.23 sec, wall time      0.01 sec

@---------------------------------------------------------------------------------------------------@
|***************************************** ITERATION     0 *****************************************|
@---------------------------------------------------------------------------------------------------@


DMET: lattice mean-field problem (F + u):
nkpts  =          2
nlo    =         26
nelec  =          8
beta   =     1000.0
nfrac  =       None

e_mf =      -8.7144941
homo =       0.8230482
lumo =       1.0190755
gap  =      0.19602732

 ** Mulliken pop  **
pop of  0 C 2s            0.91780
pop of  0 C 3s            0.00000
pop of  0 C 2px           1.02740
pop of  0 C 2py           1.02740
pop of  0 C 2pz           1.02740
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            0.91780
pop of  1 C 3s            0.00000
pop of  1 C 2px           1.02740
pop of  1 C 2py           1.02740
pop of  1 C 2pz           1.02740
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
In total                  8.00000
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000

@-------------------------------------------------------------------------------@
|---------------------- Iteration     0     Impurity     0 ---------------------|
@-------------------------------------------------------------------------------@


DMET: construct embedding Hamiltonian:
