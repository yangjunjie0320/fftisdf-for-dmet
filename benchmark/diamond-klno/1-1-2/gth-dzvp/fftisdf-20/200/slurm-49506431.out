SLURMD_NODENAME = hpc-20-15
Start time = Wed May 14 11:30:21 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49506431/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49506431/

Running /resnick/groups/changroup/members/junjiey/fftisdf-with-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-20/200/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 200.0
density_fitting_method: fftisdf-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 1161, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 3375, selected grid size = 520
truncated values = 3.89e+01, estimated error = 1.39e-02
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>
<class 'fft.isdf.InterpolativeSeparableDensityFitting'> does not have attributes  blksize

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 520.
    CPU time for building inpv_kpt      0.19 sec, wall time      0.01 sec

Out-core version is used for eta_kpt.
disk space required: 5.98e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   5.98e-01 GB
memory needed for each k-point: 2.99e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     18.20 sec, wall time      1.01 sec
    CPU time for building eta_kpt     23.72 sec, wall time      1.19 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      9.16 sec, wall time      1.74 sec
    CPU time for coul_kpt[ 2 / 2]      3.37 sec, wall time      1.72 sec
    CPU time for building coul_kpt     12.91 sec, wall time      3.47 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49506431/3hsrg3mb


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49506431/tmp5umjnqy4
max_memory 327680 MB (current use 327 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fa31fbff880>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      6.40 sec, wall time      0.20 sec
E1 = (3.114871500271779+2.3918696649254718e-18j)  E_coul = (-1.2378595231901954+1.9991930578199918e-17j)
init E= -10.9101171685427
    CPU time for initialize scf     12.84 sec, wall time      0.41 sec
HOMO = 0.710116986435  LUMO = 0.888054697534
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.19817072  0.66063637  0.71011684  0.71011699] [0.8880547  0.95745801 0.95745817 1.17950314 1.80070996 1.80071005
 1.87862846 2.07454691 2.09439179 2.09439383 2.63195606 2.63600486
 2.63600897 3.55006967 3.55008041 3.55213481 3.65113852 3.6511386
 4.21079869 4.72609109 4.72738236 4.72741385]
   1 ( 0.000  0.000 -0.500)   [-0.23641707 -0.02541416  0.59802947  0.59802958] [1.0267337  1.07277771 1.0727778  1.37028721 1.62492409 1.76439279
 1.82175306 1.82175578 2.11631426 2.11631434 2.94328304 3.05310341
 3.0531051  3.09664193 3.09664366 3.29738191 3.64911183 3.64911645
 3.75831574 3.75831802 5.12972278 9.60255153]
    CPU time for vj and vk      6.97 sec, wall time      0.22 sec
E1 = (4.379882544508412+2.6878549874196544e-17j)  E_coul = (-0.28035738500957913+3.119995874280334e-18j)
cycle= 1 E= -8.68760398612541  delta_E= 2.22  |g|= 0.369  |ddm|= 8.88
    CPU time for cycle= 1      7.41 sec, wall time      0.23 sec
HOMO = 0.838355159497  LUMO = 1.02138528439
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18203046  0.76530038  0.76530066  0.83835516] [1.02138528 1.0439877  1.04398826 1.37214063 1.82744349 1.82744352
 1.88124863 2.1311759  2.13874898 2.13875699 2.73151574 2.73152276
 2.73812003 3.56743568 3.57359234 3.57361927 3.71418941 3.7141896
 4.22631771 4.78172385 4.78670016 4.78674521]
   1 ( 0.000  0.000 -0.500)   [0.09841286 0.21861599 0.64947738 0.64947756] [1.15660013 1.1734632  1.17346423 1.40428765 1.71585867 1.82840088
 1.85970776 1.85971387 2.13682616 2.13682765 3.01698974 3.13256812
 3.13257761 3.16610235 3.16610713 3.32454764 3.67687038 3.67688575
 3.81405304 3.81406163 5.20279263 9.90612422]
    CPU time for vj and vk      6.59 sec, wall time      0.21 sec
E1 = (4.447666067368819+2.821680924007623e-17j)  E_coul = (-0.3631726773327584+3.3316992526286545e-18j)
cycle= 2 E= -8.70263575558818  delta_E= -0.015  |g|= 0.0439  |ddm|= 7.57
    CPU time for cycle= 2      7.06 sec, wall time      0.22 sec
HOMO = 0.821291906727  LUMO = 1.01858035153
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18678941  0.75421943  0.7542197   0.82129191] [1.01858035 1.03840254 1.03840302 1.36481749 1.82404719 1.82404728
 1.88254878 2.12803443 2.13563768 2.13564465 2.72014744 2.72015344
 2.72517233 3.56458919 3.57068636 3.57070931 3.70828485 3.70828498
 4.22235235 4.77638713 4.78094651 4.78098343]
   1 ( 0.000  0.000 -0.500)   [0.09349295 0.20972962 0.64063589 0.6406362 ] [1.15185327 1.16913928 1.16914001 1.40690691 1.70629114 1.81708708
 1.852042   1.85204774 2.13208358 2.13208523 3.00789695 3.12935747
 3.12936464 3.1548232  3.1548274  3.32338791 3.67357134 3.67358051
 3.8081574  3.80816515 5.19433882 9.86897597]
    CPU time for vj and vk      6.75 sec, wall time      0.21 sec
E1 = (4.436315567219363+2.8242377318488653e-17j)  E_coul = (-0.3520232885961892+3.388083000370738e-18j)
cycle= 3 E= -8.70283686700107  delta_E= -0.000201  |g|= 0.00393  |ddm|=  1.4
    CPU time for cycle= 3      7.22 sec, wall time      0.23 sec
HOMO = 0.821260503435  LUMO = 1.01952904353
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18616896  0.75474411  0.75474435  0.8212605 ] [1.01952904 1.03932356 1.03932404 1.36580413 1.82436627 1.82436635
 1.88250446 2.12832673 2.13595642 2.13596345 2.72087259 2.72087866
 2.72591765 3.56484637 3.570819   3.57084223 3.70880709 3.70880723
 4.22247666 4.77689503 4.78139684 4.78143448]
   1 ( 0.000  0.000 -0.500)   [0.09404067 0.21014131 0.64133941 0.6413397 ] [1.1522392  1.16961429 1.16961505 1.40682731 1.70675898 1.81799602
 1.85263252 1.85263827 2.13239124 2.13239288 3.008663   3.12961622
 3.12962361 3.15568826 3.15569251 3.32350807 3.67374915 3.67375883
 3.80859933 3.80860715 5.19493244 9.87132993]
    CPU time for vj and vk      6.75 sec, wall time      0.21 sec
E1 = (4.437368648250309+2.829239065419092e-17j)  E_coul = (-0.3530783676926547+3.3809570205226904e-18j)
cycle= 4 E= -8.70283886506659  delta_E= -2e-06  |g|= 0.000268  |ddm|= 0.106
    CPU time for cycle= 4      7.23 sec, wall time      0.23 sec
HOMO = 0.821236403084  LUMO = 1.01950495031
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18619097  0.75472238  0.75472263  0.8212364 ] [1.01950495 1.03930529 1.03930576 1.36580441 1.82435709 1.82435717
 1.88249497 2.12831469 2.13594339 2.13595041 2.7208413  2.72084736
 2.72587744 3.56483742 3.57081146 3.57083469 3.70879285 3.70879299
 4.22246174 4.77688179 4.78138137 4.78141899]
   1 ( 0.000  0.000 -0.500)   [0.09403218 0.21010436 0.64131688 0.64131716] [1.15223395 1.16961405 1.16961481 1.40683837 1.70674012 1.81794499
 1.85261073 1.85261647 2.13235262 2.13235425 3.00862787 3.12961686
 3.12962425 3.15566383 3.15566808 3.32351665 3.6737453  3.67375497
 3.80858634 3.80859415 5.19491257 9.87122828]
    CPU time for vj and vk      6.81 sec, wall time      0.21 sec
E1 = (4.437326472449633+2.828253280507821e-17j)  E_coul = (-0.35303620150790077+3.381713759653559e-18j)
cycle= 5 E= -8.70283887468251  delta_E= -9.62e-09  |g|= 1.94e-05  |ddm|= 0.00749
    CPU time for cycle= 5      7.28 sec, wall time      0.23 sec
HOMO = 0.821239050994  LUMO = 1.01950336461
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18619198  0.75472026  0.7547205   0.82123905] [1.01950336 1.03930473 1.0393052  1.36580199 1.82435604 1.82435613
 1.88249534 2.12831291 2.13594357 2.13595059 2.72083934 2.72084541
 2.72587706 3.56483732 3.57081112 3.57083434 3.70879262 3.70879276
 4.22246081 4.77688118 4.7813809  4.78141851]
   1 ( 0.000  0.000 -0.500)   [0.09402925 0.21010678 0.64131496 0.64131525] [1.15223292 1.16961259 1.16961335 1.40683882 1.70673854 1.81794657
 1.85261004 1.85261578 2.1323549  2.13235654 3.0086285  3.12961546
 3.12962285 3.15566222 3.15566647 3.32351383 3.67374406 3.67375373
 3.80858517 3.80859299 5.19491035 9.87122185]
    CPU time for vj and vk      6.89 sec, wall time      0.22 sec
E1 = (4.4373254801669715+2.8282847795127353e-17j)  E_coul = (-0.35303520926226944+3.3816842177827395e-18j)
Extra cycle  E= -8.70283887471954  delta_E= -3.7e-11  |g|= 9.22e-06  |ddm|= 0.000243
    CPU time for scf_cycle     56.38 sec, wall time      1.78 sec
    CPU time for SCF     56.73 sec, wall time      1.93 sec
converged SCF energy = -8.70283887471954
**** SCF Summaries ****
Total Energy =                          -8.702838874719538
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437325480166971
Two-electron Energy =                   -0.353035209262269
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00906
pop of  0 C 2py           1.00906
pop of  0 C 2pz           1.00906
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00170
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00001
charge of    1C =     -0.00001
    CPU time for vj and vk      0.49 sec, wall time      0.02 sec
K2Gamma: found kmesh= [1, 1, 2]
K2Gamma: F_g.imag= 1.1e-15

WARN: occupied orbitals do not span the same space, determinant = -1.0000e+00



WARN: ECP/PP is used. MINAO is not a good reference AO basis in IAO.


******** <class 'klno.KLNOCCSD'> ********
nocc = 8, nmo = 52
max_memory 327680 MB (current use 519 MB)
thresh_occ = 1.000000e-04
thresh_vir = 1.000000e-04
force_outcore_ao2mo = False
_Lov = None
_Lov_to_save = None
nkpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
no_type = rr
Using user input LOs
LOs span occupied space plus some virtual space.
Using user input LO-fragment assignment
nfrag = 10  nlo = 20
frag_atmlist = None
frag_lolist = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9]]
frag_wghtlist = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
frag_nonvlist = None
    CPU time for LO and fragment        0.01 sec, wall time      0.00 sec

WARN: Input vhf is not found. Building vhf from SCF MO.

    CPU time for make pno               0.41 sec, wall time      0.01 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                2.20 sec, wall time      0.07 sec
    CPU time for Fragment 1             2.61 sec, wall time      0.08 sec
Fragment 1  E_corr(MP2) = -5.45750412486015e-05  E_corr(CCSD) = -7.20066374829038e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.33 sec, wall time      0.01 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol                3.80 sec, wall time      0.12 sec
    CPU time for Fragment 2             4.14 sec, wall time      0.13 sec
Fragment 2  E_corr(MP2) = -0.00888118622588095  E_corr(CCSD) = -0.012284137044706  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.37 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               21.37 sec, wall time      0.67 sec
    CPU time for Fragment 3            21.75 sec, wall time      0.68 sec
Fragment 3  E_corr(MP2) = -0.0159843735099918  E_corr(CCSD) = -0.0222059042493054  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.39 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               11.82 sec, wall time      0.37 sec
    CPU time for Fragment 4            12.21 sec, wall time      0.39 sec
Fragment 4  E_corr(MP2) = -0.0159843326815019  E_corr(CCSD) = -0.022205844464832  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.54 sec, wall time      0.02 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol                9.03 sec, wall time      0.29 sec
    CPU time for Fragment 5             9.57 sec, wall time      0.30 sec
Fragment 5  E_corr(MP2) = -0.0159843152226472  E_corr(CCSD) = -0.0222058021947976  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.88 sec, wall time      0.03 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                6.73 sec, wall time      0.21 sec
    CPU time for Fragment 6             7.62 sec, wall time      0.24 sec
Fragment 6  E_corr(MP2) = -5.4571842920983e-05  E_corr(CCSD) = -7.20023197989939e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.35 sec, wall time      0.01 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol                3.97 sec, wall time      0.13 sec
    CPU time for Fragment 7             4.32 sec, wall time      0.14 sec
Fragment 7  E_corr(MP2) = -0.00888111716767626  E_corr(CCSD) = -0.0122840485933248  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.33 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               22.71 sec, wall time      0.71 sec
    CPU time for Fragment 8            23.04 sec, wall time      0.72 sec
Fragment 8  E_corr(MP2) = -0.0159845477024805  E_corr(CCSD) = -0.0222061040189679  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.38 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               19.51 sec, wall time      0.61 sec
    CPU time for Fragment 9            19.89 sec, wall time      0.63 sec
Fragment 9  E_corr(MP2) = -0.0159843851425856  E_corr(CCSD) = -0.0222059209682331  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.38 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               19.84 sec, wall time      0.62 sec
    CPU time for Fragment 10           20.22 sec, wall time      0.64 sec
Fragment 10  E_corr(MP2) = -0.0159844319665581  E_corr(CCSD) = -0.0222059844944366  E_corr(CCSD(T)) = 0
    CPU time for KLNOCCSD             130.90 sec, wall time      4.13 sec
E(LNOMP2) = -8.81661671122303  E_corr = -0.113777836503492
E(LNOCCSD) = -8.86078662970542  E_corr = -0.157947754985885
Summary by spin components
LNOMP2   Ess = -0.0152061357467586  Eos = -0.0985717007567334  Escs = -0.123349684111751
LNOCCSD  Ess = -0.0154845105879002  Eos = -0.142463244397985  Escs = -0.176112235303353
End time = Wed May 14 11:30:34 PM PDT 2025
