SLURMD_NODENAME = hpc-35-04
Start time = Tue May 27 03:52:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49851875/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49851875/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-20/100/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 100.0
density_fitting_method: fftisdf-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 1161, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 3375, selected grid size = 520
truncated values = 3.89e+01, estimated error = 1.39e-02
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 520.
    CPU time for building inpv_kpt      0.24 sec, wall time      0.01 sec

Out-core version is used for eta_kpt.
disk space required: 2.02e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   2.02e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     10.64 sec, wall time      0.43 sec
    CPU time for building eta_kpt     12.15 sec, wall time      0.48 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     13.01 sec, wall time      0.96 sec
    CPU time for coul_kpt[ 2 / 2]     10.61 sec, wall time      0.95 sec
    CPU time for building coul_kpt     24.20 sec, wall time      1.93 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49851875/i2d2ufry


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49851875/tmpfq7qoyj7
max_memory 327680 MB (current use 350 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f0f90e780d0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.91 sec, wall time      0.10 sec
E1 = (3.1148714996828017-7.97289888308681e-19j)  E_coul = (-5.35972849577666+1.9446593005536403e-17j)
init E= -15.0319861417181
    CPU time for initialize scf      5.95 sec, wall time      0.22 sec
HOMO = 0.634511691787  LUMO = 0.835951932058
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95469985  0.58526376  0.63451155  0.63451169] [0.83595193 0.90520794 0.90520809 1.12045015 1.80070959 1.80070967
 1.86315991 2.07362733 2.09380651 2.0938082  2.63058393 2.63483149
 2.63483336 3.54994335 3.54994891 3.55203596 3.65113811 3.65113814
 4.2089052  4.72603744 4.72731692 4.72734477]
   1 ( 0.000  0.000 -0.500)   [-0.84757901 -0.56898837  0.50108747  0.50108759] [0.9641988  1.03464033 1.03464048 1.35062395 1.61891708 1.75433139
 1.81735826 1.81736033 2.11624966 2.11625011 2.94274075 3.05301013
 3.0530116  3.09654087 3.09654275 3.29651741 3.64893332 3.64894054
 3.75827415 3.75827938 5.1290371  9.60195916]
    CPU time for vj and vk      2.86 sec, wall time      0.09 sec
E1 = (4.41173633217255-1.3940059443101363e-17j)  E_coul = (-2.192543896290977+2.6998116717676765e-18j)
cycle= 1 E= -10.5679367097427  delta_E= 4.46  |g|= 0.33  |ddm|= 8.49
    CPU time for cycle= 1      3.35 sec, wall time      0.11 sec
HOMO = 0.365524302813  LUMO = 1.01779002856
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6543708   0.29044399  0.29044423  0.3655243 ] [1.01779003 1.03924251 1.03924312 1.36689064 1.82549335 1.8254934
 1.88181492 2.12847477 2.13624968 2.13625493 2.72589623 2.72590316
 2.73256675 3.56544521 3.57188621 3.57190293 3.71006066 3.71006085
 4.22688302 4.77815509 4.78312392 4.78317309]
   1 ( 0.000  0.000 -0.500)   [-0.37094159 -0.25528131  0.17488659  0.17488674] [1.15339345 1.16989314 1.16989346 1.40380933 1.71097569 1.82289774
 1.85611942 1.85612501 2.13419191 2.13419389 3.01196359 3.130398
 3.13040334 3.15966791 3.15967879 3.32337531 3.67519445 3.67520019
 3.81046988 3.81049602 5.20023913 9.89324889]
    CPU time for vj and vk      2.86 sec, wall time      0.09 sec
E1 = (4.435277852031629-1.476306876197714e-17j)  E_coul = (-2.2292960632824164+2.9589298161245423e-18j)
cycle= 2 E= -10.581147356875  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      3.42 sec, wall time      0.11 sec
HOMO = 0.351273782685  LUMO = 1.01859915473
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65660249  0.28429148  0.28429165  0.35127378] [1.01859915 1.03825496 1.03825553 1.36488829 1.8239813  1.82398135
 1.88255952 2.12799252 2.13565601 2.13566058 2.72005194 2.72005803
 2.72506993 3.56450731 3.57062305 3.57063891 3.70812984 3.70812992
 4.22251619 4.77628908 4.78079178 4.78082862]
   1 ( 0.000  0.000 -0.500)   [-0.37618603 -0.26019817  0.17066224  0.17066254] [1.15178284 1.16898178 1.16898204 1.4067166  1.70615922 1.81704131
 1.85209545 1.85210006 2.13199448 2.13199662 3.00786209 3.12927571
 3.12928116 3.15469852 3.15470735 3.32339965 3.67354009 3.67354764
 3.8080501  3.8080724  5.19445853 9.86920694]
    CPU time for vj and vk      2.83 sec, wall time      0.09 sec
E1 = (4.4374884827246115-1.48799945085292e-17j)  E_coul = (-2.2321711571590566+3.04249466401825e-18j)
cycle= 3 E= -10.5818118200587  delta_E= -0.000664  |g|= 0.00688  |ddm|= 0.997
    CPU time for cycle= 3      3.40 sec, wall time      0.11 sec
HOMO = 0.351518527405  LUMO = 1.01949726338
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65592183  0.2849995   0.28499969  0.35151853] [1.01949726 1.03929248 1.03929307 1.36585381 1.82435313 1.82435317
 1.88248302 2.12829819 2.1359356  2.1359402  2.72084194 2.720848
 2.7258929  3.56482901 3.57080407 3.57082008 3.70879002 3.70879011
 4.22247889 4.77686816 4.78132997 4.78136697]
   1 ( 0.000  0.000 -0.500)   [-0.3757132  -0.2596266   0.17157996  0.17158025] [1.15226774 1.16960572 1.16960595 1.40683544 1.70674771 1.81797026
 1.85261901 1.85262363 2.13235466 2.13235678 3.00861314 3.12961259
 3.12961814 3.15565665 3.15566546 3.32350741 3.67372941 3.67373715
 3.80856383 3.80858605 5.19492608 9.87132736]
    CPU time for vj and vk      2.87 sec, wall time      0.09 sec
E1 = (4.437338093892767-1.48729023452136e-17j)  E_coul = (-2.2320294723628757+3.0528397497726662e-18j)
cycle= 4 E= -10.5818205240943  delta_E= -8.7e-06  |g|= 0.000625  |ddm|= 0.112
    CPU time for cycle= 4      3.44 sec, wall time      0.11 sec
HOMO = 0.35148673031  LUMO = 1.01949799573
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6559392   0.28497258  0.28497277  0.35148673] [1.019498   1.03930094 1.03930153 1.36580552 1.8243549  1.82435494
 1.88249552 2.12831581 2.13594045 2.13594505 2.72082947 2.72083552
 2.72587556 3.5648316  3.57080071 3.57081671 3.70879046 3.70879055
 4.22246226 4.77686912 4.78132779 4.78136474]
   1 ( 0.000  0.000 -0.500)   [-0.37571758 -0.25964846  0.17156626  0.17156655] [1.15223692 1.1696119  1.16961212 1.40683908 1.70673759 1.81794346
 1.85260554 1.85261015 2.13234859 2.13235071 3.0086233  3.12961047
 3.12961602 3.15565323 3.15566203 3.32351367 3.67372438 3.67373212
 3.80856552 3.80858772 5.19490921 9.87124587]
    CPU time for vj and vk      2.76 sec, wall time      0.09 sec
E1 = (4.437329854533052-1.4873351637884382e-17j)  E_coul = (-2.2320213104747646+3.053434716372729e-18j)
cycle= 5 E= -10.581820601566  delta_E= -7.75e-08  |g|= 6.03e-05  |ddm|= 0.0176
    CPU time for cycle= 5      3.31 sec, wall time      0.11 sec
HOMO = 0.351492666037  LUMO = 1.01950210893
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65593744  0.28497482  0.28497502  0.35149267] [1.01950211 1.03930395 1.03930454 1.36580368 1.8243559  1.82435594
 1.88249542 2.12831429 2.13594088 2.13594548 2.72083216 2.7208382
 2.72587906 3.56483248 3.57080135 3.57081736 3.70879212 3.70879221
 4.22246273 4.77687054 4.78132925 4.78136619]
   1 ( 0.000  0.000 -0.500)   [-0.37571607 -0.2596406   0.17156928  0.17156956] [1.15223477 1.16961235 1.16961257 1.40683718 1.70673838 1.81794592
 1.85260753 1.85261214 2.13235277 2.13235489 3.00862829 3.12961021
 3.12961575 3.15565484 3.15566364 3.32351251 3.67372409 3.67373184
 3.80856677 3.80858897 5.19491014 9.8712529 ]
    CPU time for vj and vk      2.66 sec, wall time      0.09 sec
E1 = (4.437326866762849-1.4875388959294812e-17j)  E_coul = (-2.232018323380209+3.0534657828534e-18j)
Extra cycle  E= -10.5818206022416  delta_E= -6.76e-10  |g|= 1.72e-05  |ddm|= 0.0015
    CPU time for scf_cycle     26.06 sec, wall time      0.87 sec
    CPU time for SCF     32.65 sec, wall time      1.46 sec
converged SCF energy = -10.5818206022416
**** SCF Summaries ****
Total Energy =                         -10.581820602241599
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437326866762849
Two-electron Energy =                   -2.232018323380209
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00907
pop of  0 C 2py           1.00907
pop of  0 C 2pz           1.00907
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00170
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93328
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      0.92 sec, wall time      0.03 sec
Traceback (most recent call last):
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-20/100/main.py", line 100, in <module>
    main(config)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-20/100/main.py", line 34, in main
    mf_s = k2s_scf(scf_obj)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/pyscf-forge-lnocc/pyscf/pbc/lno/tools.py", line 40, in k2s_scf
    mf = scf.RHF(scell, kpt=kpts[0]).rs_density_fit(auxbasis=kmf.with_df.auxbasis)
AttributeError: 'InterpolativeSeparableDensityFitting' object has no attribute 'auxbasis'
End time = Tue May 27 03:53:05 PM PDT 2025
