SLURMD_NODENAME = hpc-34-19
Start time = Wed May 14 11:30:21 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49506430/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49506430/

Running /resnick/groups/changroup/members/junjiey/fftisdf-with-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-20/100/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 100.0
density_fitting_method: fftisdf-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 1161, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 3375, selected grid size = 520
truncated values = 3.89e+01, estimated error = 1.39e-02
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>
<class 'fft.isdf.InterpolativeSeparableDensityFitting'> does not have attributes  blksize

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 520.
    CPU time for building inpv_kpt      0.15 sec, wall time      0.00 sec

Out-core version is used for eta_kpt.
disk space required: 2.02e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   2.02e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     10.14 sec, wall time      0.37 sec
    CPU time for building eta_kpt     11.59 sec, wall time      0.42 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]     12.24 sec, wall time      0.89 sec
    CPU time for coul_kpt[ 2 / 2]     10.30 sec, wall time      0.83 sec
    CPU time for building coul_kpt     22.96 sec, wall time      1.73 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49506430/j4xonjhp


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49506430/tmpf1j6vyqw
max_memory 327680 MB (current use 351 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fd98998b880>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.26 sec, wall time      0.08 sec
E1 = (3.1148714996828017-3.630075913876956e-32j)  E_coul = (-1.2378595371056933+1.9446593005536397e-17j)
init E= -10.9101171830471
    CPU time for initialize scf      4.82 sec, wall time      0.16 sec
HOMO = 0.710116971496  LUMO = 0.888054636028
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.19817072  0.66063633  0.71011683  0.71011697] [0.88805464 0.95745799 0.95745814 1.17950367 1.80070996 1.80071005
 1.8786284  2.07454906 2.09439037 2.09439205 2.63195515 2.63600316
 2.63600504 3.55006556 3.55007111 3.55214037 3.65113847 3.6511385
 4.21081508 4.72607658 4.72735218 4.72738002]
   1 ( 0.000  0.000 -0.500)   [-0.23641706 -0.02541416  0.59802947  0.59802959] [1.02673369 1.07277764 1.07277782 1.37028573 1.62492402 1.76438758
 1.82175257 1.82175461 2.11631397 2.11631442 2.94328301 3.05310271
 3.05310418 3.09664067 3.09664256 3.29737935 3.64910435 3.64911155
 3.75831198 3.7583172  5.12971928 9.60255093]
    CPU time for vj and vk      2.08 sec, wall time      0.07 sec
E1 = (4.379882461105379-4.186412039687692e-18j)  E_coul = (-0.28035732378901496+2.847980356113888e-18j)
cycle= 1 E= -8.68760400830788  delta_E= 2.22  |g|= 0.369  |ddm|= 8.88
    CPU time for cycle= 1      2.44 sec, wall time      0.08 sec
HOMO = 0.838355118259  LUMO = 1.02138511112
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18203045  0.76530039  0.76530069  0.83835512] [1.02138511 1.0439876  1.04398827 1.37214091 1.82744349 1.82744354
 1.88124875 2.1311773  2.13874664 2.13875196 2.73150913 2.73151605
 2.7381237  3.56743018 3.57358397 3.57360095 3.71418926 3.71418945
 4.22631784 4.78171622 4.78664849 4.78669704]
   1 ( 0.000  0.000 -0.500)   [0.09841285 0.21861595 0.64947739 0.64947758] [1.15660068 1.17346309 1.17346337 1.40428545 1.71585845 1.82840119
 1.85970523 1.85971072 2.13682527 2.13682725 3.01699165 3.13256303
 3.1325686  3.16609467 3.16610492 3.32454685 3.67685442 3.67686136
 3.81403372 3.8140589  5.20279437 9.90615687]
    CPU time for vj and vk      2.12 sec, wall time      0.07 sec
E1 = (4.447666281022668-4.325524908190105e-18j)  E_coul = (-0.363172965116554+3.02584206996481e-18j)
cycle= 2 E= -8.70263582971813  delta_E= -0.015  |g|= 0.0439  |ddm|= 7.57
    CPU time for cycle= 2      2.57 sec, wall time      0.08 sec
HOMO = 0.82129179292  LUMO = 1.01858015816
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18678942  0.75421943  0.75421964  0.82129179] [1.01858016 1.03840242 1.03840302 1.36481788 1.82404721 1.82404726
 1.8825491  2.12803583 2.13563535 2.13563993 2.72014066 2.72014677
 2.72517498 3.56458458 3.57067663 3.57069259 3.70828474 3.70828483
 4.22235399 4.77637665 4.78089448 4.78093182]
   1 ( 0.000  0.000 -0.500)   [0.09349292 0.20972957 0.64063584 0.64063614] [1.15185375 1.16913902 1.16913925 1.40690488 1.70629084 1.81708703
 1.85203992 1.85204446 2.13208271 2.13208482 3.00789855 3.12935197
 3.12935746 3.15481623 3.15482486 3.32338607 3.67355085 3.67355862
 3.80813937 3.80816126 5.19433863 9.86900757]
    CPU time for vj and vk      2.11 sec, wall time      0.07 sec
E1 = (4.436315790438821-4.1500633059781436e-18j)  E_coul = (-0.3520235847485858+3.0571390619955504e-18j)
cycle= 3 E= -8.70283693993401  delta_E= -0.000201  |g|= 0.00393  |ddm|=  1.4
    CPU time for cycle= 3      2.58 sec, wall time      0.08 sec
HOMO = 0.821260394495  LUMO = 1.0195288441
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18616898  0.7547441   0.7547443   0.82126039] [1.01952884 1.03932344 1.03932403 1.36580452 1.82436628 1.82436633
 1.88250478 2.12832815 2.13595409 2.13595869 2.72086588 2.72087193
 2.72592036 3.56484179 3.57080936 3.57082537 3.70880698 3.70880707
 4.22247848 4.77688479 4.7813455  4.78138247]
   1 ( 0.000  0.000 -0.500)   [0.09404063 0.21014126 0.64133936 0.64133965] [1.15223968 1.16961405 1.16961427 1.40682526 1.70675868 1.81799598
 1.85263039 1.85263501 2.13239037 2.13239249 3.00866461 3.12961072
 3.12961627 3.15568124 3.15569004 3.32350633 3.67372895 3.67373668
 3.80858123 3.80860343 5.19493221 9.87136156]
    CPU time for vj and vk      2.28 sec, wall time      0.07 sec
E1 = (4.437368865432731-4.183465097083552e-18j)  E_coul = (-0.3530786577891897+3.0530039070413695e-18j)
cycle= 4 E= -8.7028389379807  delta_E= -2e-06  |g|= 0.000268  |ddm|= 0.106
    CPU time for cycle= 4      2.82 sec, wall time      0.09 sec
HOMO = 0.821236293646  LUMO = 1.01950475125
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18619098  0.75472238  0.75472257  0.82123629] [1.01950475 1.03930517 1.03930576 1.36580479 1.8243571  1.82435715
 1.88249529 2.12831611 2.13594105 2.13594565 2.72083459 2.72084063
 2.72588015 3.56483284 3.57080182 3.57081783 3.70879274 3.70879283
 4.22246356 4.77687152 4.78133003 4.78136698]
   1 ( 0.000  0.000 -0.500)   [0.09403214 0.21010431 0.64131683 0.64131712] [1.15223443 1.16961381 1.16961403 1.40683632 1.70673982 1.81794494
 1.8526086  1.85261321 2.13235174 2.13235386 3.00862949 3.12961137
 3.12961692 3.15565681 3.15566562 3.32351492 3.67372509 3.67373283
 3.80856824 3.80859044 5.19491234 9.87125992]
    CPU time for vj and vk      2.34 sec, wall time      0.07 sec
E1 = (4.437326690084021-4.178735865013649e-18j)  E_coul = (-0.3530364920569457+3.053504117328479e-18j)
cycle= 5 E= -8.70283894759717  delta_E= -9.62e-09  |g|= 1.92e-05  |ddm|= 0.00749
    CPU time for cycle= 5      3.59 sec, wall time      0.11 sec
HOMO = 0.821238941587  LUMO = 1.01950316557
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18619199  0.75472025  0.75472045  0.82123894] [1.01950317 1.03930461 1.0393052  1.36580237 1.82435606 1.8243561
 1.88249567 2.12831432 2.13594123 2.13594583 2.72083263 2.72083868
 2.72587977 3.56483274 3.57080148 3.57081748 3.70879251 3.7087926
 4.22246263 4.77687092 4.78132956 4.7813665 ]
   1 ( 0.000  0.000 -0.500)   [0.09402921 0.21010673 0.64131492 0.6413152 ] [1.1522334  1.16961235 1.16961257 1.40683678 1.70673824 1.81794653
 1.85260791 1.85261252 2.13235403 2.13235615 3.00863012 3.12960997
 3.12961551 3.1556552  3.155664   3.32351209 3.67372385 3.67373159
 3.80856707 3.80858927 5.19491011 9.87125349]
    CPU time for vj and vk      2.52 sec, wall time      0.08 sec
E1 = (4.437325697825395-4.178824088488588e-18j)  E_coul = (-0.3530354998372636+3.053479244951796e-18j)
Extra cycle  E= -8.70283894763611  delta_E= -3.89e-11  |g|= 8e-06  |ddm|= 0.000241
    CPU time for scf_cycle     21.86 sec, wall time      0.70 sec
    CPU time for SCF     22.77 sec, wall time      0.98 sec
converged SCF energy = -8.70283894763611
**** SCF Summaries ****
Total Energy =                          -8.702838947636108
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437325697825395
Two-electron Energy =                   -0.353035499837264
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93329
pop of  0 C 3s            0.00446
pop of  0 C 2px           1.00906
pop of  0 C 2py           1.00906
pop of  0 C 2pz           1.00906
pop of  0 C 3px           0.00169
pop of  0 C 3py           0.00170
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00996
pop of  0 C 3dyz          0.00996
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00996
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93329
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00907
pop of  1 C 2py           1.00907
pop of  1 C 2pz           1.00907
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00169
pop of  1 C 3dxy          0.00996
pop of  1 C 3dyz          0.00996
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00996
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =     -0.00000
    CPU time for vj and vk      0.50 sec, wall time      0.02 sec
K2Gamma: found kmesh= [1, 1, 2]
K2Gamma: F_g.imag= 8.9e-13

WARN: occupied orbitals do not span the same space, determinant = -1.0000e+00



WARN: ECP/PP is used. MINAO is not a good reference AO basis in IAO.


******** <class 'klno.KLNOCCSD'> ********
nocc = 8, nmo = 52
max_memory 327680 MB (current use 561 MB)
thresh_occ = 1.000000e-04
thresh_vir = 1.000000e-04
force_outcore_ao2mo = False
_Lov = None
_Lov_to_save = None
nkpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
no_type = rr
Using user input LOs
LOs span occupied space plus some virtual space.
Using user input LO-fragment assignment
nfrag = 10  nlo = 20
frag_atmlist = None
frag_lolist = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9]]
frag_wghtlist = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
frag_nonvlist = None
    CPU time for LO and fragment        0.02 sec, wall time      0.00 sec

WARN: Input vhf is not found. Building vhf from SCF MO.

    CPU time for make pno               0.51 sec, wall time      0.02 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                9.00 sec, wall time      0.29 sec
    CPU time for Fragment 1             9.51 sec, wall time      0.31 sec
Fragment 1  E_corr(MP2) = -5.45750325468957e-05  E_corr(CCSD) = -7.20066375101142e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.72 sec, wall time      0.02 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol               16.93 sec, wall time      0.54 sec
    CPU time for Fragment 2            17.66 sec, wall time      0.57 sec
Fragment 2  E_corr(MP2) = -0.00888119105929215  E_corr(CCSD) = -0.0122841364600095  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.68 sec, wall time      0.02 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               35.80 sec, wall time      1.12 sec
    CPU time for Fragment 3            36.48 sec, wall time      1.15 sec
Fragment 3  E_corr(MP2) = -0.0159843589219667  E_corr(CCSD) = -0.0222058708920541  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.33 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               20.93 sec, wall time      0.66 sec
    CPU time for Fragment 4            21.26 sec, wall time      0.67 sec
Fragment 4  E_corr(MP2) = -0.0159843100735477  E_corr(CCSD) = -0.0222058088768151  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.98 sec, wall time      0.03 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               20.46 sec, wall time      0.64 sec
    CPU time for Fragment 5            21.45 sec, wall time      0.67 sec
Fragment 5  E_corr(MP2) = -0.0159842500781099  E_corr(CCSD) = -0.0222057246725283  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.57 sec, wall time      0.02 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                5.99 sec, wall time      0.19 sec
    CPU time for Fragment 6             6.56 sec, wall time      0.21 sec
Fragment 6  E_corr(MP2) = -5.45717637547284e-05  E_corr(CCSD) = -7.20022287332389e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.40 sec, wall time      0.01 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol                5.02 sec, wall time      0.16 sec
    CPU time for Fragment 7             5.43 sec, wall time      0.17 sec
Fragment 7  E_corr(MP2) = -0.00888112174931848  E_corr(CCSD) = -0.0122840443767953  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.44 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               27.24 sec, wall time      0.85 sec
    CPU time for Fragment 8            27.68 sec, wall time      0.87 sec
Fragment 8  E_corr(MP2) = -0.0159845126475356  E_corr(CCSD) = -0.0222060590782079  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.49 sec, wall time      0.02 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               32.51 sec, wall time      1.02 sec
    CPU time for Fragment 9            33.00 sec, wall time      1.04 sec
Fragment 9  E_corr(MP2) = -0.0159843573828142  E_corr(CCSD) = -0.0222058842489453  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.62 sec, wall time      0.02 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               20.34 sec, wall time      0.64 sec
    CPU time for Fragment 10           20.96 sec, wall time      0.66 sec
Fragment 10  E_corr(MP2) = -0.0159844149594642  E_corr(CCSD) = -0.022205932244168  E_corr(CCSD(T)) = 0
    CPU time for KLNOCCSD             202.18 sec, wall time      6.38 sec
E(LNOMP2) = -8.81661661130446  E_corr = -0.113777663668351
E(LNOCCSD) = -8.86078641735187  E_corr = -0.157947469715767
Summary by spin components
LNOMP2   Ess = -0.015206030059675  Eos = -0.0985716336086756  Escs = -0.123349568340282
LNOCCSD  Ess = -0.0154844086462641  Eos = -0.142463061069503  Escs = -0.176111981362609
End time = Wed May 14 11:30:33 PM PDT 2025
