SLURMD_NODENAME = hpc-34-17
Start time = Wed May 14 11:30:21 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49506429/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49506429/

Running /resnick/groups/changroup/members/junjiey/fftisdf-with-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/200/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 200.0
density_fitting_method: fftisdf-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 1161, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 3375, selected grid size = 260
truncated values = 3.85e+01, estimated error = 4.33e-01
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>
<class 'fft.isdf.InterpolativeSeparableDensityFitting'> does not have attributes  blksize

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 260.
    CPU time for building inpv_kpt      0.14 sec, wall time      0.00 sec

Out-core version is used for eta_kpt.
disk space required: 2.99e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   2.99e-01 GB
memory needed for each k-point: 1.49e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     12.11 sec, wall time      0.55 sec
    CPU time for building eta_kpt     16.08 sec, wall time      0.68 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      7.30 sec, wall time      0.73 sec
    CPU time for coul_kpt[ 2 / 2]      1.87 sec, wall time      0.65 sec
    CPU time for building coul_kpt      9.35 sec, wall time      1.39 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49506429/8nodqivt


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49506429/tmpd86_at5x
max_memory 327680 MB (current use 276 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fb112b63880>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.53 sec, wall time      0.18 sec
E1 = (3.11487150027178-1.4659966980306616e-32j)  E_coul = (-1.23779820057205+1.2597135869231566e-17j)
init E= -10.9100558459245
    CPU time for initialize scf     12.17 sec, wall time      0.40 sec
HOMO = 0.710159392399  LUMO = 0.888051441063
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.19813922  0.6606386   0.71007722  0.71015939] [0.88805144 0.95746687 0.95752816 1.1793213  1.80065929 1.8006974
 1.87873538 2.07467257 2.09429577 2.09440747 2.63196957 2.63598301
 2.63615814 3.54991493 3.5503111  3.55263605 3.65112893 3.65116193
 4.21061353 4.72618333 4.72713403 4.72730747]
   1 ( 0.000  0.000 -0.500)   [-0.23634953 -0.02543263  0.59799611  0.59808502] [1.02671066 1.07279113 1.07283012 1.37033733 1.62491879 1.76440035
 1.82174488 1.82176477 2.11628489 2.1163101  2.94324072 3.05306823
 3.05313512 3.0966187  3.09669205 3.29741646 3.64893827 3.64905377
 3.75827819 3.75864344 5.1298185  9.60257654]
    CPU time for vj and vk      5.58 sec, wall time      0.17 sec
E1 = (4.37977330703305+1.344890136392408e-17j)  E_coul = (-0.2802688777285576-2.651780904058314e-18j)
cycle= 1 E= -8.68762471631975  delta_E= 2.22  |g|= 0.369  |ddm|= 8.98
    CPU time for cycle= 1      6.09 sec, wall time      0.19 sec
HOMO = 0.838359269358  LUMO = 1.02142956643
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18198375  0.76520261  0.76532101  0.83835927] [1.02142957 1.04402512 1.044029   1.37199336 1.82742089 1.82743902
 1.88141163 2.13115632 2.13863014 2.13869313 2.73139042 2.73158348
 2.73812011 3.56763495 3.57364301 3.57374905 3.71416655 3.71426328
 4.22649258 4.7815455  4.78646967 4.78676946]
   1 ( 0.000  0.000 -0.500)   [0.09849183 0.21862445 0.64940799 0.64954453] [1.15662351 1.17345551 1.17351334 1.40431733 1.71579995 1.82835201
 1.85958552 1.85974647 2.13676975 2.13679133 3.0169151  3.13259444
 3.13268224 3.16603205 3.16605281 3.32465977 3.67685878 3.67702547
 3.81402461 3.81425469 5.20273721 9.90625635]
    CPU time for vj and vk      5.47 sec, wall time      0.17 sec
E1 = (4.447525012644786+1.0712977222968344e-17j)  E_coul = (-0.3630637784571481-2.6793155631282078e-18j)
cycle= 2 E= -8.7026679114366  delta_E= -0.015  |g|= 0.0439  |ddm|= 7.58
    CPU time for cycle= 2      6.06 sec, wall time      0.19 sec
HOMO = 0.821286150946  LUMO = 1.01862423255
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18673591  0.7541202   0.75424155  0.82128615] [1.01862423 1.03843969 1.03844342 1.3646967  1.82402515 1.82404561
 1.88272821 2.12804895 2.13554166 2.13558062 2.72002474 2.72017858
 2.72517943 3.56482071 3.57071731 3.57082671 3.70829744 3.70836228
 4.22252997 4.77621321 4.7807581  4.78104643]
   1 ( 0.000  0.000 -0.500)   [0.09358227 0.20973076 0.64056977 0.64070262] [1.15190234 1.16913945 1.16918638 1.40695128 1.70624299 1.81706246
 1.85193368 1.85209607 2.13202035 2.13203926 3.00782441 3.12935023
 3.12945647 3.15476191 3.15477122 3.32349549 3.67359475 3.67373631
 3.80816948 3.80837867 5.19429938 9.86911281]
    CPU time for vj and vk      5.70 sec, wall time      0.18 sec
E1 = (4.436186714656428+1.0848612441397434e-17j)  E_coul = (-0.3519263702414618-2.7029083055282075e-18j)
cycle= 3 E= -8.70286880120927  delta_E= -0.000201  |g|= 0.00394  |ddm|=  1.4
    CPU time for cycle= 3      6.28 sec, wall time      0.20 sec
HOMO = 0.821257446449  LUMO = 1.01957337107
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18611554  0.75464538  0.75476481  0.82125745] [1.01957337 1.03936048 1.03936514 1.36568392 1.82434462 1.82436514
 1.88268242 2.12833745 2.13586009 2.13589961 2.72075082 2.72090601
 2.72592638 3.56507537 3.57084934 3.57095716 3.70881692 3.70888451
 4.22265553 4.77672176 4.78121156 4.78149784]
   1 ( 0.000  0.000 -0.500)   [0.09412871 0.2101453  0.64127296 0.641405  ] [1.1522862  1.16961348 1.16966106 1.40687372 1.70671135 1.81797085
 1.85252417 1.8526859  2.13232966 2.13234911 3.00859186 3.12961288
 3.12971532 3.15562736 3.15563633 3.32361527 3.67377455 3.67391433
 3.80860945 3.80881614 5.19489149 9.87147001]
    CPU time for vj and vk      5.57 sec, wall time      0.17 sec
E1 = (4.437241346682432+1.088531275278839e-17j)  E_coul = (-0.3529830083649984-2.698840179374108e-18j)
cycle= 4 E= -8.70287080730681  delta_E= -2.01e-06  |g|= 0.00028  |ddm|= 0.107
    CPU time for cycle= 4      6.21 sec, wall time      0.20 sec
HOMO = 0.821233187508  LUMO = 1.01954942531
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18613741  0.75462384  0.75474334  0.82123319] [1.01954943 1.03934241 1.03934698 1.36568448 1.82433551 1.82435607
 1.88267307 2.12832562 2.13584713 2.13588657 2.72071976 2.72087479
 2.72588631 3.56506661 3.57084175 3.57094942 3.70880274 3.70887036
 4.22264075 4.77670883 4.78119659 4.78148244]
   1 ( 0.000  0.000 -0.500)   [0.09412044 0.21010819 0.64125054 0.6413827 ] [1.15228115 1.16961349 1.16966093 1.4068848  1.70669269 1.81791987
 1.85250259 1.85266418 2.13229095 2.1323103  3.0085568  3.12961378
 3.12971606 3.15560316 3.15561211 3.3236241  3.67377092 3.67391062
 3.80859657 3.80880312 5.19487173 9.87136902]
    CPU time for vj and vk      5.53 sec, wall time      0.17 sec
E1 = (4.437199375018607+1.0875077837344505e-17j)  E_coul = (-0.3529410454150669-2.6995795757721544e-18j)
cycle= 5 E= -8.7028708160207  delta_E= -8.71e-09  |g|= 0.000116  |ddm|= 0.00761
    CPU time for cycle= 5      6.08 sec, wall time      0.19 sec
HOMO = 0.821235769339  LUMO = 1.01954777102
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18613849  0.75462164  0.75474114  0.82123577] [1.01954777 1.03934177 1.03934634 1.36568202 1.82433443 1.82435499
 1.88267343 2.12832381 2.13584727 2.13588672 2.72071772 2.72087273
 2.7258858  3.56506648 3.57084139 3.57094904 3.70880247 3.70887008
 4.22263976 4.77670819 4.78119608 4.78148191]
   1 ( 0.000  0.000 -0.500)   [0.09411747 0.21011051 0.64124854 0.6413807 ] [1.15228009 1.16961199 1.16965943 1.40688529 1.70669106 1.81792131
 1.85250185 1.85266344 2.13229315 2.13231248 3.00855734 3.12961223
 3.12971462 3.1556016  3.15561046 3.32362129 3.67376961 3.67390937
 3.80859535 3.80880192 5.19486943 9.87136226]
    CPU time for vj and vk      5.55 sec, wall time      0.17 sec
E1 = (4.437198242016877+1.0875563180524546e-17j)  E_coul = (-0.35293990901492717-2.6991108350743056e-18j)
Extra cycle  E= -8.70287081262229  delta_E= 3.4e-09  |g|= 0.000194  |ddm|= 0.00127
    CPU time for scf_cycle     49.02 sec, wall time      1.56 sec
    CPU time for SCF     49.98 sec, wall time      1.84 sec
converged SCF energy = -8.70287081262229
**** SCF Summaries ****
Total Energy =                          -8.702870812622290
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437198242016877
Two-electron Energy =                   -0.352939909014927
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93327
pop of  0 C 3s            0.00445
pop of  0 C 2px           1.00903
pop of  0 C 2py           1.00891
pop of  0 C 2pz           1.00915
pop of  0 C 3px           0.00168
pop of  0 C 3py           0.00168
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00997
pop of  0 C 3dyz          0.00998
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00997
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93330
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00909
pop of  1 C 2py           1.00923
pop of  1 C 2pz           1.00902
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00995
pop of  1 C 3dyz          0.00997
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00995
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00014
charge of    1C =     -0.00014
    CPU time for vj and vk      0.15 sec, wall time      0.00 sec
K2Gamma: found kmesh= [1, 1, 2]
K2Gamma: F_g.imag= 8.9e-16

WARN: ECP/PP is used. MINAO is not a good reference AO basis in IAO.


******** <class 'klno.KLNOCCSD'> ********
nocc = 8, nmo = 52
max_memory 327680 MB (current use 424 MB)
thresh_occ = 1.000000e-04
thresh_vir = 1.000000e-04
force_outcore_ao2mo = False
_Lov = None
_Lov_to_save = None
nkpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
no_type = rr
Using user input LOs
LOs span occupied space plus some virtual space.
Using user input LO-fragment assignment
nfrag = 10  nlo = 20
frag_atmlist = None
frag_lolist = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9]]
frag_wghtlist = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
frag_nonvlist = None
    CPU time for LO and fragment        0.02 sec, wall time      0.00 sec

WARN: Input vhf is not found. Building vhf from SCF MO.

    CPU time for make pno               0.36 sec, wall time      0.01 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                2.55 sec, wall time      0.08 sec
    CPU time for Fragment 1             2.91 sec, wall time      0.09 sec
Fragment 1  E_corr(MP2) = -5.45803355329838e-05  E_corr(CCSD) = -7.20085298807569e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.22 sec, wall time      0.01 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol                4.65 sec, wall time      0.15 sec
    CPU time for Fragment 2             4.88 sec, wall time      0.16 sec
Fragment 2  E_corr(MP2) = -0.00888016615948838  E_corr(CCSD) = -0.0122852216114859  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.26 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               29.85 sec, wall time      0.94 sec
    CPU time for Fragment 3            30.12 sec, wall time      0.95 sec
Fragment 3  E_corr(MP2) = -0.0159837991438429  E_corr(CCSD) = -0.0222057761384794  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.31 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               27.63 sec, wall time      0.87 sec
    CPU time for Fragment 4            27.94 sec, wall time      0.88 sec
Fragment 4  E_corr(MP2) = -0.0159866555563203  E_corr(CCSD) = -0.0222062748828821  E_corr(CCSD(T)) = 0
    CPU time for make pno               1.29 sec, wall time      0.04 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               20.32 sec, wall time      0.64 sec
    CPU time for Fragment 5            21.62 sec, wall time      0.68 sec
Fragment 5  E_corr(MP2) = -0.0159841552761365  E_corr(CCSD) = -0.0222068821265418  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.25 sec, wall time      0.01 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                4.72 sec, wall time      0.15 sec
    CPU time for Fragment 6             4.97 sec, wall time      0.16 sec
Fragment 6  E_corr(MP2) = -5.45448659294714e-05  E_corr(CCSD) = -7.19650873488415e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.24 sec, wall time      0.01 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol               11.93 sec, wall time      0.38 sec
    CPU time for Fragment 7            12.17 sec, wall time      0.39 sec
Fragment 7  E_corr(MP2) = -0.00888071279290805  E_corr(CCSD) = -0.012284839758592  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.26 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               21.90 sec, wall time      0.69 sec
    CPU time for Fragment 8            22.17 sec, wall time      0.70 sec
Fragment 8  E_corr(MP2) = -0.0159883994266261  E_corr(CCSD) = -0.0222112743600218  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.45 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               17.90 sec, wall time      0.56 sec
    CPU time for Fragment 9            18.35 sec, wall time      0.58 sec
Fragment 9  E_corr(MP2) = -0.0159907700913316  E_corr(CCSD) = -0.0222129298643818  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.31 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               20.31 sec, wall time      0.64 sec
    CPU time for Fragment 10           20.62 sec, wall time      0.65 sec
Fragment 10  E_corr(MP2) = -0.0159862204866056  E_corr(CCSD) = -0.0222054011795966  E_corr(CCSD(T)) = 0
    CPU time for KLNOCCSD             171.13 sec, wall time      5.40 sec
E(LNOMP2) = -8.81666081675701  E_corr = -0.113790004134722
E(LNOCCSD) = -8.8608333861615  E_corr = -0.157962573539211
Summary by spin components
LNOMP2   Ess = -0.0152071839493586  Eos = -0.0985828201853632  Escs = -0.123363376477572
LNOCCSD  Ess = -0.0154857695171575  Eos = -0.142476804022053  Escs = -0.176128926075678
End time = Wed May 14 11:30:33 PM PDT 2025
