SLURMD_NODENAME = hpc-35-03
Start time = Tue May 27 03:52:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49851874/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49851874/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/200/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 200.0
density_fitting_method: fftisdf-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 1161, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 3375, selected grid size = 260
truncated values = 3.85e+01, estimated error = 4.33e-01
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 260.
    CPU time for building inpv_kpt      0.13 sec, wall time      0.00 sec

Out-core version is used for eta_kpt.
disk space required: 2.99e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   2.99e-01 GB
memory needed for each k-point: 1.49e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     13.23 sec, wall time      0.68 sec
    CPU time for building eta_kpt     17.38 sec, wall time      0.81 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      6.94 sec, wall time      0.69 sec
    CPU time for coul_kpt[ 2 / 2]      1.82 sec, wall time      0.64 sec
    CPU time for building coul_kpt      8.92 sec, wall time      1.34 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49851874/gjsgovai


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49851874/tmpzp6j_1va
max_memory 327680 MB (current use 276 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fd90d5c00d0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      5.85 sec, wall time      0.19 sec
E1 = (3.1148715002717804-7.97289888308537e-19j)  E_coul = (-5.359667159243018+1.259713586923157e-17j)
init E= -15.0319248045955
    CPU time for initialize scf     12.37 sec, wall time      0.41 sec
HOMO = 0.634554189577  LUMO = 0.835948339766
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95467455  0.5852655   0.63447121  0.63455419] [0.83594834 0.90521675 0.9052774  1.12026813 1.8006589  1.80069703
 1.86327495 2.07374937 2.09371253 2.09382408 2.63059906 2.63481146
 2.63498736 3.54979266 3.5501886  3.55253175 3.65112855 3.65116157
 4.20870322 4.72614443 4.72709816 4.72727215]
   1 ( 0.000  0.000 -0.500)   [-0.84751252 -0.56900391  0.50105413  0.50114314] [0.96417044 1.03465272 1.03469354 1.35067073 1.6189141  1.75434947
 1.81735031 1.81737129 2.11622034 2.11624567 2.94269786 3.05297613
 3.05304265 3.09651906 3.09659229 3.29655697 3.64876709 3.64888245
 3.75824022 3.75860536 5.12913445 9.60198554]
    CPU time for vj and vk      5.92 sec, wall time      0.19 sec
E1 = (4.411629240830448+6.319004152928335e-18j)  E_coul = (-2.1924700021949524-2.652580238075078e-18j)
cycle= 1 E= -10.5679699069887  delta_E= 4.46  |g|= 0.33  |ddm|= 8.55
    CPU time for cycle= 1      6.37 sec, wall time      0.20 sec
HOMO = 0.365527771965  LUMO = 1.01783071628
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65432516  0.29034648  0.29045796  0.36552777] [1.01783072 1.03927591 1.03928415 1.3667496  1.82547507 1.82549093
 1.88196999 2.12847207 2.13614069 2.13619601 2.72579095 2.72597448
 2.73256205 3.56566897 3.57194791 3.57205737 3.71003745 3.71013562
 4.22702116 4.77800697 4.78296394 4.78325649]
   1 ( 0.000  0.000 -0.500)   [-0.37086695 -0.25526631  0.17481683  0.17494387] [1.15342354 1.16988777 1.16994299 1.40384874 1.71092114 1.82284534
 1.85600281 1.85615989 2.13413568 2.13415832 3.01188628 3.13044165
 3.13051345 3.15960851 3.15961701 3.32348793 3.67521419 3.67535824
 3.81047697 3.81069432 5.20018399 9.89335251]
    CPU time for vj and vk      5.91 sec, wall time      0.19 sec
E1 = (4.435144093755834+5.939838210760499e-18j)  E_coul = (-2.2291942289149698-2.669212222746838e-18j)
cycle= 2 E= -10.5811792807834  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      6.49 sec, wall time      0.21 sec
HOMO = 0.351269101363  LUMO = 1.01864381255
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65654813  0.28419447  0.28431519  0.3512691 ] [1.01864381 1.03829355 1.03829663 1.36476929 1.82396    1.82398066
 1.88273938 2.12800519 2.13556378 2.13560164 2.71993829 2.72009255
 2.72507592 3.564744   3.57066326 3.57077279 3.70814302 3.70820831
 4.22269165 4.7761296  4.78065645 4.78094406]
   1 ( 0.000  0.000 -0.500)   [-0.3760973  -0.26019456  0.17059778  0.17072943] [1.15183183 1.16898255 1.16903044 1.40676334 1.70611317 1.8170175
 1.85199038 1.85215139 2.13193298 2.13195223 3.00779113 3.12927773
 3.12937969 3.15464419 3.1546544  3.32350932 3.67358587 3.67372315
 3.80808124 3.80828926 5.19441823 9.86931802]
    CPU time for vj and vk      5.91 sec, wall time      0.19 sec
E1 = (4.43736005793411+6.103551139971673e-18j)  E_coul = (-2.23207462679143-2.6942794314494576e-18j)
cycle= 3 E= -10.5818437144816  delta_E= -0.000664  |g|= 0.00687  |ddm|= 0.997
    CPU time for cycle= 3      6.47 sec, wall time      0.21 sec
HOMO = 0.351515421084  LUMO = 1.01954193661
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65586834  0.28490098  0.28502024  0.35151542] [1.01954194 1.03932969 1.03933421 1.36573336 1.82433145 1.82435215
 1.88266093 2.12830704 2.13584164 2.13588122 2.72072702 2.72088229
 2.72589891 3.56506265 3.57084398 3.57095162 3.70879987 3.70886754
 4.22265626 4.77670497 4.78119635 4.78148207]
   1 ( 0.000  0.000 -0.500)   [-0.37562495 -0.2596226   0.17151367  0.17164556] [1.15231425 1.16960522 1.16965298 1.40688377 1.70670043 1.8179451
 1.85251298 1.8526746  2.13229379 2.13231326 3.00854051 3.12961514
 3.12971713 3.1556031  3.15561196 3.3236166  3.67377501 3.67391489
 3.80859194 3.80879858 5.19488538 9.87143628]
    CPU time for vj and vk      5.87 sec, wall time      0.19 sec
E1 = (4.437210693858408+6.032409362926484e-18j)  E_coul = (-2.231933940696936-2.6987780448156077e-18j)
cycle= 4 E= -10.5818523924628  delta_E= -8.68e-06  |g|= 0.000626  |ddm|= 0.112
    CPU time for cycle= 4      6.42 sec, wall time      0.21 sec
HOMO = 0.351483594171  LUMO = 1.01954263304
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65588566  0.28487404  0.28499351  0.35148359] [1.01954263 1.03933813 1.03934269 1.36568523 1.82433326 1.82435386
 1.88267326 2.12832527 2.13584647 2.13588595 2.7207146  2.7208696
 2.72588165 3.56506535 3.57084061 3.57094829 3.70880044 3.70886805
 4.2226394  4.77670638 4.78119439 4.78148017]
   1 ( 0.000  0.000 -0.500)   [-0.3756293  -0.25964466  0.17149996  0.17163207] [1.15228365 1.16961155 1.16965904 1.40688759 1.70669044 1.81791829
 1.8524995  1.85266107 2.1322877  2.13230704 3.00855054 3.12961291
 3.12971514 3.15559954 3.15560848 3.32362287 3.67377018 3.67390992
 3.80859383 3.80880037 5.19486856 9.8713548 ]
    CPU time for vj and vk      5.93 sec, wall time      0.19 sec
E1 = (4.437202414075448+6.019761092376461e-18j)  E_coul = (-2.2319257393733682-2.699471452269508e-18j)
cycle= 5 E= -10.5818524709222  delta_E= -7.85e-08  |g|= 6.95e-05  |ddm|= 0.0176
    CPU time for cycle= 5      6.48 sec, wall time      0.21 sec
HOMO = 0.351489516466  LUMO = 1.01954672663
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65588393  0.28487623  0.28499572  0.35148952] [1.01954673 1.03934113 1.0393457  1.36568335 1.82433427 1.82435484
 1.88267318 2.12832376 2.13584692 2.13588638 2.72071726 2.72087228
 2.72588512 3.56506623 3.57084126 3.57094892 3.70880209 3.7088697
 4.22263987 4.77670781 4.7811958  4.78148162]
   1 ( 0.000  0.000 -0.500)   [-0.37562781 -0.2596368   0.17150293  0.17163507] [1.15228148 1.169612   1.16965946 1.40688569 1.70669121 1.81792074
 1.85250147 1.85266306 2.1322919  2.13231124 3.00855552 3.12961257
 3.12971487 3.15560117 3.15561008 3.3236217  3.67376988 3.67390962
 3.80859506 3.80880162 5.19486947 9.87136174]
    CPU time for vj and vk      5.99 sec, wall time      0.19 sec
E1 = (4.437199433572799+6.023192398902719e-18j)  E_coul = (-2.231922759986832-2.6994649904004444e-18j)
Extra cycle  E= -10.5818524720383  delta_E= -1.12e-09  |g|= 2.78e-05  |ddm|= 0.00153
    CPU time for scf_cycle     51.10 sec, wall time      1.65 sec
    CPU time for SCF     57.59 sec, wall time      2.31 sec
converged SCF energy = -10.5818524720383
**** SCF Summaries ****
Total Energy =                         -10.581852472038273
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437199433572799
Two-electron Energy =                   -2.231922759986832
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93326
pop of  0 C 3s            0.00445
pop of  0 C 2px           1.00898
pop of  0 C 2py           1.00887
pop of  0 C 2pz           1.00909
pop of  0 C 3px           0.00168
pop of  0 C 3py           0.00168
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00997
pop of  0 C 3dyz          0.00998
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00997
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93331
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00914
pop of  1 C 2py           1.00927
pop of  1 C 2pz           1.00908
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00995
pop of  1 C 3dyz          0.00997
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00995
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00031
charge of    1C =     -0.00031
    CPU time for vj and vk      0.57 sec, wall time      0.02 sec
Traceback (most recent call last):
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/200/main.py", line 100, in <module>
    main(config)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/200/main.py", line 34, in main
    mf_s = k2s_scf(scf_obj)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/pyscf-forge-lnocc/pyscf/pbc/lno/tools.py", line 40, in k2s_scf
    mf = scf.RHF(scell, kpt=kpts[0]).rs_density_fit(auxbasis=kmf.with_df.auxbasis)
AttributeError: 'InterpolativeSeparableDensityFitting' object has no attribute 'auxbasis'
End time = Tue May 27 03:53:08 PM PDT 2025
