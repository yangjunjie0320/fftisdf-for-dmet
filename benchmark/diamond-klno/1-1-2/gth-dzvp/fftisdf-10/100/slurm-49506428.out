SLURMD_NODENAME = hpc-35-04
Start time = Wed May 14 11:30:21 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49506428/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49506428/

Running /resnick/groups/changroup/members/junjiey/fftisdf-with-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/100/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 100.0
density_fitting_method: fftisdf-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 1161, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 3375, selected grid size = 260
truncated values = 3.85e+01, estimated error = 4.33e-01
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>
<class 'fft.isdf.InterpolativeSeparableDensityFitting'> does not have attributes  blksize

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 260.
    CPU time for building inpv_kpt      0.14 sec, wall time      0.00 sec

Out-core version is used for eta_kpt.
disk space required: 1.01e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   1.01e-01 GB
memory needed for each k-point: 5.06e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]      6.46 sec, wall time      0.20 sec
    CPU time for building eta_kpt      8.00 sec, wall time      0.25 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      9.10 sec, wall time      0.29 sec
    CPU time for coul_kpt[ 2 / 2]      7.59 sec, wall time      0.27 sec
    CPU time for building coul_kpt     16.89 sec, wall time      0.57 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49506428/hdxwrp19


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49506428/tmp6aj6_pfb
max_memory 327680 MB (current use 312 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = None
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f54c69499c0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.15 sec, wall time      0.07 sec
E1 = (3.1148714996828013-1.5673139129093582e-31j)  E_coul = (-1.2377982003873935+1.2682074029519032e-17j)
init E= -10.9100558463288
    CPU time for initialize scf      5.53 sec, wall time      0.20 sec
HOMO = 0.710159390972  LUMO = 0.888051441248
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.19813922  0.6606386   0.71007721  0.71015939] [0.88805144 0.95746687 0.95752816 1.1793213  1.80065929 1.8006974
 1.87873538 2.07467256 2.09429576 2.09440747 2.63196962 2.63598299
 2.63615813 3.54991496 3.55031109 3.55263604 3.65112892 3.65116193
 4.21061339 4.72618383 4.72713368 4.72730735]
   1 ( 0.000  0.000 -0.500)   [-0.23634953 -0.02543263  0.59799611  0.59808502] [1.02671066 1.07279113 1.07283012 1.3703373  1.62491879 1.76440027
 1.82174486 1.82176477 2.11628489 2.11631009 2.9432407  3.05306823
 3.05313509 3.09661864 3.09669203 3.29741641 3.64893818 3.64905375
 3.75827812 3.75864346 5.12981825 9.60257639]
    CPU time for vj and vk      2.03 sec, wall time      0.06 sec
E1 = (4.379773302152375-1.6214767105302106e-17j)  E_coul = (-0.2802688757161446-2.6399186881104005e-18j)
cycle= 1 E= -8.68762471918801  delta_E= 2.22  |g|= 0.369  |ddm|= 8.98
    CPU time for cycle= 1      2.50 sec, wall time      0.08 sec
HOMO = 0.838359267567  LUMO = 1.02142956678
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18198375  0.76520261  0.76532101  0.83835927] [1.02142957 1.04402512 1.044029   1.37199335 1.82742088 1.82743902
 1.88141162 2.13115629 2.13863016 2.13869316 2.73139036 2.73158339
 2.73812015 3.56763485 3.57364321 3.57374902 3.71416653 3.71426327
 4.22649249 4.78154575 4.78646896 4.78676903]
   1 ( 0.000  0.000 -0.500)   [0.09849183 0.21862445 0.64940799 0.64954453] [1.15662349 1.17345551 1.17351334 1.40431731 1.71579995 1.828352
 1.85958551 1.85974645 2.13676976 2.13679133 3.01691509 3.13259446
 3.13268226 3.16603204 3.16605286 3.32465978 3.67685869 3.67702543
 3.81402457 3.81425491 5.20273743 9.90625649]
    CPU time for vj and vk      2.03 sec, wall time      0.06 sec
E1 = (4.44752500557592-1.5432188390370614e-17j)  E_coul = (-0.36306377383945176-2.659281970431765e-18j)
cycle= 2 E= -8.70266791388777  delta_E= -0.015  |g|= 0.0439  |ddm|= 7.58
    CPU time for cycle= 2      2.56 sec, wall time      0.08 sec
HOMO = 0.821286149771  LUMO = 1.01862423357
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18673591  0.7541202   0.75424155  0.82128615] [1.01862423 1.03843969 1.03844341 1.36469669 1.82402515 1.82404561
 1.8827282  2.12804892 2.13554168 2.13558065 2.72002469 2.72017848
 2.72517947 3.56482061 3.57071748 3.57082667 3.70829742 3.70836227
 4.22252986 4.7762135  4.78075728 4.781046  ]
   1 ( 0.000  0.000 -0.500)   [0.09358227 0.20973076 0.64056977 0.64070262] [1.15190232 1.16913945 1.16918638 1.40695127 1.70624299 1.81706244
 1.85193367 1.85209605 2.13202037 2.13203926 3.0078244  3.12935024
 3.1294565  3.15476198 3.15477117 3.32349549 3.67359466 3.67373624
 3.80816945 3.80837885 5.19429963 9.86911294]
    CPU time for vj and vk      2.08 sec, wall time      0.07 sec
E1 = (4.43618670705448-1.5195331241056846e-17j)  E_coul = (-0.35192636512003633-2.678321067762119e-18j)
cycle= 3 E= -8.7028688036898  delta_E= -0.000201  |g|= 0.00394  |ddm|=  1.4
    CPU time for cycle= 3      2.63 sec, wall time      0.08 sec
HOMO = 0.821257445311  LUMO = 1.01957337213
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18611554  0.75464538  0.75476481  0.82125745] [1.01957337 1.03936048 1.03936514 1.36568392 1.82434462 1.82436514
 1.88268241 2.12833742 2.13586011 2.13589963 2.72075077 2.72090591
 2.72592642 3.56507528 3.57084952 3.57095712 3.7088169  3.7088845
 4.22265542 4.77672204 4.78121076 4.78149742]
   1 ( 0.000  0.000 -0.500)   [0.09412871 0.2101453  0.64127295 0.641405  ] [1.15228619 1.16961348 1.16966106 1.4068737  1.70671135 1.81797084
 1.85252416 1.85268587 2.13232967 2.13234911 3.00859184 3.12961289
 3.12971535 3.15562744 3.15563628 3.32361527 3.67377446 3.67391428
 3.80860942 3.80881633 5.19489173 9.87147013]
    CPU time for vj and vk      2.04 sec, wall time      0.06 sec
E1 = (4.43724133913046-1.5213442543883273e-17j)  E_coul = (-0.3529830032931394-2.67477968900967e-18j)
cycle= 4 E= -8.70287080978692  delta_E= -2.01e-06  |g|= 0.00028  |ddm|= 0.107
    CPU time for cycle= 4      2.59 sec, wall time      0.08 sec
HOMO = 0.821233186415  LUMO = 1.01954942641
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18613741  0.75462384  0.75474334  0.82123319] [1.01954943 1.0393424  1.03934698 1.36568448 1.82433551 1.82435607
 1.88267306 2.12832559 2.13584715 2.1358866  2.72071972 2.72087469
 2.72588634 3.56506651 3.57084193 3.57094938 3.70880272 3.70887035
 4.22264064 4.77670912 4.78119579 4.78148201]
   1 ( 0.000  0.000 -0.500)   [0.09412044 0.21010819 0.64125054 0.6413827 ] [1.15228113 1.16961349 1.16966092 1.40688479 1.7066927  1.81791985
 1.85250258 1.85266415 2.13229097 2.1323103  3.00855679 3.12961379
 3.12971608 3.15560324 3.15561206 3.32362409 3.67377083 3.67391056
 3.80859654 3.8088033  5.19487197 9.87136915]
    CPU time for vj and vk      2.04 sec, wall time      0.06 sec
E1 = (4.437199367548713-1.5209713179396515e-17j)  E_coul = (-0.3529410404244318-2.6754717494187305e-18j)
cycle= 5 E= -8.70287081849996  delta_E= -8.71e-09  |g|= 0.000116  |ddm|= 0.00761
    CPU time for cycle= 5      2.59 sec, wall time      0.08 sec
HOMO = 0.821235768189  LUMO = 1.01954777207
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.18613849  0.75462164  0.75474114  0.82123577] [1.01954777 1.03934177 1.03934634 1.36568202 1.82433443 1.82435499
 1.88267342 2.12832378 2.13584729 2.13588675 2.72071767 2.72087264
 2.72588584 3.56506638 3.57084157 3.570949   3.70880245 3.70887007
 4.22263965 4.77670847 4.78119528 4.78148148]
   1 ( 0.000  0.000 -0.500)   [0.09411747 0.21011051 0.64124854 0.6413807 ] [1.15228008 1.16961199 1.16965943 1.40688528 1.70669106 1.81792129
 1.85250183 1.85266342 2.13229317 2.13231248 3.00855733 3.12961224
 3.12971464 3.15560168 3.15561041 3.32362128 3.67376952 3.67390931
 3.80859533 3.8088021  5.19486967 9.87136238]
    CPU time for vj and vk      2.02 sec, wall time      0.06 sec
E1 = (4.437198234447216-1.5209070083240602e-17j)  E_coul = (-0.35293990392162794-2.675003859416196e-18j)
Extra cycle  E= -8.70287081509865  delta_E= 3.4e-09  |g|= 0.000195  |ddm|= 0.00127
    CPU time for scf_cycle     20.97 sec, wall time      0.68 sec
    CPU time for SCF     22.03 sec, wall time      1.59 sec
converged SCF energy = -8.70287081509865
**** SCF Summaries ****
Total Energy =                          -8.702870815098652
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437198234447216
Two-electron Energy =                   -0.352939903921628
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93327
pop of  0 C 3s            0.00445
pop of  0 C 2px           1.00903
pop of  0 C 2py           1.00891
pop of  0 C 2pz           1.00915
pop of  0 C 3px           0.00168
pop of  0 C 3py           0.00168
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00997
pop of  0 C 3dyz          0.00998
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00997
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93330
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00909
pop of  1 C 2py           1.00923
pop of  1 C 2pz           1.00902
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00995
pop of  1 C 3dyz          0.00997
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00995
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00014
charge of    1C =     -0.00014
    CPU time for vj and vk      0.17 sec, wall time      0.01 sec
K2Gamma: found kmesh= [1, 1, 2]
K2Gamma: F_g.imag= 8.9e-13

WARN: ECP/PP is used. MINAO is not a good reference AO basis in IAO.


******** <class 'klno.KLNOCCSD'> ********
nocc = 8, nmo = 52
max_memory 327680 MB (current use 535 MB)
thresh_occ = 1.000000e-04
thresh_vir = 1.000000e-04
force_outcore_ao2mo = False
_Lov = None
_Lov_to_save = None
nkpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
no_type = rr
Using user input LOs
LOs span occupied space plus some virtual space.
Using user input LO-fragment assignment
nfrag = 10  nlo = 20
frag_atmlist = None
frag_lolist = [[0], [1], [2], [3], [4], [5], [6], [7], [8], [9]]
frag_wghtlist = [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
frag_nonvlist = None
    CPU time for LO and fragment        0.02 sec, wall time      0.00 sec

WARN: Input vhf is not found. Building vhf from SCF MO.

    CPU time for make pno               0.37 sec, wall time      0.01 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                2.53 sec, wall time      0.08 sec
    CPU time for Fragment 1             2.91 sec, wall time      0.09 sec
Fragment 1  E_corr(MP2) = -5.45803385106327e-05  E_corr(CCSD) = -7.20085339922349e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.23 sec, wall time      0.01 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol                4.49 sec, wall time      0.14 sec
    CPU time for Fragment 2             4.72 sec, wall time      0.15 sec
Fragment 2  E_corr(MP2) = -0.00888016620651175  E_corr(CCSD) = -0.0122852216472574  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.22 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               19.71 sec, wall time      0.62 sec
    CPU time for Fragment 3            19.94 sec, wall time      0.63 sec
Fragment 3  E_corr(MP2) = -0.015983799666111  E_corr(CCSD) = -0.0222057769266491  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.55 sec, wall time      0.02 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               19.81 sec, wall time      0.62 sec
    CPU time for Fragment 4            20.36 sec, wall time      0.64 sec
Fragment 4  E_corr(MP2) = -0.0159866564283651  E_corr(CCSD) = -0.0222062758070256  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.50 sec, wall time      0.02 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               19.66 sec, wall time      0.62 sec
    CPU time for Fragment 5            20.16 sec, wall time      0.63 sec
Fragment 5  E_corr(MP2) = -0.0159841555438029  E_corr(CCSD) = -0.0222068830473356  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.21 sec, wall time      0.01 sec
    impsol:  1 LOs  9/52 MOs  1 occ  8 vir
    CPU time for imp sol                6.07 sec, wall time      0.19 sec
    CPU time for Fragment 6             6.28 sec, wall time      0.20 sec
Fragment 6  E_corr(MP2) = -5.45448643527563e-05  E_corr(CCSD) = -7.19650858427699e-05  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.22 sec, wall time      0.01 sec
    impsol:  1 LOs  12/52 MOs  4 occ  8 vir
    CPU time for imp sol                4.72 sec, wall time      0.15 sec
    CPU time for Fragment 7             4.94 sec, wall time      0.16 sec
Fragment 7  E_corr(MP2) = -0.008880712822624  E_corr(CCSD) = -0.0122848397635181  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.26 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               19.35 sec, wall time      0.61 sec
    CPU time for Fragment 8            19.61 sec, wall time      0.62 sec
Fragment 8  E_corr(MP2) = -0.0159883988410202  E_corr(CCSD) = -0.0222112739137791  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.18 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               19.32 sec, wall time      0.61 sec
    CPU time for Fragment 9            19.51 sec, wall time      0.61 sec
Fragment 9  E_corr(MP2) = -0.015990769563095  E_corr(CCSD) = -0.0222129294430938  E_corr(CCSD(T)) = 0
    CPU time for make pno               0.18 sec, wall time      0.01 sec
    impsol:  1 LOs  14/52 MOs  5 occ  9 vir
    CPU time for imp sol               20.05 sec, wall time      0.63 sec
    CPU time for Fragment 10           20.23 sec, wall time      0.63 sec
Fragment 10  E_corr(MP2) = -0.0159862203839535  E_corr(CCSD) = -0.0222054011129695  E_corr(CCSD(T)) = 0
    CPU time for KLNOCCSD             141.18 sec, wall time      4.45 sec
E(LNOMP2) = -8.816660819757  E_corr = -0.113790004658347
E(LNOCCSD) = -8.86083339038012  E_corr = -0.157962575281463
Summary by spin components
LNOMP2   Ess = -0.0152071849049569  Eos = -0.0985828197533899  Escs = -0.123363376277419
LNOCCSD  Ess = -0.0154857705608162  Eos = -0.142476804720647  Escs = -0.176128927261528
End time = Wed May 14 11:30:31 PM PDT 2025
