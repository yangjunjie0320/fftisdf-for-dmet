SLURMD_NODENAME = hpc-35-02
Start time = Tue May 27 03:52:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49851873/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49851873/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/100/main.py with:
name: diamond
xc: None
kmesh: 1-1-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 100.0
density_fitting_method: fftisdf-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 1161, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 3375, selected grid size = 260
truncated values = 3.85e+01, estimated error = 4.33e-01
Big error detected in the electron number of initial guess density matrix (Ne/cell = 9.70107)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.60121
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.46626
pop of  0 C 2py           0.46626
pop of  0 C 2pz           0.46626
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.60121
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.46626
pop of  1 C 2py           0.46626
pop of  1 C 2pz           0.46626
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 2
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 260.
    CPU time for building inpv_kpt      0.14 sec, wall time      0.00 sec

Out-core version is used for eta_kpt.
disk space required: 1.01e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   1.01e-01 GB
memory needed for each k-point: 5.06e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]      6.53 sec, wall time      0.20 sec
    CPU time for building eta_kpt      8.07 sec, wall time      0.25 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 2]      8.95 sec, wall time      0.28 sec
    CPU time for coul_kpt[ 2 / 2]      7.95 sec, wall time      0.29 sec
    CPU time for building coul_kpt     17.10 sec, wall time      0.58 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49851873/gfodt47x


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49851873/tmptb8u8a56
max_memory 327680 MB (current use 309 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.4697454136653238
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.87898165466
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fe0fa7f00d0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.39 sec, wall time      0.08 sec
E1 = (3.1148714996828013+1.5945797766170945e-18j)  E_coul = (-5.359667159058361+1.2682074029519041e-17j)
init E= -15.0319248049998
    CPU time for initialize scf      5.85 sec, wall time      0.21 sec
HOMO = 0.634554188138  LUMO = 0.835948339939
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.95467455  0.5852655   0.6344712   0.63455419] [0.83594834 0.90521675 0.9052774  1.12026813 1.8006589  1.80069703
 1.86327495 2.07374936 2.09371253 2.09382408 2.6305991  2.63481144
 2.63498734 3.54979269 3.55018858 3.55253174 3.65112855 3.65116157
 4.20870308 4.72614494 4.72709781 4.72727202]
   1 ( 0.000  0.000 -0.500)   [-0.84751252 -0.56900391  0.50105413  0.50114314] [0.96417044 1.03465272 1.03469353 1.3506707  1.6189141  1.75434939
 1.81735029 1.8173713  2.11622034 2.11624566 2.94269785 3.05297613
 3.05304262 3.096519   3.09659228 3.29655692 3.64876701 3.64888243
 3.75824014 3.75860538 5.1291342  9.60198539]
    CPU time for vj and vk      2.41 sec, wall time      0.08 sec
E1 = (4.411629236047204-1.1724374463956224e-17j)  E_coul = (-2.192470000298931-2.654722861016159e-18j)
cycle= 1 E= -10.567969909876  delta_E= 4.46  |g|= 0.33  |ddm|= 8.55
    CPU time for cycle= 1      2.85 sec, wall time      0.09 sec
HOMO = 0.365527770192  LUMO = 1.01783071675
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65432516  0.29034648  0.29045796  0.36552777] [1.01783072 1.03927591 1.03928415 1.36674959 1.82547507 1.82549092
 1.88196998 2.12847204 2.13614071 2.13619604 2.7257909  2.72597439
 2.73256208 3.56566887 3.57194812 3.57205733 3.71003743 3.7101356
 4.22702107 4.77800723 4.78296323 4.78325609]
   1 ( 0.000  0.000 -0.500)   [-0.37086695 -0.25526631  0.17481683  0.17494387] [1.15342353 1.16988778 1.16994299 1.40384872 1.71092114 1.82284533
 1.8560028  1.85615987 2.13413569 2.13415833 3.01188627 3.13044166
 3.13051348 3.15960851 3.15961705 3.32348794 3.6752141  3.6753582
 3.81047694 3.81069454 5.2001842  9.89335264]
    CPU time for vj and vk      2.49 sec, wall time      0.08 sec
E1 = (4.435144086936786-1.3520943938214525e-17j)  E_coul = (-2.229194224598178-2.6542774268638542e-18j)
cycle= 2 E= -10.5811792832856  delta_E= -0.0132  |g|= 0.0652  |ddm|=  5.7
    CPU time for cycle= 2      3.02 sec, wall time      0.10 sec
HOMO = 0.351269100097  LUMO = 1.01864381362
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65654813  0.28419447  0.28431519  0.3512691 ] [1.01864381 1.03829355 1.03829663 1.36476929 1.82396    1.82398066
 1.88273936 2.12800516 2.1355638  2.13560167 2.71993824 2.72009245
 2.72507596 3.5647439  3.57066343 3.57077275 3.70814299 3.7082083
 4.22269154 4.77612988 4.78065564 4.78094365]
   1 ( 0.000  0.000 -0.500)   [-0.3760973  -0.26019456  0.17059778  0.17072943] [1.15183182 1.16898256 1.16903043 1.40676332 1.70611318 1.81701749
 1.85199037 1.85215137 2.131933   2.13195223 3.00779112 3.12927774
 3.12937972 3.15464427 3.15465435 3.32350931 3.67358579 3.67372309
 3.80808122 3.80828944 5.19441847 9.86931815]
    CPU time for vj and vk      2.45 sec, wall time      0.08 sec
E1 = (4.437360050295151-1.3714236954460899e-17j)  E_coul = (-2.2320746216334246-2.6714461775909756e-18j)
cycle= 3 E= -10.5818437169625  delta_E= -0.000664  |g|= 0.00687  |ddm|= 0.997
    CPU time for cycle= 3      3.00 sec, wall time      0.10 sec
HOMO = 0.351515419946  LUMO = 1.0195419377
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65586834  0.28490098  0.28502024  0.35151542] [1.01954194 1.03932969 1.03933421 1.36573336 1.82433145 1.82435215
 1.88266092 2.12830701 2.13584166 2.13588125 2.72072697 2.72088219
 2.72589895 3.56506255 3.57084416 3.57095158 3.70879985 3.70886753
 4.22265615 4.77670525 4.78119555 4.78148164]
   1 ( 0.000  0.000 -0.500)   [-0.37562495 -0.2596226   0.17151367  0.17164556] [1.15231424 1.16960523 1.16965298 1.40688375 1.70670043 1.81794509
 1.85251297 1.85267458 2.13229381 2.13231326 3.0085405  3.12961515
 3.12971715 3.15560318 3.15561191 3.32361659 3.67377492 3.67391483
 3.80859191 3.80879876 5.19488562 9.8714364 ]
    CPU time for vj and vk      2.50 sec, wall time      0.08 sec
E1 = (4.437210686315636-1.3706871366328555e-17j)  E_coul = (-2.2319339356350323-2.6747563053332007e-18j)
cycle= 4 E= -10.5818523949436  delta_E= -8.68e-06  |g|= 0.000626  |ddm|= 0.112
    CPU time for cycle= 4      3.06 sec, wall time      0.10 sec
HOMO = 0.351483593042  LUMO = 1.0195426341
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65588566  0.28487404  0.28499351  0.35148359] [1.01954263 1.03933813 1.03934269 1.36568522 1.82433326 1.82435386
 1.88267325 2.12832524 2.13584649 2.13588598 2.72071455 2.72086951
 2.72588168 3.56506525 3.57084078 3.57094824 3.70880042 3.70886804
 4.22263929 4.77670666 4.78119359 4.78147974]
   1 ( 0.000  0.000 -0.500)   [-0.3756293  -0.25964466  0.17149996  0.17163207] [1.15228364 1.16961155 1.16965903 1.40688757 1.70669045 1.81791828
 1.85249948 1.85266105 2.13228772 2.13230704 3.00855052 3.12961292
 3.12971516 3.15559961 3.15560843 3.32362287 3.67377009 3.67390986
 3.8085938  3.80880055 5.1948688  9.87135492]
    CPU time for vj and vk      2.35 sec, wall time      0.08 sec
E1 = (4.437202406528792-1.3708035434468793e-17j)  E_coul = (-2.23192573430754-2.6753655850792907e-18j)
cycle= 5 E= -10.581852473403  delta_E= -7.85e-08  |g|= 6.95e-05  |ddm|= 0.0176
    CPU time for cycle= 5      2.92 sec, wall time      0.10 sec
HOMO = 0.351489515331  LUMO = 1.01954672769
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65588393  0.28487624  0.28499573  0.35148952] [1.01954673 1.03934113 1.0393457  1.36568334 1.82433427 1.82435484
 1.88267317 2.12832373 2.13584694 2.1358864  2.72071721 2.72087218
 2.72588516 3.56506613 3.57084143 3.57094888 3.70880207 3.70886969
 4.22263976 4.77670809 4.781195   4.7814812 ]
   1 ( 0.000  0.000 -0.500)   [-0.37562781 -0.2596368   0.17150293  0.17163507] [1.15228146 1.169612   1.16965945 1.40688568 1.70669122 1.81792072
 1.85250146 1.85266304 2.13229192 2.13231124 3.00855551 3.12961258
 3.1297149  3.15560125 3.15561003 3.3236217  3.67376979 3.67390957
 3.80859504 3.8088018  5.19486971 9.87136186]
    CPU time for vj and vk      2.35 sec, wall time      0.08 sec
E1 = (4.437199426025423-1.3709727046113217e-17j)  E_coul = (-2.2319227549202756-2.6753569197642423e-18j)
Extra cycle  E= -10.5818524745191  delta_E= -1.12e-09  |g|= 2.78e-05  |ddm|= 0.00153
    CPU time for scf_cycle     23.57 sec, wall time      0.79 sec
    CPU time for SCF     30.12 sec, wall time      1.16 sec
converged SCF energy = -10.5818524745191
**** SCF Summaries ****
Total Energy =                         -10.581852474519092
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.437199426025423
Two-electron Energy =                   -2.231922754920276
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.93326
pop of  0 C 3s            0.00445
pop of  0 C 2px           1.00898
pop of  0 C 2py           1.00887
pop of  0 C 2pz           1.00909
pop of  0 C 3px           0.00168
pop of  0 C 3py           0.00168
pop of  0 C 3pz           0.00169
pop of  0 C 3dxy          0.00997
pop of  0 C 3dyz          0.00998
pop of  0 C 3dz^2         0.00004
pop of  0 C 3dxz          0.00997
pop of  0 C 3dx2-y2       0.00004
pop of  1 C 2s            0.93331
pop of  1 C 3s            0.00446
pop of  1 C 2px           1.00914
pop of  1 C 2py           1.00927
pop of  1 C 2pz           1.00908
pop of  1 C 3px           0.00170
pop of  1 C 3py           0.00170
pop of  1 C 3pz           0.00170
pop of  1 C 3dxy          0.00995
pop of  1 C 3dyz          0.00997
pop of  1 C 3dz^2         0.00004
pop of  1 C 3dxz          0.00995
pop of  1 C 3dx2-y2       0.00004
 ** Mulliken atomic charges  **
charge of    0C =      0.00031
charge of    1C =     -0.00031
    CPU time for vj and vk      0.55 sec, wall time      0.02 sec
Traceback (most recent call last):
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/100/main.py", line 100, in <module>
    main(config)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-1-2/gth-dzvp/fftisdf-10/100/main.py", line 34, in main
    mf_s = k2s_scf(scf_obj)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/pyscf-forge-lnocc/pyscf/pbc/lno/tools.py", line 40, in k2s_scf
    mf = scf.RHF(scell, kpt=kpts[0]).rs_density_fit(auxbasis=kmf.with_df.auxbasis)
AttributeError: 'InterpolativeSeparableDensityFitting' object has no attribute 'auxbasis'
End time = Tue May 27 03:53:03 PM PDT 2025
