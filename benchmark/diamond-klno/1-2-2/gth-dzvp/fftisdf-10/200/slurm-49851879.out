SLURMD_NODENAME = hpc-52-31
Start time = Tue May 27 03:52:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49851879/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49851879/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-10/200/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 200.0
density_fitting_method: fftisdf-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 2029, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 3375, selected grid size = 260
truncated values = 6.42e+01, estimated error = 2.35e+00
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 260.
    CPU time for building inpv_kpt      0.19 sec, wall time      0.01 sec

Out-core version is used for eta_kpt.
disk space required: 5.98e-01 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   5.98e-01 GB
memory needed for each k-point: 1.49e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     15.14 sec, wall time      1.17 sec
    CPU time for building eta_kpt     19.43 sec, wall time      1.31 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      6.24 sec, wall time      0.67 sec
    CPU time for coul_kpt[ 2 / 4]      1.87 sec, wall time      0.64 sec
    CPU time for coul_kpt[ 3 / 4]      1.78 sec, wall time      0.63 sec
    CPU time for coul_kpt[ 4 / 4]      1.78 sec, wall time      0.64 sec
    CPU time for building coul_kpt     11.95 sec, wall time      2.59 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49851879/hbovjj1h


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49851879/tmpt73u4rpe
max_memory 327680 MB (current use 422 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f1f561f00d0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      6.78 sec, wall time      0.22 sec
E1 = (3.6045119533019325-1.179933654894098e-17j)  E_coul = (-4.237891674810131+8.773317124399649e-18j)
init E= -13.4205088671324
    CPU time for initialize scf     19.88 sec, wall time      0.65 sec
HOMO = 0.642156648377  LUMO = 0.776555232709
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97408926  0.60525943  0.6092327   0.64215665] [0.8597983  0.88579657 0.91018228 1.12508181 1.79088174 1.80518002
 1.86213171 2.08324014 2.0871976  2.09907215 2.64574465 2.64766098
 2.64898968 3.55329445 3.55399247 3.55479798 3.6596077  3.66034024
 4.20993972 4.73471514 4.73530972 4.7355905 ]
   1 ( 0.000  0.000 -0.500)   [-0.77997631 -0.50845106  0.46133316  0.50286817] [0.94784876 1.0214569  1.04033484 1.35347409 1.62937885 1.75598584
 1.81459998 1.82397709 2.11254806 2.1193131  2.95649011 3.06731775
 3.06852069 3.10239217 3.10325505 3.30392992 3.64907239 3.65337145
 3.76741326 3.76762095 5.1390063  9.64988163]
   2 (-0.000 -0.500  0.000)   [-0.78001683 -0.50844096  0.4612815   0.50284729] [0.94784035 1.02149523 1.04031113 1.35347557 1.62933593 1.7560284
 1.81463049 1.8242341  2.1126253  2.11920895 2.95654289 3.06741824
 3.06839989 3.1024032  3.10314918 3.30379836 3.6492757  3.65323356
 3.76729113 3.76788449 5.13903083 9.64991173]
   3 ( 0.000 -0.500 -0.500)   [-0.41677503 -0.40445901  0.22474242  0.3106603 ] [0.77655523 0.84141172 1.40154795 1.40350176 1.67773992 1.68166155
 2.07037472 2.0759076  2.31223587 2.31461783 2.79337563 2.80063426
 2.87049937 2.87949485 2.95496314 2.95594248 3.67420724 3.67552251
 5.04699671 5.04748022 6.809179   6.81444322]
    CPU time for vj and vk      6.68 sec, wall time      0.21 sec
E1 = (4.197961004254193-1.0063371063741081e-17j)  E_coul = (-2.2325626065522535-2.489531327373118e-19j)
cycle= 1 E= -10.8217307479223  delta_E=  2.6  |g|= 0.446  |ddm|= 14.9
    CPU time for cycle= 1      7.20 sec, wall time      0.23 sec
HOMO = 0.352199380006  LUMO = 0.898317897961
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67154896  0.30145588  0.34064373  0.35219938] [0.97849448 0.99126861 1.01474419 1.33228425 1.80541039 1.8059552
 1.88419786 2.11977123 2.12169533 2.1251644  2.70801368 2.71163374
 2.71196322 3.56368182 3.5653907  3.57015368 3.69769167 3.70499647
 4.22156924 4.77093616 4.77254436 4.77449654]
   1 ( 0.000  0.000 -0.500)   [-0.39607187 -0.25659125  0.18702928  0.22272031] [1.09294416 1.10494442 1.15037861 1.396989   1.68419872 1.81159623
 1.84719628 1.85162265 2.11918763 2.12589181 3.00546795 3.12340797
 3.12509751 3.13795661 3.14082982 3.32126329 3.66783016 3.66814967
 3.79991734 3.80623569 5.18609678 9.83351881]
   2 (-0.000 -0.500  0.000)   [-0.39606485 -0.25653615  0.18702202  0.22265121] [1.09293434 1.10498879 1.15038181 1.3970384  1.68424036 1.8115913
 1.847119   1.85181251 2.11922061 2.12573742 3.00538634 3.1234522
 3.12485388 3.13803249 3.14072771 3.32116004 3.66786935 3.66797787
 3.79995936 3.80658091 5.18601693 9.83353555]
   3 ( 0.000 -0.500 -0.500)   [-0.25540878 -0.25112269  0.03949034  0.07506643] [0.8983179  0.95906108 1.5026989  1.51000788 1.74945103 1.76461832
 2.07044798 2.07224671 2.32314609 2.3306953  2.8433276  2.8512106
 2.8848308  2.8851521  2.98373184 2.9872527  3.73236328 3.73345404
 5.07585082 5.07875127 6.89805687 6.8988725 ]
    CPU time for vj and vk      6.76 sec, wall time      0.22 sec
E1 = (4.194305225960404-1.1423297159716668e-17j)  E_coul = (-2.2413967918998603+1.2443292796438293e-19j)
cycle= 2 E= -10.8342207115637  delta_E= -0.0125  |g|= 0.0896  |ddm|= 4.38
    CPU time for cycle= 2      7.40 sec, wall time      0.24 sec
HOMO = 0.346016057632  LUMO = 0.903532636195
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66963699  0.29994893  0.33512403  0.34601606] [0.98169618 0.99573004 1.01711785 1.3386999  1.80527089 1.80610619
 1.88502548 2.12040441 2.12280675 2.12620319 2.70734776 2.71023983
 2.71095439 3.56383403 3.56577479 3.56974515 3.69900257 3.70592306
 4.21946588 4.77195424 4.77317915 4.77503243]
   1 ( 0.000  0.000 -0.500)   [-0.39575039 -0.25765267  0.18684659  0.21790695] [1.09766239 1.10842774 1.15156871 1.39883632 1.68494919 1.8120157
 1.84618867 1.85174328 2.1191975  2.12566478 3.00616958 3.12406677
 3.12529234 3.13865856 3.14104892 3.32178573 3.66744026 3.668459
 3.80030356 3.80622416 5.18494715 9.82825661]
   2 (-0.000 -0.500  0.000)   [-0.39575023 -0.25758206  0.18684176  0.21782041] [1.09765481 1.10846416 1.15157497 1.39888392 1.68499254 1.81202411
 1.84610676 1.85192129 2.11923769 2.12552342 3.00609161 3.12410357
 3.12505301 3.13873654 3.1409631  3.32169167 3.66754998 3.66819416
 3.80034087 3.80655156 5.18487743 9.82827146]
   3 ( 0.000 -0.500 -0.500)   [-0.25624047 -0.25196637  0.04001711  0.07056282] [0.90353264 0.95982509 1.50630936 1.51278952 1.75050622 1.76455327
 2.06996543 2.07161306 2.32335525 2.33115957 2.84331033 2.85154541
 2.88490418 2.88528794 2.98351148 2.98729489 3.7338328  3.73454985
 5.07588367 5.07811652 6.89484423 6.89623656]
    CPU time for vj and vk      6.78 sec, wall time      0.22 sec
E1 = (4.193549163789613-1.15978064851622e-17j)  E_coul = (-2.241235802127402+2.34828380748225e-19j)
cycle= 3 E= -10.834815783962  delta_E= -0.000595  |g|= 0.00536  |ddm|= 0.858
    CPU time for cycle= 3      7.46 sec, wall time      0.24 sec
HOMO = 0.346360282943  LUMO = 0.903840323974
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66913358  0.30032859  0.33528437  0.34636028] [0.98218092 0.99631444 1.01756869 1.33928135 1.80547557 1.80628544
 1.88489312 2.12055589 2.12290376 2.12635385 2.70774442 2.71059249
 2.71139745 3.56394021 3.56591942 3.56978197 3.69931939 3.70619796
 4.21952068 4.77223284 4.77342927 4.77526891]
   1 ( 0.000  0.000 -0.500)   [-0.39514445 -0.25730743  0.18731555  0.21815758] [1.09808026 1.10889291 1.15176382 1.39890951 1.68509288 1.81239508
 1.84640803 1.85198344 2.11940769 2.1257427  3.00652033 3.12430686
 3.1254437  3.13917085 3.14151191 3.32190189 3.6675297  3.66859621
 3.80053276 3.80643525 5.18526518 9.82952284]
   2 (-0.000 -0.500  0.000)   [-0.39514223 -0.25724042  0.18731066  0.21807114] [1.09807574 1.10893054 1.15176848 1.39895732 1.68513872 1.81240053
 1.84632619 1.85216154 2.11944533 2.12559774 3.00643896 3.12434619
 3.12520509 3.13924843 3.14142655 3.32181057 3.66763761 3.6683344
 3.80056943 3.80676291 5.18519549 9.82953848]
   3 ( 0.000 -0.500 -0.500)   [-0.25574399 -0.25155372  0.04044218  0.07083883] [0.90384032 0.95981986 1.50709416 1.51357499 1.75080141 1.7648301
 2.07005306 2.07162377 2.32346668 2.33139606 2.84366015 2.85184086
 2.88494227 2.88540917 2.98371516 2.98752328 3.73415106 3.73501187
 5.0761285  5.07830105 6.89537979 6.89693382]
    CPU time for vj and vk      6.85 sec, wall time      0.22 sec
E1 = (4.193576873380883-1.160684344750985e-17j)  E_coul = (-2.2412662026685353+2.406960354777406e-19j)
cycle= 4 E= -10.8348184749119  delta_E= -2.69e-06  |g|= 0.000625  |ddm|= 0.103
    CPU time for cycle= 4      7.47 sec, wall time      0.24 sec
HOMO = 0.346316709525  LUMO = 0.903827393238
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66918601  0.30027159  0.33520892  0.34631671] [0.98215751 0.99628118 1.01753323 1.33922681 1.80546339 1.80626287
 1.88490653 2.12054633 2.1228827  2.12634118 2.70768858 2.71053495
 2.71135071 3.56392812 3.5659086  3.56976385 3.69929055 3.70616799
 4.21950381 4.77220891 4.77340112 4.77524017]
   1 ( 0.000  0.000 -0.500)   [-0.39516475 -0.25737569  0.18726727  0.21809312] [1.09803881 1.10886437 1.15173974 1.39891486 1.68506384 1.812355
 1.84636494 1.85194677 2.11940048 2.12571806 3.00648897 3.12429535
 3.12542652 3.13911971 3.14145745 3.32189413 3.66751085 3.6685873
 3.80050026 3.80640246 5.18522722 9.82934929]
   2 (-0.000 -0.500  0.000)   [-0.39516275 -0.25730824  0.18726245  0.2180062 ] [1.09803413 1.10890178 1.15174452 1.39896271 1.68510982 1.812361
 1.84628286 1.85212492 2.11943846 2.12557348 3.00640789 3.12433429
 3.12518811 3.13919729 3.14137207 3.32180269 3.66761837 3.6683254
 3.80053682 3.80672987 5.1851575  9.82936487]
   3 ( 0.000 -0.500 -0.500)   [-0.2558014  -0.25160906  0.04039099  0.07080163] [0.90382739 0.95981133 1.50704313 1.5135433  1.75073472 1.7647702
 2.07003719 2.07161176 2.32344409 2.33137314 2.84361966 2.85179741
 2.88492879 2.88541001 2.98368367 2.98750462 3.73410831 3.7349755
 5.07610549 5.07827309 6.89528622 6.89685976]
    CPU time for vj and vk      6.77 sec, wall time      0.22 sec
E1 = (4.193598278650915-1.1609051217919446e-17j)  E_coul = (-2.2412876551981773+2.4064152108225416e-19j)
cycle= 5 E= -10.8348185221715  delta_E= -4.73e-08  |g|= 0.000109  |ddm|= 0.00986
    CPU time for cycle= 5      7.64 sec, wall time      0.24 sec
HOMO = 0.34632327733  LUMO = 0.903828413207
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66918369  0.30027204  0.33520895  0.34632328] [0.98215868 0.99628238 1.01753371 1.33922804 1.80546391 1.8062634
 1.88490559 2.12054589 2.12288186 2.12634179 2.70768934 2.71053604
 2.71135356 3.56392855 3.56590913 3.56976365 3.69929111 3.70616845
 4.21950469 4.7722096  4.77340151 4.77524064]
   1 ( 0.000  0.000 -0.500)   [-0.39515974 -0.25737339  0.18726792  0.21809364] [1.09803924 1.10886555 1.151739   1.39891407 1.68506479 1.81235691
 1.8463653  1.85194774 2.11940322 2.12571821 3.00649086 3.12429619
 3.12542654 3.13912089 3.1414581  3.321894   3.6675106  3.66858818
 3.80050003 3.80640265 5.18522869 9.82935566]
   2 (-0.000 -0.500  0.000)   [-0.39515772 -0.25730598  0.1872631   0.21800673] [1.0980346  1.10890298 1.15174377 1.39896194 1.68511078 1.81236288
 1.84628321 1.85212589 2.11944118 2.1255736  3.00640975 3.12433522
 3.12518808 3.13919841 3.14137276 3.32180259 3.66761812 3.6683263
 3.80053658 3.80673007 5.18515898 9.82937124]
   3 ( 0.000 -0.500 -0.500)   [-0.25579828 -0.2516084   0.04039199  0.07080549] [0.90382841 0.95981083 1.50704422 1.51354761 1.75073492 1.76476841
 2.07003796 2.07161192 2.32344354 2.33137449 2.84362064 2.85179777
 2.88493054 2.88540859 2.98368401 2.98750601 3.73410814 3.73497714
 5.07610655 5.07827388 6.8952893  6.89686293]
    CPU time for vj and vk      6.96 sec, wall time      0.22 sec
E1 = (4.1935989899395745-1.1608080326799498e-17j)  E_coul = (-2.2412883677640836+2.40666312736053e-19j)
Extra cycle  E= -10.8348185234487  delta_E= -1.28e-09  |g|= 4.08e-05  |ddm|= 0.00173
    CPU time for scf_cycle     65.02 sec, wall time      2.09 sec
    CPU time for SCF     70.78 sec, wall time      2.91 sec
converged SCF energy = -10.8348185234487
**** SCF Summaries ****
Total Energy =                         -10.834818523448750
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193598989939574
Two-electron Energy =                   -2.241288367764084
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89512
pop of  0 C 3s            0.00353
pop of  0 C 2px           1.05195
pop of  0 C 2py           1.01183
pop of  0 C 2pz           1.01166
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00649
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89495
pop of  1 C 3s            0.00354
pop of  1 C 2px           1.05212
pop of  1 C 2py           1.01147
pop of  1 C 2pz           1.01168
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00651
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00016
charge of    1C =      0.00016
    CPU time for vj and vk      0.71 sec, wall time      0.03 sec
Traceback (most recent call last):
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-10/200/main.py", line 100, in <module>
    main(config)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-10/200/main.py", line 34, in main
    mf_s = k2s_scf(scf_obj)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/pyscf-forge-lnocc/pyscf/pbc/lno/tools.py", line 40, in k2s_scf
    mf = scf.RHF(scell, kpt=kpts[0]).rs_density_fit(auxbasis=kmf.with_df.auxbasis)
AttributeError: 'InterpolativeSeparableDensityFitting' object has no attribute 'auxbasis'
End time = Tue May 27 03:53:13 PM PDT 2025
