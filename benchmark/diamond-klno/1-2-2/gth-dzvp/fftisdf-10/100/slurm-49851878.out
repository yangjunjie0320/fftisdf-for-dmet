SLURMD_NODENAME = hpc-19-35
Start time = Tue May 27 03:52:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49851878/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49851878/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-10/100/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 100.0
density_fitting_method: fftisdf-10
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 2029, c0 =  10.00, nao = 26, nip = 260
Parent grid size = 3375, selected grid size = 260
truncated values = 6.42e+01, estimated error = 2.35e+00
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 260.
    CPU time for building inpv_kpt      0.16 sec, wall time      0.01 sec

Out-core version is used for eta_kpt.
disk space required: 2.02e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   2.02e-01 GB
memory needed for each k-point: 5.06e-02 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     11.31 sec, wall time      0.45 sec
    CPU time for building eta_kpt     12.79 sec, wall time      0.50 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      8.46 sec, wall time      0.27 sec
    CPU time for coul_kpt[ 2 / 4]      7.81 sec, wall time      0.26 sec
    CPU time for coul_kpt[ 3 / 4]      7.96 sec, wall time      0.26 sec
    CPU time for coul_kpt[ 4 / 4]      7.92 sec, wall time      0.26 sec
    CPU time for building coul_kpt     32.41 sec, wall time      1.06 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49851878/jmaafri0


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49851878/tmp_s_m8n7f
max_memory 327680 MB (current use 422 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fdfdcf840d0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      2.75 sec, wall time      0.09 sec
E1 = (3.6045119526610736-4.992027001475097e-18j)  E_coul = (-4.237891674496242+8.746526841798056e-18j)
init E= -13.4205088674594
    CPU time for initialize scf      6.03 sec, wall time      0.20 sec
HOMO = 0.642156647408  LUMO = 0.776555232826
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97408926  0.60525943  0.6092327   0.64215665] [0.8597983  0.88579657 0.91018228 1.12508181 1.79088174 1.80518002
 1.86213171 2.08324013 2.0871976  2.09907214 2.64574465 2.64766098
 2.64898967 3.55329445 3.55399247 3.55479798 3.6596077  3.66034024
 4.20993973 4.73471512 4.7353097  4.7355905 ]
   1 ( 0.000  0.000 -0.500)   [-0.77997631 -0.50845106  0.46133316  0.50286817] [0.94784876 1.0214569  1.04033483 1.35347409 1.62937885 1.75598584
 1.81459998 1.82397709 2.11254806 2.1193131  2.95649011 3.06731775
 3.06852068 3.10239217 3.10325505 3.30392992 3.64907239 3.65337144
 3.76741326 3.76762094 5.13900631 9.64988165]
   2 (-0.000 -0.500  0.000)   [-0.78001683 -0.50844096  0.4612815   0.50284729] [0.94784035 1.02149523 1.04031113 1.35347557 1.62933593 1.7560284
 1.81463049 1.82423409 2.1126253  2.11920895 2.95654289 3.06741824
 3.06839988 3.10240319 3.10314918 3.30379836 3.6492757  3.65323356
 3.76729113 3.76788448 5.13903085 9.64991176]
   3 ( 0.000 -0.500 -0.500)   [-0.41677503 -0.40445901  0.22474242  0.3106603 ] [0.77655523 0.84141172 1.40154795 1.40350176 1.67773992 1.68166155
 2.07037472 2.0759076  2.31223587 2.31461783 2.79337563 2.80063425
 2.87049936 2.87949485 2.95496313 2.95594248 3.67420724 3.67552251
 5.04699669 5.0474802  6.80917902 6.81444324]
    CPU time for vj and vk      2.85 sec, wall time      0.09 sec
E1 = (4.197961001135173-2.0396691764400518e-18j)  E_coul = (-2.2325626054051337-2.694068695228014e-19j)
cycle= 1 E= -10.8217307498942  delta_E=  2.6  |g|= 0.446  |ddm|= 14.9
    CPU time for cycle= 1      3.40 sec, wall time      0.11 sec
HOMO = 0.352199379977  LUMO = 0.898317898103
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67154896  0.30145587  0.34064373  0.35219938] [0.97849448 0.99126861 1.01474419 1.33228425 1.80541039 1.8059552
 1.88419787 2.11977123 2.12169532 2.1251644  2.70801368 2.71163373
 2.71196322 3.56368181 3.5653907  3.57015368 3.69769167 3.70499647
 4.22156925 4.77093614 4.77254435 4.77449653]
   1 ( 0.000  0.000 -0.500)   [-0.39607187 -0.25659125  0.18702928  0.22272031] [1.09294416 1.10494442 1.15037861 1.396989   1.68419872 1.81159623
 1.84719628 1.85162265 2.11918763 2.12589181 3.00546795 3.12340797
 3.12509751 3.13795661 3.14082981 3.32126329 3.66783016 3.66814966
 3.79991734 3.80623569 5.1860968  9.83351884]
   2 (-0.000 -0.500  0.000)   [-0.39606485 -0.25653615  0.18702202  0.22265121] [1.09293434 1.10498879 1.15038181 1.3970384  1.68424036 1.81159129
 1.84711899 1.85181251 2.11922061 2.12573742 3.00538633 3.1234522
 3.12485387 3.13803249 3.1407277  3.32116004 3.66786935 3.66797787
 3.79995936 3.8065809  5.18601695 9.8335356 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25540878 -0.25112269  0.03949034  0.07506643] [0.8983179  0.95906108 1.5026989  1.51000788 1.74945103 1.76461832
 2.07044797 2.07224671 2.32314609 2.3306953  2.8433276  2.8512106
 2.88483079 2.8851521  2.98373183 2.9872527  3.73236328 3.73345404
 5.07585079 5.07875124 6.89805689 6.89887252]
    CPU time for vj and vk      2.83 sec, wall time      0.09 sec
E1 = (4.194305222980584-1.1028107698338218e-18j)  E_coul = (-2.2413967908867884+1.0367072900654904e-19j)
cycle= 2 E= -10.8342207135304  delta_E= -0.0125  |g|= 0.0896  |ddm|= 4.38
    CPU time for cycle= 2      3.48 sec, wall time      0.11 sec
HOMO = 0.34601605758  LUMO = 0.903532636308
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66963699  0.29994893  0.33512403  0.34601606] [0.98169618 0.99573004 1.01711785 1.3386999  1.80527089 1.80610619
 1.88502549 2.12040441 2.12280675 2.12620319 2.70734776 2.71023983
 2.71095439 3.56383403 3.56577478 3.56974514 3.69900257 3.70592306
 4.2194659  4.77195423 4.77317913 4.77503242]
   1 ( 0.000  0.000 -0.500)   [-0.39575039 -0.25765267  0.18684659  0.21790695] [1.09766239 1.10842774 1.15156871 1.39883632 1.68494918 1.8120157
 1.84618867 1.85174328 2.1191975  2.12566478 3.00616958 3.12406677
 3.12529233 3.13865855 3.14104892 3.32178573 3.66744026 3.66845899
 3.80030356 3.80622416 5.18494717 9.82825664]
   2 (-0.000 -0.500  0.000)   [-0.39575023 -0.25758206  0.18684176  0.21782041] [1.09765481 1.10846416 1.15157497 1.39888392 1.68499254 1.81202411
 1.84610675 1.85192129 2.11923769 2.12552342 3.00609161 3.12410356
 3.12505301 3.13873653 3.14096309 3.32169167 3.66754997 3.66819415
 3.80034087 3.80655156 5.18487744 9.8282715 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25624047 -0.25196637  0.04001711  0.07056282] [0.90353264 0.95982509 1.50630936 1.51278952 1.75050622 1.76455327
 2.06996543 2.07161306 2.32335525 2.33115957 2.84331033 2.8515454
 2.88490418 2.88528794 2.98351147 2.98729488 3.7338328  3.73454985
 5.07588364 5.0781165  6.89484426 6.89623658]
    CPU time for vj and vk      2.85 sec, wall time      0.09 sec
E1 = (4.193549160818087-1.1689557469126035e-18j)  E_coul = (-2.2412358011229436+2.1402442719401808e-19j)
cycle= 3 E= -10.8348157859291  delta_E= -0.000595  |g|= 0.00536  |ddm|= 0.858
    CPU time for cycle= 3      3.47 sec, wall time      0.11 sec
HOMO = 0.346360282899  LUMO = 0.903840324087
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66913358  0.30032859  0.33528437  0.34636028] [0.98218092 0.99631444 1.01756869 1.33928135 1.80547557 1.80628544
 1.88489312 2.12055589 2.12290376 2.12635384 2.70774441 2.71059249
 2.71139744 3.5639402  3.56591941 3.56978196 3.69931939 3.70619795
 4.21952069 4.77223283 4.77342926 4.7752689 ]
   1 ( 0.000  0.000 -0.500)   [-0.39514445 -0.25730743  0.18731555  0.21815758] [1.09808026 1.1088929  1.15176382 1.39890951 1.68509288 1.81239508
 1.84640803 1.85198344 2.11940769 2.1257427  3.00652033 3.12430685
 3.12544369 3.13917084 3.1415119  3.32190188 3.6675297  3.66859621
 3.80053276 3.80643525 5.1852652  9.82952287]
   2 (-0.000 -0.500  0.000)   [-0.39514223 -0.25724042  0.18731066  0.21807114] [1.09807574 1.10893054 1.15176848 1.39895732 1.68513872 1.81240053
 1.84632619 1.85216154 2.11944533 2.12559774 3.00643896 3.12434619
 3.12520508 3.13924843 3.14142655 3.32181057 3.66763761 3.66833439
 3.80056943 3.80676291 5.1851955  9.82953853]
   3 ( 0.000 -0.500 -0.500)   [-0.25574399 -0.25155372  0.04044218  0.07083883] [0.90384032 0.95981986 1.50709416 1.51357499 1.75080141 1.7648301
 2.07005305 2.07162377 2.32346668 2.33139606 2.84366015 2.85184085
 2.88494226 2.88540917 2.98371516 2.98752328 3.73415106 3.73501187
 5.07612848 5.07830103 6.89537982 6.89693384]
    CPU time for vj and vk      2.97 sec, wall time      0.10 sec
E1 = (4.1935768704125-1.2168075950062965e-18j)  E_coul = (-2.241266201667243+2.1988927577860556e-19j)
cycle= 4 E= -10.834818476879  delta_E= -2.69e-06  |g|= 0.000625  |ddm|= 0.103
    CPU time for cycle= 4      3.67 sec, wall time      0.12 sec
HOMO = 0.346316709482  LUMO = 0.903827393351
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.669186    0.30027159  0.33520892  0.34631671] [0.98215751 0.99628118 1.01753323 1.33922681 1.80546339 1.80626287
 1.88490653 2.12054633 2.1228827  2.12634118 2.70768858 2.71053495
 2.7113507  3.56392812 3.5659086  3.56976384 3.69929055 3.70616799
 4.21950382 4.7722089  4.7734011  4.77524016]
   1 ( 0.000  0.000 -0.500)   [-0.39516475 -0.25737569  0.18726727  0.21809312] [1.09803881 1.10886437 1.15173974 1.39891486 1.68506384 1.812355
 1.84636494 1.85194676 2.11940048 2.12571806 3.00648897 3.12429535
 3.12542652 3.13911971 3.14145745 3.32189413 3.66751085 3.66858729
 3.80050026 3.80640246 5.18522724 9.82934932]
   2 (-0.000 -0.500  0.000)   [-0.39516275 -0.25730824  0.18726245  0.2180062 ] [1.09803413 1.10890178 1.15174452 1.39896271 1.68510981 1.812361
 1.84628286 1.85212492 2.11943846 2.12557348 3.00640789 3.12433429
 3.1251881  3.13919729 3.14137206 3.32180269 3.66761836 3.66832539
 3.80053681 3.80672986 5.18515751 9.82936491]
   3 ( 0.000 -0.500 -0.500)   [-0.2558014  -0.25160906  0.04039099  0.07080163] [0.90382739 0.95981133 1.50704313 1.5135433  1.75073472 1.7647702
 2.07003719 2.07161176 2.32344409 2.33137314 2.84361966 2.85179741
 2.88492879 2.88541001 2.98368366 2.98750462 3.73410831 3.7349755
 5.07610546 5.07827307 6.89528625 6.89685978]
    CPU time for vj and vk      3.20 sec, wall time      0.10 sec
E1 = (4.193598275682722-1.2194068955907057e-18j)  E_coul = (-2.2412876541970745+2.19832768498534e-19j)
cycle= 5 E= -10.8348185241386  delta_E= -4.73e-08  |g|= 0.000109  |ddm|= 0.00986
    CPU time for cycle= 5      4.09 sec, wall time      0.13 sec
HOMO = 0.346323277286  LUMO = 0.903828413319
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66918369  0.30027204  0.33520895  0.34632328] [0.98215868 0.99628238 1.01753371 1.33922804 1.80546391 1.8062634
 1.88490559 2.12054589 2.12288186 2.12634179 2.70768933 2.71053603
 2.71135356 3.56392854 3.56590913 3.56976364 3.69929111 3.70616845
 4.2195047  4.7722096  4.7734015  4.77524063]
   1 ( 0.000  0.000 -0.500)   [-0.39515974 -0.25737339  0.18726792  0.21809364] [1.09803925 1.10886555 1.151739   1.39891407 1.68506479 1.81235691
 1.8463653  1.85194774 2.11940322 2.12571821 3.00649086 3.12429619
 3.12542654 3.13912089 3.14145809 3.321894   3.6675106  3.66858817
 3.80050002 3.80640265 5.18522871 9.82935568]
   2 (-0.000 -0.500  0.000)   [-0.39515772 -0.25730598  0.1872631   0.21800673] [1.0980346  1.10890298 1.15174377 1.39896194 1.68511078 1.81236288
 1.84628321 1.85212589 2.11944117 2.1255736  3.00640975 3.12433521
 3.12518808 3.13919841 3.14137276 3.32180259 3.66761812 3.66832629
 3.80053658 3.80673006 5.18515899 9.82937128]
   3 ( 0.000 -0.500 -0.500)   [-0.25579828 -0.2516084   0.04039198  0.07080549] [0.90382841 0.95981083 1.50704422 1.51354761 1.75073492 1.7647684
 2.07003796 2.07161192 2.32344354 2.33137449 2.84362064 2.85179776
 2.88493054 2.88540859 2.983684   2.98750601 3.73410814 3.73497714
 5.07610653 5.07827386 6.89528933 6.89686295]
    CPU time for vj and vk      2.87 sec, wall time      0.09 sec
E1 = (4.193598986971781-1.2191248389546456e-18j)  E_coul = (-2.2412883667633845+2.1985751322708485e-19j)
Extra cycle  E= -10.8348185254158  delta_E= -1.28e-09  |g|= 4.08e-05  |ddm|= 0.00173
    CPU time for scf_cycle     27.60 sec, wall time      0.89 sec
    CPU time for SCF     33.56 sec, wall time      1.85 sec
converged SCF energy = -10.8348185254158
**** SCF Summaries ****
Total Energy =                         -10.834818525415843
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193598986971781
Two-electron Energy =                   -2.241288366763384
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89512
pop of  0 C 3s            0.00353
pop of  0 C 2px           1.05195
pop of  0 C 2py           1.01183
pop of  0 C 2pz           1.01166
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00649
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89495
pop of  1 C 3s            0.00354
pop of  1 C 2px           1.05212
pop of  1 C 2py           1.01147
pop of  1 C 2pz           1.01168
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00651
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00016
charge of    1C =      0.00016
    CPU time for vj and vk      0.62 sec, wall time      0.02 sec
Traceback (most recent call last):
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-10/100/main.py", line 100, in <module>
    main(config)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-10/100/main.py", line 34, in main
    mf_s = k2s_scf(scf_obj)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/pyscf-forge-lnocc/pyscf/pbc/lno/tools.py", line 40, in k2s_scf
    mf = scf.RHF(scell, kpt=kpts[0]).rs_density_fit(auxbasis=kmf.with_df.auxbasis)
AttributeError: 'InterpolativeSeparableDensityFitting' object has no attribute 'auxbasis'
End time = Tue May 27 03:53:07 PM PDT 2025
