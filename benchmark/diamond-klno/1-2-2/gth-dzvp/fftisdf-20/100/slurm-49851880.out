SLURMD_NODENAME = hpc-52-36
Start time = Tue May 27 03:52:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49851880/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49851880/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-20/100/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 100.0
density_fitting_method: fftisdf-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 2029, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 3375, selected grid size = 520
truncated values = 6.63e+01, estimated error = 2.32e-01
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [23 23 23] (12167 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (100 / [23 23 23]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.61 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 520.
    CPU time for building inpv_kpt      0.17 sec, wall time      0.01 sec

Out-core version is used for eta_kpt.
disk space required: 4.05e-01 GB.
blksize = 12167, ngrid = 12167
memory needed for each block:   4.05e-01 GB
memory needed for each k-point: 1.01e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 12167]     12.97 sec, wall time      0.71 sec
    CPU time for building eta_kpt     14.49 sec, wall time      0.76 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]     10.71 sec, wall time      0.81 sec
    CPU time for coul_kpt[ 2 / 4]      8.57 sec, wall time      0.68 sec
    CPU time for coul_kpt[ 3 / 4]      8.54 sec, wall time      0.67 sec
    CPU time for coul_kpt[ 4 / 4]      8.46 sec, wall time      0.66 sec
    CPU time for building coul_kpt     37.02 sec, wall time      2.84 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49851880/l1qmfpxv


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49851880/tmpzxrgk0kv
max_memory 327680 MB (current use 412 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7fe68276c0d0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      3.73 sec, wall time      0.12 sec
E1 = (3.6045119526610736-9.076412729955186e-19j)  E_coul = (-4.238149019187077+2.8233883736402104e-17j)
init E= -13.4207662121502
    CPU time for initialize scf      7.31 sec, wall time      0.24 sec
HOMO = 0.642149196884  LUMO = 0.776527790638
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422275  0.60527324  0.60923189  0.6421492 ] [0.85981144 0.88582629 0.91020115 1.12519841 1.7910035  1.80523367
 1.86205512 2.08341745 2.08748567 2.09924937 2.64579332 2.64766562
 2.64895313 3.55320123 3.55392062 3.55480359 3.65950806 3.66029188
 4.21012328 4.73495909 4.73542627 4.73597525]
   1 ( 0.000  0.000 -0.500)   [-0.78014987 -0.50848287  0.4613322   0.50285064] [0.94785699 1.02143236 1.04032591 1.35354276 1.62942557 1.75601761
 1.81457156 1.82408445 2.11260187 2.11925268 2.95658171 3.06754745
 3.06862645 3.10243449 3.1032096  3.30379374 3.64927079 3.65340133
 3.76724752 3.76776199 5.1391744  9.64995731]
   2 (-0.000 -0.500  0.000)   [-0.78015065 -0.5084834   0.46133117  0.50285024] [0.94785687 1.02143161 1.04032572 1.35354486 1.62942844 1.75601398
 1.81457113 1.82408313 2.11260118 2.11925466 2.95658467 3.06755004
 3.06862729 3.10243216 3.10320746 3.30379281 3.64927619 3.65340888
 3.76724602 3.76775939 5.13917635 9.64995993]
   3 ( 0.000 -0.500 -0.500)   [-0.41689215 -0.40450198  0.22475862  0.31063627] [0.77652779 0.84136696 1.40153325 1.40349428 1.67780104 1.68166346
 2.07043143 2.07586365 2.31225602 2.31465206 2.79346749 2.80079508
 2.87065361 2.87949446 2.95490649 2.95599372 3.67413168 3.67560485
 5.04761872 5.04820356 6.80908691 6.81454919]
    CPU time for vj and vk      3.81 sec, wall time      0.12 sec
E1 = (4.198024160578392-4.6786560790313144e-18j)  E_coul = (-2.232609386331779+1.9118458324141708e-17j)
cycle= 1 E= -10.8217143713776  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      4.41 sec, wall time      0.14 sec
HOMO = 0.352245212462  LUMO = 0.898271502912
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169373  0.30156393  0.3406806   0.35224521] [0.97852876 0.99133596 1.01471849 1.33231625 1.805542   1.80602151
 1.88404869 2.11998684 2.12203235 2.12539728 2.70808031 2.71166952
 2.71193883 3.56352557 3.5654116  3.5699784  3.69758946 3.70486785
 4.22160097 4.77132516 4.77265807 4.77476534]
   1 ( 0.000  0.000 -0.500)   [-0.39621692 -0.25657641  0.18713092  0.22273415] [1.09293208 1.10500356 1.15031157 1.3970919  1.68429896 1.81151053
 1.84709422 1.85166073 2.11920439 2.12573382 3.00549217 3.12357646
 3.12502746 3.13812075 3.14101156 3.3210925  3.66803601 3.66810226
 3.79985919 3.80638244 5.18613544 9.83350742]
   2 (-0.000 -0.500  0.000)   [-0.39621661 -0.25657681  0.18712695  0.22273263] [1.09293291 1.10500179 1.1503101  1.39709403 1.68430156 1.81150515
 1.84709679 1.85165985 2.11920466 2.1257383  3.00549412 3.12357065
 3.12502719 3.13812378 3.1410121  3.3210927  3.66804621 3.66810677
 3.7998585  3.8063929  5.18613799 9.83351014]
   3 ( 0.000 -0.500 -0.500)   [-0.25545706 -0.25122917  0.03956477  0.07508996] [0.8982715  0.9590005  1.50273775 1.50995213 1.74944463 1.76464804
 2.07048937 2.07210206 2.32316352 2.33068249 2.84347509 2.85142892
 2.88507627 2.88514196 2.98374982 2.98719955 3.73224366 3.73350235
 5.07640948 5.07990974 6.89788232 6.89900118]
    CPU time for vj and vk      3.70 sec, wall time      0.12 sec
E1 = (4.19421067519405-4.044897044000007e-18j)  E_coul = (-2.2412680695249123+1.959080445062291e-17j)
cycle= 2 E= -10.8341865399551  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      4.36 sec, wall time      0.14 sec
HOMO = 0.346103451331  LUMO = 0.903474373295
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976024  0.30008777  0.33519833  0.34610345] [0.98176763 0.99581612 1.01711465 1.33874517 1.80541335 1.80618479
 1.88485885 2.12064983 2.12314234 2.12643298 2.70745964 2.71030394
 2.71095921 3.56369671 3.565821   3.56959423 3.69892177 3.70582135
 4.21948583 4.77236492 4.77326746 4.77526548]
   1 ( 0.000  0.000 -0.500)   [-0.39588015 -0.25760968  0.18697698  0.21794837] [1.09766484 1.10849924 1.15152573 1.39893399 1.68507848 1.81196418
 1.84609814 1.85179549 2.11922511 2.1255222  3.00621197 3.12425797
 3.12524359 3.13886332 3.14126938 3.32162463 3.66769032 3.66834579
 3.80025973 3.80639111 5.18501871 9.82837588]
   2 (-0.000 -0.500  0.000)   [-0.3958798  -0.25761007  0.18697297  0.21794661] [1.09766606 1.10849766 1.15152438 1.3989361  1.68508108 1.81195948
 1.84610071 1.85179481 2.11922546 2.12552668 3.00621413 3.12425243
 3.12524231 3.13886646 3.14126946 3.32162496 3.66769771 3.66835261
 3.80025877 3.8064017  5.18502092 9.82837802]
   3 ( 0.000 -0.500 -0.500)   [-0.2562769  -0.25205086  0.04012023  0.07062905] [0.90347437 0.95976748 1.50637815 1.51278219 1.75053789 1.76461619
 2.07003307 2.07148058 2.3233878  2.33115262 2.84349413 2.85177414
 2.88517665 2.88526694 2.98354545 2.98724846 3.7337669  3.734602
 5.07649282 5.07917386 6.89473265 6.89641678]
    CPU time for vj and vk      3.61 sec, wall time      0.12 sec
E1 = (4.19344587295147-3.8466186085535624e-18j)  E_coul = (-2.241097199577164+1.972595411685914e-17j)
cycle= 3 E= -10.8347804722499  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      4.31 sec, wall time      0.14 sec
HOMO = 0.346444836984  LUMO = 0.903778586936
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926017  0.30046148  0.33535232  0.34644484] [0.98224851 0.99639527 1.01756097 1.33931863 1.80561644 1.80636184
 1.88472751 2.12079883 2.12323769 2.1265822  2.70785004 2.71065184
 2.71139551 3.56380136 3.56596242 3.56963027 3.6992364  3.70609252
 4.21953925 4.77264088 4.77351411 4.77549866]
   1 ( 0.000  0.000 -0.500)   [-0.39527646 -0.25726904  0.18744088  0.21819453] [1.0980799  1.10896055 1.15171683 1.39900599 1.68521869 1.81233708
 1.84631467 1.85203146 2.11943244 2.12559717 3.0065565  3.12449749
 3.12539173 3.13936878 3.14172736 3.32174064 3.66777536 3.66848466
 3.80048718 3.80659832 5.18533215 9.82962328]
   2 (-0.000 -0.500  0.000)   [-0.39527612 -0.25726943  0.18743686  0.21819276] [1.09808111 1.10895898 1.15171548 1.39900807 1.68522129 1.81233233
 1.84631726 1.85203077 2.11943281 2.12560167 3.00655866 3.12449193
 3.12539044 3.13937194 3.14172741 3.32174094 3.66778274 3.66849152
 3.80048623 3.80660892 5.18533437 9.8296254 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25578374 -0.25164216  0.04054044  0.07090332] [0.90377859 0.9597614  1.5071551  1.51356056 1.75082447 1.76488719
 2.07011805 2.0714912  2.32349659 2.33138739 2.84383964 2.85206498
 2.88518792 2.88541189 2.98374523 2.9874742  3.73407884 3.73506263
 5.07673567 5.07935599 6.89525478 6.89710941]
    CPU time for vj and vk      3.77 sec, wall time      0.12 sec
E1 = (4.193475039656153-3.823337011559338e-18j)  E_coul = (-2.2411290524168637+1.973511387482392e-17j)
cycle= 4 E= -10.834783158385  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      4.43 sec, wall time      0.14 sec
HOMO = 0.346400892508  LUMO = 0.903765380382
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931333  0.30040413  0.33527605  0.34640089] [0.98222476 0.99636163 1.01752505 1.33926345 1.80560417 1.80633894
 1.8847412  2.12078911 2.12321642 2.12656935 2.70779392 2.71059382
 2.71134828 3.56378926 3.56595155 3.56961216 3.69920728 3.70606237
 4.21952245 4.77261645 4.77348536 4.77546943]
   1 ( 0.000  0.000 -0.500)   [-0.39529743 -0.25733776  0.18739225  0.21812918] [1.0980379  1.10893155 1.15169265 1.39901144 1.68518954 1.81229686
 1.84627109 1.85199447 2.11942529 2.12557262 3.00652491 3.12448555
 3.12537445 3.13931704 3.14167243 3.32173282 3.66775603 3.66847549
 3.80045439 3.80656522 5.18529385 9.82944805]
   2 (-0.000 -0.500  0.000)   [-0.39529709 -0.25733815  0.18738823  0.21812742] [1.09803911 1.10892998 1.15169131 1.39901352 1.68519214 1.81229212
 1.84627368 1.85199377 2.11942566 2.12557712 3.00652706 3.12447999
 3.12537314 3.13932019 3.14167247 3.32173312 3.6677634  3.66848235
 3.80045345 3.80657581 5.18529606 9.82945017]
   3 ( 0.000 -0.500 -0.500)   [-0.25584203 -0.2516982   0.04048886  0.07086579] [0.90376538 0.95975293 1.50710355 1.51352847 1.75075761 1.76482624
 2.07010211 2.07147931 2.32347359 2.33136437 2.84379871 2.85202105
 2.88517861 2.88540851 2.98371354 2.98745531 3.73403672 3.73502491
 5.07671233 5.07932711 6.89516271 6.89703225]
    CPU time for vj and vk      3.72 sec, wall time      0.12 sec
E1 = (4.193496535964209-3.821525687295707e-18j)  E_coul = (-2.2411505948646413+1.9736058548006565e-17j)
cycle= 5 E= -10.8347832045247  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00952
    CPU time for cycle= 5      4.37 sec, wall time      0.14 sec
HOMO = 0.346407882007  LUMO = 0.903766538386
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931055  0.30040505  0.33527657  0.34640788] [0.98222619 0.99636315 1.01752583 1.33926512 1.80560483 1.80633965
 1.88474016 2.12078876 2.12321574 2.12657007 2.70779511 2.71059535
 2.71135156 3.56378978 3.56595219 3.56961209 3.69920809 3.70606308
 4.21952347 4.77261735 4.77348603 4.77547014]
   1 ( 0.000  0.000 -0.500)   [-0.39529211 -0.25733495  0.18739331  0.21813017] [1.0980387  1.10893301 1.1516921  1.39901062 1.68519071 1.81229911
 1.84627177 1.85199574 2.11942812 2.12557292 3.00652707 3.12448657
 3.12537461 3.1393186  3.14167353 3.32173278 3.66775592 3.66847648
 3.80045442 3.80656567 5.18529566 9.82945583]
   2 (-0.000 -0.500  0.000)   [-0.39529177 -0.25733534  0.18738929  0.21812841] [1.0980399  1.10893144 1.15169075 1.39901271 1.68519331 1.81229437
 1.84627436 1.85199504 2.11942849 2.12557742 3.00652922 3.12448102
 3.1253733  3.13932175 3.14167357 3.32173308 3.6677633  3.66848334
 3.80045348 3.80657626 5.18529787 9.82945795]
   3 ( 0.000 -0.500 -0.500)   [-0.25583845 -0.25169706  0.04049027  0.07086999] [0.90376654 0.9597525  1.50710513 1.51353318 1.75075796 1.76482515
 2.07010302 2.07147955 2.32347326 2.33136585 2.84380002 2.85202177
 2.88517767 2.88540988 2.98371412 2.98745689 3.73403645 3.7350273
 5.0767136  5.07932814 6.89516508 6.89703753]
    CPU time for vj and vk      3.86 sec, wall time      0.12 sec
E1 = (4.193497112602906-3.82168067048742e-18j)  E_coul = (-2.2411511723826103+1.973613879536296e-17j)
Extra cycle  E= -10.8347832054039  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00139
    CPU time for scf_cycle     33.74 sec, wall time      1.09 sec
    CPU time for SCF     39.53 sec, wall time      1.45 sec
converged SCF energy = -10.8347832054039
**** SCF Summaries ****
Total Energy =                         -10.834783205403944
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193497112602906
Two-electron Energy =                   -2.241151172382610
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89509
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01164
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.49 sec, wall time      0.05 sec
Traceback (most recent call last):
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-20/100/main.py", line 100, in <module>
    main(config)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-20/100/main.py", line 34, in main
    mf_s = k2s_scf(scf_obj)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/pyscf-forge-lnocc/pyscf/pbc/lno/tools.py", line 40, in k2s_scf
    mf = scf.RHF(scell, kpt=kpts[0]).rs_density_fit(auxbasis=kmf.with_df.auxbasis)
AttributeError: 'InterpolativeSeparableDensityFitting' object has no attribute 'auxbasis'
End time = Tue May 27 03:53:09 PM PDT 2025
