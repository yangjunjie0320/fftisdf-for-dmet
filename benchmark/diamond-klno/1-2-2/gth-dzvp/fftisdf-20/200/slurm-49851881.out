SLURMD_NODENAME = hpc-52-39
Start time = Tue May 27 03:52:51 PM PDT 2025
/central/home/junjiey/anaconda3/bin/activate
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//diamond/49851881/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//diamond/49851881/

Running /resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-20/200/main.py with:
name: diamond
xc: None
kmesh: 1-2-2
basis: gth-dzvp
pseudo: gth-pbe
ke_cutoff: 200.0
density_fitting_method: fftisdf-20
is_unrestricted: False
init_guess_method: minao
df_to_read: None


Cholesky rank = 2029, c0 =  20.00, nao = 26, nip = 520
Parent grid size = 3375, selected grid size = 520
truncated values = 6.63e+01, estimated error = 2.32e-01
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.52161)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            2.12325
pop of  0 C 3s            0.00000
pop of  0 C 2px           0.75946
pop of  0 C 2py           0.55865
pop of  0 C 2pz           0.55865
pop of  0 C 3px           0.00000
pop of  0 C 3py           0.00000
pop of  0 C 3pz           0.00000
pop of  0 C 3dxy          0.00000
pop of  0 C 3dyz          0.00000
pop of  0 C 3dz^2         0.00000
pop of  0 C 3dxz          0.00000
pop of  0 C 3dx2-y2       0.00000
pop of  1 C 2s            2.12325
pop of  1 C 3s            0.00000
pop of  1 C 2px           0.75946
pop of  1 C 2py           0.55865
pop of  1 C 2pz           0.55865
pop of  1 C 3px           0.00000
pop of  1 C 3py           0.00000
pop of  1 C 3pz           0.00000
pop of  1 C 3dxy          0.00000
pop of  1 C 3dyz          0.00000
pop of  1 C 3dz^2         0.00000
pop of  1 C 3dxz          0.00000
pop of  1 C 3dx2-y2       0.00000
 ** Mulliken atomic charges  **
charge of    0C =      0.00000
charge of    1C =      0.00000


******** <class 'fft.isdf.InterpolativeSeparableDensityFitting'> ********
mesh = [33 33 33] (35937 PWs)
len(kpts) = 4
tol = 1e-08
c0 = 20.0
wrap_around = True
Overwritten attributes  build  of <class 'fft.isdf.InterpolativeSeparableDensityFitting'>

WARN: ke_cutoff/mesh (200 / [33 33 33]) is not enough for FFTDF to get integral accuracy 1e-08.
Coulomb integral error is ~ 0.0027 Eh.
Recommended ke_cutoff/mesh are 422.908 / [47 47 47].

Using pre-computed interpolating vectors, c0 is not used
Number of interpolating points is 520.
    CPU time for building inpv_kpt      0.25 sec, wall time      0.01 sec

Out-core version is used for eta_kpt.
disk space required: 1.20e+00 GB.
blksize = 35937, ngrid = 35937
memory needed for each block:   1.20e+00 GB
memory needed for each k-point: 2.99e-01 GB
max_memory: 3.27e+02 GB

Computing eta_kpt
    CPU time for eta_kpt[     0: 35937]     18.74 sec, wall time      2.35 sec
    CPU time for building eta_kpt     22.98 sec, wall time      2.49 sec

Computing coul_kpt
    CPU time for coul_kpt[ 1 / 4]      8.53 sec, wall time      2.01 sec
    CPU time for coul_kpt[ 2 / 4]      3.36 sec, wall time      1.40 sec
    CPU time for coul_kpt[ 3 / 4]      3.35 sec, wall time      1.40 sec
    CPU time for coul_kpt[ 4 / 4]      3.34 sec, wall time      1.39 sec
    CPU time for building coul_kpt     19.44 sec, wall time      6.23 sec
Successfully removed swap file /resnick/scratch/yangjunjie/diamond/49851881/sbdrqn57


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /resnick/scratch/yangjunjie/diamond/49851881/tmp7rniez6u
max_memory 327680 MB (current use 419 MB)


******** PBC SCF flags ********
N kpts = 4
kpts = [[ 0.          0.          0.        ]
 [-0.46609264 -0.46609264  0.46609264]
 [-0.46609264  0.46609264 -0.46609264]
 [-0.93218529  0.          0.        ]]
Exchange divergence treatment (exxdiv) = ewald
    madelung (= occupied orbital energy shift) = 0.38332141474093495
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.53328565896
DF object = <fft.isdf.InterpolativeSeparableDensityFitting object at 0x7f44ac5880d0>
Set gradient conv threshold to 0.001
    CPU time for vj and vk      7.34 sec, wall time      0.23 sec
E1 = (3.604511953301932+1.815282545991041e-18j)  E_coul = (-4.238149020775185+2.7183857079339254e-17j)
init E= -13.4207662130975
    CPU time for initialize scf     14.90 sec, wall time      0.48 sec
HOMO = 0.642149205515  LUMO = 0.776527800132
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-1.97422275  0.60527325  0.60923189  0.64214921] [0.85981145 0.88582629 0.91020115 1.12519836 1.7910035  1.80523367
 1.86205514 2.08341732 2.08748551 2.09924934 2.64579324 2.64766563
 2.64895332 3.55320071 3.55392    3.55480327 3.65950807 3.66029198
 4.2101229  4.73495799 4.73542517 4.73597621]
   1 ( 0.000  0.000 -0.500)   [-0.78014987 -0.50848287  0.4613322   0.50285064] [0.94785698 1.02143235 1.04032591 1.35354277 1.62942553 1.7560176
 1.81457165 1.82408447 2.1126019  2.11925268 2.95658165 3.06754763
 3.06862625 3.10243447 3.10320966 3.30379368 3.64927118 3.65340121
 3.76724791 3.76776177 5.13917511 9.64995736]
   2 (-0.000 -0.500  0.000)   [-0.78015065 -0.5084834   0.46133117  0.50285025] [0.94785687 1.02143162 1.04032573 1.35354487 1.62942844 1.75601384
 1.81457112 1.82408316 2.11260118 2.11925463 2.95658459 3.06754999
 3.06862722 3.10243222 3.10320741 3.3037929  3.64927692 3.6534094
 3.7672456  3.76775899 5.1391764  9.6499602 ]
   3 ( 0.000 -0.500 -0.500)   [-0.41689216 -0.40450198  0.22475861  0.31063627] [0.7765278  0.84136698 1.40153325 1.40349427 1.67780107 1.68166343
 2.07043137 2.07586364 2.31225603 2.31465205 2.79346733 2.80079507
 2.87065376 2.87949454 2.95490652 2.95599365 3.67413173 3.67560495
 5.0476143  5.04821033 6.80908703 6.81454945]
    CPU time for vj and vk      7.53 sec, wall time      0.24 sec
E1 = (4.1980241466117185+9.402484553606525e-18j)  E_coul = (-2.232609373994748+1.7709845442527397e-17j)
cycle= 1 E= -10.8217143730073  delta_E=  2.6  |g|= 0.446  |ddm|= 14.8
    CPU time for cycle= 1      8.07 sec, wall time      0.26 sec
HOMO = 0.352245218121  LUMO = 0.898271516087
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67169373  0.30156394  0.34068058  0.35224522] [0.97852877 0.99133597 1.0147185  1.33231616 1.805542   1.80602152
 1.88404871 2.11998652 2.12203211 2.12539733 2.7080798  2.71166997
 2.71193866 3.56352512 3.56541062 3.56997818 3.69758948 3.70486794
 4.22160087 4.77132195 4.77265756 4.7747618 ]
   1 ( 0.000  0.000 -0.500)   [-0.39621691 -0.25657641  0.18713094  0.22273415] [1.09293208 1.10500355 1.1503116  1.39709207 1.68429884 1.81151079
 1.84709446 1.85166071 2.11920441 2.12573382 3.00549217 3.12357677
 3.12502743 3.13812063 3.14101147 3.32109237 3.66803505 3.66810426
 3.79985905 3.80638162 5.18613696 9.83350877]
   2 (-0.000 -0.500  0.000)   [-0.39621661 -0.2565768   0.18712695  0.22273262] [1.09293293 1.10500183 1.1503101  1.39709402 1.68430155 1.81150514
 1.84709679 1.85166    2.11920469 2.12573831 3.00549392 3.12357069
 3.1250275  3.13812356 3.14101237 3.32109278 3.66804781 3.66810812
 3.79985788 3.80639319 5.18613808 9.83350852]
   3 ( 0.000 -0.500 -0.500)   [-0.25545706 -0.25122917  0.03956477  0.07508996] [0.89827152 0.95900055 1.50273774 1.50995216 1.74944467 1.76464792
 2.07048939 2.07210215 2.32316353 2.33068249 2.8434751  2.85142897
 2.8850765  2.88514217 2.9837495  2.98719947 3.73224382 3.73350258
 5.07640133 5.07991263 6.89788284 6.89900244]
    CPU time for vj and vk      7.55 sec, wall time      0.24 sec
E1 = (4.194210682410936+7.299756750158694e-18j)  E_coul = (-2.2412680815880077+1.820370471608879e-17j)
cycle= 2 E= -10.8341865448013  delta_E= -0.0125  |g|= 0.0895  |ddm|= 4.05
    CPU time for cycle= 2      8.19 sec, wall time      0.26 sec
HOMO = 0.346103449729  LUMO = 0.903474385466
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66976024  0.30008778  0.33519831  0.34610345] [0.98176763 0.99581613 1.01711466 1.33874507 1.80541335 1.80618479
 1.88485887 2.12064956 2.12314215 2.12643303 2.70745911 2.71030435
 2.71095904 3.5636964  3.56582004 3.56959397 3.69892182 3.70582141
 4.21948582 4.77236195 4.77326718 4.77526173]
   1 ( 0.000  0.000 -0.500)   [-0.39588014 -0.25760969  0.18697699  0.21794837] [1.09766484 1.10849924 1.15152577 1.39893418 1.68507838 1.81196446
 1.84609838 1.85179548 2.11922514 2.12552221 3.00621195 3.12425834
 3.1252436  3.13886324 3.14126935 3.32162449 3.66769133 3.66834585
 3.80025964 3.80639039 5.18502028 9.82837665]
   2 (-0.000 -0.500  0.000)   [-0.3958798  -0.25761006  0.18697296  0.2179466 ] [1.09766607 1.10849771 1.15152438 1.39893606 1.68508106 1.81195944
 1.8461007  1.85179497 2.11922548 2.1255267  3.00621392 3.12425243
 3.12524263 3.13886625 3.14126977 3.32162504 3.66769883 3.66835435
 3.80025823 3.80640201 5.18502107 9.82837654]
   3 ( 0.000 -0.500 -0.500)   [-0.25627691 -0.25205087  0.04012023  0.07062904] [0.90347439 0.95976753 1.50637814 1.5127822  1.75053794 1.76461609
 2.07003306 2.07148067 2.32338781 2.33115262 2.84349413 2.8517742
 2.88517687 2.88526719 2.98354519 2.98724842 3.73376706 3.73460221
 5.07648434 5.07917821 6.89473315 6.89641784]
    CPU time for vj and vk      7.52 sec, wall time      0.24 sec
E1 = (4.193445884495419+6.901041756322603e-18j)  E_coul = (-2.241097216093415+1.833928681117805e-17j)
cycle= 3 E= -10.8347804772222  delta_E= -0.000594  |g|= 0.00536  |ddm|= 0.838
    CPU time for cycle= 3      8.18 sec, wall time      0.26 sec
HOMO = 0.346444835685  LUMO = 0.903778599538
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66926017  0.30046149  0.3353523   0.34644484] [0.98224851 0.99639528 1.01756098 1.33931854 1.80561643 1.80636184
 1.88472753 2.12079857 2.1232375  2.12658224 2.70784952 2.71065226
 2.71139535 3.56380105 3.56596147 3.56963001 3.69923644 3.70609259
 4.21953923 4.77263789 4.77351384 4.77549494]
   1 ( 0.000  0.000 -0.500)   [-0.39527646 -0.25726905  0.1874409   0.21819453] [1.09807991 1.10896054 1.15171687 1.39900618 1.68521858 1.81233735
 1.84631491 1.85203144 2.11943247 2.12559717 3.00655648 3.12449785
 3.12539175 3.1393687  3.14172732 3.3217405  3.66777637 3.6684847
 3.80048709 3.80659761 5.18533371 9.82962405]
   2 (-0.000 -0.500  0.000)   [-0.39527612 -0.25726942  0.18743685  0.21819275] [1.09808112 1.10895902 1.15171548 1.39900804 1.68522127 1.81233229
 1.84631725 1.85203093 2.11943284 2.12560169 3.00655844 3.12449193
 3.12539076 3.13937173 3.14172771 3.32174101 3.66778386 3.66849325
 3.8004857  3.80660923 5.18533451 9.82962394]
   3 ( 0.000 -0.500 -0.500)   [-0.25578374 -0.25164216  0.04054044  0.07090332] [0.9037786  0.95976145 1.50715509 1.51356057 1.75082452 1.76488709
 2.07011804 2.07149129 2.3234966  2.33138739 2.84383965 2.85206504
 2.88518815 2.88541212 2.98374497 2.98747416 3.734079   3.73506284
 5.07672728 5.07936049 6.89525529 6.8971105 ]
    CPU time for vj and vk      7.55 sec, wall time      0.24 sec
E1 = (4.193475050790823+6.8594352274634365e-18j)  E_coul = (-2.241129068523575+1.8348445585914316e-17j)
cycle= 4 E= -10.834783163357  delta_E= -2.69e-06  |g|= 0.000614  |ddm|= 0.0987
    CPU time for cycle= 4      8.18 sec, wall time      0.26 sec
HOMO = 0.346400891239  LUMO = 0.903765392992
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931333  0.30040414  0.33527603  0.34640089] [0.98222476 0.99636165 1.01752506 1.33926336 1.80560417 1.80633894
 1.88474123 2.12078884 2.12321624 2.1265694  2.7077934  2.71059423
 2.71134811 3.56378895 3.56595061 3.5696119  3.69920733 3.70606244
 4.21952242 4.77261346 4.77348509 4.7754657 ]
   1 ( 0.000  0.000 -0.500)   [-0.39529743 -0.25733777  0.18739227  0.21812919] [1.09803791 1.10893154 1.15169269 1.39901162 1.68518943 1.81229714
 1.84627133 1.85199445 2.11942532 2.12557263 3.00652489 3.12448592
 3.12537446 3.13931696 3.14167239 3.32173268 3.66775704 3.66847553
 3.8004543  3.80656451 5.1852954  9.82944882]
   2 (-0.000 -0.500  0.000)   [-0.39529709 -0.25733814  0.18738822  0.2181274 ] [1.09803912 1.10893002 1.15169131 1.39901349 1.68519213 1.81229208
 1.84627367 1.85199393 2.11942569 2.12557714 3.00652684 3.12448
 3.12537346 3.13931999 3.14167277 3.32173319 3.66776452 3.66848409
 3.80045291 3.80657612 5.18529621 9.82944872]
   3 ( 0.000 -0.500 -0.500)   [-0.25584204 -0.2516982   0.04048885  0.07086578] [0.90376539 0.95975298 1.50710354 1.51352848 1.75075765 1.76482614
 2.0701021  2.0714794  2.3234736  2.33136437 2.84379872 2.85202111
 2.88517884 2.88540875 2.98371328 2.98745527 3.73403688 3.73502512
 5.07670393 5.07933163 6.89516322 6.89703334]
    CPU time for vj and vk      7.62 sec, wall time      0.24 sec
E1 = (4.193496547081073+6.8552724494822185e-18j)  E_coul = (-2.241150610953504+1.8349608907324544e-17j)
cycle= 5 E= -10.8347832094967  delta_E= -4.61e-08  |g|= 8.44e-05  |ddm|= 0.00952
    CPU time for cycle= 5      8.28 sec, wall time      0.26 sec
HOMO = 0.346407880743  LUMO = 0.903766550994
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.66931055  0.30040506  0.33527656  0.34640788] [0.98222619 0.99636316 1.01752584 1.33926503 1.80560482 1.80633965
 1.88474018 2.1207885  2.12321555 2.12657012 2.70779459 2.71059577
 2.71135139 3.56378948 3.56595124 3.56961183 3.69920814 3.70606315
 4.21952345 4.77261435 4.77348576 4.77546642]
   1 ( 0.000  0.000 -0.500)   [-0.39529211 -0.25733496  0.18739333  0.21813017] [1.0980387  1.108933   1.15169213 1.39901081 1.6851906  1.81229938
 1.84627201 1.85199572 2.11942815 2.12557293 3.00652705 3.12448694
 3.12537462 3.13931852 3.14167349 3.32173264 3.66775693 3.66847653
 3.80045434 3.80656496 5.18529721 9.8294566 ]
   2 (-0.000 -0.500  0.000)   [-0.39529178 -0.25733534  0.18738928  0.21812839] [1.09803992 1.10893148 1.15169075 1.39901268 1.68519329 1.81229432
 1.84627434 1.8519952  2.11942852 2.12557744 3.006529   3.12448102
 3.12537363 3.13932155 3.14167387 3.32173315 3.66776442 3.66848508
 3.80045295 3.80657657 5.18529802 9.8294565 ]
   3 ( 0.000 -0.500 -0.500)   [-0.25583846 -0.25169707  0.04049027  0.07086998] [0.90376655 0.95975255 1.50710512 1.51353318 1.75075801 1.76482505
 2.07010301 2.07147964 2.32347327 2.33136585 2.84380002 2.85202182
 2.88517789 2.88541012 2.98371386 2.98745685 3.73403661 3.73502752
 5.0767052  5.07933266 6.89516559 6.89703861]
    CPU time for vj and vk      7.52 sec, wall time      0.24 sec
E1 = (4.1934971237197285+6.856855259573578e-18j)  E_coul = (-2.241151188471433+1.834975074625791e-17j)
Extra cycle  E= -10.8347832103759  delta_E= -8.79e-10  |g|= 2.67e-05  |ddm|= 0.00139
    CPU time for scf_cycle     63.94 sec, wall time      2.04 sec
    CPU time for SCF     69.72 sec, wall time      2.87 sec
converged SCF energy = -10.8347832103759
**** SCF Summaries ****
Total Energy =                         -10.834783210375944
Nuclear Repulsion Energy =             -12.787129145624240
One-electron Energy =                    4.193497123719728
Two-electron Energy =                   -2.241151188471433
 ** Mulliken pop on meta-lowdin orthogonal AOs **
 ** Mulliken pop  **
pop of  0 C 2s            0.89509
pop of  0 C 3s            0.00355
pop of  0 C 2px           1.05199
pop of  0 C 2py           1.01165
pop of  0 C 2pz           1.01165
pop of  0 C 3px           0.00285
pop of  0 C 3py           0.00220
pop of  0 C 3pz           0.00220
pop of  0 C 3dxy          0.00650
pop of  0 C 3dyz          0.00556
pop of  0 C 3dz^2         0.00010
pop of  0 C 3dxz          0.00650
pop of  0 C 3dx2-y2       0.00015
pop of  1 C 2s            0.89510
pop of  1 C 3s            0.00355
pop of  1 C 2px           1.05199
pop of  1 C 2py           1.01165
pop of  1 C 2pz           1.01164
pop of  1 C 3px           0.00285
pop of  1 C 3py           0.00220
pop of  1 C 3pz           0.00220
pop of  1 C 3dxy          0.00650
pop of  1 C 3dyz          0.00556
pop of  1 C 3dz^2         0.00010
pop of  1 C 3dxz          0.00650
pop of  1 C 3dx2-y2       0.00015
 ** Mulliken atomic charges  **
charge of    0C =     -0.00000
charge of    1C =      0.00000
    CPU time for vj and vk      1.54 sec, wall time      0.05 sec
Traceback (most recent call last):
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-20/200/main.py", line 100, in <module>
    main(config)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/benchmark/diamond-klno/1-2-2/gth-dzvp/fftisdf-20/200/main.py", line 34, in main
    mf_s = k2s_scf(scf_obj)
  File "/resnick/groups/changroup/members/junjiey/fftisdf-for-dmet/src/pyscf-forge-lnocc/pyscf/pbc/lno/tools.py", line 40, in k2s_scf
    mf = scf.RHF(scell, kpt=kpts[0]).rs_density_fit(auxbasis=kmf.with_df.auxbasis)
AttributeError: 'InterpolativeSeparableDensityFitting' object has no attribute 'auxbasis'
End time = Tue May 27 03:53:17 PM PDT 2025
